(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function _x(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var U_={exports:{}},gm={},G_={exports:{}},gn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QT;function WP(){if(QT)return gn;QT=1;var s=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),r=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function p(W){return W===null||typeof W!="object"?null:(W=f&&W[f]||W["@@iterator"],typeof W=="function"?W:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,_={};function S(W,ne,Ee){this.props=W,this.context=ne,this.refs=_,this.updater=Ee||y}S.prototype.isReactComponent={},S.prototype.setState=function(W,ne){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,ne,"setState")},S.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function A(){}A.prototype=S.prototype;function w(W,ne,Ee){this.props=W,this.context=ne,this.refs=_,this.updater=Ee||y}var M=w.prototype=new A;M.constructor=w,v(M,S.prototype),M.isPureReactComponent=!0;var C=Array.isArray,I=Object.prototype.hasOwnProperty,O={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function N(W,ne,Ee){var le,ye={},we=null,Ie=null;if(ne!=null)for(le in ne.ref!==void 0&&(Ie=ne.ref),ne.key!==void 0&&(we=""+ne.key),ne)I.call(ne,le)&&!k.hasOwnProperty(le)&&(ye[le]=ne[le]);var ze=arguments.length-2;if(ze===1)ye.children=Ee;else if(1<ze){for(var Ze=Array(ze),rt=0;rt<ze;rt++)Ze[rt]=arguments[rt+2];ye.children=Ze}if(W&&W.defaultProps)for(le in ze=W.defaultProps,ze)ye[le]===void 0&&(ye[le]=ze[le]);return{$$typeof:s,type:W,key:we,ref:Ie,props:ye,_owner:O.current}}function B(W,ne){return{$$typeof:s,type:W.type,key:ne,ref:W.ref,props:W.props,_owner:W._owner}}function P(W){return typeof W=="object"&&W!==null&&W.$$typeof===s}function G(W){var ne={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(Ee){return ne[Ee]})}var Z=/\/+/g;function Y(W,ne){return typeof W=="object"&&W!==null&&W.key!=null?G(""+W.key):ne.toString(36)}function se(W,ne,Ee,le,ye){var we=typeof W;(we==="undefined"||we==="boolean")&&(W=null);var Ie=!1;if(W===null)Ie=!0;else switch(we){case"string":case"number":Ie=!0;break;case"object":switch(W.$$typeof){case s:case e:Ie=!0}}if(Ie)return Ie=W,ye=ye(Ie),W=le===""?"."+Y(Ie,0):le,C(ye)?(Ee="",W!=null&&(Ee=W.replace(Z,"$&/")+"/"),se(ye,ne,Ee,"",function(rt){return rt})):ye!=null&&(P(ye)&&(ye=B(ye,Ee+(!ye.key||Ie&&Ie.key===ye.key?"":(""+ye.key).replace(Z,"$&/")+"/")+W)),ne.push(ye)),1;if(Ie=0,le=le===""?".":le+":",C(W))for(var ze=0;ze<W.length;ze++){we=W[ze];var Ze=le+Y(we,ze);Ie+=se(we,ne,Ee,Ze,ye)}else if(Ze=p(W),typeof Ze=="function")for(W=Ze.call(W),ze=0;!(we=W.next()).done;)we=we.value,Ze=le+Y(we,ze++),Ie+=se(we,ne,Ee,Ze,ye);else if(we==="object")throw ne=String(W),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.");return Ie}function oe(W,ne,Ee){if(W==null)return W;var le=[],ye=0;return se(W,le,"","",function(we){return ne.call(Ee,we,ye++)}),le}function re(W){if(W._status===-1){var ne=W._result;ne=ne(),ne.then(function(Ee){(W._status===0||W._status===-1)&&(W._status=1,W._result=Ee)},function(Ee){(W._status===0||W._status===-1)&&(W._status=2,W._result=Ee)}),W._status===-1&&(W._status=0,W._result=ne)}if(W._status===1)return W._result.default;throw W._result}var ce={current:null},H={transition:null},$={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:H,ReactCurrentOwner:O};function X(){throw Error("act(...) is not supported in production builds of React.")}return gn.Children={map:oe,forEach:function(W,ne,Ee){oe(W,function(){ne.apply(this,arguments)},Ee)},count:function(W){var ne=0;return oe(W,function(){ne++}),ne},toArray:function(W){return oe(W,function(ne){return ne})||[]},only:function(W){if(!P(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},gn.Component=S,gn.Fragment=t,gn.Profiler=i,gn.PureComponent=w,gn.StrictMode=n,gn.Suspense=l,gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,gn.act=X,gn.cloneElement=function(W,ne,Ee){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var le=v({},W.props),ye=W.key,we=W.ref,Ie=W._owner;if(ne!=null){if(ne.ref!==void 0&&(we=ne.ref,Ie=O.current),ne.key!==void 0&&(ye=""+ne.key),W.type&&W.type.defaultProps)var ze=W.type.defaultProps;for(Ze in ne)I.call(ne,Ze)&&!k.hasOwnProperty(Ze)&&(le[Ze]=ne[Ze]===void 0&&ze!==void 0?ze[Ze]:ne[Ze])}var Ze=arguments.length-2;if(Ze===1)le.children=Ee;else if(1<Ze){ze=Array(Ze);for(var rt=0;rt<Ze;rt++)ze[rt]=arguments[rt+2];le.children=ze}return{$$typeof:s,type:W.type,key:ye,ref:we,props:le,_owner:Ie}},gn.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:r,_context:W},W.Consumer=W},gn.createElement=N,gn.createFactory=function(W){var ne=N.bind(null,W);return ne.type=W,ne},gn.createRef=function(){return{current:null}},gn.forwardRef=function(W){return{$$typeof:a,render:W}},gn.isValidElement=P,gn.lazy=function(W){return{$$typeof:h,_payload:{_status:-1,_result:W},_init:re}},gn.memo=function(W,ne){return{$$typeof:c,type:W,compare:ne===void 0?null:ne}},gn.startTransition=function(W){var ne=H.transition;H.transition={};try{W()}finally{H.transition=ne}},gn.unstable_act=X,gn.useCallback=function(W,ne){return ce.current.useCallback(W,ne)},gn.useContext=function(W){return ce.current.useContext(W)},gn.useDebugValue=function(){},gn.useDeferredValue=function(W){return ce.current.useDeferredValue(W)},gn.useEffect=function(W,ne){return ce.current.useEffect(W,ne)},gn.useId=function(){return ce.current.useId()},gn.useImperativeHandle=function(W,ne,Ee){return ce.current.useImperativeHandle(W,ne,Ee)},gn.useInsertionEffect=function(W,ne){return ce.current.useInsertionEffect(W,ne)},gn.useLayoutEffect=function(W,ne){return ce.current.useLayoutEffect(W,ne)},gn.useMemo=function(W,ne){return ce.current.useMemo(W,ne)},gn.useReducer=function(W,ne,Ee){return ce.current.useReducer(W,ne,Ee)},gn.useRef=function(W){return ce.current.useRef(W)},gn.useState=function(W){return ce.current.useState(W)},gn.useSyncExternalStore=function(W,ne,Ee){return ce.current.useSyncExternalStore(W,ne,Ee)},gn.useTransition=function(){return ce.current.useTransition()},gn.version="18.3.1",gn}var ZT;function T0(){return ZT||(ZT=1,G_.exports=WP()),G_.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ew;function KP(){if(ew)return gm;ew=1;var s=T0(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var h,f={},p=null,y=null;c!==void 0&&(p=""+c),l.key!==void 0&&(p=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)n.call(l,h)&&!r.hasOwnProperty(h)&&(f[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)f[h]===void 0&&(f[h]=l[h]);return{$$typeof:e,type:a,key:p,ref:y,props:f,_owner:i.current}}return gm.Fragment=t,gm.jsx=o,gm.jsxs=o,gm}var tw;function XP(){return tw||(tw=1,U_.exports=KP()),U_.exports}var F=XP(),te=T0();const nw=_x(te);var Ng={},H_={exports:{}},vs={},z_={exports:{}},j_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iw;function $P(){return iw||(iw=1,function(s){function e(H,$){var X=H.length;H.push($);e:for(;0<X;){var W=X-1>>>1,ne=H[W];if(0<i(ne,$))H[W]=$,H[X]=ne,X=W;else break e}}function t(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var $=H[0],X=H.pop();if(X!==$){H[0]=X;e:for(var W=0,ne=H.length,Ee=ne>>>1;W<Ee;){var le=2*(W+1)-1,ye=H[le],we=le+1,Ie=H[we];if(0>i(ye,X))we<ne&&0>i(Ie,ye)?(H[W]=Ie,H[we]=X,W=we):(H[W]=ye,H[le]=X,W=le);else if(we<ne&&0>i(Ie,X))H[W]=Ie,H[we]=X,W=we;else break e}}return $}function i(H,$){var X=H.sortIndex-$.sortIndex;return X!==0?X:H.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;s.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();s.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,f=null,p=3,y=!1,v=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(H){for(var $=t(c);$!==null;){if($.callback===null)n(c);else if($.startTime<=H)n(c),$.sortIndex=$.expirationTime,e(l,$);else break;$=t(c)}}function C(H){if(_=!1,M(H),!v)if(t(l)!==null)v=!0,re(I);else{var $=t(c);$!==null&&ce(C,$.startTime-H)}}function I(H,$){v=!1,_&&(_=!1,A(N),N=-1),y=!0;var X=p;try{for(M($),f=t(l);f!==null&&(!(f.expirationTime>$)||H&&!G());){var W=f.callback;if(typeof W=="function"){f.callback=null,p=f.priorityLevel;var ne=W(f.expirationTime<=$);$=s.unstable_now(),typeof ne=="function"?f.callback=ne:f===t(l)&&n(l),M($)}else n(l);f=t(l)}if(f!==null)var Ee=!0;else{var le=t(c);le!==null&&ce(C,le.startTime-$),Ee=!1}return Ee}finally{f=null,p=X,y=!1}}var O=!1,k=null,N=-1,B=5,P=-1;function G(){return!(s.unstable_now()-P<B)}function Z(){if(k!==null){var H=s.unstable_now();P=H;var $=!0;try{$=k(!0,H)}finally{$?Y():(O=!1,k=null)}}else O=!1}var Y;if(typeof w=="function")Y=function(){w(Z)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,oe=se.port2;se.port1.onmessage=Z,Y=function(){oe.postMessage(null)}}else Y=function(){S(Z,0)};function re(H){k=H,O||(O=!0,Y())}function ce(H,$){N=S(function(){H(s.unstable_now())},$)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(H){H.callback=null},s.unstable_continueExecution=function(){v||y||(v=!0,re(I))},s.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<H?Math.floor(1e3/H):5},s.unstable_getCurrentPriorityLevel=function(){return p},s.unstable_getFirstCallbackNode=function(){return t(l)},s.unstable_next=function(H){switch(p){case 1:case 2:case 3:var $=3;break;default:$=p}var X=p;p=$;try{return H()}finally{p=X}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(H,$){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var X=p;p=H;try{return $()}finally{p=X}},s.unstable_scheduleCallback=function(H,$,X){var W=s.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?W+X:W):X=W,H){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=X+ne,H={id:h++,callback:$,priorityLevel:H,startTime:X,expirationTime:ne,sortIndex:-1},X>W?(H.sortIndex=X,e(c,H),t(l)===null&&H===t(c)&&(_?(A(N),N=-1):_=!0,ce(C,X-W))):(H.sortIndex=ne,e(l,H),v||y||(v=!0,re(I))),H},s.unstable_shouldYield=G,s.unstable_wrapCallback=function(H){var $=p;return function(){var X=p;p=$;try{return H.apply(this,arguments)}finally{p=X}}}}(j_)),j_}var rw;function YP(){return rw||(rw=1,z_.exports=$P()),z_.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sw;function JP(){if(sw)return vs;sw=1;var s=T0(),e=YP();function t(u){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+u,x=1;x<arguments.length;x++)d+="&args[]="+encodeURIComponent(arguments[x]);return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function r(u,d){o(u,d),o(u+"Capture",d)}function o(u,d){for(i[u]=d,u=0;u<d.length;u++)n.add(d[u])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function p(u){return l.call(f,u)?!0:l.call(h,u)?!1:c.test(u)?f[u]=!0:(h[u]=!0,!1)}function y(u,d,x,T){if(x!==null&&x.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return T?!1:x!==null?!x.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function v(u,d,x,T){if(d===null||typeof d>"u"||y(u,d,x,T))return!0;if(T)return!1;if(x!==null)switch(x.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function _(u,d,x,T,R,D,j){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=T,this.attributeNamespace=R,this.mustUseProperty=x,this.propertyName=u,this.type=d,this.sanitizeURL=D,this.removeEmptyString=j}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){S[u]=new _(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var d=u[0];S[d]=new _(d,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){S[u]=new _(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){S[u]=new _(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){S[u]=new _(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){S[u]=new _(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){S[u]=new _(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){S[u]=new _(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){S[u]=new _(u,5,!1,u.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function w(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var d=u.replace(A,w);S[d]=new _(d,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var d=u.replace(A,w);S[d]=new _(d,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var d=u.replace(A,w);S[d]=new _(d,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){S[u]=new _(u,1,!1,u.toLowerCase(),null,!1,!1)}),S.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){S[u]=new _(u,1,!1,u.toLowerCase(),null,!0,!0)});function M(u,d,x,T){var R=S.hasOwnProperty(d)?S[d]:null;(R!==null?R.type!==0:T||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(v(d,x,R,T)&&(x=null),T||R===null?p(d)&&(x===null?u.removeAttribute(d):u.setAttribute(d,""+x)):R.mustUseProperty?u[R.propertyName]=x===null?R.type===3?!1:"":x:(d=R.attributeName,T=R.attributeNamespace,x===null?u.removeAttribute(d):(R=R.type,x=R===3||R===4&&x===!0?"":""+x,T?u.setAttributeNS(T,d,x):u.setAttribute(d,x))))}var C=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),O=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),G=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),re=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),H=Symbol.iterator;function $(u){return u===null||typeof u!="object"?null:(u=H&&u[H]||u["@@iterator"],typeof u=="function"?u:null)}var X=Object.assign,W;function ne(u){if(W===void 0)try{throw Error()}catch(x){var d=x.stack.trim().match(/\n( *(at )?)/);W=d&&d[1]||""}return`
`+W+u}var Ee=!1;function le(u,d){if(!u||Ee)return"";Ee=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(be){var T=be}Reflect.construct(u,[],d)}else{try{d.call()}catch(be){T=be}u.call(d.prototype)}else{try{throw Error()}catch(be){T=be}u()}}catch(be){if(be&&T&&typeof be.stack=="string"){for(var R=be.stack.split(`
`),D=T.stack.split(`
`),j=R.length-1,ie=D.length-1;1<=j&&0<=ie&&R[j]!==D[ie];)ie--;for(;1<=j&&0<=ie;j--,ie--)if(R[j]!==D[ie]){if(j!==1||ie!==1)do if(j--,ie--,0>ie||R[j]!==D[ie]){var he=`
`+R[j].replace(" at new "," at ");return u.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",u.displayName)),he}while(1<=j&&0<=ie);break}}}finally{Ee=!1,Error.prepareStackTrace=x}return(u=u?u.displayName||u.name:"")?ne(u):""}function ye(u){switch(u.tag){case 5:return ne(u.type);case 16:return ne("Lazy");case 13:return ne("Suspense");case 19:return ne("SuspenseList");case 0:case 2:case 15:return u=le(u.type,!1),u;case 11:return u=le(u.type.render,!1),u;case 1:return u=le(u.type,!0),u;default:return""}}function we(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case k:return"Fragment";case O:return"Portal";case B:return"Profiler";case N:return"StrictMode";case Y:return"Suspense";case se:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case G:return(u.displayName||"Context")+".Consumer";case P:return(u._context.displayName||"Context")+".Provider";case Z:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case oe:return d=u.displayName||null,d!==null?d:we(u.type)||"Memo";case re:d=u._payload,u=u._init;try{return we(u(d))}catch{}}return null}function Ie(u){var d=u.type;switch(u.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=d.render,u=u.displayName||u.name||"",d.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return we(d);case 8:return d===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function ze(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function Ze(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function rt(u){var d=Ze(u)?"checked":"value",x=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),T=""+u[d];if(!u.hasOwnProperty(d)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var R=x.get,D=x.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return R.call(this)},set:function(j){T=""+j,D.call(this,j)}}),Object.defineProperty(u,d,{enumerable:x.enumerable}),{getValue:function(){return T},setValue:function(j){T=""+j},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function ct(u){u._valueTracker||(u._valueTracker=rt(u))}function Ne(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var x=d.getValue(),T="";return u&&(T=Ze(u)?u.checked?"true":"false":u.value),u=T,u!==x?(d.setValue(u),!0):!1}function Ge(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Q(u,d){var x=d.checked;return X({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:x??u._wrapperState.initialChecked})}function St(u,d){var x=d.defaultValue==null?"":d.defaultValue,T=d.checked!=null?d.checked:d.defaultChecked;x=ze(d.value!=null?d.value:x),u._wrapperState={initialChecked:T,initialValue:x,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function We(u,d){d=d.checked,d!=null&&M(u,"checked",d,!1)}function st(u,d){We(u,d);var x=ze(d.value),T=d.type;if(x!=null)T==="number"?(x===0&&u.value===""||u.value!=x)&&(u.value=""+x):u.value!==""+x&&(u.value=""+x);else if(T==="submit"||T==="reset"){u.removeAttribute("value");return}d.hasOwnProperty("value")?It(u,d.type,x):d.hasOwnProperty("defaultValue")&&It(u,d.type,ze(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(u.defaultChecked=!!d.defaultChecked)}function qe(u,d,x){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var T=d.type;if(!(T!=="submit"&&T!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+u._wrapperState.initialValue,x||d===u.value||(u.value=d),u.defaultValue=d}x=u.name,x!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,x!==""&&(u.name=x)}function It(u,d,x){(d!=="number"||Ge(u.ownerDocument)!==u)&&(x==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+x&&(u.defaultValue=""+x))}var tt=Array.isArray;function q(u,d,x,T){if(u=u.options,d){d={};for(var R=0;R<x.length;R++)d["$"+x[R]]=!0;for(x=0;x<u.length;x++)R=d.hasOwnProperty("$"+u[x].value),u[x].selected!==R&&(u[x].selected=R),R&&T&&(u[x].defaultSelected=!0)}else{for(x=""+ze(x),d=null,R=0;R<u.length;R++){if(u[R].value===x){u[R].selected=!0,T&&(u[R].defaultSelected=!0);return}d!==null||u[R].disabled||(d=u[R])}d!==null&&(d.selected=!0)}}function V(u,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return X({},d,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function xe(u,d){var x=d.value;if(x==null){if(x=d.children,d=d.defaultValue,x!=null){if(d!=null)throw Error(t(92));if(tt(x)){if(1<x.length)throw Error(t(93));x=x[0]}d=x}d==null&&(d=""),x=d}u._wrapperState={initialValue:ze(x)}}function De(u,d){var x=ze(d.value),T=ze(d.defaultValue);x!=null&&(x=""+x,x!==u.value&&(u.value=x),d.defaultValue==null&&u.defaultValue!==x&&(u.defaultValue=x)),T!=null&&(u.defaultValue=""+T)}function He(u){var d=u.textContent;d===u._wrapperState.initialValue&&d!==""&&d!==null&&(u.value=d)}function Fe(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ht(u,d){return u==null||u==="http://www.w3.org/1999/xhtml"?Fe(d):u==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var nt,mt=function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,x,T,R){MSApp.execUnsafeLocalFunction(function(){return u(d,x,T,R)})}:u}(function(u,d){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=d;else{for(nt=nt||document.createElement("div"),nt.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=nt.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;d.firstChild;)u.appendChild(d.firstChild)}});function Qt(u,d){if(d){var x=u.firstChild;if(x&&x===u.lastChild&&x.nodeType===3){x.nodeValue=d;return}}u.textContent=d}var Xe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},At=["Webkit","ms","Moz","O"];Object.keys(Xe).forEach(function(u){At.forEach(function(d){d=d+u.charAt(0).toUpperCase()+u.substring(1),Xe[d]=Xe[u]})});function kt(u,d,x){return d==null||typeof d=="boolean"||d===""?"":x||typeof d!="number"||d===0||Xe.hasOwnProperty(u)&&Xe[u]?(""+d).trim():d+"px"}function Gt(u,d){u=u.style;for(var x in d)if(d.hasOwnProperty(x)){var T=x.indexOf("--")===0,R=kt(x,d[x],T);x==="float"&&(x="cssFloat"),T?u.setProperty(x,R):u[x]=R}}var vt=X({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ue(u,d){if(d){if(vt[u]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function Be(u,d){if(u.indexOf("-")===-1)return typeof d.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var at=null;function ae(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Ye=null,Ce=null,ke=null;function pt(u){if(u=ko(u)){if(typeof Ye!="function")throw Error(t(280));var d=u.stateNode;d&&(d=Gd(d),Ye(u.stateNode,u.type,d))}}function lt(u){Ce?ke?ke.push(u):ke=[u]:Ce=u}function Ft(){if(Ce){var u=Ce,d=ke;if(ke=Ce=null,pt(u),d)for(u=0;u<d.length;u++)pt(d[u])}}function yn(u,d){return u(d)}function Nn(){}var ln=!1;function ai(u,d,x){if(ln)return u(d,x);ln=!0;try{return yn(u,d,x)}finally{ln=!1,(Ce!==null||ke!==null)&&(Nn(),Ft())}}function gi(u,d){var x=u.stateNode;if(x===null)return null;var T=Gd(x);if(T===null)return null;x=T[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(T=!T.disabled)||(u=u.type,T=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!T;break e;default:u=!1}if(u)return null;if(x&&typeof x!="function")throw Error(t(231,d,typeof x));return x}var Ql=!1;if(a)try{var ua={};Object.defineProperty(ua,"passive",{get:function(){Ql=!0}}),window.addEventListener("test",ua,ua),window.removeEventListener("test",ua,ua)}catch{Ql=!1}function Zs(u,d,x,T,R,D,j,ie,he){var be=Array.prototype.slice.call(arguments,3);try{d.apply(x,be)}catch(Ke){this.onError(Ke)}}var Rs=!1,Wa=null,Is=!1,ha=null,td={onError:function(u){Rs=!0,Wa=u}};function Zl(u,d,x,T,R,D,j,ie,he){Rs=!1,Wa=null,Zs.apply(td,arguments)}function nd(u,d,x,T,R,D,j,ie,he){if(Zl.apply(this,arguments),Rs){if(Rs){var be=Wa;Rs=!1,Wa=null}else throw Error(t(198));Is||(Is=!0,ha=be)}}function eo(u){var d=u,x=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,d.flags&4098&&(x=d.return),u=d.return;while(u)}return d.tag===3?x:null}function id(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function rd(u){if(eo(u)!==u)throw Error(t(188))}function sd(u){var d=u.alternate;if(!d){if(d=eo(u),d===null)throw Error(t(188));return d!==u?null:u}for(var x=u,T=d;;){var R=x.return;if(R===null)break;var D=R.alternate;if(D===null){if(T=R.return,T!==null){x=T;continue}break}if(R.child===D.child){for(D=R.child;D;){if(D===x)return rd(R),u;if(D===T)return rd(R),d;D=D.sibling}throw Error(t(188))}if(x.return!==T.return)x=R,T=D;else{for(var j=!1,ie=R.child;ie;){if(ie===x){j=!0,x=R,T=D;break}if(ie===T){j=!0,T=R,x=D;break}ie=ie.sibling}if(!j){for(ie=D.child;ie;){if(ie===x){j=!0,x=D,T=R;break}if(ie===T){j=!0,T=D,x=R;break}ie=ie.sibling}if(!j)throw Error(t(189))}}if(x.alternate!==T)throw Error(t(190))}if(x.tag!==3)throw Error(t(188));return x.stateNode.current===x?u:d}function od(u){return u=sd(u),u!==null?ad(u):null}function ad(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var d=ad(u);if(d!==null)return d;u=u.sibling}return null}var K=e.unstable_scheduleCallback,me=e.unstable_cancelCallback,Me=e.unstable_shouldYield,Re=e.unstable_requestPaint,de=e.unstable_now,$e=e.unstable_getCurrentPriorityLevel,ot=e.unstable_ImmediatePriority,yt=e.unstable_UserBlockingPriority,Et=e.unstable_NormalPriority,Xt=e.unstable_LowPriority,Nt=e.unstable_IdlePriority,wt=null,xt=null;function Bt(u){if(xt&&typeof xt.onCommitFiberRoot=="function")try{xt.onCommitFiberRoot(wt,u,void 0,(u.current.flags&128)===128)}catch{}}var dn=Math.clz32?Math.clz32:Lt,fn=Math.log,Jt=Math.LN2;function Lt(u){return u>>>=0,u===0?32:31-(fn(u)/Jt|0)|0}var On=64,$t=4194304;function yi(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function os(u,d){var x=u.pendingLanes;if(x===0)return 0;var T=0,R=u.suspendedLanes,D=u.pingedLanes,j=x&268435455;if(j!==0){var ie=j&~R;ie!==0?T=yi(ie):(D&=j,D!==0&&(T=yi(D)))}else j=x&~R,j!==0?T=yi(j):D!==0&&(T=yi(D));if(T===0)return 0;if(d!==0&&d!==T&&!(d&R)&&(R=T&-T,D=d&-d,R>=D||R===16&&(D&4194240)!==0))return d;if(T&4&&(T|=x&16),d=u.entangledLanes,d!==0)for(u=u.entanglements,d&=T;0<d;)x=31-dn(d),R=1<<x,T|=u[x],d&=~R;return T}function Qi(u,d){switch(u){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function to(u,d){for(var x=u.suspendedLanes,T=u.pingedLanes,R=u.expirationTimes,D=u.pendingLanes;0<D;){var j=31-dn(D),ie=1<<j,he=R[j];he===-1?(!(ie&x)||ie&T)&&(R[j]=Qi(ie,d)):he<=d&&(u.expiredLanes|=ie),D&=~ie}}function Ln(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function zn(){var u=On;return On<<=1,!(On&4194240)&&(On=64),u}function Zi(u){for(var d=[],x=0;31>x;x++)d.push(u);return d}function li(u,d,x){u.pendingLanes|=d,d!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,d=31-dn(d),u[d]=x}function er(u,d){var x=u.pendingLanes&~d;u.pendingLanes=d,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=d,u.mutableReadLanes&=d,u.entangledLanes&=d,d=u.entanglements;var T=u.eventTimes;for(u=u.expirationTimes;0<x;){var R=31-dn(x),D=1<<R;d[R]=0,T[R]=-1,u[R]=-1,x&=~D}}function no(u,d){var x=u.entangledLanes|=d;for(u=u.entanglements;x;){var T=31-dn(x),R=1<<T;R&d|u[T]&d&&(u[T]|=d),x&=~R}}var cn=0;function ec(u){return u&=-u,1<u?4<u?u&268435455?16:536870912:4:1}var au,Ap,K0,ld,cd,Ka=!1,ud=[],io=null,pn=null,Ro=null,Xa=new Map,tc=new Map,da=[],u_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ei(u,d){switch(u){case"focusin":case"focusout":io=null;break;case"dragenter":case"dragleave":pn=null;break;case"mouseover":case"mouseout":Ro=null;break;case"pointerover":case"pointerout":Xa.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":tc.delete(d.pointerId)}}function $a(u,d,x,T,R,D){return u===null||u.nativeEvent!==D?(u={blockedOn:d,domEventName:x,eventSystemFlags:T,nativeEvent:D,targetContainers:[R]},d!==null&&(d=ko(d),d!==null&&Ap(d)),u):(u.eventSystemFlags|=T,d=u.targetContainers,R!==null&&d.indexOf(R)===-1&&d.push(R),u)}function h_(u,d,x,T,R){switch(d){case"focusin":return io=$a(io,u,d,x,T,R),!0;case"dragenter":return pn=$a(pn,u,d,x,T,R),!0;case"mouseover":return Ro=$a(Ro,u,d,x,T,R),!0;case"pointerover":var D=R.pointerId;return Xa.set(D,$a(Xa.get(D)||null,u,d,x,T,R)),!0;case"gotpointercapture":return D=R.pointerId,tc.set(D,$a(tc.get(D)||null,u,d,x,T,R)),!0}return!1}function hd(u){var d=xa(u.target);if(d!==null){var x=eo(d);if(x!==null){if(d=x.tag,d===13){if(d=id(x),d!==null){u.blockedOn=d,cd(u.priority,function(){K0(x)});return}}else if(d===3&&x.stateNode.current.memoizedState.isDehydrated){u.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}u.blockedOn=null}function dd(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var x=ls(u.domEventName,u.eventSystemFlags,d[0],u.nativeEvent);if(x===null){x=u.nativeEvent;var T=new x.constructor(x.type,x);at=T,x.target.dispatchEvent(T),at=null}else return d=ko(x),d!==null&&Ap(d),u.blockedOn=x,!1;d.shift()}return!0}function lu(u,d,x){dd(u)&&x.delete(d)}function ro(){Ka=!1,io!==null&&dd(io)&&(io=null),pn!==null&&dd(pn)&&(pn=null),Ro!==null&&dd(Ro)&&(Ro=null),Xa.forEach(lu),tc.forEach(lu)}function cu(u,d){u.blockedOn===d&&(u.blockedOn=null,Ka||(Ka=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ro)))}function uu(u){function d(R){return cu(R,u)}if(0<ud.length){cu(ud[0],u);for(var x=1;x<ud.length;x++){var T=ud[x];T.blockedOn===u&&(T.blockedOn=null)}}for(io!==null&&cu(io,u),pn!==null&&cu(pn,u),Ro!==null&&cu(Ro,u),Xa.forEach(d),tc.forEach(d),x=0;x<da.length;x++)T=da[x],T.blockedOn===u&&(T.blockedOn=null);for(;0<da.length&&(x=da[0],x.blockedOn===null);)hd(x),x.blockedOn===null&&da.shift()}var mr=C.ReactCurrentBatchConfig,as=!0;function fd(u,d,x,T){var R=cn,D=mr.transition;mr.transition=null;try{cn=1,pd(u,d,x,T)}finally{cn=R,mr.transition=D}}function Ep(u,d,x,T){var R=cn,D=mr.transition;mr.transition=null;try{cn=4,pd(u,d,x,T)}finally{cn=R,mr.transition=D}}function pd(u,d,x,T){if(as){var R=ls(u,d,x,T);if(R===null)Od(u,d,T,md,x),Ei(u,T);else if(h_(R,u,d,x,T))T.stopPropagation();else if(Ei(u,T),d&4&&-1<u_.indexOf(u)){for(;R!==null;){var D=ko(R);if(D!==null&&au(D),D=ls(u,d,x,T),D===null&&Od(u,d,T,md,x),D===R)break;R=D}R!==null&&T.stopPropagation()}else Od(u,d,T,null,x)}}var md=null;function ls(u,d,x,T){if(md=null,u=ae(T),u=xa(u),u!==null)if(d=eo(u),d===null)u=null;else if(x=d.tag,x===13){if(u=id(d),u!==null)return u;u=null}else if(x===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null);return md=u,null}function X0(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case ot:return 1;case yt:return 4;case Et:case Xt:return 16;case Nt:return 536870912;default:return 16}default:return 16}}var Ls=null,Tp=null,Mr=null;function hu(){if(Mr)return Mr;var u,d=Tp,x=d.length,T,R="value"in Ls?Ls.value:Ls.textContent,D=R.length;for(u=0;u<x&&d[u]===R[u];u++);var j=x-u;for(T=1;T<=j&&d[x-T]===R[D-T];T++);return Mr=R.slice(u,1<T?1-T:void 0)}function Ya(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function Io(){return!0}function gd(){return!1}function gr(u){function d(x,T,R,D,j){this._reactName=x,this._targetInst=R,this.type=T,this.nativeEvent=D,this.target=j,this.currentTarget=null;for(var ie in u)u.hasOwnProperty(ie)&&(x=u[ie],this[ie]=x?x(D):D[ie]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?Io:gd,this.isPropagationStopped=gd,this}return X(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=Io)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=Io)},persist:function(){},isPersistent:Io}),d}var Ja={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},du=gr(Ja),qa=X({},Ja,{view:0,detail:0}),nc=gr(qa),br,cs,us,ic=X({},qa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pa,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==us&&(us&&u.type==="mousemove"?(br=u.screenX-us.screenX,cs=u.screenY-us.screenY):cs=br=0,us=u),br)},movementY:function(u){return"movementY"in u?u.movementY:cs}}),wp=gr(ic),Lo=X({},ic,{dataTransfer:0}),fa=gr(Lo),yd=X({},qa,{relatedTarget:0}),vd=gr(yd),xd=X({},Ja,{animationName:0,elapsedTime:0,pseudoElement:0}),$0=gr(xd),Y0=X({},Ja,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),Mp=gr(Y0),_d=X({},Ja,{data:0}),bp=gr(_d),J0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rc(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=Cp[u])?!!d[u]:!1}function pa(){return rc}var Sd=X({},qa,{key:function(u){if(u.key){var d=J0[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=Ya(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?q0[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pa,charCode:function(u){return u.type==="keypress"?Ya(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Ya(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Ad=gr(Sd),hs=X({},ic,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jr=gr(hs),Qa=X({},qa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pa}),Po=gr(Qa),Do=X({},Ja,{propertyName:0,elapsedTime:0,pseudoElement:0}),Za=gr(Do),Q0=X({},ic,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),Rp=gr(Q0),Ip=[9,13,27,32],yr=a&&"CompositionEvent"in window,Hi=null;a&&"documentMode"in document&&(Hi=document.documentMode);var Xn=a&&"TextEvent"in window&&!Hi,sc=a&&(!yr||Hi&&8<Hi&&11>=Hi),ds=" ",Lp=!1;function Pp(u,d){switch(u){case"keyup":return Ip.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ed(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var ma=!1;function Z0(u,d){switch(u){case"compositionend":return Ed(d);case"keypress":return d.which!==32?null:(Lp=!0,ds);case"textInput":return u=d.data,u===ds&&Lp?null:u;default:return null}}function fu(u,d){if(ma)return u==="compositionend"||!yr&&Pp(u,d)?(u=hu(),Mr=Tp=Ls=null,ma=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return sc&&d.locale!=="ko"?null:d.data;default:return null}}var oc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Td(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!oc[u.type]:d==="textarea"}function ac(u,d,x,T){lt(T),d=Bd(d,"onChange"),0<d.length&&(x=new du("onChange","change",null,x,T),u.push({event:x,listeners:d}))}var ga=null,lc=null;function eg(u){dc(u,0)}function Oo(u){var d=ci(u);if(Ne(d))return u}function tg(u,d){if(u==="change")return d}var cc=!1;if(a){var Cr;if(a){var el="oninput"in document;if(!el){var tl=document.createElement("div");tl.setAttribute("oninput","return;"),el=typeof tl.oninput=="function"}Cr=el}else Cr=!1;cc=Cr&&(!document.documentMode||9<document.documentMode)}function Ps(){ga&&(ga.detachEvent("onpropertychange",wd),lc=ga=null)}function wd(u){if(u.propertyName==="value"&&Oo(lc)){var d=[];ac(d,lc,u,ae(u)),ai(eg,d)}}function uc(u,d,x){u==="focusin"?(Ps(),ga=d,lc=x,ga.attachEvent("onpropertychange",wd)):u==="focusout"&&Ps()}function ng(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Oo(lc)}function Dp(u,d){if(u==="click")return Oo(d)}function Qn(u,d){if(u==="input"||u==="change")return Oo(d)}function Md(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var Vr=typeof Object.is=="function"?Object.is:Md;function nl(u,d){if(Vr(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var x=Object.keys(u),T=Object.keys(d);if(x.length!==T.length)return!1;for(T=0;T<x.length;T++){var R=x[T];if(!l.call(d,R)||!Vr(u[R],d[R]))return!1}return!0}function pu(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function Wr(u,d){var x=pu(u);u=0;for(var T;x;){if(x.nodeType===3){if(T=u+x.textContent.length,u<=d&&T>=d)return{node:x,offset:d-u};u=T}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=pu(x)}}function il(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?il(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function Zn(){for(var u=window,d=Ge();d instanceof u.HTMLIFrameElement;){try{var x=typeof d.contentWindow.location.href=="string"}catch{x=!1}if(x)u=d.contentWindow;else break;d=Ge(u.document)}return d}function Ri(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}function Ii(u){var d=Zn(),x=u.focusedElem,T=u.selectionRange;if(d!==x&&x&&x.ownerDocument&&il(x.ownerDocument.documentElement,x)){if(T!==null&&Ri(x)){if(d=T.start,u=T.end,u===void 0&&(u=d),"selectionStart"in x)x.selectionStart=d,x.selectionEnd=Math.min(u,x.value.length);else if(u=(d=x.ownerDocument||document)&&d.defaultView||window,u.getSelection){u=u.getSelection();var R=x.textContent.length,D=Math.min(T.start,R);T=T.end===void 0?D:Math.min(T.end,R),!u.extend&&D>T&&(R=T,T=D,D=R),R=Wr(x,D);var j=Wr(x,T);R&&j&&(u.rangeCount!==1||u.anchorNode!==R.node||u.anchorOffset!==R.offset||u.focusNode!==j.node||u.focusOffset!==j.offset)&&(d=d.createRange(),d.setStart(R.node,R.offset),u.removeAllRanges(),D>T?(u.addRange(d),u.extend(j.node,j.offset)):(d.setEnd(j.node,j.offset),u.addRange(d)))}}for(d=[],u=x;u=u.parentNode;)u.nodeType===1&&d.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<d.length;x++)u=d[x],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var bd=a&&"documentMode"in document&&11>=document.documentMode,so=null,rl=null,mu=null,Li=!1;function Cd(u,d,x){var T=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;Li||so==null||so!==Ge(T)||(T=so,"selectionStart"in T&&Ri(T)?T={start:T.selectionStart,end:T.selectionEnd}:(T=(T.ownerDocument&&T.ownerDocument.defaultView||window).getSelection(),T={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset}),mu&&nl(mu,T)||(mu=T,T=Bd(rl,"onSelect"),0<T.length&&(d=new du("onSelect","select",null,d,x),u.push({event:d,listeners:T}),d.target=so)))}function hc(u,d){var x={};return x[u.toLowerCase()]=d.toLowerCase(),x["Webkit"+u]="webkit"+d,x["Moz"+u]="moz"+d,x}var ya={animationend:hc("Animation","AnimationEnd"),animationiteration:hc("Animation","AnimationIteration"),animationstart:hc("Animation","AnimationStart"),transitionend:hc("Transition","TransitionEnd")},Ds={},Os={};a&&(Os=document.createElement("div").style,"AnimationEvent"in window||(delete ya.animationend.animation,delete ya.animationiteration.animation,delete ya.animationstart.animation),"TransitionEvent"in window||delete ya.transitionend.transition);function oo(u){if(Ds[u])return Ds[u];if(!ya[u])return u;var d=ya[u],x;for(x in d)if(d.hasOwnProperty(x)&&x in Os)return Ds[u]=d[x];return u}var gu=oo("animationend"),yu=oo("animationiteration"),Op=oo("animationstart"),Bp=oo("transitionend"),Fp=new Map,kp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bo(u,d){Fp.set(u,d),r(d,[u])}for(var Rd=0;Rd<kp.length;Rd++){var vu=kp[Rd],xu=vu.toLowerCase(),ig=vu[0].toUpperCase()+vu.slice(1);Bo(xu,"on"+ig)}Bo(gu,"onAnimationEnd"),Bo(yu,"onAnimationIteration"),Bo(Op,"onAnimationStart"),Bo("dblclick","onDoubleClick"),Bo("focusin","onFocus"),Bo("focusout","onBlur"),Bo(Bp,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),r("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),r("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),r("onBeforeInput",["compositionend","keypress","textInput","paste"]),r("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var va="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Id=new Set("cancel close invalid load scroll toggle".split(" ").concat(va));function Ld(u,d,x){var T=u.type||"unknown-event";u.currentTarget=x,nd(T,d,void 0,u),u.currentTarget=null}function dc(u,d){d=(d&4)!==0;for(var x=0;x<u.length;x++){var T=u[x],R=T.event;T=T.listeners;e:{var D=void 0;if(d)for(var j=T.length-1;0<=j;j--){var ie=T[j],he=ie.instance,be=ie.currentTarget;if(ie=ie.listener,he!==D&&R.isPropagationStopped())break e;Ld(R,ie,be),D=he}else for(j=0;j<T.length;j++){if(ie=T[j],he=ie.instance,be=ie.currentTarget,ie=ie.listener,he!==D&&R.isPropagationStopped())break e;Ld(R,ie,be),D=he}}}if(Is)throw u=ha,Is=!1,ha=null,u}function Un(u,d){var x=d[al];x===void 0&&(x=d[al]=new Set);var T=u+"__bubble";x.has(T)||(Dd(d,u,2,!1),x.add(T))}function Pd(u,d,x){var T=0;d&&(T|=4),Dd(x,u,T,d)}var _u="_reactListening"+Math.random().toString(36).slice(2);function fc(u){if(!u[_u]){u[_u]=!0,n.forEach(function(x){x!=="selectionchange"&&(Id.has(x)||Pd(x,!1,u),Pd(x,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[_u]||(d[_u]=!0,Pd("selectionchange",!1,d))}}function Dd(u,d,x,T){switch(X0(d)){case 1:var R=fd;break;case 4:R=Ep;break;default:R=pd}x=R.bind(null,d,x,u),R=void 0,!Ql||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(R=!0),T?R!==void 0?u.addEventListener(d,x,{capture:!0,passive:R}):u.addEventListener(d,x,!0):R!==void 0?u.addEventListener(d,x,{passive:R}):u.addEventListener(d,x,!1)}function Od(u,d,x,T,R){var D=T;if(!(d&1)&&!(d&2)&&T!==null)e:for(;;){if(T===null)return;var j=T.tag;if(j===3||j===4){var ie=T.stateNode.containerInfo;if(ie===R||ie.nodeType===8&&ie.parentNode===R)break;if(j===4)for(j=T.return;j!==null;){var he=j.tag;if((he===3||he===4)&&(he=j.stateNode.containerInfo,he===R||he.nodeType===8&&he.parentNode===R))return;j=j.return}for(;ie!==null;){if(j=xa(ie),j===null)return;if(he=j.tag,he===5||he===6){T=D=j;continue e}ie=ie.parentNode}}T=T.return}ai(function(){var be=D,Ke=ae(x),Je=[];e:{var Ve=Fp.get(u);if(Ve!==void 0){var _t=du,Ct=u;switch(u){case"keypress":if(Ya(x)===0)break e;case"keydown":case"keyup":_t=Ad;break;case"focusin":Ct="focus",_t=vd;break;case"focusout":Ct="blur",_t=vd;break;case"beforeblur":case"afterblur":_t=vd;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_t=wp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_t=fa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_t=Po;break;case gu:case yu:case Op:_t=$0;break;case Bp:_t=Za;break;case"scroll":_t=nc;break;case"wheel":_t=Rp;break;case"copy":case"cut":case"paste":_t=Mp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_t=jr}var Rt=(d&4)!==0,wi=!Rt&&u==="scroll",_e=Rt?Ve!==null?Ve+"Capture":null:Ve;Rt=[];for(var fe=be,Ae;fe!==null;){Ae=fe;var et=Ae.stateNode;if(Ae.tag===5&&et!==null&&(Ae=et,_e!==null&&(et=gi(fe,_e),et!=null&&Rt.push(pc(fe,et,Ae)))),wi)break;fe=fe.return}0<Rt.length&&(Ve=new _t(Ve,Ct,null,x,Ke),Je.push({event:Ve,listeners:Rt}))}}if(!(d&7)){e:{if(Ve=u==="mouseover"||u==="pointerover",_t=u==="mouseout"||u==="pointerout",Ve&&x!==at&&(Ct=x.relatedTarget||x.fromElement)&&(xa(Ct)||Ct[Kr]))break e;if((_t||Ve)&&(Ve=Ke.window===Ke?Ke:(Ve=Ke.ownerDocument)?Ve.defaultView||Ve.parentWindow:window,_t?(Ct=x.relatedTarget||x.toElement,_t=be,Ct=Ct?xa(Ct):null,Ct!==null&&(wi=eo(Ct),Ct!==wi||Ct.tag!==5&&Ct.tag!==6)&&(Ct=null)):(_t=null,Ct=be),_t!==Ct)){if(Rt=wp,et="onMouseLeave",_e="onMouseEnter",fe="mouse",(u==="pointerout"||u==="pointerover")&&(Rt=jr,et="onPointerLeave",_e="onPointerEnter",fe="pointer"),wi=_t==null?Ve:ci(_t),Ae=Ct==null?Ve:ci(Ct),Ve=new Rt(et,fe+"leave",_t,x,Ke),Ve.target=wi,Ve.relatedTarget=Ae,et=null,xa(Ke)===be&&(Rt=new Rt(_e,fe+"enter",Ct,x,Ke),Rt.target=Ae,Rt.relatedTarget=wi,et=Rt),wi=et,_t&&Ct)t:{for(Rt=_t,_e=Ct,fe=0,Ae=Rt;Ae;Ae=sl(Ae))fe++;for(Ae=0,et=_e;et;et=sl(et))Ae++;for(;0<fe-Ae;)Rt=sl(Rt),fe--;for(;0<Ae-fe;)_e=sl(_e),Ae--;for(;fe--;){if(Rt===_e||_e!==null&&Rt===_e.alternate)break t;Rt=sl(Rt),_e=sl(_e)}Rt=null}else Rt=null;_t!==null&&rg(Je,Ve,_t,Rt,!1),Ct!==null&&wi!==null&&rg(Je,wi,Ct,Rt,!0)}}e:{if(Ve=be?ci(be):window,_t=Ve.nodeName&&Ve.nodeName.toLowerCase(),_t==="select"||_t==="input"&&Ve.type==="file")var Ot=tg;else if(Td(Ve))if(cc)Ot=Qn;else{Ot=ng;var zt=uc}else(_t=Ve.nodeName)&&_t.toLowerCase()==="input"&&(Ve.type==="checkbox"||Ve.type==="radio")&&(Ot=Dp);if(Ot&&(Ot=Ot(u,be))){ac(Je,Ot,x,Ke);break e}zt&&zt(u,Ve,be),u==="focusout"&&(zt=Ve._wrapperState)&&zt.controlled&&Ve.type==="number"&&It(Ve,"number",Ve.value)}switch(zt=be?ci(be):window,u){case"focusin":(Td(zt)||zt.contentEditable==="true")&&(so=zt,rl=be,mu=null);break;case"focusout":mu=rl=so=null;break;case"mousedown":Li=!0;break;case"contextmenu":case"mouseup":case"dragend":Li=!1,Cd(Je,x,Ke);break;case"selectionchange":if(bd)break;case"keydown":case"keyup":Cd(Je,x,Ke)}var jt;if(yr)e:{switch(u){case"compositionstart":var qt="onCompositionStart";break e;case"compositionend":qt="onCompositionEnd";break e;case"compositionupdate":qt="onCompositionUpdate";break e}qt=void 0}else ma?Pp(u,x)&&(qt="onCompositionEnd"):u==="keydown"&&x.keyCode===229&&(qt="onCompositionStart");qt&&(sc&&x.locale!=="ko"&&(ma||qt!=="onCompositionStart"?qt==="onCompositionEnd"&&ma&&(jt=hu()):(Ls=Ke,Tp="value"in Ls?Ls.value:Ls.textContent,ma=!0)),zt=Bd(be,qt),0<zt.length&&(qt=new bp(qt,u,null,x,Ke),Je.push({event:qt,listeners:zt}),jt?qt.data=jt:(jt=Ed(x),jt!==null&&(qt.data=jt)))),(jt=Xn?Z0(u,x):fu(u,x))&&(be=Bd(be,"onBeforeInput"),0<be.length&&(Ke=new bp("onBeforeInput","beforeinput",null,x,Ke),Je.push({event:Ke,listeners:be}),Ke.data=jt))}dc(Je,d)})}function pc(u,d,x){return{instance:u,listener:d,currentTarget:x}}function Bd(u,d){for(var x=d+"Capture",T=[];u!==null;){var R=u,D=R.stateNode;R.tag===5&&D!==null&&(R=D,D=gi(u,x),D!=null&&T.unshift(pc(u,D,R)),D=gi(u,d),D!=null&&T.push(pc(u,D,R))),u=u.return}return T}function sl(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function rg(u,d,x,T,R){for(var D=d._reactName,j=[];x!==null&&x!==T;){var ie=x,he=ie.alternate,be=ie.stateNode;if(he!==null&&he===T)break;ie.tag===5&&be!==null&&(ie=be,R?(he=gi(x,D),he!=null&&j.unshift(pc(x,he,ie))):R||(he=gi(x,D),he!=null&&j.push(pc(x,he,ie)))),x=x.return}j.length!==0&&u.push({event:d,listeners:j})}var d_=/\r\n?/g,sg=/\u0000|\uFFFD/g;function Np(u){return(typeof u=="string"?u:""+u).replace(d_,`
`).replace(sg,"")}function Su(u,d,x){if(d=Np(d),Np(u)!==d&&x)throw Error(t(425))}function Au(){}var mc=null,Up=null;function Gp(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var Hp=typeof setTimeout=="function"?setTimeout:void 0,zp=typeof clearTimeout=="function"?clearTimeout:void 0,Fd=typeof Promise=="function"?Promise:void 0,f_=typeof queueMicrotask=="function"?queueMicrotask:typeof Fd<"u"?function(u){return Fd.resolve(null).then(u).catch(og)}:Hp;function og(u){setTimeout(function(){throw u})}function kd(u,d){var x=d,T=0;do{var R=x.nextSibling;if(u.removeChild(x),R&&R.nodeType===8)if(x=R.data,x==="/$"){if(T===0){u.removeChild(R),uu(d);return}T--}else x!=="$"&&x!=="$?"&&x!=="$!"||T++;x=R}while(x);uu(d)}function Fo(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return u}function jp(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var x=u.data;if(x==="$"||x==="$!"||x==="$?"){if(d===0)return u;d--}else x==="/$"&&d++}u=u.previousSibling}return null}var ol=Math.random().toString(36).slice(2),Ti="__reactFiber$"+ol,gc="__reactProps$"+ol,Kr="__reactContainer$"+ol,al="__reactEvents$"+ol,Nd="__reactListeners$"+ol,Ud="__reactHandles$"+ol;function xa(u){var d=u[Ti];if(d)return d;for(var x=u.parentNode;x;){if(d=x[Kr]||x[Ti]){if(x=d.alternate,d.child!==null||x!==null&&x.child!==null)for(u=jp(u);u!==null;){if(x=u[Ti])return x;u=jp(u)}return d}u=x,x=u.parentNode}return null}function ko(u){return u=u[Ti]||u[Kr],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function ci(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function Gd(u){return u[gc]||null}var Vp=[],Pi=-1;function ti(u){return{current:u}}function Gn(u){0>Pi||(u.current=Vp[Pi],Vp[Pi]=null,Pi--)}function Bn(u,d){Pi++,Vp[Pi]=u.current,u.current=d}var No={},zi=ti(No),vr=ti(!1),Uo=No;function ll(u,d){var x=u.type.contextTypes;if(!x)return No;var T=u.stateNode;if(T&&T.__reactInternalMemoizedUnmaskedChildContext===d)return T.__reactInternalMemoizedMaskedChildContext;var R={},D;for(D in x)R[D]=d[D];return T&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=d,u.__reactInternalMemoizedMaskedChildContext=R),R}function tr(u){return u=u.childContextTypes,u!=null}function Eu(){Gn(vr),Gn(zi)}function Wp(u,d,x){if(zi.current!==No)throw Error(t(168));Bn(zi,d),Bn(vr,x)}function Tu(u,d,x){var T=u.stateNode;if(d=d.childContextTypes,typeof T.getChildContext!="function")return x;T=T.getChildContext();for(var R in T)if(!(R in d))throw Error(t(108,Ie(u)||"Unknown",R));return X({},x,T)}function cl(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||No,Uo=zi.current,Bn(zi,u),Bn(vr,vr.current),!0}function Kp(u,d,x){var T=u.stateNode;if(!T)throw Error(t(169));x?(u=Tu(u,d,Uo),T.__reactInternalMemoizedMergedChildContext=u,Gn(vr),Gn(zi),Bn(zi,u)):Gn(vr),Bn(vr,x)}var Bs=null,wu=!1,Hd=!1;function Mu(u){Bs===null?Bs=[u]:Bs.push(u)}function ag(u){wu=!0,Mu(u)}function ao(){if(!Hd&&Bs!==null){Hd=!0;var u=0,d=cn;try{var x=Bs;for(cn=1;u<x.length;u++){var T=x[u];do T=T(!0);while(T!==null)}Bs=null,wu=!1}catch(R){throw Bs!==null&&(Bs=Bs.slice(u+1)),K(ot,ao),R}finally{cn=d,Hd=!1}}return null}var ul=[],Rr=0,zd=null,jd=0,xr=[],Di=0,hl=null,it=1,fs="";function Go(u,d){ul[Rr++]=jd,ul[Rr++]=zd,zd=u,jd=d}function Xp(u,d,x){xr[Di++]=it,xr[Di++]=fs,xr[Di++]=hl,hl=u;var T=it;u=fs;var R=32-dn(T)-1;T&=~(1<<R),x+=1;var D=32-dn(d)+R;if(30<D){var j=R-R%5;D=(T&(1<<j)-1).toString(32),T>>=j,R-=j,it=1<<32-dn(d)+R|x<<R|T,fs=D+u}else it=1<<D|x<<R|T,fs=u}function $p(u){u.return!==null&&(Go(u,1),Xp(u,1,0))}function Ho(u){for(;u===zd;)zd=ul[--Rr],ul[Rr]=null,jd=ul[--Rr],ul[Rr]=null;for(;u===hl;)hl=xr[--Di],xr[Di]=null,fs=xr[--Di],xr[Di]=null,it=xr[--Di],xr[Di]=null}var ji=null,_r=null,jn=!1,ps=null;function Yp(u,d){var x=fo(5,null,null,0);x.elementType="DELETED",x.stateNode=d,x.return=u,d=u.deletions,d===null?(u.deletions=[x],u.flags|=16):d.push(x)}function Jp(u,d){switch(u.tag){case 5:var x=u.type;return d=d.nodeType!==1||x.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(u.stateNode=d,ji=u,_r=Fo(d.firstChild),!0):!1;case 6:return d=u.pendingProps===""||d.nodeType!==3?null:d,d!==null?(u.stateNode=d,ji=u,_r=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(x=hl!==null?{id:it,overflow:fs}:null,u.memoizedState={dehydrated:d,treeContext:x,retryLane:1073741824},x=fo(18,null,null,0),x.stateNode=d,x.return=u,u.child=x,ji=u,_r=null,!0):!1;default:return!1}}function Vd(u){return(u.mode&1)!==0&&(u.flags&128)===0}function Wd(u){if(jn){var d=_r;if(d){var x=d;if(!Jp(u,d)){if(Vd(u))throw Error(t(418));d=Fo(x.nextSibling);var T=ji;d&&Jp(u,d)?Yp(T,x):(u.flags=u.flags&-4097|2,jn=!1,ji=u)}}else{if(Vd(u))throw Error(t(418));u.flags=u.flags&-4097|2,jn=!1,ji=u}}}function Kd(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;ji=u}function yc(u){if(u!==ji)return!1;if(!jn)return Kd(u),jn=!0,!1;var d;if((d=u.tag!==3)&&!(d=u.tag!==5)&&(d=u.type,d=d!=="head"&&d!=="body"&&!Gp(u.type,u.memoizedProps)),d&&(d=_r)){if(Vd(u))throw qp(),Error(t(418));for(;d;)Yp(u,d),d=Fo(d.nextSibling)}if(Kd(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8){var x=u.data;if(x==="/$"){if(d===0){_r=Fo(u.nextSibling);break e}d--}else x!=="$"&&x!=="$!"&&x!=="$?"||d++}u=u.nextSibling}_r=null}}else _r=ji?Fo(u.stateNode.nextSibling):null;return!0}function qp(){for(var u=_r;u;)u=Fo(u.nextSibling)}function _a(){_r=ji=null,jn=!1}function vc(u){ps===null?ps=[u]:ps.push(u)}var p_=C.ReactCurrentBatchConfig;function bu(u,d,x){if(u=x.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(x._owner){if(x=x._owner,x){if(x.tag!==1)throw Error(t(309));var T=x.stateNode}if(!T)throw Error(t(147,u));var R=T,D=""+u;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===D?d.ref:(d=function(j){var ie=R.refs;j===null?delete ie[D]:ie[D]=j},d._stringRef=D,d)}if(typeof u!="string")throw Error(t(284));if(!x._owner)throw Error(t(290,u))}return u}function Cu(u,d){throw u=Object.prototype.toString.call(d),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u))}function Qp(u){var d=u._init;return d(u._payload)}function Zp(u){function d(_e,fe){if(u){var Ae=_e.deletions;Ae===null?(_e.deletions=[fe],_e.flags|=16):Ae.push(fe)}}function x(_e,fe){if(!u)return null;for(;fe!==null;)d(_e,fe),fe=fe.sibling;return null}function T(_e,fe){for(_e=new Map;fe!==null;)fe.key!==null?_e.set(fe.key,fe):_e.set(fe.index,fe),fe=fe.sibling;return _e}function R(_e,fe){return _e=Rc(_e,fe),_e.index=0,_e.sibling=null,_e}function D(_e,fe,Ae){return _e.index=Ae,u?(Ae=_e.alternate,Ae!==null?(Ae=Ae.index,Ae<fe?(_e.flags|=2,fe):Ae):(_e.flags|=2,fe)):(_e.flags|=1048576,fe)}function j(_e){return u&&_e.alternate===null&&(_e.flags|=2),_e}function ie(_e,fe,Ae,et){return fe===null||fe.tag!==6?(fe=D_(Ae,_e.mode,et),fe.return=_e,fe):(fe=R(fe,Ae),fe.return=_e,fe)}function he(_e,fe,Ae,et){var Ot=Ae.type;return Ot===k?Ke(_e,fe,Ae.props.children,et,Ae.key):fe!==null&&(fe.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===re&&Qp(Ot)===fe.type)?(et=R(fe,Ae.props),et.ref=bu(_e,fe,Ae),et.return=_e,et):(et=Ig(Ae.type,Ae.key,Ae.props,null,_e.mode,et),et.ref=bu(_e,fe,Ae),et.return=_e,et)}function be(_e,fe,Ae,et){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==Ae.containerInfo||fe.stateNode.implementation!==Ae.implementation?(fe=O_(Ae,_e.mode,et),fe.return=_e,fe):(fe=R(fe,Ae.children||[]),fe.return=_e,fe)}function Ke(_e,fe,Ae,et,Ot){return fe===null||fe.tag!==7?(fe=Wu(Ae,_e.mode,et,Ot),fe.return=_e,fe):(fe=R(fe,Ae),fe.return=_e,fe)}function Je(_e,fe,Ae){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return fe=D_(""+fe,_e.mode,Ae),fe.return=_e,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case I:return Ae=Ig(fe.type,fe.key,fe.props,null,_e.mode,Ae),Ae.ref=bu(_e,null,fe),Ae.return=_e,Ae;case O:return fe=O_(fe,_e.mode,Ae),fe.return=_e,fe;case re:var et=fe._init;return Je(_e,et(fe._payload),Ae)}if(tt(fe)||$(fe))return fe=Wu(fe,_e.mode,Ae,null),fe.return=_e,fe;Cu(_e,fe)}return null}function Ve(_e,fe,Ae,et){var Ot=fe!==null?fe.key:null;if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return Ot!==null?null:ie(_e,fe,""+Ae,et);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case I:return Ae.key===Ot?he(_e,fe,Ae,et):null;case O:return Ae.key===Ot?be(_e,fe,Ae,et):null;case re:return Ot=Ae._init,Ve(_e,fe,Ot(Ae._payload),et)}if(tt(Ae)||$(Ae))return Ot!==null?null:Ke(_e,fe,Ae,et,null);Cu(_e,Ae)}return null}function _t(_e,fe,Ae,et,Ot){if(typeof et=="string"&&et!==""||typeof et=="number")return _e=_e.get(Ae)||null,ie(fe,_e,""+et,Ot);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case I:return _e=_e.get(et.key===null?Ae:et.key)||null,he(fe,_e,et,Ot);case O:return _e=_e.get(et.key===null?Ae:et.key)||null,be(fe,_e,et,Ot);case re:var zt=et._init;return _t(_e,fe,Ae,zt(et._payload),Ot)}if(tt(et)||$(et))return _e=_e.get(Ae)||null,Ke(fe,_e,et,Ot,null);Cu(fe,et)}return null}function Ct(_e,fe,Ae,et){for(var Ot=null,zt=null,jt=fe,qt=fe=0,sr=null;jt!==null&&qt<Ae.length;qt++){jt.index>qt?(sr=jt,jt=null):sr=jt.sibling;var In=Ve(_e,jt,Ae[qt],et);if(In===null){jt===null&&(jt=sr);break}u&&jt&&In.alternate===null&&d(_e,jt),fe=D(In,fe,qt),zt===null?Ot=In:zt.sibling=In,zt=In,jt=sr}if(qt===Ae.length)return x(_e,jt),jn&&Go(_e,qt),Ot;if(jt===null){for(;qt<Ae.length;qt++)jt=Je(_e,Ae[qt],et),jt!==null&&(fe=D(jt,fe,qt),zt===null?Ot=jt:zt.sibling=jt,zt=jt);return jn&&Go(_e,qt),Ot}for(jt=T(_e,jt);qt<Ae.length;qt++)sr=_t(jt,_e,qt,Ae[qt],et),sr!==null&&(u&&sr.alternate!==null&&jt.delete(sr.key===null?qt:sr.key),fe=D(sr,fe,qt),zt===null?Ot=sr:zt.sibling=sr,zt=sr);return u&&jt.forEach(function(Ic){return d(_e,Ic)}),jn&&Go(_e,qt),Ot}function Rt(_e,fe,Ae,et){var Ot=$(Ae);if(typeof Ot!="function")throw Error(t(150));if(Ae=Ot.call(Ae),Ae==null)throw Error(t(151));for(var zt=Ot=null,jt=fe,qt=fe=0,sr=null,In=Ae.next();jt!==null&&!In.done;qt++,In=Ae.next()){jt.index>qt?(sr=jt,jt=null):sr=jt.sibling;var Ic=Ve(_e,jt,In.value,et);if(Ic===null){jt===null&&(jt=sr);break}u&&jt&&Ic.alternate===null&&d(_e,jt),fe=D(Ic,fe,qt),zt===null?Ot=Ic:zt.sibling=Ic,zt=Ic,jt=sr}if(In.done)return x(_e,jt),jn&&Go(_e,qt),Ot;if(jt===null){for(;!In.done;qt++,In=Ae.next())In=Je(_e,In.value,et),In!==null&&(fe=D(In,fe,qt),zt===null?Ot=In:zt.sibling=In,zt=In);return jn&&Go(_e,qt),Ot}for(jt=T(_e,jt);!In.done;qt++,In=Ae.next())In=_t(jt,_e,qt,In.value,et),In!==null&&(u&&In.alternate!==null&&jt.delete(In.key===null?qt:In.key),fe=D(In,fe,qt),zt===null?Ot=In:zt.sibling=In,zt=In);return u&&jt.forEach(function(VP){return d(_e,VP)}),jn&&Go(_e,qt),Ot}function wi(_e,fe,Ae,et){if(typeof Ae=="object"&&Ae!==null&&Ae.type===k&&Ae.key===null&&(Ae=Ae.props.children),typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case I:e:{for(var Ot=Ae.key,zt=fe;zt!==null;){if(zt.key===Ot){if(Ot=Ae.type,Ot===k){if(zt.tag===7){x(_e,zt.sibling),fe=R(zt,Ae.props.children),fe.return=_e,_e=fe;break e}}else if(zt.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===re&&Qp(Ot)===zt.type){x(_e,zt.sibling),fe=R(zt,Ae.props),fe.ref=bu(_e,zt,Ae),fe.return=_e,_e=fe;break e}x(_e,zt);break}else d(_e,zt);zt=zt.sibling}Ae.type===k?(fe=Wu(Ae.props.children,_e.mode,et,Ae.key),fe.return=_e,_e=fe):(et=Ig(Ae.type,Ae.key,Ae.props,null,_e.mode,et),et.ref=bu(_e,fe,Ae),et.return=_e,_e=et)}return j(_e);case O:e:{for(zt=Ae.key;fe!==null;){if(fe.key===zt)if(fe.tag===4&&fe.stateNode.containerInfo===Ae.containerInfo&&fe.stateNode.implementation===Ae.implementation){x(_e,fe.sibling),fe=R(fe,Ae.children||[]),fe.return=_e,_e=fe;break e}else{x(_e,fe);break}else d(_e,fe);fe=fe.sibling}fe=O_(Ae,_e.mode,et),fe.return=_e,_e=fe}return j(_e);case re:return zt=Ae._init,wi(_e,fe,zt(Ae._payload),et)}if(tt(Ae))return Ct(_e,fe,Ae,et);if($(Ae))return Rt(_e,fe,Ae,et);Cu(_e,Ae)}return typeof Ae=="string"&&Ae!==""||typeof Ae=="number"?(Ae=""+Ae,fe!==null&&fe.tag===6?(x(_e,fe.sibling),fe=R(fe,Ae),fe.return=_e,_e=fe):(x(_e,fe),fe=D_(Ae,_e.mode,et),fe.return=_e,_e=fe),j(_e)):x(_e,fe)}return wi}var dl=Zp(!0),Ru=Zp(!1),fl=ti(null),pl=null,zo=null,xc=null;function ml(){xc=zo=pl=null}function Iu(u){var d=fl.current;Gn(fl),u._currentValue=d}function Lu(u,d,x){for(;u!==null;){var T=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,T!==null&&(T.childLanes|=d)):T!==null&&(T.childLanes&d)!==d&&(T.childLanes|=d),u===x)break;u=u.return}}function Sa(u,d){pl=u,xc=zo=null,u=u.dependencies,u!==null&&u.firstContext!==null&&(u.lanes&d&&(un=!0),u.firstContext=null)}function Xr(u){var d=u._currentValue;if(xc!==u)if(u={context:u,memoizedValue:d,next:null},zo===null){if(pl===null)throw Error(t(308));zo=u,pl.dependencies={lanes:0,firstContext:u}}else zo=zo.next=u;return d}var jo=null;function em(u){jo===null?jo=[u]:jo.push(u)}function Pu(u,d,x,T){var R=d.interleaved;return R===null?(x.next=x,em(d)):(x.next=R.next,R.next=x),d.interleaved=x,Fs(u,T)}function Fs(u,d){u.lanes|=d;var x=u.alternate;for(x!==null&&(x.lanes|=d),x=u,u=u.return;u!==null;)u.childLanes|=d,x=u.alternate,x!==null&&(x.childLanes|=d),x=u,u=u.return;return x.tag===3?x.stateNode:null}var Pn=!1;function sn(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ui(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Dn(u,d){return{eventTime:u,lane:d,tag:0,payload:null,callback:null,next:null}}function $n(u,d,x){var T=u.updateQueue;if(T===null)return null;if(T=T.shared,bn&2){var R=T.pending;return R===null?d.next=d:(d.next=R.next,R.next=d),T.pending=d,Fs(u,x)}return R=T.interleaved,R===null?(d.next=d,em(T)):(d.next=R.next,R.next=d),T.interleaved=d,Fs(u,x)}function nr(u,d,x){if(d=d.updateQueue,d!==null&&(d=d.shared,(x&4194240)!==0)){var T=d.lanes;T&=u.pendingLanes,x|=T,d.lanes=x,no(u,x)}}function gl(u,d){var x=u.updateQueue,T=u.alternate;if(T!==null&&(T=T.updateQueue,x===T)){var R=null,D=null;if(x=x.firstBaseUpdate,x!==null){do{var j={eventTime:x.eventTime,lane:x.lane,tag:x.tag,payload:x.payload,callback:x.callback,next:null};D===null?R=D=j:D=D.next=j,x=x.next}while(x!==null);D===null?R=D=d:D=D.next=d}else R=D=d;x={baseState:T.baseState,firstBaseUpdate:R,lastBaseUpdate:D,shared:T.shared,effects:T.effects},u.updateQueue=x;return}u=x.lastBaseUpdate,u===null?x.firstBaseUpdate=d:u.next=d,x.lastBaseUpdate=d}function ni(u,d,x,T){var R=u.updateQueue;Pn=!1;var D=R.firstBaseUpdate,j=R.lastBaseUpdate,ie=R.shared.pending;if(ie!==null){R.shared.pending=null;var he=ie,be=he.next;he.next=null,j===null?D=be:j.next=be,j=he;var Ke=u.alternate;Ke!==null&&(Ke=Ke.updateQueue,ie=Ke.lastBaseUpdate,ie!==j&&(ie===null?Ke.firstBaseUpdate=be:ie.next=be,Ke.lastBaseUpdate=he))}if(D!==null){var Je=R.baseState;j=0,Ke=be=he=null,ie=D;do{var Ve=ie.lane,_t=ie.eventTime;if((T&Ve)===Ve){Ke!==null&&(Ke=Ke.next={eventTime:_t,lane:0,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null});e:{var Ct=u,Rt=ie;switch(Ve=d,_t=x,Rt.tag){case 1:if(Ct=Rt.payload,typeof Ct=="function"){Je=Ct.call(_t,Je,Ve);break e}Je=Ct;break e;case 3:Ct.flags=Ct.flags&-65537|128;case 0:if(Ct=Rt.payload,Ve=typeof Ct=="function"?Ct.call(_t,Je,Ve):Ct,Ve==null)break e;Je=X({},Je,Ve);break e;case 2:Pn=!0}}ie.callback!==null&&ie.lane!==0&&(u.flags|=64,Ve=R.effects,Ve===null?R.effects=[ie]:Ve.push(ie))}else _t={eventTime:_t,lane:Ve,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},Ke===null?(be=Ke=_t,he=Je):Ke=Ke.next=_t,j|=Ve;if(ie=ie.next,ie===null){if(ie=R.shared.pending,ie===null)break;Ve=ie,ie=Ve.next,Ve.next=null,R.lastBaseUpdate=Ve,R.shared.pending=null}}while(!0);if(Ke===null&&(he=Je),R.baseState=he,R.firstBaseUpdate=be,R.lastBaseUpdate=Ke,d=R.shared.interleaved,d!==null){R=d;do j|=R.lane,R=R.next;while(R!==d)}else D===null&&(R.shared.lanes=0);Hu|=j,u.lanes=j,u.memoizedState=Je}}function _c(u,d,x){if(u=d.effects,d.effects=null,u!==null)for(d=0;d<u.length;d++){var T=u[d],R=T.callback;if(R!==null){if(T.callback=null,T=x,typeof R!="function")throw Error(t(191,R));R.call(T)}}}var lo={},$r=ti(lo),yl=ti(lo),Vo=ti(lo);function vi(u){if(u===lo)throw Error(t(174));return u}function Du(u,d){switch(Bn(Vo,d),Bn(yl,u),Bn($r,lo),u=d.nodeType,u){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:ht(null,"");break;default:u=u===8?d.parentNode:d,d=u.namespaceURI||null,u=u.tagName,d=ht(d,u)}Gn($r),Bn($r,d)}function Aa(){Gn($r),Gn(yl),Gn(Vo)}function vl(u){vi(Vo.current);var d=vi($r.current),x=ht(d,u.type);d!==x&&(Bn(yl,u),Bn($r,x))}function Sc(u){yl.current===u&&(Gn($r),Gn(yl))}var Vn=ti(0);function ks(u){for(var d=u;d!==null;){if(d.tag===13){var x=d.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||x.data==="$?"||x.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if(d.flags&128)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var Ac=[];function co(){for(var u=0;u<Ac.length;u++)Ac[u]._workInProgressVersionPrimary=null;Ac.length=0}var xl=C.ReactCurrentDispatcher,_l=C.ReactCurrentBatchConfig,Wo=0,Hn=null,ii=null,En=null,Ns=!1,ir=!1,Ea=0,Ir=0;function Vi(){throw Error(t(321))}function Ou(u,d){if(d===null)return!1;for(var x=0;x<d.length&&x<u.length;x++)if(!Vr(u[x],d[x]))return!1;return!0}function Bu(u,d,x,T,R,D){if(Wo=D,Hn=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,xl.current=u===null||u.memoizedState===null?pg:mg,u=x(T,R),ir){D=0;do{if(ir=!1,Ea=0,25<=D)throw Error(t(301));D+=1,En=ii=null,d.updateQueue=null,xl.current=gg,u=x(T,R)}while(ir)}if(xl.current=Zd,d=ii!==null&&ii.next!==null,Wo=0,En=ii=Hn=null,Ns=!1,d)throw Error(t(300));return u}function tm(){var u=Ea!==0;return Ea=0,u}function Wi(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?Hn.memoizedState=En=u:En=En.next=u,En}function Yr(){if(ii===null){var u=Hn.alternate;u=u!==null?u.memoizedState:null}else u=ii.next;var d=En===null?Hn.memoizedState:En.next;if(d!==null)En=d,ii=u;else{if(u===null)throw Error(t(310));ii=u,u={memoizedState:ii.memoizedState,baseState:ii.baseState,baseQueue:ii.baseQueue,queue:ii.queue,next:null},En===null?Hn.memoizedState=En=u:En=En.next=u}return En}function Ec(u,d){return typeof d=="function"?d(u):d}function Fu(u){var d=Yr(),x=d.queue;if(x===null)throw Error(t(311));x.lastRenderedReducer=u;var T=ii,R=T.baseQueue,D=x.pending;if(D!==null){if(R!==null){var j=R.next;R.next=D.next,D.next=j}T.baseQueue=R=D,x.pending=null}if(R!==null){D=R.next,T=T.baseState;var ie=j=null,he=null,be=D;do{var Ke=be.lane;if((Wo&Ke)===Ke)he!==null&&(he=he.next={lane:0,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),T=be.hasEagerState?be.eagerState:u(T,be.action);else{var Je={lane:Ke,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null};he===null?(ie=he=Je,j=T):he=he.next=Je,Hn.lanes|=Ke,Hu|=Ke}be=be.next}while(be!==null&&be!==D);he===null?j=T:he.next=ie,Vr(T,d.memoizedState)||(un=!0),d.memoizedState=T,d.baseState=j,d.baseQueue=he,x.lastRenderedState=T}if(u=x.interleaved,u!==null){R=u;do D=R.lane,Hn.lanes|=D,Hu|=D,R=R.next;while(R!==u)}else R===null&&(x.lanes=0);return[d.memoizedState,x.dispatch]}function Ko(u){var d=Yr(),x=d.queue;if(x===null)throw Error(t(311));x.lastRenderedReducer=u;var T=x.dispatch,R=x.pending,D=d.memoizedState;if(R!==null){x.pending=null;var j=R=R.next;do D=u(D,j.action),j=j.next;while(j!==R);Vr(D,d.memoizedState)||(un=!0),d.memoizedState=D,d.baseQueue===null&&(d.baseState=D),x.lastRenderedState=D}return[D,T]}function nm(){}function im(u,d){var x=Hn,T=Yr(),R=d(),D=!Vr(T.memoizedState,R);if(D&&(T.memoizedState=R,un=!0),T=T.queue,om(lg.bind(null,x,T,u),[u]),T.getSnapshot!==d||D||En!==null&&En.memoizedState.tag&1){if(x.flags|=2048,Us(9,ku.bind(null,x,T,R,d),void 0,null),rr===null)throw Error(t(349));Wo&30||Xd(x,d,R)}return R}function Xd(u,d,x){u.flags|=16384,u={getSnapshot:d,value:x},d=Hn.updateQueue,d===null?(d={lastEffect:null,stores:null},Hn.updateQueue=d,d.stores=[u]):(x=d.stores,x===null?d.stores=[u]:x.push(u))}function ku(u,d,x,T){d.value=x,d.getSnapshot=T,cg(d)&&rm(u)}function lg(u,d,x){return x(function(){cg(d)&&rm(u)})}function cg(u){var d=u.getSnapshot;u=u.value;try{var x=d();return!Vr(u,x)}catch{return!0}}function rm(u){var d=Fs(u,1);d!==null&&qo(d,u,1,-1)}function sm(u){var d=Wi();return typeof u=="function"&&(u=u()),d.memoizedState=d.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ec,lastRenderedState:u},d.queue=u,u=u.dispatch=Sl.bind(null,Hn,u),[d.memoizedState,u]}function Us(u,d,x,T){return u={tag:u,create:d,destroy:x,deps:T,next:null},d=Hn.updateQueue,d===null?(d={lastEffect:null,stores:null},Hn.updateQueue=d,d.lastEffect=u.next=u):(x=d.lastEffect,x===null?d.lastEffect=u.next=u:(T=x.next,x.next=u,u.next=T,d.lastEffect=u)),u}function ug(){return Yr().memoizedState}function uo(u,d,x,T){var R=Wi();Hn.flags|=u,R.memoizedState=Us(1|d,x,void 0,T===void 0?null:T)}function Nu(u,d,x,T){var R=Yr();T=T===void 0?null:T;var D=void 0;if(ii!==null){var j=ii.memoizedState;if(D=j.destroy,T!==null&&Ou(T,j.deps)){R.memoizedState=Us(d,x,D,T);return}}Hn.flags|=u,R.memoizedState=Us(1|d,x,D,T)}function Sr(u,d){return uo(8390656,8,u,d)}function om(u,d){return Nu(2048,8,u,d)}function am(u,d){return Nu(4,2,u,d)}function hg(u,d){return Nu(4,4,u,d)}function dg(u,d){if(typeof d=="function")return u=u(),d(u),function(){d(null)};if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function lm(u,d,x){return x=x!=null?x.concat([u]):null,Nu(4,4,dg.bind(null,d,u),x)}function $d(){}function fg(u,d){var x=Yr();d=d===void 0?null:d;var T=x.memoizedState;return T!==null&&d!==null&&Ou(d,T[1])?T[0]:(x.memoizedState=[u,d],u)}function Jr(u,d){var x=Yr();d=d===void 0?null:d;var T=x.memoizedState;return T!==null&&d!==null&&Ou(d,T[1])?T[0]:(u=u(),x.memoizedState=[u,d],u)}function Yd(u,d,x){return Wo&21?(Vr(x,d)||(x=zn(),Hn.lanes|=x,Hu|=x,u.baseState=!0),d):(u.baseState&&(u.baseState=!1,un=!0),u.memoizedState=x)}function m_(u,d){var x=cn;cn=x!==0&&4>x?x:4,u(!0);var T=_l.transition;_l.transition={};try{u(!1),d()}finally{cn=x,_l.transition=T}}function Xo(){return Yr().memoizedState}function Jd(u,d,x){var T=bc(u);if(x={lane:T,action:x,hasEagerState:!1,eagerState:null,next:null},Uu(u))qd(d,x);else if(x=Pu(u,d,x,T),x!==null){var R=Qr();qo(x,u,T,R),Qd(x,d,T)}}function Sl(u,d,x){var T=bc(u),R={lane:T,action:x,hasEagerState:!1,eagerState:null,next:null};if(Uu(u))qd(d,R);else{var D=u.alternate;if(u.lanes===0&&(D===null||D.lanes===0)&&(D=d.lastRenderedReducer,D!==null))try{var j=d.lastRenderedState,ie=D(j,x);if(R.hasEagerState=!0,R.eagerState=ie,Vr(ie,j)){var he=d.interleaved;he===null?(R.next=R,em(d)):(R.next=he.next,he.next=R),d.interleaved=R;return}}catch{}finally{}x=Pu(u,d,R,T),x!==null&&(R=Qr(),qo(x,u,T,R),Qd(x,d,T))}}function Uu(u){var d=u.alternate;return u===Hn||d!==null&&d===Hn}function qd(u,d){ir=Ns=!0;var x=u.pending;x===null?d.next=d:(d.next=x.next,x.next=d),u.pending=d}function Qd(u,d,x){if(x&4194240){var T=d.lanes;T&=u.pendingLanes,x|=T,d.lanes=x,no(u,x)}}var Zd={readContext:Xr,useCallback:Vi,useContext:Vi,useEffect:Vi,useImperativeHandle:Vi,useInsertionEffect:Vi,useLayoutEffect:Vi,useMemo:Vi,useReducer:Vi,useRef:Vi,useState:Vi,useDebugValue:Vi,useDeferredValue:Vi,useTransition:Vi,useMutableSource:Vi,useSyncExternalStore:Vi,useId:Vi,unstable_isNewReconciler:!1},pg={readContext:Xr,useCallback:function(u,d){return Wi().memoizedState=[u,d===void 0?null:d],u},useContext:Xr,useEffect:Sr,useImperativeHandle:function(u,d,x){return x=x!=null?x.concat([u]):null,uo(4194308,4,dg.bind(null,d,u),x)},useLayoutEffect:function(u,d){return uo(4194308,4,u,d)},useInsertionEffect:function(u,d){return uo(4,2,u,d)},useMemo:function(u,d){var x=Wi();return d=d===void 0?null:d,u=u(),x.memoizedState=[u,d],u},useReducer:function(u,d,x){var T=Wi();return d=x!==void 0?x(d):d,T.memoizedState=T.baseState=d,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:d},T.queue=u,u=u.dispatch=Jd.bind(null,Hn,u),[T.memoizedState,u]},useRef:function(u){var d=Wi();return u={current:u},d.memoizedState=u},useState:sm,useDebugValue:$d,useDeferredValue:function(u){return Wi().memoizedState=u},useTransition:function(){var u=sm(!1),d=u[0];return u=m_.bind(null,u[1]),Wi().memoizedState=u,[d,u]},useMutableSource:function(){},useSyncExternalStore:function(u,d,x){var T=Hn,R=Wi();if(jn){if(x===void 0)throw Error(t(407));x=x()}else{if(x=d(),rr===null)throw Error(t(349));Wo&30||Xd(T,d,x)}R.memoizedState=x;var D={value:x,getSnapshot:d};return R.queue=D,Sr(lg.bind(null,T,D,u),[u]),T.flags|=2048,Us(9,ku.bind(null,T,D,x,d),void 0,null),x},useId:function(){var u=Wi(),d=rr.identifierPrefix;if(jn){var x=fs,T=it;x=(T&~(1<<32-dn(T)-1)).toString(32)+x,d=":"+d+"R"+x,x=Ea++,0<x&&(d+="H"+x.toString(32)),d+=":"}else x=Ir++,d=":"+d+"r"+x.toString(32)+":";return u.memoizedState=d},unstable_isNewReconciler:!1},mg={readContext:Xr,useCallback:fg,useContext:Xr,useEffect:om,useImperativeHandle:lm,useInsertionEffect:am,useLayoutEffect:hg,useMemo:Jr,useReducer:Fu,useRef:ug,useState:function(){return Fu(Ec)},useDebugValue:$d,useDeferredValue:function(u){var d=Yr();return Yd(d,ii.memoizedState,u)},useTransition:function(){var u=Fu(Ec)[0],d=Yr().memoizedState;return[u,d]},useMutableSource:nm,useSyncExternalStore:im,useId:Xo,unstable_isNewReconciler:!1},gg={readContext:Xr,useCallback:fg,useContext:Xr,useEffect:om,useImperativeHandle:lm,useInsertionEffect:am,useLayoutEffect:hg,useMemo:Jr,useReducer:Ko,useRef:ug,useState:function(){return Ko(Ec)},useDebugValue:$d,useDeferredValue:function(u){var d=Yr();return ii===null?d.memoizedState=u:Yd(d,ii.memoizedState,u)},useTransition:function(){var u=Ko(Ec)[0],d=Yr().memoizedState;return[u,d]},useMutableSource:nm,useSyncExternalStore:im,useId:Xo,unstable_isNewReconciler:!1};function ms(u,d){if(u&&u.defaultProps){d=X({},d),u=u.defaultProps;for(var x in u)d[x]===void 0&&(d[x]=u[x]);return d}return d}function Gu(u,d,x,T){d=u.memoizedState,x=x(T,d),x=x==null?d:X({},d,x),u.memoizedState=x,u.lanes===0&&(u.updateQueue.baseState=x)}var ef={isMounted:function(u){return(u=u._reactInternals)?eo(u)===u:!1},enqueueSetState:function(u,d,x){u=u._reactInternals;var T=Qr(),R=bc(u),D=Dn(T,R);D.payload=d,x!=null&&(D.callback=x),d=$n(u,D,R),d!==null&&(qo(d,u,R,T),nr(d,u,R))},enqueueReplaceState:function(u,d,x){u=u._reactInternals;var T=Qr(),R=bc(u),D=Dn(T,R);D.tag=1,D.payload=d,x!=null&&(D.callback=x),d=$n(u,D,R),d!==null&&(qo(d,u,R,T),nr(d,u,R))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var x=Qr(),T=bc(u),R=Dn(x,T);R.tag=2,d!=null&&(R.callback=d),d=$n(u,R,T),d!==null&&(qo(d,u,T,x),nr(d,u,T))}};function yg(u,d,x,T,R,D,j){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(T,D,j):d.prototype&&d.prototype.isPureReactComponent?!nl(x,T)||!nl(R,D):!0}function m(u,d,x){var T=!1,R=No,D=d.contextType;return typeof D=="object"&&D!==null?D=Xr(D):(R=tr(d)?Uo:zi.current,T=d.contextTypes,D=(T=T!=null)?ll(u,R):No),d=new d(x,D),u.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=ef,u.stateNode=d,d._reactInternals=u,T&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=R,u.__reactInternalMemoizedMaskedChildContext=D),d}function g(u,d,x,T){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(x,T),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(x,T),d.state!==u&&ef.enqueueReplaceState(d,d.state,null)}function E(u,d,x,T){var R=u.stateNode;R.props=x,R.state=u.memoizedState,R.refs={},sn(u);var D=d.contextType;typeof D=="object"&&D!==null?R.context=Xr(D):(D=tr(d)?Uo:zi.current,R.context=ll(u,D)),R.state=u.memoizedState,D=d.getDerivedStateFromProps,typeof D=="function"&&(Gu(u,d,D,x),R.state=u.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(d=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),d!==R.state&&ef.enqueueReplaceState(R,R.state,null),ni(u,x,R,T),R.state=u.memoizedState),typeof R.componentDidMount=="function"&&(u.flags|=4194308)}function b(u,d){try{var x="",T=d;do x+=ye(T),T=T.return;while(T);var R=x}catch(D){R=`
Error generating stack: `+D.message+`
`+D.stack}return{value:u,source:d,stack:R,digest:null}}function L(u,d,x){return{value:u,source:null,stack:x??null,digest:d??null}}function U(u,d){try{console.error(d.value)}catch(x){setTimeout(function(){throw x})}}var ee=typeof WeakMap=="function"?WeakMap:Map;function pe(u,d,x){x=Dn(-1,x),x.tag=3,x.payload={element:null};var T=d.value;return x.callback=function(){Tg||(Tg=!0,w_=T),U(u,d)},x}function Oe(u,d,x){x=Dn(-1,x),x.tag=3;var T=u.type.getDerivedStateFromError;if(typeof T=="function"){var R=d.value;x.payload=function(){return T(R)},x.callback=function(){U(u,d)}}var D=u.stateNode;return D!==null&&typeof D.componentDidCatch=="function"&&(x.callback=function(){U(u,d),typeof T!="function"&&(wc===null?wc=new Set([this]):wc.add(this));var j=d.stack;this.componentDidCatch(d.value,{componentStack:j!==null?j:""})}),x}function Qe(u,d,x){var T=u.pingCache;if(T===null){T=u.pingCache=new ee;var R=new Set;T.set(d,R)}else R=T.get(d),R===void 0&&(R=new Set,T.set(d,R));R.has(x)||(R.add(x),u=DP.bind(null,u,d,x),d.then(u,u))}function Tt(u){do{var d;if((d=u.tag===13)&&(d=u.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return u;u=u.return}while(u!==null);return null}function Zt(u,d,x,T,R){return u.mode&1?(u.flags|=65536,u.lanes=R,u):(u===d?u.flags|=65536:(u.flags|=128,x.flags|=131072,x.flags&=-52805,x.tag===1&&(x.alternate===null?x.tag=17:(d=Dn(-1,1),d.tag=2,$n(x,d,1))),x.lanes|=1),u)}var Ut=C.ReactCurrentOwner,un=!1;function gt(u,d,x,T){d.child=u===null?Ru(d,null,x,T):dl(d,u.child,x,T)}function Ki(u,d,x,T,R){x=x.render;var D=d.ref;return Sa(d,R),T=Bu(u,d,x,T,D,R),x=tm(),u!==null&&!un?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~R,Al(u,d,R)):(jn&&x&&$p(d),d.flags|=1,gt(u,d,T,R),d.child)}function qr(u,d,x,T,R){if(u===null){var D=x.type;return typeof D=="function"&&!P_(D)&&D.defaultProps===void 0&&x.compare===null&&x.defaultProps===void 0?(d.tag=15,d.type=D,Te(u,d,D,T,R)):(u=Ig(x.type,null,T,d,d.mode,R),u.ref=d.ref,u.return=d,d.child=u)}if(D=u.child,!(u.lanes&R)){var j=D.memoizedProps;if(x=x.compare,x=x!==null?x:nl,x(j,T)&&u.ref===d.ref)return Al(u,d,R)}return d.flags|=1,u=Rc(D,T),u.ref=d.ref,u.return=d,d.child=u}function Te(u,d,x,T,R){if(u!==null){var D=u.memoizedProps;if(nl(D,T)&&u.ref===d.ref)if(un=!1,d.pendingProps=T=D,(u.lanes&R)!==0)u.flags&131072&&(un=!0);else return d.lanes=u.lanes,Al(u,d,R)}return dt(u,d,x,T,R)}function ge(u,d,x){var T=d.pendingProps,R=T.children,D=u!==null?u.memoizedState:null;if(T.mode==="hidden")if(!(d.mode&1))d.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bn(nf,Gs),Gs|=x;else{if(!(x&1073741824))return u=D!==null?D.baseLanes|x:x,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:u,cachePool:null,transitions:null},d.updateQueue=null,Bn(nf,Gs),Gs|=u,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},T=D!==null?D.baseLanes:x,Bn(nf,Gs),Gs|=T}else D!==null?(T=D.baseLanes|x,d.memoizedState=null):T=x,Bn(nf,Gs),Gs|=T;return gt(u,d,R,x),d.child}function Pe(u,d){var x=d.ref;(u===null&&x!==null||u!==null&&u.ref!==x)&&(d.flags|=512,d.flags|=2097152)}function dt(u,d,x,T,R){var D=tr(x)?Uo:zi.current;return D=ll(d,D),Sa(d,R),x=Bu(u,d,x,T,D,R),T=tm(),u!==null&&!un?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~R,Al(u,d,R)):(jn&&T&&$p(d),d.flags|=1,gt(u,d,x,R),d.child)}function Pt(u,d,x,T,R){if(tr(x)){var D=!0;cl(d)}else D=!1;if(Sa(d,R),d.stateNode===null)xg(u,d),m(d,x,T),E(d,x,T,R),T=!0;else if(u===null){var j=d.stateNode,ie=d.memoizedProps;j.props=ie;var he=j.context,be=x.contextType;typeof be=="object"&&be!==null?be=Xr(be):(be=tr(x)?Uo:zi.current,be=ll(d,be));var Ke=x.getDerivedStateFromProps,Je=typeof Ke=="function"||typeof j.getSnapshotBeforeUpdate=="function";Je||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(ie!==T||he!==be)&&g(d,j,T,be),Pn=!1;var Ve=d.memoizedState;j.state=Ve,ni(d,T,j,R),he=d.memoizedState,ie!==T||Ve!==he||vr.current||Pn?(typeof Ke=="function"&&(Gu(d,x,Ke,T),he=d.memoizedState),(ie=Pn||yg(d,x,ie,T,Ve,he,be))?(Je||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(d.flags|=4194308)):(typeof j.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=T,d.memoizedState=he),j.props=T,j.state=he,j.context=be,T=ie):(typeof j.componentDidMount=="function"&&(d.flags|=4194308),T=!1)}else{j=d.stateNode,ui(u,d),ie=d.memoizedProps,be=d.type===d.elementType?ie:ms(d.type,ie),j.props=be,Je=d.pendingProps,Ve=j.context,he=x.contextType,typeof he=="object"&&he!==null?he=Xr(he):(he=tr(x)?Uo:zi.current,he=ll(d,he));var _t=x.getDerivedStateFromProps;(Ke=typeof _t=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(ie!==Je||Ve!==he)&&g(d,j,T,he),Pn=!1,Ve=d.memoizedState,j.state=Ve,ni(d,T,j,R);var Ct=d.memoizedState;ie!==Je||Ve!==Ct||vr.current||Pn?(typeof _t=="function"&&(Gu(d,x,_t,T),Ct=d.memoizedState),(be=Pn||yg(d,x,be,T,Ve,Ct,he)||!1)?(Ke||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(T,Ct,he),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(T,Ct,he)),typeof j.componentDidUpdate=="function"&&(d.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof j.componentDidUpdate!="function"||ie===u.memoizedProps&&Ve===u.memoizedState||(d.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||ie===u.memoizedProps&&Ve===u.memoizedState||(d.flags|=1024),d.memoizedProps=T,d.memoizedState=Ct),j.props=T,j.state=Ct,j.context=he,T=be):(typeof j.componentDidUpdate!="function"||ie===u.memoizedProps&&Ve===u.memoizedState||(d.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||ie===u.memoizedProps&&Ve===u.memoizedState||(d.flags|=1024),T=!1)}return tn(u,d,x,T,D,R)}function tn(u,d,x,T,R,D){Pe(u,d);var j=(d.flags&128)!==0;if(!T&&!j)return R&&Kp(d,x,!1),Al(u,d,D);T=d.stateNode,Ut.current=d;var ie=j&&typeof x.getDerivedStateFromError!="function"?null:T.render();return d.flags|=1,u!==null&&j?(d.child=dl(d,u.child,null,D),d.child=dl(d,null,ie,D)):gt(u,d,ie,D),d.memoizedState=T.state,R&&Kp(d,x,!0),d.child}function en(u){var d=u.stateNode;d.pendingContext?Wp(u,d.pendingContext,d.pendingContext!==d.context):d.context&&Wp(u,d.context,!1),Du(u,d.containerInfo)}function _n(u,d,x,T,R){return _a(),vc(R),d.flags|=256,gt(u,d,x,T),d.child}var xi={dehydrated:null,treeContext:null,retryLane:0};function xn(u){return{baseLanes:u,cachePool:null,transitions:null}}function $o(u,d,x){var T=d.pendingProps,R=Vn.current,D=!1,j=(d.flags&128)!==0,ie;if((ie=j)||(ie=u!==null&&u.memoizedState===null?!1:(R&2)!==0),ie?(D=!0,d.flags&=-129):(u===null||u.memoizedState!==null)&&(R|=1),Bn(Vn,R&1),u===null)return Wd(d),u=d.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?(d.mode&1?u.data==="$!"?d.lanes=8:d.lanes=1073741824:d.lanes=1,null):(j=T.children,u=T.fallback,D?(T=d.mode,D=d.child,j={mode:"hidden",children:j},!(T&1)&&D!==null?(D.childLanes=0,D.pendingProps=j):D=Lg(j,T,0,null),u=Wu(u,T,x,null),D.return=d,u.return=d,D.sibling=u,d.child=D,d.child.memoizedState=xn(x),d.memoizedState=xi,u):cm(d,j));if(R=u.memoizedState,R!==null&&(ie=R.dehydrated,ie!==null))return SP(u,d,j,T,ie,R,x);if(D){D=T.fallback,j=d.mode,R=u.child,ie=R.sibling;var he={mode:"hidden",children:T.children};return!(j&1)&&d.child!==R?(T=d.child,T.childLanes=0,T.pendingProps=he,d.deletions=null):(T=Rc(R,he),T.subtreeFlags=R.subtreeFlags&14680064),ie!==null?D=Rc(ie,D):(D=Wu(D,j,x,null),D.flags|=2),D.return=d,T.return=d,T.sibling=D,d.child=T,T=D,D=d.child,j=u.child.memoizedState,j=j===null?xn(x):{baseLanes:j.baseLanes|x,cachePool:null,transitions:j.transitions},D.memoizedState=j,D.childLanes=u.childLanes&~x,d.memoizedState=xi,T}return D=u.child,u=D.sibling,T=Rc(D,{mode:"visible",children:T.children}),!(d.mode&1)&&(T.lanes=x),T.return=d,T.sibling=null,u!==null&&(x=d.deletions,x===null?(d.deletions=[u],d.flags|=16):x.push(u)),d.child=T,d.memoizedState=null,T}function cm(u,d){return d=Lg({mode:"visible",children:d},u.mode,0,null),d.return=u,u.child=d}function vg(u,d,x,T){return T!==null&&vc(T),dl(d,u.child,null,x),u=cm(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function SP(u,d,x,T,R,D,j){if(x)return d.flags&256?(d.flags&=-257,T=L(Error(t(422))),vg(u,d,j,T)):d.memoizedState!==null?(d.child=u.child,d.flags|=128,null):(D=T.fallback,R=d.mode,T=Lg({mode:"visible",children:T.children},R,0,null),D=Wu(D,R,j,null),D.flags|=2,T.return=d,D.return=d,T.sibling=D,d.child=T,d.mode&1&&dl(d,u.child,null,j),d.child.memoizedState=xn(j),d.memoizedState=xi,D);if(!(d.mode&1))return vg(u,d,j,null);if(R.data==="$!"){if(T=R.nextSibling&&R.nextSibling.dataset,T)var ie=T.dgst;return T=ie,D=Error(t(419)),T=L(D,T,void 0),vg(u,d,j,T)}if(ie=(j&u.childLanes)!==0,un||ie){if(T=rr,T!==null){switch(j&-j){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=R&(T.suspendedLanes|j)?0:R,R!==0&&R!==D.retryLane&&(D.retryLane=R,Fs(u,R),qo(T,u,R,-1))}return L_(),T=L(Error(t(421))),vg(u,d,j,T)}return R.data==="$?"?(d.flags|=128,d.child=u.child,d=OP.bind(null,u),R._reactRetry=d,null):(u=D.treeContext,_r=Fo(R.nextSibling),ji=d,jn=!0,ps=null,u!==null&&(xr[Di++]=it,xr[Di++]=fs,xr[Di++]=hl,it=u.id,fs=u.overflow,hl=d),d=cm(d,T.children),d.flags|=4096,d)}function ST(u,d,x){u.lanes|=d;var T=u.alternate;T!==null&&(T.lanes|=d),Lu(u.return,d,x)}function g_(u,d,x,T,R){var D=u.memoizedState;D===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:T,tail:x,tailMode:R}:(D.isBackwards=d,D.rendering=null,D.renderingStartTime=0,D.last=T,D.tail=x,D.tailMode=R)}function AT(u,d,x){var T=d.pendingProps,R=T.revealOrder,D=T.tail;if(gt(u,d,T.children,x),T=Vn.current,T&2)T=T&1|2,d.flags|=128;else{if(u!==null&&u.flags&128)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&ST(u,x,d);else if(u.tag===19)ST(u,x,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}T&=1}if(Bn(Vn,T),!(d.mode&1))d.memoizedState=null;else switch(R){case"forwards":for(x=d.child,R=null;x!==null;)u=x.alternate,u!==null&&ks(u)===null&&(R=x),x=x.sibling;x=R,x===null?(R=d.child,d.child=null):(R=x.sibling,x.sibling=null),g_(d,!1,R,x,D);break;case"backwards":for(x=null,R=d.child,d.child=null;R!==null;){if(u=R.alternate,u!==null&&ks(u)===null){d.child=R;break}u=R.sibling,R.sibling=x,x=R,R=u}g_(d,!0,x,null,D);break;case"together":g_(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function xg(u,d){!(d.mode&1)&&u!==null&&(u.alternate=null,d.alternate=null,d.flags|=2)}function Al(u,d,x){if(u!==null&&(d.dependencies=u.dependencies),Hu|=d.lanes,!(x&d.childLanes))return null;if(u!==null&&d.child!==u.child)throw Error(t(153));if(d.child!==null){for(u=d.child,x=Rc(u,u.pendingProps),d.child=x,x.return=d;u.sibling!==null;)u=u.sibling,x=x.sibling=Rc(u,u.pendingProps),x.return=d;x.sibling=null}return d.child}function AP(u,d,x){switch(d.tag){case 3:en(d),_a();break;case 5:vl(d);break;case 1:tr(d.type)&&cl(d);break;case 4:Du(d,d.stateNode.containerInfo);break;case 10:var T=d.type._context,R=d.memoizedProps.value;Bn(fl,T._currentValue),T._currentValue=R;break;case 13:if(T=d.memoizedState,T!==null)return T.dehydrated!==null?(Bn(Vn,Vn.current&1),d.flags|=128,null):x&d.child.childLanes?$o(u,d,x):(Bn(Vn,Vn.current&1),u=Al(u,d,x),u!==null?u.sibling:null);Bn(Vn,Vn.current&1);break;case 19:if(T=(x&d.childLanes)!==0,u.flags&128){if(T)return AT(u,d,x);d.flags|=128}if(R=d.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),Bn(Vn,Vn.current),T)break;return null;case 22:case 23:return d.lanes=0,ge(u,d,x)}return Al(u,d,x)}var ET,y_,TT,wT;ET=function(u,d){for(var x=d.child;x!==null;){if(x.tag===5||x.tag===6)u.appendChild(x.stateNode);else if(x.tag!==4&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===d)break;for(;x.sibling===null;){if(x.return===null||x.return===d)return;x=x.return}x.sibling.return=x.return,x=x.sibling}},y_=function(){},TT=function(u,d,x,T){var R=u.memoizedProps;if(R!==T){u=d.stateNode,vi($r.current);var D=null;switch(x){case"input":R=Q(u,R),T=Q(u,T),D=[];break;case"select":R=X({},R,{value:void 0}),T=X({},T,{value:void 0}),D=[];break;case"textarea":R=V(u,R),T=V(u,T),D=[];break;default:typeof R.onClick!="function"&&typeof T.onClick=="function"&&(u.onclick=Au)}ue(x,T);var j;x=null;for(be in R)if(!T.hasOwnProperty(be)&&R.hasOwnProperty(be)&&R[be]!=null)if(be==="style"){var ie=R[be];for(j in ie)ie.hasOwnProperty(j)&&(x||(x={}),x[j]="")}else be!=="dangerouslySetInnerHTML"&&be!=="children"&&be!=="suppressContentEditableWarning"&&be!=="suppressHydrationWarning"&&be!=="autoFocus"&&(i.hasOwnProperty(be)?D||(D=[]):(D=D||[]).push(be,null));for(be in T){var he=T[be];if(ie=R!=null?R[be]:void 0,T.hasOwnProperty(be)&&he!==ie&&(he!=null||ie!=null))if(be==="style")if(ie){for(j in ie)!ie.hasOwnProperty(j)||he&&he.hasOwnProperty(j)||(x||(x={}),x[j]="");for(j in he)he.hasOwnProperty(j)&&ie[j]!==he[j]&&(x||(x={}),x[j]=he[j])}else x||(D||(D=[]),D.push(be,x)),x=he;else be==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,ie=ie?ie.__html:void 0,he!=null&&ie!==he&&(D=D||[]).push(be,he)):be==="children"?typeof he!="string"&&typeof he!="number"||(D=D||[]).push(be,""+he):be!=="suppressContentEditableWarning"&&be!=="suppressHydrationWarning"&&(i.hasOwnProperty(be)?(he!=null&&be==="onScroll"&&Un("scroll",u),D||ie===he||(D=[])):(D=D||[]).push(be,he))}x&&(D=D||[]).push("style",x);var be=D;(d.updateQueue=be)&&(d.flags|=4)}},wT=function(u,d,x,T){x!==T&&(d.flags|=4)};function um(u,d){if(!jn)switch(u.tailMode){case"hidden":d=u.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?u.tail=null:x.sibling=null;break;case"collapsed":x=u.tail;for(var T=null;x!==null;)x.alternate!==null&&(T=x),x=x.sibling;T===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:T.sibling=null}}function Lr(u){var d=u.alternate!==null&&u.alternate.child===u.child,x=0,T=0;if(d)for(var R=u.child;R!==null;)x|=R.lanes|R.childLanes,T|=R.subtreeFlags&14680064,T|=R.flags&14680064,R.return=u,R=R.sibling;else for(R=u.child;R!==null;)x|=R.lanes|R.childLanes,T|=R.subtreeFlags,T|=R.flags,R.return=u,R=R.sibling;return u.subtreeFlags|=T,u.childLanes=x,d}function EP(u,d,x){var T=d.pendingProps;switch(Ho(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lr(d),null;case 1:return tr(d.type)&&Eu(),Lr(d),null;case 3:return T=d.stateNode,Aa(),Gn(vr),Gn(zi),co(),T.pendingContext&&(T.context=T.pendingContext,T.pendingContext=null),(u===null||u.child===null)&&(yc(d)?d.flags|=4:u===null||u.memoizedState.isDehydrated&&!(d.flags&256)||(d.flags|=1024,ps!==null&&(C_(ps),ps=null))),y_(u,d),Lr(d),null;case 5:Sc(d);var R=vi(Vo.current);if(x=d.type,u!==null&&d.stateNode!=null)TT(u,d,x,T,R),u.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!T){if(d.stateNode===null)throw Error(t(166));return Lr(d),null}if(u=vi($r.current),yc(d)){T=d.stateNode,x=d.type;var D=d.memoizedProps;switch(T[Ti]=d,T[gc]=D,u=(d.mode&1)!==0,x){case"dialog":Un("cancel",T),Un("close",T);break;case"iframe":case"object":case"embed":Un("load",T);break;case"video":case"audio":for(R=0;R<va.length;R++)Un(va[R],T);break;case"source":Un("error",T);break;case"img":case"image":case"link":Un("error",T),Un("load",T);break;case"details":Un("toggle",T);break;case"input":St(T,D),Un("invalid",T);break;case"select":T._wrapperState={wasMultiple:!!D.multiple},Un("invalid",T);break;case"textarea":xe(T,D),Un("invalid",T)}ue(x,D),R=null;for(var j in D)if(D.hasOwnProperty(j)){var ie=D[j];j==="children"?typeof ie=="string"?T.textContent!==ie&&(D.suppressHydrationWarning!==!0&&Su(T.textContent,ie,u),R=["children",ie]):typeof ie=="number"&&T.textContent!==""+ie&&(D.suppressHydrationWarning!==!0&&Su(T.textContent,ie,u),R=["children",""+ie]):i.hasOwnProperty(j)&&ie!=null&&j==="onScroll"&&Un("scroll",T)}switch(x){case"input":ct(T),qe(T,D,!0);break;case"textarea":ct(T),He(T);break;case"select":case"option":break;default:typeof D.onClick=="function"&&(T.onclick=Au)}T=R,d.updateQueue=T,T!==null&&(d.flags|=4)}else{j=R.nodeType===9?R:R.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=Fe(x)),u==="http://www.w3.org/1999/xhtml"?x==="script"?(u=j.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof T.is=="string"?u=j.createElement(x,{is:T.is}):(u=j.createElement(x),x==="select"&&(j=u,T.multiple?j.multiple=!0:T.size&&(j.size=T.size))):u=j.createElementNS(u,x),u[Ti]=d,u[gc]=T,ET(u,d,!1,!1),d.stateNode=u;e:{switch(j=Be(x,T),x){case"dialog":Un("cancel",u),Un("close",u),R=T;break;case"iframe":case"object":case"embed":Un("load",u),R=T;break;case"video":case"audio":for(R=0;R<va.length;R++)Un(va[R],u);R=T;break;case"source":Un("error",u),R=T;break;case"img":case"image":case"link":Un("error",u),Un("load",u),R=T;break;case"details":Un("toggle",u),R=T;break;case"input":St(u,T),R=Q(u,T),Un("invalid",u);break;case"option":R=T;break;case"select":u._wrapperState={wasMultiple:!!T.multiple},R=X({},T,{value:void 0}),Un("invalid",u);break;case"textarea":xe(u,T),R=V(u,T),Un("invalid",u);break;default:R=T}ue(x,R),ie=R;for(D in ie)if(ie.hasOwnProperty(D)){var he=ie[D];D==="style"?Gt(u,he):D==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,he!=null&&mt(u,he)):D==="children"?typeof he=="string"?(x!=="textarea"||he!=="")&&Qt(u,he):typeof he=="number"&&Qt(u,""+he):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(i.hasOwnProperty(D)?he!=null&&D==="onScroll"&&Un("scroll",u):he!=null&&M(u,D,he,j))}switch(x){case"input":ct(u),qe(u,T,!1);break;case"textarea":ct(u),He(u);break;case"option":T.value!=null&&u.setAttribute("value",""+ze(T.value));break;case"select":u.multiple=!!T.multiple,D=T.value,D!=null?q(u,!!T.multiple,D,!1):T.defaultValue!=null&&q(u,!!T.multiple,T.defaultValue,!0);break;default:typeof R.onClick=="function"&&(u.onclick=Au)}switch(x){case"button":case"input":case"select":case"textarea":T=!!T.autoFocus;break e;case"img":T=!0;break e;default:T=!1}}T&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Lr(d),null;case 6:if(u&&d.stateNode!=null)wT(u,d,u.memoizedProps,T);else{if(typeof T!="string"&&d.stateNode===null)throw Error(t(166));if(x=vi(Vo.current),vi($r.current),yc(d)){if(T=d.stateNode,x=d.memoizedProps,T[Ti]=d,(D=T.nodeValue!==x)&&(u=ji,u!==null))switch(u.tag){case 3:Su(T.nodeValue,x,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&Su(T.nodeValue,x,(u.mode&1)!==0)}D&&(d.flags|=4)}else T=(x.nodeType===9?x:x.ownerDocument).createTextNode(T),T[Ti]=d,d.stateNode=T}return Lr(d),null;case 13:if(Gn(Vn),T=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(jn&&_r!==null&&d.mode&1&&!(d.flags&128))qp(),_a(),d.flags|=98560,D=!1;else if(D=yc(d),T!==null&&T.dehydrated!==null){if(u===null){if(!D)throw Error(t(318));if(D=d.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(t(317));D[Ti]=d}else _a(),!(d.flags&128)&&(d.memoizedState=null),d.flags|=4;Lr(d),D=!1}else ps!==null&&(C_(ps),ps=null),D=!0;if(!D)return d.flags&65536?d:null}return d.flags&128?(d.lanes=x,d):(T=T!==null,T!==(u!==null&&u.memoizedState!==null)&&T&&(d.child.flags|=8192,d.mode&1&&(u===null||Vn.current&1?Xi===0&&(Xi=3):L_())),d.updateQueue!==null&&(d.flags|=4),Lr(d),null);case 4:return Aa(),y_(u,d),u===null&&fc(d.stateNode.containerInfo),Lr(d),null;case 10:return Iu(d.type._context),Lr(d),null;case 17:return tr(d.type)&&Eu(),Lr(d),null;case 19:if(Gn(Vn),D=d.memoizedState,D===null)return Lr(d),null;if(T=(d.flags&128)!==0,j=D.rendering,j===null)if(T)um(D,!1);else{if(Xi!==0||u!==null&&u.flags&128)for(u=d.child;u!==null;){if(j=ks(u),j!==null){for(d.flags|=128,um(D,!1),T=j.updateQueue,T!==null&&(d.updateQueue=T,d.flags|=4),d.subtreeFlags=0,T=x,x=d.child;x!==null;)D=x,u=T,D.flags&=14680066,j=D.alternate,j===null?(D.childLanes=0,D.lanes=u,D.child=null,D.subtreeFlags=0,D.memoizedProps=null,D.memoizedState=null,D.updateQueue=null,D.dependencies=null,D.stateNode=null):(D.childLanes=j.childLanes,D.lanes=j.lanes,D.child=j.child,D.subtreeFlags=0,D.deletions=null,D.memoizedProps=j.memoizedProps,D.memoizedState=j.memoizedState,D.updateQueue=j.updateQueue,D.type=j.type,u=j.dependencies,D.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),x=x.sibling;return Bn(Vn,Vn.current&1|2),d.child}u=u.sibling}D.tail!==null&&de()>rf&&(d.flags|=128,T=!0,um(D,!1),d.lanes=4194304)}else{if(!T)if(u=ks(j),u!==null){if(d.flags|=128,T=!0,x=u.updateQueue,x!==null&&(d.updateQueue=x,d.flags|=4),um(D,!0),D.tail===null&&D.tailMode==="hidden"&&!j.alternate&&!jn)return Lr(d),null}else 2*de()-D.renderingStartTime>rf&&x!==1073741824&&(d.flags|=128,T=!0,um(D,!1),d.lanes=4194304);D.isBackwards?(j.sibling=d.child,d.child=j):(x=D.last,x!==null?x.sibling=j:d.child=j,D.last=j)}return D.tail!==null?(d=D.tail,D.rendering=d,D.tail=d.sibling,D.renderingStartTime=de(),d.sibling=null,x=Vn.current,Bn(Vn,T?x&1|2:x&1),d):(Lr(d),null);case 22:case 23:return I_(),T=d.memoizedState!==null,u!==null&&u.memoizedState!==null!==T&&(d.flags|=8192),T&&d.mode&1?Gs&1073741824&&(Lr(d),d.subtreeFlags&6&&(d.flags|=8192)):Lr(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function TP(u,d){switch(Ho(d),d.tag){case 1:return tr(d.type)&&Eu(),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return Aa(),Gn(vr),Gn(zi),co(),u=d.flags,u&65536&&!(u&128)?(d.flags=u&-65537|128,d):null;case 5:return Sc(d),null;case 13:if(Gn(Vn),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(t(340));_a()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return Gn(Vn),null;case 4:return Aa(),null;case 10:return Iu(d.type._context),null;case 22:case 23:return I_(),null;case 24:return null;default:return null}}var _g=!1,Pr=!1,wP=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function tf(u,d){var x=u.ref;if(x!==null)if(typeof x=="function")try{x(null)}catch(T){_i(u,d,T)}else x.current=null}function v_(u,d,x){try{x()}catch(T){_i(u,d,T)}}var MT=!1;function MP(u,d){if(mc=as,u=Zn(),Ri(u)){if("selectionStart"in u)var x={start:u.selectionStart,end:u.selectionEnd};else e:{x=(x=u.ownerDocument)&&x.defaultView||window;var T=x.getSelection&&x.getSelection();if(T&&T.rangeCount!==0){x=T.anchorNode;var R=T.anchorOffset,D=T.focusNode;T=T.focusOffset;try{x.nodeType,D.nodeType}catch{x=null;break e}var j=0,ie=-1,he=-1,be=0,Ke=0,Je=u,Ve=null;t:for(;;){for(var _t;Je!==x||R!==0&&Je.nodeType!==3||(ie=j+R),Je!==D||T!==0&&Je.nodeType!==3||(he=j+T),Je.nodeType===3&&(j+=Je.nodeValue.length),(_t=Je.firstChild)!==null;)Ve=Je,Je=_t;for(;;){if(Je===u)break t;if(Ve===x&&++be===R&&(ie=j),Ve===D&&++Ke===T&&(he=j),(_t=Je.nextSibling)!==null)break;Je=Ve,Ve=Je.parentNode}Je=_t}x=ie===-1||he===-1?null:{start:ie,end:he}}else x=null}x=x||{start:0,end:0}}else x=null;for(Up={focusedElem:u,selectionRange:x},as=!1,Mt=d;Mt!==null;)if(d=Mt,u=d.child,(d.subtreeFlags&1028)!==0&&u!==null)u.return=d,Mt=u;else for(;Mt!==null;){d=Mt;try{var Ct=d.alternate;if(d.flags&1024)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Ct!==null){var Rt=Ct.memoizedProps,wi=Ct.memoizedState,_e=d.stateNode,fe=_e.getSnapshotBeforeUpdate(d.elementType===d.type?Rt:ms(d.type,Rt),wi);_e.__reactInternalSnapshotBeforeUpdate=fe}break;case 3:var Ae=d.stateNode.containerInfo;Ae.nodeType===1?Ae.textContent="":Ae.nodeType===9&&Ae.documentElement&&Ae.removeChild(Ae.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(et){_i(d,d.return,et)}if(u=d.sibling,u!==null){u.return=d.return,Mt=u;break}Mt=d.return}return Ct=MT,MT=!1,Ct}function hm(u,d,x){var T=d.updateQueue;if(T=T!==null?T.lastEffect:null,T!==null){var R=T=T.next;do{if((R.tag&u)===u){var D=R.destroy;R.destroy=void 0,D!==void 0&&v_(d,x,D)}R=R.next}while(R!==T)}}function Sg(u,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var x=d=d.next;do{if((x.tag&u)===u){var T=x.create;x.destroy=T()}x=x.next}while(x!==d)}}function x_(u){var d=u.ref;if(d!==null){var x=u.stateNode;switch(u.tag){case 5:u=x;break;default:u=x}typeof d=="function"?d(u):d.current=u}}function bT(u){var d=u.alternate;d!==null&&(u.alternate=null,bT(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&(delete d[Ti],delete d[gc],delete d[al],delete d[Nd],delete d[Ud])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function CT(u){return u.tag===5||u.tag===3||u.tag===4}function RT(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||CT(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function __(u,d,x){var T=u.tag;if(T===5||T===6)u=u.stateNode,d?x.nodeType===8?x.parentNode.insertBefore(u,d):x.insertBefore(u,d):(x.nodeType===8?(d=x.parentNode,d.insertBefore(u,x)):(d=x,d.appendChild(u)),x=x._reactRootContainer,x!=null||d.onclick!==null||(d.onclick=Au));else if(T!==4&&(u=u.child,u!==null))for(__(u,d,x),u=u.sibling;u!==null;)__(u,d,x),u=u.sibling}function S_(u,d,x){var T=u.tag;if(T===5||T===6)u=u.stateNode,d?x.insertBefore(u,d):x.appendChild(u);else if(T!==4&&(u=u.child,u!==null))for(S_(u,d,x),u=u.sibling;u!==null;)S_(u,d,x),u=u.sibling}var Ar=null,Yo=!1;function Tc(u,d,x){for(x=x.child;x!==null;)IT(u,d,x),x=x.sibling}function IT(u,d,x){if(xt&&typeof xt.onCommitFiberUnmount=="function")try{xt.onCommitFiberUnmount(wt,x)}catch{}switch(x.tag){case 5:Pr||tf(x,d);case 6:var T=Ar,R=Yo;Ar=null,Tc(u,d,x),Ar=T,Yo=R,Ar!==null&&(Yo?(u=Ar,x=x.stateNode,u.nodeType===8?u.parentNode.removeChild(x):u.removeChild(x)):Ar.removeChild(x.stateNode));break;case 18:Ar!==null&&(Yo?(u=Ar,x=x.stateNode,u.nodeType===8?kd(u.parentNode,x):u.nodeType===1&&kd(u,x),uu(u)):kd(Ar,x.stateNode));break;case 4:T=Ar,R=Yo,Ar=x.stateNode.containerInfo,Yo=!0,Tc(u,d,x),Ar=T,Yo=R;break;case 0:case 11:case 14:case 15:if(!Pr&&(T=x.updateQueue,T!==null&&(T=T.lastEffect,T!==null))){R=T=T.next;do{var D=R,j=D.destroy;D=D.tag,j!==void 0&&(D&2||D&4)&&v_(x,d,j),R=R.next}while(R!==T)}Tc(u,d,x);break;case 1:if(!Pr&&(tf(x,d),T=x.stateNode,typeof T.componentWillUnmount=="function"))try{T.props=x.memoizedProps,T.state=x.memoizedState,T.componentWillUnmount()}catch(ie){_i(x,d,ie)}Tc(u,d,x);break;case 21:Tc(u,d,x);break;case 22:x.mode&1?(Pr=(T=Pr)||x.memoizedState!==null,Tc(u,d,x),Pr=T):Tc(u,d,x);break;default:Tc(u,d,x)}}function LT(u){var d=u.updateQueue;if(d!==null){u.updateQueue=null;var x=u.stateNode;x===null&&(x=u.stateNode=new wP),d.forEach(function(T){var R=BP.bind(null,u,T);x.has(T)||(x.add(T),T.then(R,R))})}}function Jo(u,d){var x=d.deletions;if(x!==null)for(var T=0;T<x.length;T++){var R=x[T];try{var D=u,j=d,ie=j;e:for(;ie!==null;){switch(ie.tag){case 5:Ar=ie.stateNode,Yo=!1;break e;case 3:Ar=ie.stateNode.containerInfo,Yo=!0;break e;case 4:Ar=ie.stateNode.containerInfo,Yo=!0;break e}ie=ie.return}if(Ar===null)throw Error(t(160));IT(D,j,R),Ar=null,Yo=!1;var he=R.alternate;he!==null&&(he.return=null),R.return=null}catch(be){_i(R,d,be)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)PT(d,u),d=d.sibling}function PT(u,d){var x=u.alternate,T=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(Jo(d,u),Ta(u),T&4){try{hm(3,u,u.return),Sg(3,u)}catch(Rt){_i(u,u.return,Rt)}try{hm(5,u,u.return)}catch(Rt){_i(u,u.return,Rt)}}break;case 1:Jo(d,u),Ta(u),T&512&&x!==null&&tf(x,x.return);break;case 5:if(Jo(d,u),Ta(u),T&512&&x!==null&&tf(x,x.return),u.flags&32){var R=u.stateNode;try{Qt(R,"")}catch(Rt){_i(u,u.return,Rt)}}if(T&4&&(R=u.stateNode,R!=null)){var D=u.memoizedProps,j=x!==null?x.memoizedProps:D,ie=u.type,he=u.updateQueue;if(u.updateQueue=null,he!==null)try{ie==="input"&&D.type==="radio"&&D.name!=null&&We(R,D),Be(ie,j);var be=Be(ie,D);for(j=0;j<he.length;j+=2){var Ke=he[j],Je=he[j+1];Ke==="style"?Gt(R,Je):Ke==="dangerouslySetInnerHTML"?mt(R,Je):Ke==="children"?Qt(R,Je):M(R,Ke,Je,be)}switch(ie){case"input":st(R,D);break;case"textarea":De(R,D);break;case"select":var Ve=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!D.multiple;var _t=D.value;_t!=null?q(R,!!D.multiple,_t,!1):Ve!==!!D.multiple&&(D.defaultValue!=null?q(R,!!D.multiple,D.defaultValue,!0):q(R,!!D.multiple,D.multiple?[]:"",!1))}R[gc]=D}catch(Rt){_i(u,u.return,Rt)}}break;case 6:if(Jo(d,u),Ta(u),T&4){if(u.stateNode===null)throw Error(t(162));R=u.stateNode,D=u.memoizedProps;try{R.nodeValue=D}catch(Rt){_i(u,u.return,Rt)}}break;case 3:if(Jo(d,u),Ta(u),T&4&&x!==null&&x.memoizedState.isDehydrated)try{uu(d.containerInfo)}catch(Rt){_i(u,u.return,Rt)}break;case 4:Jo(d,u),Ta(u);break;case 13:Jo(d,u),Ta(u),R=u.child,R.flags&8192&&(D=R.memoizedState!==null,R.stateNode.isHidden=D,!D||R.alternate!==null&&R.alternate.memoizedState!==null||(T_=de())),T&4&&LT(u);break;case 22:if(Ke=x!==null&&x.memoizedState!==null,u.mode&1?(Pr=(be=Pr)||Ke,Jo(d,u),Pr=be):Jo(d,u),Ta(u),T&8192){if(be=u.memoizedState!==null,(u.stateNode.isHidden=be)&&!Ke&&u.mode&1)for(Mt=u,Ke=u.child;Ke!==null;){for(Je=Mt=Ke;Mt!==null;){switch(Ve=Mt,_t=Ve.child,Ve.tag){case 0:case 11:case 14:case 15:hm(4,Ve,Ve.return);break;case 1:tf(Ve,Ve.return);var Ct=Ve.stateNode;if(typeof Ct.componentWillUnmount=="function"){T=Ve,x=Ve.return;try{d=T,Ct.props=d.memoizedProps,Ct.state=d.memoizedState,Ct.componentWillUnmount()}catch(Rt){_i(T,x,Rt)}}break;case 5:tf(Ve,Ve.return);break;case 22:if(Ve.memoizedState!==null){BT(Je);continue}}_t!==null?(_t.return=Ve,Mt=_t):BT(Je)}Ke=Ke.sibling}e:for(Ke=null,Je=u;;){if(Je.tag===5){if(Ke===null){Ke=Je;try{R=Je.stateNode,be?(D=R.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none"):(ie=Je.stateNode,he=Je.memoizedProps.style,j=he!=null&&he.hasOwnProperty("display")?he.display:null,ie.style.display=kt("display",j))}catch(Rt){_i(u,u.return,Rt)}}}else if(Je.tag===6){if(Ke===null)try{Je.stateNode.nodeValue=be?"":Je.memoizedProps}catch(Rt){_i(u,u.return,Rt)}}else if((Je.tag!==22&&Je.tag!==23||Je.memoizedState===null||Je===u)&&Je.child!==null){Je.child.return=Je,Je=Je.child;continue}if(Je===u)break e;for(;Je.sibling===null;){if(Je.return===null||Je.return===u)break e;Ke===Je&&(Ke=null),Je=Je.return}Ke===Je&&(Ke=null),Je.sibling.return=Je.return,Je=Je.sibling}}break;case 19:Jo(d,u),Ta(u),T&4&&LT(u);break;case 21:break;default:Jo(d,u),Ta(u)}}function Ta(u){var d=u.flags;if(d&2){try{e:{for(var x=u.return;x!==null;){if(CT(x)){var T=x;break e}x=x.return}throw Error(t(160))}switch(T.tag){case 5:var R=T.stateNode;T.flags&32&&(Qt(R,""),T.flags&=-33);var D=RT(u);S_(u,D,R);break;case 3:case 4:var j=T.stateNode.containerInfo,ie=RT(u);__(u,ie,j);break;default:throw Error(t(161))}}catch(he){_i(u,u.return,he)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function bP(u,d,x){Mt=u,DT(u)}function DT(u,d,x){for(var T=(u.mode&1)!==0;Mt!==null;){var R=Mt,D=R.child;if(R.tag===22&&T){var j=R.memoizedState!==null||_g;if(!j){var ie=R.alternate,he=ie!==null&&ie.memoizedState!==null||Pr;ie=_g;var be=Pr;if(_g=j,(Pr=he)&&!be)for(Mt=R;Mt!==null;)j=Mt,he=j.child,j.tag===22&&j.memoizedState!==null?FT(R):he!==null?(he.return=j,Mt=he):FT(R);for(;D!==null;)Mt=D,DT(D),D=D.sibling;Mt=R,_g=ie,Pr=be}OT(u)}else R.subtreeFlags&8772&&D!==null?(D.return=R,Mt=D):OT(u)}}function OT(u){for(;Mt!==null;){var d=Mt;if(d.flags&8772){var x=d.alternate;try{if(d.flags&8772)switch(d.tag){case 0:case 11:case 15:Pr||Sg(5,d);break;case 1:var T=d.stateNode;if(d.flags&4&&!Pr)if(x===null)T.componentDidMount();else{var R=d.elementType===d.type?x.memoizedProps:ms(d.type,x.memoizedProps);T.componentDidUpdate(R,x.memoizedState,T.__reactInternalSnapshotBeforeUpdate)}var D=d.updateQueue;D!==null&&_c(d,D,T);break;case 3:var j=d.updateQueue;if(j!==null){if(x=null,d.child!==null)switch(d.child.tag){case 5:x=d.child.stateNode;break;case 1:x=d.child.stateNode}_c(d,j,x)}break;case 5:var ie=d.stateNode;if(x===null&&d.flags&4){x=ie;var he=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":he.autoFocus&&x.focus();break;case"img":he.src&&(x.src=he.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var be=d.alternate;if(be!==null){var Ke=be.memoizedState;if(Ke!==null){var Je=Ke.dehydrated;Je!==null&&uu(Je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Pr||d.flags&512&&x_(d)}catch(Ve){_i(d,d.return,Ve)}}if(d===u){Mt=null;break}if(x=d.sibling,x!==null){x.return=d.return,Mt=x;break}Mt=d.return}}function BT(u){for(;Mt!==null;){var d=Mt;if(d===u){Mt=null;break}var x=d.sibling;if(x!==null){x.return=d.return,Mt=x;break}Mt=d.return}}function FT(u){for(;Mt!==null;){var d=Mt;try{switch(d.tag){case 0:case 11:case 15:var x=d.return;try{Sg(4,d)}catch(he){_i(d,x,he)}break;case 1:var T=d.stateNode;if(typeof T.componentDidMount=="function"){var R=d.return;try{T.componentDidMount()}catch(he){_i(d,R,he)}}var D=d.return;try{x_(d)}catch(he){_i(d,D,he)}break;case 5:var j=d.return;try{x_(d)}catch(he){_i(d,j,he)}}}catch(he){_i(d,d.return,he)}if(d===u){Mt=null;break}var ie=d.sibling;if(ie!==null){ie.return=d.return,Mt=ie;break}Mt=d.return}}var CP=Math.ceil,Ag=C.ReactCurrentDispatcher,A_=C.ReactCurrentOwner,ho=C.ReactCurrentBatchConfig,bn=0,rr=null,Oi=null,Er=0,Gs=0,nf=ti(0),Xi=0,dm=null,Hu=0,Eg=0,E_=0,fm=null,gs=null,T_=0,rf=1/0,El=null,Tg=!1,w_=null,wc=null,wg=!1,Mc=null,Mg=0,pm=0,M_=null,bg=-1,Cg=0;function Qr(){return bn&6?de():bg!==-1?bg:bg=de()}function bc(u){return u.mode&1?bn&2&&Er!==0?Er&-Er:p_.transition!==null?(Cg===0&&(Cg=zn()),Cg):(u=cn,u!==0||(u=window.event,u=u===void 0?16:X0(u.type)),u):1}function qo(u,d,x,T){if(50<pm)throw pm=0,M_=null,Error(t(185));li(u,x,T),(!(bn&2)||u!==rr)&&(u===rr&&(!(bn&2)&&(Eg|=x),Xi===4&&Cc(u,Er)),ys(u,T),x===1&&bn===0&&!(d.mode&1)&&(rf=de()+500,wu&&ao()))}function ys(u,d){var x=u.callbackNode;to(u,d);var T=os(u,u===rr?Er:0);if(T===0)x!==null&&me(x),u.callbackNode=null,u.callbackPriority=0;else if(d=T&-T,u.callbackPriority!==d){if(x!=null&&me(x),d===1)u.tag===0?ag(NT.bind(null,u)):Mu(NT.bind(null,u)),f_(function(){!(bn&6)&&ao()}),x=null;else{switch(ec(T)){case 1:x=ot;break;case 4:x=yt;break;case 16:x=Et;break;case 536870912:x=Nt;break;default:x=Et}x=KT(x,kT.bind(null,u))}u.callbackPriority=d,u.callbackNode=x}}function kT(u,d){if(bg=-1,Cg=0,bn&6)throw Error(t(327));var x=u.callbackNode;if(sf()&&u.callbackNode!==x)return null;var T=os(u,u===rr?Er:0);if(T===0)return null;if(T&30||T&u.expiredLanes||d)d=Rg(u,T);else{d=T;var R=bn;bn|=2;var D=GT();(rr!==u||Er!==d)&&(El=null,rf=de()+500,ju(u,d));do try{LP();break}catch(ie){UT(u,ie)}while(!0);ml(),Ag.current=D,bn=R,Oi!==null?d=0:(rr=null,Er=0,d=Xi)}if(d!==0){if(d===2&&(R=Ln(u),R!==0&&(T=R,d=b_(u,R))),d===1)throw x=dm,ju(u,0),Cc(u,T),ys(u,de()),x;if(d===6)Cc(u,T);else{if(R=u.current.alternate,!(T&30)&&!RP(R)&&(d=Rg(u,T),d===2&&(D=Ln(u),D!==0&&(T=D,d=b_(u,D))),d===1))throw x=dm,ju(u,0),Cc(u,T),ys(u,de()),x;switch(u.finishedWork=R,u.finishedLanes=T,d){case 0:case 1:throw Error(t(345));case 2:Vu(u,gs,El);break;case 3:if(Cc(u,T),(T&130023424)===T&&(d=T_+500-de(),10<d)){if(os(u,0)!==0)break;if(R=u.suspendedLanes,(R&T)!==T){Qr(),u.pingedLanes|=u.suspendedLanes&R;break}u.timeoutHandle=Hp(Vu.bind(null,u,gs,El),d);break}Vu(u,gs,El);break;case 4:if(Cc(u,T),(T&4194240)===T)break;for(d=u.eventTimes,R=-1;0<T;){var j=31-dn(T);D=1<<j,j=d[j],j>R&&(R=j),T&=~D}if(T=R,T=de()-T,T=(120>T?120:480>T?480:1080>T?1080:1920>T?1920:3e3>T?3e3:4320>T?4320:1960*CP(T/1960))-T,10<T){u.timeoutHandle=Hp(Vu.bind(null,u,gs,El),T);break}Vu(u,gs,El);break;case 5:Vu(u,gs,El);break;default:throw Error(t(329))}}}return ys(u,de()),u.callbackNode===x?kT.bind(null,u):null}function b_(u,d){var x=fm;return u.current.memoizedState.isDehydrated&&(ju(u,d).flags|=256),u=Rg(u,d),u!==2&&(d=gs,gs=x,d!==null&&C_(d)),u}function C_(u){gs===null?gs=u:gs.push.apply(gs,u)}function RP(u){for(var d=u;;){if(d.flags&16384){var x=d.updateQueue;if(x!==null&&(x=x.stores,x!==null))for(var T=0;T<x.length;T++){var R=x[T],D=R.getSnapshot;R=R.value;try{if(!Vr(D(),R))return!1}catch{return!1}}}if(x=d.child,d.subtreeFlags&16384&&x!==null)x.return=d,d=x;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Cc(u,d){for(d&=~E_,d&=~Eg,u.suspendedLanes|=d,u.pingedLanes&=~d,u=u.expirationTimes;0<d;){var x=31-dn(d),T=1<<x;u[x]=-1,d&=~T}}function NT(u){if(bn&6)throw Error(t(327));sf();var d=os(u,0);if(!(d&1))return ys(u,de()),null;var x=Rg(u,d);if(u.tag!==0&&x===2){var T=Ln(u);T!==0&&(d=T,x=b_(u,T))}if(x===1)throw x=dm,ju(u,0),Cc(u,d),ys(u,de()),x;if(x===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=d,Vu(u,gs,El),ys(u,de()),null}function R_(u,d){var x=bn;bn|=1;try{return u(d)}finally{bn=x,bn===0&&(rf=de()+500,wu&&ao())}}function zu(u){Mc!==null&&Mc.tag===0&&!(bn&6)&&sf();var d=bn;bn|=1;var x=ho.transition,T=cn;try{if(ho.transition=null,cn=1,u)return u()}finally{cn=T,ho.transition=x,bn=d,!(bn&6)&&ao()}}function I_(){Gs=nf.current,Gn(nf)}function ju(u,d){u.finishedWork=null,u.finishedLanes=0;var x=u.timeoutHandle;if(x!==-1&&(u.timeoutHandle=-1,zp(x)),Oi!==null)for(x=Oi.return;x!==null;){var T=x;switch(Ho(T),T.tag){case 1:T=T.type.childContextTypes,T!=null&&Eu();break;case 3:Aa(),Gn(vr),Gn(zi),co();break;case 5:Sc(T);break;case 4:Aa();break;case 13:Gn(Vn);break;case 19:Gn(Vn);break;case 10:Iu(T.type._context);break;case 22:case 23:I_()}x=x.return}if(rr=u,Oi=u=Rc(u.current,null),Er=Gs=d,Xi=0,dm=null,E_=Eg=Hu=0,gs=fm=null,jo!==null){for(d=0;d<jo.length;d++)if(x=jo[d],T=x.interleaved,T!==null){x.interleaved=null;var R=T.next,D=x.pending;if(D!==null){var j=D.next;D.next=R,T.next=j}x.pending=T}jo=null}return u}function UT(u,d){do{var x=Oi;try{if(ml(),xl.current=Zd,Ns){for(var T=Hn.memoizedState;T!==null;){var R=T.queue;R!==null&&(R.pending=null),T=T.next}Ns=!1}if(Wo=0,En=ii=Hn=null,ir=!1,Ea=0,A_.current=null,x===null||x.return===null){Xi=1,dm=d,Oi=null;break}e:{var D=u,j=x.return,ie=x,he=d;if(d=Er,ie.flags|=32768,he!==null&&typeof he=="object"&&typeof he.then=="function"){var be=he,Ke=ie,Je=Ke.tag;if(!(Ke.mode&1)&&(Je===0||Je===11||Je===15)){var Ve=Ke.alternate;Ve?(Ke.updateQueue=Ve.updateQueue,Ke.memoizedState=Ve.memoizedState,Ke.lanes=Ve.lanes):(Ke.updateQueue=null,Ke.memoizedState=null)}var _t=Tt(j);if(_t!==null){_t.flags&=-257,Zt(_t,j,ie,D,d),_t.mode&1&&Qe(D,be,d),d=_t,he=be;var Ct=d.updateQueue;if(Ct===null){var Rt=new Set;Rt.add(he),d.updateQueue=Rt}else Ct.add(he);break e}else{if(!(d&1)){Qe(D,be,d),L_();break e}he=Error(t(426))}}else if(jn&&ie.mode&1){var wi=Tt(j);if(wi!==null){!(wi.flags&65536)&&(wi.flags|=256),Zt(wi,j,ie,D,d),vc(b(he,ie));break e}}D=he=b(he,ie),Xi!==4&&(Xi=2),fm===null?fm=[D]:fm.push(D),D=j;do{switch(D.tag){case 3:D.flags|=65536,d&=-d,D.lanes|=d;var _e=pe(D,he,d);gl(D,_e);break e;case 1:ie=he;var fe=D.type,Ae=D.stateNode;if(!(D.flags&128)&&(typeof fe.getDerivedStateFromError=="function"||Ae!==null&&typeof Ae.componentDidCatch=="function"&&(wc===null||!wc.has(Ae)))){D.flags|=65536,d&=-d,D.lanes|=d;var et=Oe(D,ie,d);gl(D,et);break e}}D=D.return}while(D!==null)}zT(x)}catch(Ot){d=Ot,Oi===x&&x!==null&&(Oi=x=x.return);continue}break}while(!0)}function GT(){var u=Ag.current;return Ag.current=Zd,u===null?Zd:u}function L_(){(Xi===0||Xi===3||Xi===2)&&(Xi=4),rr===null||!(Hu&268435455)&&!(Eg&268435455)||Cc(rr,Er)}function Rg(u,d){var x=bn;bn|=2;var T=GT();(rr!==u||Er!==d)&&(El=null,ju(u,d));do try{IP();break}catch(R){UT(u,R)}while(!0);if(ml(),bn=x,Ag.current=T,Oi!==null)throw Error(t(261));return rr=null,Er=0,Xi}function IP(){for(;Oi!==null;)HT(Oi)}function LP(){for(;Oi!==null&&!Me();)HT(Oi)}function HT(u){var d=WT(u.alternate,u,Gs);u.memoizedProps=u.pendingProps,d===null?zT(u):Oi=d,A_.current=null}function zT(u){var d=u;do{var x=d.alternate;if(u=d.return,d.flags&32768){if(x=TP(x,d),x!==null){x.flags&=32767,Oi=x;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{Xi=6,Oi=null;return}}else if(x=EP(x,d,Gs),x!==null){Oi=x;return}if(d=d.sibling,d!==null){Oi=d;return}Oi=d=u}while(d!==null);Xi===0&&(Xi=5)}function Vu(u,d,x){var T=cn,R=ho.transition;try{ho.transition=null,cn=1,PP(u,d,x,T)}finally{ho.transition=R,cn=T}return null}function PP(u,d,x,T){do sf();while(Mc!==null);if(bn&6)throw Error(t(327));x=u.finishedWork;var R=u.finishedLanes;if(x===null)return null;if(u.finishedWork=null,u.finishedLanes=0,x===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var D=x.lanes|x.childLanes;if(er(u,D),u===rr&&(Oi=rr=null,Er=0),!(x.subtreeFlags&2064)&&!(x.flags&2064)||wg||(wg=!0,KT(Et,function(){return sf(),null})),D=(x.flags&15990)!==0,x.subtreeFlags&15990||D){D=ho.transition,ho.transition=null;var j=cn;cn=1;var ie=bn;bn|=4,A_.current=null,MP(u,x),PT(x,u),Ii(Up),as=!!mc,Up=mc=null,u.current=x,bP(x),Re(),bn=ie,cn=j,ho.transition=D}else u.current=x;if(wg&&(wg=!1,Mc=u,Mg=R),D=u.pendingLanes,D===0&&(wc=null),Bt(x.stateNode),ys(u,de()),d!==null)for(T=u.onRecoverableError,x=0;x<d.length;x++)R=d[x],T(R.value,{componentStack:R.stack,digest:R.digest});if(Tg)throw Tg=!1,u=w_,w_=null,u;return Mg&1&&u.tag!==0&&sf(),D=u.pendingLanes,D&1?u===M_?pm++:(pm=0,M_=u):pm=0,ao(),null}function sf(){if(Mc!==null){var u=ec(Mg),d=ho.transition,x=cn;try{if(ho.transition=null,cn=16>u?16:u,Mc===null)var T=!1;else{if(u=Mc,Mc=null,Mg=0,bn&6)throw Error(t(331));var R=bn;for(bn|=4,Mt=u.current;Mt!==null;){var D=Mt,j=D.child;if(Mt.flags&16){var ie=D.deletions;if(ie!==null){for(var he=0;he<ie.length;he++){var be=ie[he];for(Mt=be;Mt!==null;){var Ke=Mt;switch(Ke.tag){case 0:case 11:case 15:hm(8,Ke,D)}var Je=Ke.child;if(Je!==null)Je.return=Ke,Mt=Je;else for(;Mt!==null;){Ke=Mt;var Ve=Ke.sibling,_t=Ke.return;if(bT(Ke),Ke===be){Mt=null;break}if(Ve!==null){Ve.return=_t,Mt=Ve;break}Mt=_t}}}var Ct=D.alternate;if(Ct!==null){var Rt=Ct.child;if(Rt!==null){Ct.child=null;do{var wi=Rt.sibling;Rt.sibling=null,Rt=wi}while(Rt!==null)}}Mt=D}}if(D.subtreeFlags&2064&&j!==null)j.return=D,Mt=j;else e:for(;Mt!==null;){if(D=Mt,D.flags&2048)switch(D.tag){case 0:case 11:case 15:hm(9,D,D.return)}var _e=D.sibling;if(_e!==null){_e.return=D.return,Mt=_e;break e}Mt=D.return}}var fe=u.current;for(Mt=fe;Mt!==null;){j=Mt;var Ae=j.child;if(j.subtreeFlags&2064&&Ae!==null)Ae.return=j,Mt=Ae;else e:for(j=fe;Mt!==null;){if(ie=Mt,ie.flags&2048)try{switch(ie.tag){case 0:case 11:case 15:Sg(9,ie)}}catch(Ot){_i(ie,ie.return,Ot)}if(ie===j){Mt=null;break e}var et=ie.sibling;if(et!==null){et.return=ie.return,Mt=et;break e}Mt=ie.return}}if(bn=R,ao(),xt&&typeof xt.onPostCommitFiberRoot=="function")try{xt.onPostCommitFiberRoot(wt,u)}catch{}T=!0}return T}finally{cn=x,ho.transition=d}}return!1}function jT(u,d,x){d=b(x,d),d=pe(u,d,1),u=$n(u,d,1),d=Qr(),u!==null&&(li(u,1,d),ys(u,d))}function _i(u,d,x){if(u.tag===3)jT(u,u,x);else for(;d!==null;){if(d.tag===3){jT(d,u,x);break}else if(d.tag===1){var T=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(wc===null||!wc.has(T))){u=b(x,u),u=Oe(d,u,1),d=$n(d,u,1),u=Qr(),d!==null&&(li(d,1,u),ys(d,u));break}}d=d.return}}function DP(u,d,x){var T=u.pingCache;T!==null&&T.delete(d),d=Qr(),u.pingedLanes|=u.suspendedLanes&x,rr===u&&(Er&x)===x&&(Xi===4||Xi===3&&(Er&130023424)===Er&&500>de()-T_?ju(u,0):E_|=x),ys(u,d)}function VT(u,d){d===0&&(u.mode&1?(d=$t,$t<<=1,!($t&130023424)&&($t=4194304)):d=1);var x=Qr();u=Fs(u,d),u!==null&&(li(u,d,x),ys(u,x))}function OP(u){var d=u.memoizedState,x=0;d!==null&&(x=d.retryLane),VT(u,x)}function BP(u,d){var x=0;switch(u.tag){case 13:var T=u.stateNode,R=u.memoizedState;R!==null&&(x=R.retryLane);break;case 19:T=u.stateNode;break;default:throw Error(t(314))}T!==null&&T.delete(d),VT(u,x)}var WT;WT=function(u,d,x){if(u!==null)if(u.memoizedProps!==d.pendingProps||vr.current)un=!0;else{if(!(u.lanes&x)&&!(d.flags&128))return un=!1,AP(u,d,x);un=!!(u.flags&131072)}else un=!1,jn&&d.flags&1048576&&Xp(d,jd,d.index);switch(d.lanes=0,d.tag){case 2:var T=d.type;xg(u,d),u=d.pendingProps;var R=ll(d,zi.current);Sa(d,x),R=Bu(null,d,T,u,R,x);var D=tm();return d.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,tr(T)?(D=!0,cl(d)):D=!1,d.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,sn(d),R.updater=ef,d.stateNode=R,R._reactInternals=d,E(d,T,u,x),d=tn(null,d,T,!0,D,x)):(d.tag=0,jn&&D&&$p(d),gt(null,d,R,x),d=d.child),d;case 16:T=d.elementType;e:{switch(xg(u,d),u=d.pendingProps,R=T._init,T=R(T._payload),d.type=T,R=d.tag=kP(T),u=ms(T,u),R){case 0:d=dt(null,d,T,u,x);break e;case 1:d=Pt(null,d,T,u,x);break e;case 11:d=Ki(null,d,T,u,x);break e;case 14:d=qr(null,d,T,ms(T.type,u),x);break e}throw Error(t(306,T,""))}return d;case 0:return T=d.type,R=d.pendingProps,R=d.elementType===T?R:ms(T,R),dt(u,d,T,R,x);case 1:return T=d.type,R=d.pendingProps,R=d.elementType===T?R:ms(T,R),Pt(u,d,T,R,x);case 3:e:{if(en(d),u===null)throw Error(t(387));T=d.pendingProps,D=d.memoizedState,R=D.element,ui(u,d),ni(d,T,null,x);var j=d.memoizedState;if(T=j.element,D.isDehydrated)if(D={element:T,isDehydrated:!1,cache:j.cache,pendingSuspenseBoundaries:j.pendingSuspenseBoundaries,transitions:j.transitions},d.updateQueue.baseState=D,d.memoizedState=D,d.flags&256){R=b(Error(t(423)),d),d=_n(u,d,T,x,R);break e}else if(T!==R){R=b(Error(t(424)),d),d=_n(u,d,T,x,R);break e}else for(_r=Fo(d.stateNode.containerInfo.firstChild),ji=d,jn=!0,ps=null,x=Ru(d,null,T,x),d.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(_a(),T===R){d=Al(u,d,x);break e}gt(u,d,T,x)}d=d.child}return d;case 5:return vl(d),u===null&&Wd(d),T=d.type,R=d.pendingProps,D=u!==null?u.memoizedProps:null,j=R.children,Gp(T,R)?j=null:D!==null&&Gp(T,D)&&(d.flags|=32),Pe(u,d),gt(u,d,j,x),d.child;case 6:return u===null&&Wd(d),null;case 13:return $o(u,d,x);case 4:return Du(d,d.stateNode.containerInfo),T=d.pendingProps,u===null?d.child=dl(d,null,T,x):gt(u,d,T,x),d.child;case 11:return T=d.type,R=d.pendingProps,R=d.elementType===T?R:ms(T,R),Ki(u,d,T,R,x);case 7:return gt(u,d,d.pendingProps,x),d.child;case 8:return gt(u,d,d.pendingProps.children,x),d.child;case 12:return gt(u,d,d.pendingProps.children,x),d.child;case 10:e:{if(T=d.type._context,R=d.pendingProps,D=d.memoizedProps,j=R.value,Bn(fl,T._currentValue),T._currentValue=j,D!==null)if(Vr(D.value,j)){if(D.children===R.children&&!vr.current){d=Al(u,d,x);break e}}else for(D=d.child,D!==null&&(D.return=d);D!==null;){var ie=D.dependencies;if(ie!==null){j=D.child;for(var he=ie.firstContext;he!==null;){if(he.context===T){if(D.tag===1){he=Dn(-1,x&-x),he.tag=2;var be=D.updateQueue;if(be!==null){be=be.shared;var Ke=be.pending;Ke===null?he.next=he:(he.next=Ke.next,Ke.next=he),be.pending=he}}D.lanes|=x,he=D.alternate,he!==null&&(he.lanes|=x),Lu(D.return,x,d),ie.lanes|=x;break}he=he.next}}else if(D.tag===10)j=D.type===d.type?null:D.child;else if(D.tag===18){if(j=D.return,j===null)throw Error(t(341));j.lanes|=x,ie=j.alternate,ie!==null&&(ie.lanes|=x),Lu(j,x,d),j=D.sibling}else j=D.child;if(j!==null)j.return=D;else for(j=D;j!==null;){if(j===d){j=null;break}if(D=j.sibling,D!==null){D.return=j.return,j=D;break}j=j.return}D=j}gt(u,d,R.children,x),d=d.child}return d;case 9:return R=d.type,T=d.pendingProps.children,Sa(d,x),R=Xr(R),T=T(R),d.flags|=1,gt(u,d,T,x),d.child;case 14:return T=d.type,R=ms(T,d.pendingProps),R=ms(T.type,R),qr(u,d,T,R,x);case 15:return Te(u,d,d.type,d.pendingProps,x);case 17:return T=d.type,R=d.pendingProps,R=d.elementType===T?R:ms(T,R),xg(u,d),d.tag=1,tr(T)?(u=!0,cl(d)):u=!1,Sa(d,x),m(d,T,R),E(d,T,R,x),tn(null,d,T,!0,u,x);case 19:return AT(u,d,x);case 22:return ge(u,d,x)}throw Error(t(156,d.tag))};function KT(u,d){return K(u,d)}function FP(u,d,x,T){this.tag=u,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fo(u,d,x,T){return new FP(u,d,x,T)}function P_(u){return u=u.prototype,!(!u||!u.isReactComponent)}function kP(u){if(typeof u=="function")return P_(u)?1:0;if(u!=null){if(u=u.$$typeof,u===Z)return 11;if(u===oe)return 14}return 2}function Rc(u,d){var x=u.alternate;return x===null?(x=fo(u.tag,d,u.key,u.mode),x.elementType=u.elementType,x.type=u.type,x.stateNode=u.stateNode,x.alternate=u,u.alternate=x):(x.pendingProps=d,x.type=u.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=u.flags&14680064,x.childLanes=u.childLanes,x.lanes=u.lanes,x.child=u.child,x.memoizedProps=u.memoizedProps,x.memoizedState=u.memoizedState,x.updateQueue=u.updateQueue,d=u.dependencies,x.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},x.sibling=u.sibling,x.index=u.index,x.ref=u.ref,x}function Ig(u,d,x,T,R,D){var j=2;if(T=u,typeof u=="function")P_(u)&&(j=1);else if(typeof u=="string")j=5;else e:switch(u){case k:return Wu(x.children,R,D,d);case N:j=8,R|=8;break;case B:return u=fo(12,x,d,R|2),u.elementType=B,u.lanes=D,u;case Y:return u=fo(13,x,d,R),u.elementType=Y,u.lanes=D,u;case se:return u=fo(19,x,d,R),u.elementType=se,u.lanes=D,u;case ce:return Lg(x,R,D,d);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case P:j=10;break e;case G:j=9;break e;case Z:j=11;break e;case oe:j=14;break e;case re:j=16,T=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return d=fo(j,x,d,R),d.elementType=u,d.type=T,d.lanes=D,d}function Wu(u,d,x,T){return u=fo(7,u,T,d),u.lanes=x,u}function Lg(u,d,x,T){return u=fo(22,u,T,d),u.elementType=ce,u.lanes=x,u.stateNode={isHidden:!1},u}function D_(u,d,x){return u=fo(6,u,null,d),u.lanes=x,u}function O_(u,d,x){return d=fo(4,u.children!==null?u.children:[],u.key,d),d.lanes=x,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}function NP(u,d,x,T,R){this.tag=d,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zi(0),this.expirationTimes=Zi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zi(0),this.identifierPrefix=T,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function B_(u,d,x,T,R,D,j,ie,he){return u=new NP(u,d,x,ie,he),d===1?(d=1,D===!0&&(d|=8)):d=0,D=fo(3,null,null,d),u.current=D,D.stateNode=u,D.memoizedState={element:T,isDehydrated:x,cache:null,transitions:null,pendingSuspenseBoundaries:null},sn(D),u}function UP(u,d,x){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:O,key:T==null?null:""+T,children:u,containerInfo:d,implementation:x}}function XT(u){if(!u)return No;u=u._reactInternals;e:{if(eo(u)!==u||u.tag!==1)throw Error(t(170));var d=u;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(tr(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(u.tag===1){var x=u.type;if(tr(x))return Tu(u,x,d)}return d}function $T(u,d,x,T,R,D,j,ie,he){return u=B_(x,T,!0,u,R,D,j,ie,he),u.context=XT(null),x=u.current,T=Qr(),R=bc(x),D=Dn(T,R),D.callback=d??null,$n(x,D,R),u.current.lanes=R,li(u,R,T),ys(u,T),u}function Pg(u,d,x,T){var R=d.current,D=Qr(),j=bc(R);return x=XT(x),d.context===null?d.context=x:d.pendingContext=x,d=Dn(D,j),d.payload={element:u},T=T===void 0?null:T,T!==null&&(d.callback=T),u=$n(R,d,j),u!==null&&(qo(u,R,j,D),nr(u,R,j)),j}function Dg(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function YT(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var x=u.retryLane;u.retryLane=x!==0&&x<d?x:d}}function F_(u,d){YT(u,d),(u=u.alternate)&&YT(u,d)}function GP(){return null}var JT=typeof reportError=="function"?reportError:function(u){console.error(u)};function k_(u){this._internalRoot=u}Og.prototype.render=k_.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(t(409));Pg(u,d,null,null)},Og.prototype.unmount=k_.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;zu(function(){Pg(null,u,null,null)}),d[Kr]=null}};function Og(u){this._internalRoot=u}Og.prototype.unstable_scheduleHydration=function(u){if(u){var d=ld();u={blockedOn:null,target:u,priority:d};for(var x=0;x<da.length&&d!==0&&d<da[x].priority;x++);da.splice(x,0,u),x===0&&hd(u)}};function N_(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function Bg(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function qT(){}function HP(u,d,x,T,R){if(R){if(typeof T=="function"){var D=T;T=function(){var be=Dg(j);D.call(be)}}var j=$T(d,T,u,0,null,!1,!1,"",qT);return u._reactRootContainer=j,u[Kr]=j.current,fc(u.nodeType===8?u.parentNode:u),zu(),j}for(;R=u.lastChild;)u.removeChild(R);if(typeof T=="function"){var ie=T;T=function(){var be=Dg(he);ie.call(be)}}var he=B_(u,0,!1,null,null,!1,!1,"",qT);return u._reactRootContainer=he,u[Kr]=he.current,fc(u.nodeType===8?u.parentNode:u),zu(function(){Pg(d,he,x,T)}),he}function Fg(u,d,x,T,R){var D=x._reactRootContainer;if(D){var j=D;if(typeof R=="function"){var ie=R;R=function(){var he=Dg(j);ie.call(he)}}Pg(d,j,u,R)}else j=HP(x,d,u,R,T);return Dg(j)}au=function(u){switch(u.tag){case 3:var d=u.stateNode;if(d.current.memoizedState.isDehydrated){var x=yi(d.pendingLanes);x!==0&&(no(d,x|1),ys(d,de()),!(bn&6)&&(rf=de()+500,ao()))}break;case 13:zu(function(){var T=Fs(u,1);if(T!==null){var R=Qr();qo(T,u,1,R)}}),F_(u,1)}},Ap=function(u){if(u.tag===13){var d=Fs(u,134217728);if(d!==null){var x=Qr();qo(d,u,134217728,x)}F_(u,134217728)}},K0=function(u){if(u.tag===13){var d=bc(u),x=Fs(u,d);if(x!==null){var T=Qr();qo(x,u,d,T)}F_(u,d)}},ld=function(){return cn},cd=function(u,d){var x=cn;try{return cn=u,d()}finally{cn=x}},Ye=function(u,d,x){switch(d){case"input":if(st(u,x),d=x.name,x.type==="radio"&&d!=null){for(x=u;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<x.length;d++){var T=x[d];if(T!==u&&T.form===u.form){var R=Gd(T);if(!R)throw Error(t(90));Ne(T),st(T,R)}}}break;case"textarea":De(u,x);break;case"select":d=x.value,d!=null&&q(u,!!x.multiple,d,!1)}},yn=R_,Nn=zu;var zP={usingClientEntryPoint:!1,Events:[ko,ci,Gd,lt,Ft,R_]},mm={findFiberByHostInstance:xa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jP={bundleType:mm.bundleType,version:mm.version,rendererPackageName:mm.rendererPackageName,rendererConfig:mm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=od(u),u===null?null:u.stateNode},findFiberByHostInstance:mm.findFiberByHostInstance||GP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kg.isDisabled&&kg.supportsFiber)try{wt=kg.inject(jP),xt=kg}catch{}}return vs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zP,vs.createPortal=function(u,d){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N_(d))throw Error(t(200));return UP(u,d,null,x)},vs.createRoot=function(u,d){if(!N_(u))throw Error(t(299));var x=!1,T="",R=JT;return d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(T=d.identifierPrefix),d.onRecoverableError!==void 0&&(R=d.onRecoverableError)),d=B_(u,1,!1,null,null,x,!1,T,R),u[Kr]=d.current,fc(u.nodeType===8?u.parentNode:u),new k_(d)},vs.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=od(d),u=u===null?null:u.stateNode,u},vs.flushSync=function(u){return zu(u)},vs.hydrate=function(u,d,x){if(!Bg(d))throw Error(t(200));return Fg(null,u,d,!0,x)},vs.hydrateRoot=function(u,d,x){if(!N_(u))throw Error(t(405));var T=x!=null&&x.hydratedSources||null,R=!1,D="",j=JT;if(x!=null&&(x.unstable_strictMode===!0&&(R=!0),x.identifierPrefix!==void 0&&(D=x.identifierPrefix),x.onRecoverableError!==void 0&&(j=x.onRecoverableError)),d=$T(d,null,u,1,x??null,R,!1,D,j),u[Kr]=d.current,fc(u),T)for(u=0;u<T.length;u++)x=T[u],R=x._getVersion,R=R(x._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[x,R]:d.mutableSourceEagerHydrationData.push(x,R);return new Og(d)},vs.render=function(u,d,x){if(!Bg(d))throw Error(t(200));return Fg(null,u,d,!1,x)},vs.unmountComponentAtNode=function(u){if(!Bg(u))throw Error(t(40));return u._reactRootContainer?(zu(function(){Fg(null,null,u,!1,function(){u._reactRootContainer=null,u[Kr]=null})}),!0):!1},vs.unstable_batchedUpdates=R_,vs.unstable_renderSubtreeIntoContainer=function(u,d,x,T){if(!Bg(x))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return Fg(u,d,x,!1,T)},vs.version="18.3.1-next-f1338f8080-20240426",vs}var ow;function qP(){if(ow)return H_.exports;ow=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),H_.exports=JP(),H_.exports}var aw;function QP(){if(aw)return Ng;aw=1;var s=qP();return Ng.createRoot=s.createRoot,Ng.hydrateRoot=s.hydrateRoot,Ng}var Zb=QP(),ym={},lw;function ZP(){if(lw)return ym;lw=1,Object.defineProperty(ym,"__esModule",{value:!0}),ym.parse=o,ym.serialize=c;const s=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,r=(()=>{const p=function(){};return p.prototype=Object.create(null),p})();function o(p,y){const v=new r,_=p.length;if(_<2)return v;const S=(y==null?void 0:y.decode)||h;let A=0;do{const w=p.indexOf("=",A);if(w===-1)break;const M=p.indexOf(";",A),C=M===-1?_:M;if(w>C){A=p.lastIndexOf(";",w-1)+1;continue}const I=a(p,A,w),O=l(p,w,I),k=p.slice(I,O);if(v[k]===void 0){let N=a(p,w+1,C),B=l(p,C,N);const P=S(p.slice(N,B));v[k]=P}A=C+1}while(A<_);return v}function a(p,y,v){do{const _=p.charCodeAt(y);if(_!==32&&_!==9)return y}while(++y<v);return v}function l(p,y,v){for(;y>v;){const _=p.charCodeAt(--y);if(_!==32&&_!==9)return y+1}return v}function c(p,y,v){const _=(v==null?void 0:v.encode)||encodeURIComponent;if(!s.test(p))throw new TypeError(`argument name is invalid: ${p}`);const S=_(y);if(!e.test(S))throw new TypeError(`argument val is invalid: ${y}`);let A=p+"="+S;if(!v)return A;if(v.maxAge!==void 0){if(!Number.isInteger(v.maxAge))throw new TypeError(`option maxAge is invalid: ${v.maxAge}`);A+="; Max-Age="+v.maxAge}if(v.domain){if(!t.test(v.domain))throw new TypeError(`option domain is invalid: ${v.domain}`);A+="; Domain="+v.domain}if(v.path){if(!n.test(v.path))throw new TypeError(`option path is invalid: ${v.path}`);A+="; Path="+v.path}if(v.expires){if(!f(v.expires)||!Number.isFinite(v.expires.valueOf()))throw new TypeError(`option expires is invalid: ${v.expires}`);A+="; Expires="+v.expires.toUTCString()}if(v.httpOnly&&(A+="; HttpOnly"),v.secure&&(A+="; Secure"),v.partitioned&&(A+="; Partitioned"),v.priority)switch(typeof v.priority=="string"?v.priority.toLowerCase():void 0){case"low":A+="; Priority=Low";break;case"medium":A+="; Priority=Medium";break;case"high":A+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${v.priority}`)}if(v.sameSite)switch(typeof v.sameSite=="string"?v.sameSite.toLowerCase():v.sameSite){case!0:case"strict":A+="; SameSite=Strict";break;case"lax":A+="; SameSite=Lax";break;case"none":A+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${v.sameSite}`)}return A}function h(p){if(p.indexOf("%")===-1)return p;try{return decodeURIComponent(p)}catch{return p}}function f(p){return i.call(p)==="[object Date]"}return ym}ZP();/**
 * react-router v7.1.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var cw="popstate";function eD(s={}){function e(n,i){let{pathname:r,search:o,hash:a}=n.location;return LS("",{pathname:r,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(n,i){return typeof i=="string"?i:n0(i)}return nD(e,t,null,s)}function mi(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Ua(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tD(){return Math.random().toString(36).substring(2,10)}function uw(s,e){return{usr:s.state,key:s.key,idx:e}}function LS(s,e,t=null,n){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?pp(e):e,state:t,key:e&&e.key||n||tD()}}function n0({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function pp(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let n=s.indexOf("?");n>=0&&(e.search=s.substring(n),s=s.substring(0,n)),s&&(e.pathname=s)}return e}function nD(s,e,t,n={}){let{window:i=document.defaultView,v5Compat:r=!1}=n,o=i.history,a="POP",l=null,c=h();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let S=h(),A=S==null?null:S-c;c=S,l&&l({action:a,location:_.location,delta:A})}function p(S,A){a="PUSH";let w=LS(_.location,S,A);c=h()+1;let M=uw(w,c),C=_.createHref(w);try{o.pushState(M,"",C)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;i.location.assign(C)}r&&l&&l({action:a,location:_.location,delta:1})}function y(S,A){a="REPLACE";let w=LS(_.location,S,A);c=h();let M=uw(w,c),C=_.createHref(w);o.replaceState(M,"",C),r&&l&&l({action:a,location:_.location,delta:0})}function v(S){let A=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof S=="string"?S:n0(S);return w=w.replace(/ $/,"%20"),mi(A,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,A)}let _={get action(){return a},get location(){return s(i,o)},listen(S){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(cw,f),l=S,()=>{i.removeEventListener(cw,f),l=null}},createHref(S){return e(i,S)},createURL:v,encodeLocation(S){let A=v(S);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:p,replace:y,go(S){return o.go(S)}};return _}function eC(s,e,t="/"){return iD(s,e,t,!1)}function iD(s,e,t,n){let i=typeof e=="string"?pp(e):e,r=Jc(i.pathname||"/",t);if(r==null)return null;let o=tC(s);rD(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=mD(r);a=fD(o[l],c,n)}return a}function tC(s,e=[],t=[],n=""){let i=(r,o,a)=>{let l={relativePath:a===void 0?r.path||"":a,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};l.relativePath.startsWith("/")&&(mi(l.relativePath.startsWith(n),`Absolute route path "${l.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(n.length));let c=zl([n,l.relativePath]),h=t.concat(l);r.children&&r.children.length>0&&(mi(r.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),tC(r.children,e,h,c)),!(r.path==null&&!r.index)&&e.push({path:c,score:hD(c,r.index),routesMeta:h})};return s.forEach((r,o)=>{var a;if(r.path===""||!((a=r.path)!=null&&a.includes("?")))i(r,o);else for(let l of nC(r.path))i(r,o,l)}),e}function nC(s){let e=s.split("/");if(e.length===0)return[];let[t,...n]=e,i=t.endsWith("?"),r=t.replace(/\?$/,"");if(n.length===0)return i?[r,""]:[r];let o=nC(n.join("/")),a=[];return a.push(...o.map(l=>l===""?r:[r,l].join("/"))),i&&a.push(...o),a.map(l=>s.startsWith("/")&&l===""?"/":l)}function rD(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:dD(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var sD=/^:[\w-]+$/,oD=3,aD=2,lD=1,cD=10,uD=-2,hw=s=>s==="*";function hD(s,e){let t=s.split("/"),n=t.length;return t.some(hw)&&(n+=uD),e&&(n+=aD),t.filter(i=>!hw(i)).reduce((i,r)=>i+(sD.test(r)?oD:r===""?lD:cD),n)}function dD(s,e){return s.length===e.length&&s.slice(0,-1).every((n,i)=>n===e[i])?s[s.length-1]-e[e.length-1]:0}function fD(s,e,t=!1){let{routesMeta:n}=s,i={},r="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,h=r==="/"?e:e.slice(r.length)||"/",f=fv({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),p=l.route;if(!f&&c&&t&&!n[n.length-1].route.index&&(f=fv({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:zl([r,f.pathname]),pathnameBase:xD(zl([r,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(r=zl([r,f.pathnameBase]))}return o}function fv(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,n]=pD(s.path,s.caseSensitive,s.end),i=e.match(t);if(!i)return null;let r=i[0],o=r.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((c,{paramName:h,isOptional:f},p)=>{if(h==="*"){let v=a[p]||"";o=r.slice(0,r.length-v.length).replace(/(.)\/+$/,"$1")}const y=a[p];return f&&!y?c[h]=void 0:c[h]=(y||"").replace(/%2F/g,"/"),c},{}),pathname:r,pathnameBase:o,pattern:s}}function pD(s,e=!1,t=!0){Ua(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let n=[],i="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(n.push({paramName:"*"}),i+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":s!==""&&s!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function mD(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ua(!1,`The URL path "${s}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function Jc(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=s.charAt(t);return n&&n!=="/"?null:s.slice(t)||"/"}function gD(s,e="/"){let{pathname:t,search:n="",hash:i=""}=typeof s=="string"?pp(s):s;return{pathname:t?t.startsWith("/")?t:yD(t,e):e,search:_D(n),hash:SD(i)}}function yD(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function V_(s,e,t,n){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function vD(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function iC(s){let e=vD(s);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function rC(s,e,t,n=!1){let i;typeof s=="string"?i=pp(s):(i={...s},mi(!i.pathname||!i.pathname.includes("?"),V_("?","pathname","search",i)),mi(!i.pathname||!i.pathname.includes("#"),V_("#","pathname","hash",i)),mi(!i.search||!i.search.includes("#"),V_("#","search","hash",i)));let r=s===""||i.pathname==="",o=r?"/":i.pathname,a;if(o==null)a=t;else{let f=e.length-1;if(!n&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;i.pathname=p.join("/")}a=f>=0?e[f]:"/"}let l=gD(i,a),c=o&&o!=="/"&&o.endsWith("/"),h=(r||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}var zl=s=>s.join("/").replace(/\/\/+/g,"/"),xD=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),_D=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,SD=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function AD(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var sC=["POST","PUT","PATCH","DELETE"];new Set(sC);var ED=["GET",...sC];new Set(ED);var mp=te.createContext(null);mp.displayName="DataRouter";var Sx=te.createContext(null);Sx.displayName="DataRouterState";var oC=te.createContext({isTransitioning:!1});oC.displayName="ViewTransition";var TD=te.createContext(new Map);TD.displayName="Fetchers";var wD=te.createContext(null);wD.displayName="Await";var ja=te.createContext(null);ja.displayName="Navigation";var w0=te.createContext(null);w0.displayName="Location";var ql=te.createContext({outlet:null,matches:[],isDataRoute:!1});ql.displayName="Route";var DA=te.createContext(null);DA.displayName="RouteError";function MD(s,{relative:e}={}){mi(M0(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=te.useContext(ja),{hash:i,pathname:r,search:o}=b0(s,{relative:e}),a=r;return t!=="/"&&(a=r==="/"?t:zl([t,r])),n.createHref({pathname:a,search:o,hash:i})}function M0(){return te.useContext(w0)!=null}function $h(){return mi(M0(),"useLocation() may be used only in the context of a <Router> component."),te.useContext(w0).location}var aC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function lC(s){te.useContext(ja).static||te.useLayoutEffect(s)}function bD(){let{isDataRoute:s}=te.useContext(ql);return s?GD():CD()}function CD(){mi(M0(),"useNavigate() may be used only in the context of a <Router> component.");let s=te.useContext(mp),{basename:e,navigator:t}=te.useContext(ja),{matches:n}=te.useContext(ql),{pathname:i}=$h(),r=JSON.stringify(iC(n)),o=te.useRef(!1);return lC(()=>{o.current=!0}),te.useCallback((l,c={})=>{if(Ua(o.current,aC),!o.current)return;if(typeof l=="number"){t.go(l);return}let h=rC(l,JSON.parse(r),i,c.relative==="path");s==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:zl([e,h.pathname])),(c.replace?t.replace:t.push)(h,c.state,c)},[e,t,r,i,s])}te.createContext(null);function b0(s,{relative:e}={}){let{matches:t}=te.useContext(ql),{pathname:n}=$h(),i=JSON.stringify(iC(t));return te.useMemo(()=>rC(s,JSON.parse(i),n,e==="path"),[s,i,n,e])}function RD(s,e){return cC(s,e)}function cC(s,e,t,n){var A;mi(M0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=te.useContext(ja),{matches:r}=te.useContext(ql),o=r[r.length-1],a=o?o.params:{},l=o?o.pathname:"/",c=o?o.pathnameBase:"/",h=o&&o.route;{let w=h&&h.path||"";uC(l,!h||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let f=$h(),p;if(e){let w=typeof e=="string"?pp(e):e;mi(c==="/"||((A=w.pathname)==null?void 0:A.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${w.pathname}" was given in the \`location\` prop.`),p=w}else p=f;let y=p.pathname||"/",v=y;if(c!=="/"){let w=c.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(w.length).join("/")}let _=eC(s,{pathname:v});Ua(h||_!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Ua(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=OD(_&&_.map(w=>Object.assign({},w,{params:Object.assign({},a,w.params),pathname:zl([c,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:zl([c,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),r,t,n);return e&&S?te.createElement(w0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},S):S}function ID(){let s=UD(),e=AD(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},r={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",s),o=te.createElement(te.Fragment,null,te.createElement("p",null,"💿 Hey developer 👋"),te.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",te.createElement("code",{style:r},"ErrorBoundary")," or"," ",te.createElement("code",{style:r},"errorElement")," prop on your route.")),te.createElement(te.Fragment,null,te.createElement("h2",null,"Unexpected Application Error!"),te.createElement("h3",{style:{fontStyle:"italic"}},e),t?te.createElement("pre",{style:i},t):null,o)}var LD=te.createElement(ID,null),PD=class extends te.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){console.error("React Router caught the following error during render",s,e)}render(){return this.state.error!==void 0?te.createElement(ql.Provider,{value:this.props.routeContext},te.createElement(DA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function DD({routeContext:s,match:e,children:t}){let n=te.useContext(mp);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),te.createElement(ql.Provider,{value:s},t)}function OD(s,e=[],t=null,n=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let i=s,r=t==null?void 0:t.errors;if(r!=null){let l=i.findIndex(c=>c.route.id&&(r==null?void 0:r[c.route.id])!==void 0);mi(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let o=!1,a=-1;if(t)for(let l=0;l<i.length;l++){let c=i[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:h,errors:f}=t,p=c.route.loader&&!h.hasOwnProperty(c.route.id)&&(!f||f[c.route.id]===void 0);if(c.route.lazy||p){o=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((l,c,h)=>{let f,p=!1,y=null,v=null;t&&(f=r&&c.route.id?r[c.route.id]:void 0,y=c.route.errorElement||LD,o&&(a<0&&h===0?(uC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,v=null):a===h&&(p=!0,v=c.route.hydrateFallbackElement||null)));let _=e.concat(i.slice(0,h+1)),S=()=>{let A;return f?A=y:p?A=v:c.route.Component?A=te.createElement(c.route.Component,null):c.route.element?A=c.route.element:A=l,te.createElement(DD,{match:c,routeContext:{outlet:l,matches:_,isDataRoute:t!=null},children:A})};return t&&(c.route.ErrorBoundary||c.route.errorElement||h===0)?te.createElement(PD,{location:t.location,revalidation:t.revalidation,component:y,error:f,children:S(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):S()},null)}function OA(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function BD(s){let e=te.useContext(mp);return mi(e,OA(s)),e}function FD(s){let e=te.useContext(Sx);return mi(e,OA(s)),e}function kD(s){let e=te.useContext(ql);return mi(e,OA(s)),e}function BA(s){let e=kD(s),t=e.matches[e.matches.length-1];return mi(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function ND(){return BA("useRouteId")}function UD(){var n;let s=te.useContext(DA),e=FD("useRouteError"),t=BA("useRouteError");return s!==void 0?s:(n=e.errors)==null?void 0:n[t]}function GD(){let{router:s}=BD("useNavigate"),e=BA("useNavigate"),t=te.useRef(!1);return lC(()=>{t.current=!0}),te.useCallback(async(i,r={})=>{Ua(t.current,aC),t.current&&(typeof i=="number"?s.navigate(i):await s.navigate(i,{fromRouteId:e,...r}))},[s,e])}var dw={};function uC(s,e,t){!e&&!dw[s]&&(dw[s]=!0,Ua(!1,t))}te.memo(HD);function HD({routes:s,future:e,state:t}){return cC(s,void 0,t,e)}function PS(s){mi(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function zD({basename:s="/",children:e=null,location:t,navigationType:n="POP",navigator:i,static:r=!1}){mi(!M0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=s.replace(/^\/*/,"/"),a=te.useMemo(()=>({basename:o,navigator:i,static:r,future:{}}),[o,i,r]);typeof t=="string"&&(t=pp(t));let{pathname:l="/",search:c="",hash:h="",state:f=null,key:p="default"}=t,y=te.useMemo(()=>{let v=Jc(l,o);return v==null?null:{location:{pathname:v,search:c,hash:h,state:f,key:p},navigationType:n}},[o,l,c,h,f,p,n]);return Ua(y!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:te.createElement(ja.Provider,{value:a},te.createElement(w0.Provider,{children:e,value:y}))}function jD({children:s,location:e}){return RD(DS(s),e)}function DS(s,e=[]){let t=[];return te.Children.forEach(s,(n,i)=>{if(!te.isValidElement(n))return;let r=[...e,i];if(n.type===te.Fragment){t.push.apply(t,DS(n.props.children,r));return}mi(n.type===PS,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),mi(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||r.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=DS(n.props.children,r)),t.push(o)}),t}var qy="get",Qy="application/x-www-form-urlencoded";function Ax(s){return s!=null&&typeof s.tagName=="string"}function VD(s){return Ax(s)&&s.tagName.toLowerCase()==="button"}function WD(s){return Ax(s)&&s.tagName.toLowerCase()==="form"}function KD(s){return Ax(s)&&s.tagName.toLowerCase()==="input"}function XD(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function $D(s,e){return s.button===0&&(!e||e==="_self")&&!XD(s)}var Ug=null;function YD(){if(Ug===null)try{new FormData(document.createElement("form"),0),Ug=!1}catch{Ug=!0}return Ug}var JD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function W_(s){return s!=null&&!JD.has(s)?(Ua(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Qy}"`),null):s}function qD(s,e){let t,n,i,r,o;if(WD(s)){let a=s.getAttribute("action");n=a?Jc(a,e):null,t=s.getAttribute("method")||qy,i=W_(s.getAttribute("enctype"))||Qy,r=new FormData(s)}else if(VD(s)||KD(s)&&(s.type==="submit"||s.type==="image")){let a=s.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=s.getAttribute("formaction")||a.getAttribute("action");if(n=l?Jc(l,e):null,t=s.getAttribute("formmethod")||a.getAttribute("method")||qy,i=W_(s.getAttribute("formenctype"))||W_(a.getAttribute("enctype"))||Qy,r=new FormData(a,s),!YD()){let{name:c,type:h,value:f}=s;if(h==="image"){let p=c?`${c}.`:"";r.append(`${p}x`,"0"),r.append(`${p}y`,"0")}else c&&r.append(c,f)}}else{if(Ax(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=qy,n=null,i=Qy,o=s}return r&&i==="text/plain"&&(o=r,r=void 0),{action:n,method:t.toLowerCase(),encType:i,formData:r,body:o}}function FA(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}async function QD(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ZD(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function eO(s,e,t){let n=await Promise.all(s.map(async i=>{let r=e.routes[i.route.id];if(r){let o=await QD(r,t);return o.links?o.links():[]}return[]}));return rO(n.flat(1).filter(ZD).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function fw(s,e,t,n,i,r){let o=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,a=(l,c)=>{var h;return t[c].pathname!==l.pathname||((h=t[c].route.path)==null?void 0:h.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return r==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):r==="data"?e.filter((l,c)=>{var f;let h=n.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let p=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((f=t[0])==null?void 0:f.params)||{},nextUrl:new URL(s,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function tO(s,e){return nO(s.map(t=>{let n=e.routes[t.route.id];if(!n)return[];let i=[n.module];return n.imports&&(i=i.concat(n.imports)),i}).flat(1))}function nO(s){return[...new Set(s)]}function iO(s){let e={},t=Object.keys(s).sort();for(let n of t)e[n]=s[n];return e}function rO(s,e){let t=new Set;return new Set(e),s.reduce((n,i)=>{let r=JSON.stringify(iO(i));return t.has(r)||(t.add(r),n.push({key:r,link:i})),n},[])}function sO(s){let e=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function oO(){let s=te.useContext(mp);return FA(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function aO(){let s=te.useContext(Sx);return FA(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var kA=te.createContext(void 0);kA.displayName="FrameworkContext";function hC(){let s=te.useContext(kA);return FA(s,"You must render this element inside a <HydratedRouter> element"),s}function lO(s,e){let t=te.useContext(kA),[n,i]=te.useState(!1),[r,o]=te.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:h,onTouchStart:f}=e,p=te.useRef(null);te.useEffect(()=>{if(s==="render"&&o(!0),s==="viewport"){let _=A=>{A.forEach(w=>{o(w.isIntersecting)})},S=new IntersectionObserver(_,{threshold:.5});return p.current&&S.observe(p.current),()=>{S.disconnect()}}},[s]),te.useEffect(()=>{if(n){let _=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(_)}}},[n]);let y=()=>{i(!0)},v=()=>{i(!1),o(!1)};return t?s!=="intent"?[r,p,{}]:[r,p,{onFocus:vm(a,y),onBlur:vm(l,v),onMouseEnter:vm(c,y),onMouseLeave:vm(h,v),onTouchStart:vm(f,y)}]:[!1,p,{}]}function vm(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function cO({page:s,...e}){let{router:t}=oO(),n=te.useMemo(()=>eC(t.routes,s,t.basename),[t.routes,s,t.basename]);return n?te.createElement(hO,{page:s,matches:n,...e}):null}function uO(s){let{manifest:e,routeModules:t}=hC(),[n,i]=te.useState([]);return te.useEffect(()=>{let r=!1;return eO(s,e,t).then(o=>{r||i(o)}),()=>{r=!0}},[s,e,t]),n}function hO({page:s,matches:e,...t}){let n=$h(),{manifest:i,routeModules:r}=hC(),{loaderData:o,matches:a}=aO(),l=te.useMemo(()=>fw(s,e,a,i,n,"data"),[s,e,a,i,n]),c=te.useMemo(()=>fw(s,e,a,i,n,"assets"),[s,e,a,i,n]),h=te.useMemo(()=>{if(s===n.pathname+n.search+n.hash)return[];let y=new Set,v=!1;if(e.forEach(S=>{var w;let A=i.routes[S.route.id];!A||!A.hasLoader||(!l.some(M=>M.route.id===S.route.id)&&S.route.id in o&&((w=r[S.route.id])!=null&&w.shouldRevalidate)||A.hasClientLoader?v=!0:y.add(S.route.id))}),y.size===0)return[];let _=sO(s);return v&&y.size>0&&_.searchParams.set("_routes",e.filter(S=>y.has(S.route.id)).map(S=>S.route.id).join(",")),[_.pathname+_.search]},[o,n,i,l,e,s,r]),f=te.useMemo(()=>tO(c,i),[c,i]),p=uO(c);return te.createElement(te.Fragment,null,h.map(y=>te.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),f.map(y=>te.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),p.map(({key:y,link:v})=>te.createElement("link",{key:y,...v})))}function dO(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var dC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{dC&&(window.__reactRouterVersion="7.1.0")}catch{}function fO({basename:s,children:e,window:t}){let n=te.useRef();n.current==null&&(n.current=eD({window:t,v5Compat:!0}));let i=n.current,[r,o]=te.useState({action:i.action,location:i.location}),a=te.useCallback(l=>{te.startTransition(()=>o(l))},[o]);return te.useLayoutEffect(()=>i.listen(a),[i,a]),te.createElement(zD,{basename:s,children:e,location:r.location,navigationType:r.action,navigator:i})}var fC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,NA=te.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:i,reloadDocument:r,replace:o,state:a,target:l,to:c,preventScrollReset:h,viewTransition:f,...p},y){let{basename:v}=te.useContext(ja),_=typeof c=="string"&&fC.test(c),S,A=!1;if(typeof c=="string"&&_&&(S=c,dC))try{let B=new URL(window.location.href),P=c.startsWith("//")?new URL(B.protocol+c):new URL(c),G=Jc(P.pathname,v);P.origin===B.origin&&G!=null?c=G+P.search+P.hash:A=!0}catch{Ua(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=MD(c,{relative:i}),[M,C,I]=lO(n,p),O=yO(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:i,viewTransition:f});function k(B){e&&e(B),B.defaultPrevented||O(B)}let N=te.createElement("a",{...p,...I,href:S||w,onClick:A||r?e:k,ref:dO(y,C),target:l,"data-discover":!_&&t==="render"?"true":void 0});return M&&!_?te.createElement(te.Fragment,null,N,te.createElement(cO,{page:w})):N});NA.displayName="Link";var pO=te.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:i=!1,style:r,to:o,viewTransition:a,children:l,...c},h){let f=b0(o,{relative:c.relative}),p=$h(),y=te.useContext(Sx),{navigator:v,basename:_}=te.useContext(ja),S=y!=null&&AO(f)&&a===!0,A=v.encodeLocation?v.encodeLocation(f).pathname:f.pathname,w=p.pathname,M=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;t||(w=w.toLowerCase(),M=M?M.toLowerCase():null,A=A.toLowerCase()),M&&_&&(M=Jc(M,_)||M);const C=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let I=w===A||!i&&w.startsWith(A)&&w.charAt(C)==="/",O=M!=null&&(M===A||!i&&M.startsWith(A)&&M.charAt(A.length)==="/"),k={isActive:I,isPending:O,isTransitioning:S},N=I?e:void 0,B;typeof n=="function"?B=n(k):B=[n,I?"active":null,O?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let P=typeof r=="function"?r(k):r;return te.createElement(NA,{...c,"aria-current":N,className:B,ref:h,style:P,to:o,viewTransition:a},typeof l=="function"?l(k):l)});pO.displayName="NavLink";var mO=te.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:i,state:r,method:o=qy,action:a,onSubmit:l,relative:c,preventScrollReset:h,viewTransition:f,...p},y)=>{let v=_O(),_=SO(a,{relative:c}),S=o.toLowerCase()==="get"?"get":"post",A=typeof a=="string"&&fC.test(a),w=M=>{if(l&&l(M),M.defaultPrevented)return;M.preventDefault();let C=M.nativeEvent.submitter,I=(C==null?void 0:C.getAttribute("formmethod"))||o;v(C||M.currentTarget,{fetcherKey:e,method:I,navigate:t,replace:i,state:r,relative:c,preventScrollReset:h,viewTransition:f})};return te.createElement("form",{ref:y,method:S,action:_,onSubmit:n?l:w,...p,"data-discover":!A&&s==="render"?"true":void 0})});mO.displayName="Form";function gO(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pC(s){let e=te.useContext(mp);return mi(e,gO(s)),e}function yO(s,{target:e,replace:t,state:n,preventScrollReset:i,relative:r,viewTransition:o}={}){let a=bD(),l=$h(),c=b0(s,{relative:r});return te.useCallback(h=>{if($D(h,e)){h.preventDefault();let f=t!==void 0?t:n0(l)===n0(c);a(s,{replace:f,state:n,preventScrollReset:i,relative:r,viewTransition:o})}},[l,a,c,t,n,e,s,i,r,o])}var vO=0,xO=()=>`__${String(++vO)}__`;function _O(){let{router:s}=pC("useSubmit"),{basename:e}=te.useContext(ja),t=ND();return te.useCallback(async(n,i={})=>{let{action:r,method:o,encType:a,formData:l,body:c}=qD(n,e);if(i.navigate===!1){let h=i.fetcherKey||xO();await s.fetch(h,t,i.action||r,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await s.navigate(i.action||r,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[s,e,t])}function SO(s,{relative:e}={}){let{basename:t}=te.useContext(ja),n=te.useContext(ql);mi(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),r={...b0(s||".",{relative:e})},o=$h();if(s==null){r.search=o.search;let a=new URLSearchParams(r.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();r.search=h?`?${h}`:""}}return(!s||s===".")&&i.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(r.pathname=r.pathname==="/"?t:zl([t,r.pathname])),n0(r)}function AO(s,e={}){let t=te.useContext(oC);mi(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=pC("useViewTransitionState"),i=b0(s,{relative:e.relative});if(!t.isTransitioning)return!1;let r=Jc(t.currentLocation.pathname,n)||t.currentLocation.pathname,o=Jc(t.nextLocation.pathname,n)||t.nextLocation.pathname;return fv(i.pathname,o)!=null||fv(i.pathname,r)!=null}new TextEncoder;const EO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0,0,256,256'%20width='25px'%20height='25px'%20fill-rule='nonzero'%3e%3cg%20fill='%23eef8cf'%20fill-rule='nonzero'%20stroke='none'%20stroke-width='1'%20stroke-linecap='butt'%20stroke-linejoin='miter'%20stroke-miterlimit='10'%20stroke-dasharray=''%20stroke-dashoffset='0'%20font-family='none'%20font-weight='none'%20font-size='none'%20text-anchor='none'%20style='mix-blend-mode:%20normal'%3e%3cg%20transform='scale(5.12,5.12)'%3e%3cpath%20d='M0,9v2h50v-2zM0,24v2h50v-2zM0,39v2h50v-2z'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/svg%3e",TO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2050%2050'%20width='25px'%20height='25px'%3e%3cpath%20d='M%207.71875%206.28125%20L%206.28125%207.71875%20L%2023.5625%2025%20L%206.28125%2042.28125%20L%207.71875%2043.71875%20L%2025%2026.4375%20L%2042.28125%2043.71875%20L%2043.71875%2042.28125%20L%2026.4375%2025%20L%2043.71875%207.71875%20L%2042.28125%206.28125%20L%2025%2023.5625%20Z'/%3e%3c/svg%3e";function mC(){const[s,e]=te.useState(!1),t=()=>{e(!s)};return F.jsx(F.Fragment,{children:F.jsxs("header",{className:"flex justify-between desktop:px-40 tablet:px-10 phone:px-3 py-4 fixed w-full backdrop-blur-lg z-40",children:[F.jsx("a",{href:"/",children:"DarrenF"}),F.jsxs("nav",{children:[F.jsxs("ul",{className:"flex gap-12",children:[F.jsx("li",{className:"phone:max-tablet:hidden",children:F.jsx("a",{href:"/#hero",children:"Home"})}),F.jsx("li",{className:"phone:max-tablet:hidden",children:F.jsx("a",{href:"/#about",children:"About"})}),F.jsx("li",{className:"phone:max-tablet:hidden",children:F.jsx("a",{href:"/#projects",children:"Projects"})}),F.jsx("li",{className:"phone:max-tablet:hidden",children:F.jsx("a",{href:"/#contact",children:"Contact"})}),F.jsx("li",{className:"tablet:hidden",children:F.jsx("button",{onClick:t,className:"p-0",children:F.jsx("img",{src:EO,alt:"Hamburger menu"})})})]}),F.jsx("div",{className:`w-[70vw] h-screen absolute right-0 top-0 bottom-0 bg-secondary-color text-black ${s?"block":"hidden"} z-30 phone:px-3 py-4 tablet:hidden`,children:F.jsxs("ul",{className:"flex flex-col items-center justify-center gap-20 h-full text-3xl relative",children:[F.jsx("li",{className:"absolute top-0 right-0",children:F.jsx("button",{onClick:t,className:"p-0",children:F.jsx("img",{src:TO,alt:"Close icon"})})}),F.jsx("li",{children:F.jsx("a",{href:"/#hero",onClick:t,children:"Home"})}),F.jsx("li",{children:F.jsx("a",{href:"/#about",onClick:t,children:"About"})}),F.jsx("li",{children:F.jsx("a",{href:"/#projects",onClick:t,children:"Projects"})}),F.jsx("li",{children:F.jsx("a",{href:"/#contact",onClick:t,children:"Contact"})})]})})]})]})})}const wO=()=>F.jsxs(F.Fragment,{children:[F.jsx(mC,{}),F.jsxs("section",{className:"h-screen px-[25vw] py-40 flex flex-col",children:[F.jsx("h1",{className:"self-center",children:"Credits"}),F.jsx("h2",{className:"self-center mb-10",children:"Here are the resources used in this project:"}),F.jsxs("div",{className:"flex flex-col gap-10",children:[F.jsx("div",{className:"credit-item",children:F.jsxs("p",{children:[F.jsx("strong",{children:"3D Model: PC setup"}),F.jsx("br",{}),"Model created by"," ",F.jsx("a",{href:"https://sketchfab.com/Yolala3d",target:"_blank",className:"underline",children:"Yolala3d"}),F.jsx("br",{}),"This 3D model represents a gaming setup on the websites landing page."]})}),F.jsx("div",{className:"credit-item",children:F.jsxs("p",{children:[F.jsx("strong",{children:"3D Model: Dell Laptop"}),F.jsx("br",{}),"Model created by"," ",F.jsx("a",{href:"https://sketchfab.com/Xinyiii",target:"_blank",className:"underline",children:"Xinyiii"}),F.jsx("br",{}),"This 3D model represents a Dell laptop on the websites my work section."]})}),F.jsx("div",{className:"credit-item",children:F.jsxs("p",{children:[F.jsx("strong",{children:"Texture: Under Construction"}),F.jsx("br",{}),"Texture created by"," ",F.jsx("a",{href:"https://www.vecteezy.com/members/nahumam",target:"_blank",className:"underline",children:"Humam Naufal"}),F.jsx("br",{}),"This texture was used on the dell laptop screen"]})})]})]})]}),MO="/drren-portfolio/assets/tech-hand-touch-BvzX0Pb5.png",bO="/drren-portfolio/assets/me-aBamPD6i.jpeg";var Gg={},pw;function CO(){if(pw)return Gg;pw=1;function s(r){if(typeof window>"u")return;const o=document.createElement("style");return o.setAttribute("type","text/css"),o.innerHTML=r,document.head.appendChild(o),r}Object.defineProperty(Gg,"__esModule",{value:!0});var e=T0();function t(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var n=t(e);s(`.rfm-marquee-container {
  overflow-x: hidden;
  display: flex;
  flex-direction: row;
  position: relative;
  width: var(--width);
  transform: var(--transform);
}
.rfm-marquee-container:hover div {
  animation-play-state: var(--pause-on-hover);
}
.rfm-marquee-container:active div {
  animation-play-state: var(--pause-on-click);
}

.rfm-overlay {
  position: absolute;
  width: 100%;
  height: 100%;
}
.rfm-overlay::before, .rfm-overlay::after {
  background: linear-gradient(to right, var(--gradient-color), rgba(255, 255, 255, 0));
  content: "";
  height: 100%;
  position: absolute;
  width: var(--gradient-width);
  z-index: 2;
  pointer-events: none;
  touch-action: none;
}
.rfm-overlay::after {
  right: 0;
  top: 0;
  transform: rotateZ(180deg);
}
.rfm-overlay::before {
  left: 0;
  top: 0;
}

.rfm-marquee {
  flex: 0 0 auto;
  min-width: var(--min-width);
  z-index: 1;
  display: flex;
  flex-direction: row;
  align-items: center;
  animation: scroll var(--duration) linear var(--delay) var(--iteration-count);
  animation-play-state: var(--play);
  animation-delay: var(--delay);
  animation-direction: var(--direction);
}
@keyframes scroll {
  0% {
    transform: translateX(0%);
  }
  100% {
    transform: translateX(-100%);
  }
}

.rfm-initial-child-container {
  flex: 0 0 auto;
  display: flex;
  min-width: auto;
  flex-direction: row;
  align-items: center;
}

.rfm-child {
  transform: var(--transform);
}`);const i=e.forwardRef(function({style:o={},className:a="",autoFill:l=!1,play:c=!0,pauseOnHover:h=!1,pauseOnClick:f=!1,direction:p="left",speed:y=50,delay:v=0,loop:_=0,gradient:S=!1,gradientColor:A="white",gradientWidth:w=200,onFinish:M,onCycleComplete:C,onMount:I,children:O},k){const[N,B]=e.useState(0),[P,G]=e.useState(0),[Z,Y]=e.useState(1),[se,oe]=e.useState(!1),re=e.useRef(null),ce=k||re,H=e.useRef(null),$=e.useCallback(()=>{if(H.current&&ce.current){const we=ce.current.getBoundingClientRect(),Ie=H.current.getBoundingClientRect();let ze=we.width,Ze=Ie.width;(p==="up"||p==="down")&&(ze=we.height,Ze=Ie.height),Y(l&&ze&&Ze&&Ze<ze?Math.ceil(ze/Ze):1),B(ze),G(Ze)}},[l,ce,p]);e.useEffect(()=>{if(se&&($(),H.current&&ce.current)){const we=new ResizeObserver(()=>$());return we.observe(ce.current),we.observe(H.current),()=>{we&&we.disconnect()}}},[$,ce,se]),e.useEffect(()=>{$()},[$,O]),e.useEffect(()=>{oe(!0)},[]),e.useEffect(()=>{typeof I=="function"&&I()},[]);const X=e.useMemo(()=>l?P*Z/y:P<N?N/y:P/y,[l,N,P,Z,y]),W=e.useMemo(()=>Object.assign(Object.assign({},o),{"--pause-on-hover":!c||h?"paused":"running","--pause-on-click":!c||h&&!f||f?"paused":"running","--width":p==="up"||p==="down"?"100vh":"100%","--transform":p==="up"?"rotate(-90deg)":p==="down"?"rotate(90deg)":"none"}),[o,c,h,f,p]),ne=e.useMemo(()=>({"--gradient-color":A,"--gradient-width":typeof w=="number"?`${w}px`:w}),[A,w]),Ee=e.useMemo(()=>({"--play":c?"running":"paused","--direction":p==="left"?"normal":"reverse","--duration":`${X}s`,"--delay":`${v}s`,"--iteration-count":_?`${_}`:"infinite","--min-width":l?"auto":"100%"}),[c,p,X,v,_,l]),le=e.useMemo(()=>({"--transform":p==="up"?"rotate(90deg)":p==="down"?"rotate(-90deg)":"none"}),[p]),ye=e.useCallback(we=>[...Array(Number.isFinite(we)&&we>=0?we:0)].map((Ie,ze)=>n.default.createElement(e.Fragment,{key:ze},e.Children.map(O,Ze=>n.default.createElement("div",{style:le,className:"rfm-child"},Ze)))),[le,O]);return se?n.default.createElement("div",{ref:ce,style:W,className:"rfm-marquee-container "+a},S&&n.default.createElement("div",{style:ne,className:"rfm-overlay"}),n.default.createElement("div",{className:"rfm-marquee",style:Ee,onAnimationIteration:C,onAnimationEnd:M},n.default.createElement("div",{className:"rfm-initial-child-container",ref:H},e.Children.map(O,we=>n.default.createElement("div",{style:le,className:"rfm-child"},we))),ye(Z-1)),n.default.createElement("div",{className:"rfm-marquee",style:Ee},ye(Z))):null});return Gg.default=i,Gg}var RO=CO();const IO=_x(RO),gC="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='96px'%20height='96px'%3e%3clinearGradient%20id='TQDriqswrKwPOniLrPT12a'%20x1='16.33'%20x2='32.293'%20y1='-2.748'%20y2='41.109'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%232aa4f4'/%3e%3cstop%20offset='1'%20stop-color='%23007ad9'/%3e%3c/linearGradient%3e%3cpath%20fill='url(%23TQDriqswrKwPOniLrPT12a)'%20d='M7.192,7.176l2.627,29.77c0.109,1.237,0.97,2.28,2.164,2.621l10.643,3.041%20c0.898,0.257,1.849,0.257,2.747,0l10.643-3.041c1.194-0.341,2.055-1.383,2.164-2.621l2.627-29.77C40.911,6.006,39.99,5,38.816,5%20H9.184C8.01,5,7.089,6.006,7.192,7.176z'/%3e%3cpath%20fill='%2335c1f1'%20d='M24,8v31.9l9.876-2.822c0.797-0.228,1.371-0.924,1.443-1.749l2.286-26.242%20C37.656,8.502,37.196,8,36.609,8H24z'/%3e%3cpath%20fill='%23fff'%20d='M33.1,13H24v4h4.9l-0.3,4H24v4h4.4l-0.3,4.5L24,30.9v4.2l7.9-2.6L32.6,21l0,0L33.1,13z'/%3e%3cpath%20fill='%23d6e0e9'%20d='M24,13v4h-8.9l-0.3-4H24z%20M19.4,21l0.2,4H24v-4H19.4z%20M19.8,27h-4l0.3,5.5l7.9,2.6v-4.2l-4.1-1.4%20L19.8,27z'/%3e%3cpath%20d='M33.1,13l-0.5,8l-0.7,11.5L24,35.1l-7.9-2.6L15.8,27h4l0.1,2.5l4.1,1.4l4.1-1.4l0.3-4.5H24h-4.4l-0.2-4H24h4.6l0.3-4H24%20h-8.9l-0.3-4H24H33.1%20M34.164,12H33.1H24h-9.2h-1.078l0.081,1.075l0.3,4L14.172,18H15.1H24h3.822l-0.15,2H24h-4.6h-1.051%20l0.052,1.05l0.2,4L18.649,26H15.8h-1.056l0.058,1.054l0.3,5.5l0.037,0.682l0.649,0.214l7.9,2.6L24,36.153l0.313-0.103l7.9-2.6%20l0.644-0.212l0.041-0.677l0.7-11.5l0.5-7.998L34.164,12L34.164,12z%20M20.761,26H24h3.331l-0.185,2.769L24,29.843l-3.128-1.068%20l-0.073-1.815L20.761,26L20.761,26z'%20opacity='.05'/%3e%3cpath%20d='M33.1,13l-0.5,8l-0.7,11.5L24,35.1l-7.9-2.6L15.8,27h4l0.1,2.5l4.1,1.4l4.1-1.4l0.3-4.5H24h-4.4l-0.2-4H24h4.6l0.3-4H24%20h-8.9l-0.3-4H24H33.1%20M33.632,12.5H33.1H24h-9.2h-0.539l0.04,0.537l0.3,4l0.035,0.463H15.1H24h4.361l-0.225,3H24h-4.6h-0.526%20l0.026,0.525l0.2,4l0.024,0.475H19.6H24h3.866l-0.242,3.634L24,30.372l-3.614-1.234L20.3,26.98L20.28,26.5H19.8h-4h-0.528%20l0.029,0.527l0.3,5.5l0.019,0.341l0.324,0.107l7.9,2.6L24,35.626l0.156-0.051l7.9-2.6l0.322-0.106l0.021-0.339l0.7-11.5l0.5-7.999%20L33.632,12.5L33.632,12.5z'%20opacity='.07'/%3e%3c/svg%3e",LO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='96px'%20height='96px'%3e%3cpath%20fill='%23e64a19'%20d='M26,17h-8c-3.866,0-7-3.134-7-7v0c0-3.866,3.134-7,7-7h8V17z'/%3e%3cpath%20fill='%237c4dff'%20d='M25,31h-7c-3.866,0-7-3.134-7-7v0c0-3.866,3.134-7,7-7h7V31z'/%3e%3cpath%20fill='%2366bb6a'%20d='M18,45L18,45c-3.866,0-7-3.134-7-7v0c0-3.866,3.134-7,7-7h7v7C25,41.866,21.866,45,18,45z'/%3e%3cpath%20fill='%23ff7043'%20d='M32,17h-7V3h7c3.866,0,7,3.134,7,7v0C39,13.866,35.866,17,32,17z'/%3e%3ccircle%20cx='32'%20cy='24'%20r='7'%20fill='%2329b6f6'/%3e%3c/svg%3e",PO="data:image/svg+xml,%3c?xml%20version='1.0'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2050%2050'%20width='90px'%20height='90px'%3e%3cpath%20d='M17.791,46.836C18.502,46.53,19,45.823,19,45v-5.4c0-0.197,0.016-0.402,0.041-0.61C19.027,38.994,19.014,38.997,19,39%20c0,0-3,0-3.6,0c-1.5,0-2.8-0.6-3.4-1.8c-0.7-1.3-1-3.5-2.8-4.7C8.9,32.3,9.1,32,9.7,32c0.6,0.1,1.9,0.9,2.7,2c0.9,1.1,1.8,2,3.4,2%20c2.487,0,3.82-0.125,4.622-0.555C21.356,34.056,22.649,33,24,33v-0.025c-5.668-0.182-9.289-2.066-10.975-4.975%20c-3.665,0.042-6.856,0.405-8.677,0.707c-0.058-0.327-0.108-0.656-0.151-0.987c1.797-0.296,4.843-0.647,8.345-0.714%20c-0.112-0.276-0.209-0.559-0.291-0.849c-3.511-0.178-6.541-0.039-8.187,0.097c-0.02-0.332-0.047-0.663-0.051-0.999%20c1.649-0.135,4.597-0.27,8.018-0.111c-0.079-0.5-0.13-1.011-0.13-1.543c0-1.7,0.6-3.5,1.7-5c-0.5-1.7-1.2-5.3,0.2-6.6%20c2.7,0,4.6,1.3,5.5,2.1C21,13.4,22.9,13,25,13s4,0.4,5.6,1.1c0.9-0.8,2.8-2.1,5.5-2.1c1.5,1.4,0.7,5,0.2,6.6c1.1,1.5,1.7,3.2,1.6,5%20c0,0.484-0.045,0.951-0.11,1.409c3.499-0.172,6.527-0.034,8.204,0.102c-0.002,0.337-0.033,0.666-0.051,0.999%20c-1.671-0.138-4.775-0.28-8.359-0.089c-0.089,0.336-0.197,0.663-0.325,0.98c3.546,0.046,6.665,0.389,8.548,0.689%20c-0.043,0.332-0.093,0.661-0.151,0.987c-1.912-0.306-5.171-0.664-8.879-0.682C35.112,30.873,31.557,32.75,26,32.969V33%20c2.6,0,5,3.9,5,6.6V45c0,0.823,0.498,1.53,1.209,1.836C41.37,43.804,48,35.164,48,25C48,12.318,37.683,2,25,2S2,12.318,2,25%20C2,35.164,8.63,43.804,17.791,46.836z'/%3e%3c/svg%3e",yC="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='96px'%20height='96px'%3e%3cpath%20fill='%23E65100'%20d='M41,5H7l3,34l14,4l14-4L41,5L41,5z'/%3e%3cpath%20fill='%23FF6D00'%20d='M24%208L24%2039.9%2035.2%2036.7%2037.7%208z'/%3e%3cpath%20fill='%23FFF'%20d='M24,25v-4h8.6l-0.7,11.5L24,35.1v-4.2l4.1-1.4l0.3-4.5H24z%20M32.9,17l0.3-4H24v4H32.9z'/%3e%3cpath%20fill='%23EEE'%20d='M24,30.9v4.2l-7.9-2.6L15.7,27h4l0.2,2.5L24,30.9z%20M19.1,17H24v-4h-9.1l0.7,12H24v-4h-4.6L19.1,17z'/%3e%3c/svg%3e",OS="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='96px'%20height='96px'%3e%3cpath%20fill='%23ffd600'%20d='M6,42V6h36v36H6z'/%3e%3cpath%20fill='%23000001'%20d='M29.538%2032.947c.692%201.124%201.444%202.201%203.037%202.201%201.338%200%202.04-.665%202.04-1.585%200-1.101-.726-1.492-2.198-2.133l-.807-.344c-2.329-.988-3.878-2.226-3.878-4.841%200-2.41%201.845-4.244%204.728-4.244%202.053%200%203.528.711%204.592%202.573l-2.514%201.607c-.553-.988-1.151-1.377-2.078-1.377-.946%200-1.545.597-1.545%201.377%200%20.964.6%201.354%201.985%201.951l.807.344C36.452%2029.645%2038%2030.839%2038%2033.523%2038%2036.415%2035.716%2038%2032.65%2038c-2.999%200-4.702-1.505-5.65-3.368L29.538%2032.947zM17.952%2033.029c.506.906%201.275%201.603%202.381%201.603%201.058%200%201.667-.418%201.667-2.043V22h3.333v11.101c0%203.367-1.953%204.899-4.805%204.899-2.577%200-4.437-1.746-5.195-3.368L17.952%2033.029z'/%3e%3c/svg%3e",vC="/drren-portfolio/assets/mysql-CirjnRlH.svg",xC="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='96px'%20height='96px'%3e%3cpath%20fill='%23388e3c'%20d='M17.204%2019.122l-4.907%202.715C12.113%2021.938%2012%2022.126%2012%2022.329v5.433c0%20.203.113.39.297.492l4.908%202.717c.183.101.41.101.593%200l4.907-2.717C22.887%2028.152%2023%2027.965%2023%2027.762v-5.433c0-.203-.113-.39-.297-.492l-4.906-2.715c-.092-.051-.195-.076-.297-.076-.103%200-.205.025-.297.076M42.451%2024.013l-.818.452c-.031.017-.049.048-.049.082v.906c0%20.034.019.065.049.082l.818.453c.031.017.068.017.099%200l.818-.453c.03-.017.049-.048.049-.082v-.906c0-.034-.019-.065-.05-.082l-.818-.452C42.534%2024.004%2042.517%2024%2042.5%2024S42.466%2024.004%2042.451%2024.013'/%3e%3cpath%20fill='%2337474f'%20d='M35.751,13.364l-2.389-1.333c-0.075-0.042-0.167-0.041-0.241,0.003%20c-0.074,0.044-0.12,0.123-0.12,0.209L33,20.295l-2.203-1.219C30.705,19.025,30.602,19,30.5,19c-0.102,0-0.205,0.025-0.297,0.076%20h0.001l-4.907,2.715C25.113,21.892,25,22.08,25,22.282v5.433c0,0.203,0.113,0.39,0.297,0.492l4.908,2.717%20c0.183,0.101,0.41,0.101,0.593,0l4.907-2.717C35.887,28.106,36,27.918,36,27.715V13.788C36,13.612,35.904,13.45,35.751,13.364z%20M32.866,26.458l-2.23,1.235c-0.083,0.046-0.186,0.046-0.269,0l-2.231-1.235C28.051,26.412,28,26.326,28,26.234v-2.47%20c0-0.092,0.051-0.177,0.135-0.224l2.231-1.234h-0.001c0.042-0.023,0.088-0.034,0.135-0.034c0.047,0,0.093,0.012,0.135,0.034%20l2.23,1.234C32.949,23.587,33,23.673,33,23.765v2.47C33,26.326,32.949,26.412,32.866,26.458z'/%3e%3cpath%20fill='%232e7d32'%20d='M17.204,19.122L12,27.762c0,0.203,0.113,0.39,0.297,0.492l4.908,2.717%20c0.183,0.101,0.41,0.101,0.593,0L23,22.329c0-0.203-0.113-0.39-0.297-0.492l-4.906-2.715c-0.092-0.051-0.195-0.076-0.297-0.076%20c-0.103,0-0.205,0.025-0.297,0.076'/%3e%3cpath%20fill='%234caf50'%20d='M17.204,19.122l-4.907,2.715C12.113,21.938,12,22.126,12,22.329l5.204,8.642%20c0.183,0.101,0.41,0.101,0.593,0l4.907-2.717C22.887,28.152,23,27.965,23,27.762l-5.203-8.64c-0.092-0.051-0.195-0.076-0.297-0.076%20c-0.103,0-0.205,0.025-0.297,0.076'/%3e%3cpath%20fill='%2337474f'%20d='M47.703%2021.791l-4.906-2.715C42.705%2019.025%2042.602%2019%2042.5%2019c-.102%200-.205.025-.297.076h.001l-4.907%202.715C37.114%2021.892%2037%2022.084%2037%2022.294v5.411c0%20.209.114.402.297.503l4.908%202.717c.184.102.409.102.593%200l2.263-1.253c.207-.115.206-.412-.002-.526l-4.924-2.687C40.052%2026.412%2040%2026.325%2040%2026.231v-2.466c0-.092.05-.177.13-.221l2.235-1.236h-.001c.042-.023.088-.034.135-.034.047%200%20.093.012.135.034l2.235%201.237c.08.044.13.129.13.221v2.012c0%20.086.046.166.121.209.075.042.167.042.242-.001l2.398-1.393c.148-.086.24-.245.24-.417v-1.88C48%2022.085%2047.886%2021.892%2047.703%2021.791zM10.703%2021.791l-4.906-2.715C5.705%2019.025%205.602%2019%205.5%2019c-.102%200-.205.025-.297.076h.001l-4.907%202.715C.114%2021.892%200%2022.084%200%2022.294v7.465c0%20.086.046.166.121.209.075.042.167.042.242-.001l2.398-1.393C2.909%2028.488%203%2028.329%203%2028.157v-4.393c0-.092.05-.177.13-.221l2.235-1.236H5.365c.042-.023.088-.034.135-.034.047%200%20.093.012.135.034l2.235%201.237C7.95%2023.588%208%2023.673%208%2023.765v4.393c0%20.172.091.331.24.417l2.398%201.393c.075.043.167.043.242.001C10.954%2029.925%2011%2029.845%2011%2029.759v-7.464C11%2022.085%2010.886%2021.892%2010.703%2021.791z'/%3e%3c/svg%3e",DO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='96px'%20height='96px'%3e%3cpath%20fill='%230277BD'%20d='M24.047,5c-1.555,0.005-2.633,0.142-3.936,0.367c-3.848,0.67-4.549,2.077-4.549,4.67V14h9v2H15.22h-4.35c-2.636,0-4.943,1.242-5.674,4.219c-0.826,3.417-0.863,5.557,0,9.125C5.851,32.005,7.294,34,9.931,34h3.632v-5.104c0-2.966,2.686-5.896,5.764-5.896h7.236c2.523,0,5-1.862,5-4.377v-8.586c0-2.439-1.759-4.263-4.218-4.672C27.406,5.359,25.589,4.994,24.047,5z%20M19.063,9c0.821,0,1.5,0.677,1.5,1.502c0,0.833-0.679,1.498-1.5,1.498c-0.837,0-1.5-0.664-1.5-1.498C17.563,9.68,18.226,9,19.063,9z'/%3e%3cpath%20fill='%23FFC107'%20d='M23.078,43c1.555-0.005,2.633-0.142,3.936-0.367c3.848-0.67,4.549-2.077,4.549-4.67V34h-9v-2h9.343h4.35c2.636,0,4.943-1.242,5.674-4.219c0.826-3.417,0.863-5.557,0-9.125C41.274,15.995,39.831,14,37.194,14h-3.632v5.104c0,2.966-2.686,5.896-5.764,5.896h-7.236c-2.523,0-5,1.862-5,4.377v8.586c0,2.439,1.759,4.263,4.218,4.672C19.719,42.641,21.536,43.006,23.078,43z%20M28.063,39c-0.821,0-1.5-0.677-1.5-1.502c0-0.833,0.679-1.498,1.5-1.498c0.837,0,1.5,0.664,1.5,1.498C29.563,38.32,28.899,39,28.063,39z'/%3e%3c/svg%3e",_C="/drren-portfolio/assets/react-DleHMil7.svg",OO="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='90px'%20height='90px'%20viewBox='-8.78%200%2070%2070'%20xmlns:dc='http://purl.org/dc/elements/1.1/'%20xmlns:cc='http://creativecommons.org/ns%23'%20xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23'%20xmlns='http://www.w3.org/2000/svg'%20fill='%23000000'%20stroke='%23000000'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cmetadata%3e%3crdf:rdf%3e%3ccc:work%3e%3cdc:subject%3e%20Data%20%3c/dc:subject%3e%3cdc:identifier%3e%20sql-database-generic%20%3c/dc:identifier%3e%3cdc:title%3e%20SQL%20Database%20(Generic)%20%3c/dc:title%3e%3cdc:format%3e%20image/svg+xml%20%3c/dc:format%3e%3cdc:publisher%3e%20Amido%20Limited%20%3c/dc:publisher%3e%3cdc:creator%3e%20Richard%20Slater%20%3c/dc:creator%3e%3cdc:type%20rdf:resource='http://purl.org/dc/dcmitype/StillImage'/%3e%3c/cc:work%3e%3c/rdf:rdf%3e%3c/metadata%3e%3cpath%20d='m%20852.97077,1013.9363%20c%20-6.55238,-0.4723%20-13.02857,-2.1216%20-17.00034,-4.3296%20-2.26232,-1.2576%20-3.98589,-2.8032%20-4.66223,-4.1807%20l%20-0.4024,-0.8196%200,-25.70807%200,-25.7081%200.31843,-0.6465%20c%201.42297,-2.889%205.96432,-5.4935%2012.30378,-7.0562%202.15195,-0.5305%205.2586,-1.0588%207.79304,-1.3252%202.58797,-0.2721%209.44765,-0.2307%2012.02919,0.073%206.86123,0.8061%2012.69967,2.6108%2016.29768,5.0377%201.38756,0.9359%202.81137,2.4334%203.29371,3.4642%20l%200.41358,0.8838%20-0.0354,25.6303%20-0.0354,25.63047%20-0.33195,0.6744%20c%20-0.18257,0.3709%20-0.73406,1.1007%20-1.22553,1.6216%20-2.99181,3.1715%20-9.40919,5.5176%20-17.8267,6.5172%20-1.71567,0.2038%20-9.16916,0.3686%20-10.92937,0.2417%20z%20m%2012.07501,-22.02839%20c%20-0.0252,-0.0657%20-1.00472,-0.93831%20-2.17671,-1.93922%20-1.17199,-1.00091%20-2.18138,-1.86687%20-2.24309,-1.92436%20-0.0617,-0.0575%200.15481,-0.26106%200.48117,-0.45237%200.32635,-0.19131%200.95163,-0.7235%201.3895,-1.18265%201.2805,-1.34272%201.88466,-3.00131%201.88466,-5.17388%200,-2.1388%20-0.65162,-3.8645%20-1.95671,-5.1818%20-1.31533,-1.3278%20-2.82554,-1.8983%20-5.02486,-1.8983%20-3.39007,0%20-5.99368,1.9781%20-6.82468,5.1851%20-0.28586,1.1031%20-0.28432,3.33211%200.003,4.31023%200.74941,2.55136%202.79044,4.40434%205.33062,4.83946%200.8596,0.14724%200.97605,0.21071%201.5621,0.85144%200.34829,0.38078%201.06301,1.14085%201.58827,1.68904%20l%200.95501,0.9967%202.53878,0%20c%201.39633,0%202.51816,-0.0537%202.49296,-0.11939%20z%20m%20-8.70653,-7.10848%20c%20-0.61119,-0.31868%20-0.84225,-0.56599%20-1.19079,-1.27453%20-0.26919,-0.54724%20-0.31522,-0.85851%20-0.31824,-2.15197%20-0.003,-1.3143%200.0388,-1.5983%200.31987,-2.169%200.45985,-0.9339%201.09355,-1.376%202.07384,-1.4469%201.36454,-0.099%202.15217,0.5707%202.56498,2.1801%200.50612,1.97321%20-0.0504,4.07107%20-1.26471,4.76729%20-0.63707,0.36527%20-1.58737,0.40659%20-2.18495,0.095%20z%20m%20-11.25315,3.66269%20c%202.66179,-0.5048%204.1728,-2.0528%204.1728,-4.27495%200,-1.97137%20-0.97548,-3.12004%20-3.6716,-4.32364%20-1.54338,-0.689%20-2.10241,-1.1215%20-2.10241,-1.6268%200,-0.4188%200.53052,-0.8777%201.14813,-0.993%200.60302,-0.1126%202.20237,0.1652%203.14683,0.5467%20l%200.79167,0.3198%200,-1.7524%200,-1.7525%20-0.85923,-0.1906%20c%20-0.53103,-0.1178%20-1.64689,-0.1885%20-2.92137,-0.1849%20-1.80528,0%20-2.15881,0.044%20-2.83818,0.3138%20-1.98445,0.7878%20-2.92613,2.1298%20-2.91107,4.1485%200.0141,1.8898%201.01108,3.06864%203.49227,4.12912%201.46399,0.62572%202.05076,1.10218%202.05076,1.66522%200,1.1965%20-1.99362,1.34375%20-4.10437,0.30315%20-0.57805,-0.28498%20-1.09739,-0.54137%20-1.1541,-0.56976%20-0.0567,-0.0284%20-0.10311,0.79023%20-0.10311,1.81917%200,1.86239%200.002,1.87137%200.33919,1.99974%201.26979,0.48278%204.07626,0.69787%205.52379,0.42335%20z%20m%2030.4308,-1.72766%200,-1.58098%20-2.40584,0%20-2.40583,0%200,-5.43035%200,-5.4303%20-2.13089,0%20-2.13088,0%200,7.0113%200,7.01131%204.53672,0%204.53672,0%200,-1.58098%20z%20m%20-14.84745,-27.70503%20c%204.23447,-0.2937%207.4086,-0.8482%2010.20178,-1.7821%202.78264,-0.9304%204.42643,-2.0562%204.79413,-3.2834%200.14166,-0.4729%200.13146,-0.6523%20-0.0665,-1.1708%20-0.88775,-2.3245%20-5.84694,-4.1104%20-13.42493,-4.8345%20-3.24154,-0.3098%20-9.13671,-0.2094%20-12.22745,0.2081%20-4.71604,0.6372%20-8.54333,1.8208%20-10.2451,3.1683%20-3.44251,2.726%200.19793,5.7242%208.66397,7.1354%203.67084,0.6119%208.42674,0.828%2012.30414,0.559%20z'%20fill='%23000000'%20transform='translate(-830.906%20-943.981)'/%3e%3c/g%3e%3c/svg%3e",BO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='96px'%20height='96px'%3e%3cpath%20fill='%2300acc1'%20d='M24,9.604c-6.4,0-10.4,3.199-12,9.597c2.4-3.199,5.2-4.398,8.4-3.599%20c1.826,0.456,3.131,1.781,4.576,3.247C27.328,21.236,30.051,24,36,24c6.4,0,10.4-3.199,12-9.598c-2.4,3.199-5.2,4.399-8.4,3.6%20c-1.825-0.456-3.13-1.781-4.575-3.247C32.672,12.367,29.948,9.604,24,9.604L24,9.604z%20M12,24c-6.4,0-10.4,3.199-12,9.598%20c2.4-3.199,5.2-4.399,8.4-3.599c1.825,0.457,3.13,1.781,4.575,3.246c2.353,2.388,5.077,5.152,11.025,5.152%20c6.4,0,10.4-3.199,12-9.598c-2.4,3.199-5.2,4.399-8.4,3.599c-1.826-0.456-3.131-1.781-4.576-3.246C20.672,26.764,17.949,24,12,24%20L12,24z'/%3e%3c/svg%3e",FO=[{id:1,src:gC,alt:"css icon",type:["frontend"]},{id:2,src:LO,alt:"figma icon",type:["tool"]},{id:3,src:PO,alt:"github icon",type:["tool"]},{id:4,src:yC,alt:"html icon",type:["frontend","language"]},{id:5,src:OS,alt:"javascript icon",type:["frontend","language"]},{id:6,src:vC,alt:"mysql icon",type:["backend"]},{id:7,src:xC,alt:"node.js icon",type:["backend"]},{id:8,src:DO,alt:"python icon",type:["language","backend"]},{id:9,src:_C,alt:"react.js icon",type:["frontend"]},{id:10,src:OO,alt:"sql icon",type:["language","backend"]},{id:11,src:BO,alt:"tailwind.css icon",type:["tool","frontend"]}];function kO({skillFilter:s}){const e=FO.filter(t=>s=="all"?t:t.type.some(n=>n===s));return F.jsx("div",{className:"bg-[#252525] overflow-hidden",children:F.jsx(IO,{pauseOnHover:!0,direction:"right",children:F.jsx("div",{id:"slider",className:"flex overflow-hidden justify-between w-full",children:e.map(t=>F.jsx("div",{className:"desktop:w-[100px] desktop:h-[100px] flex-shrink-0 mx-2 desktop:scale-100 tablet:max-desktop:scale-75 phone:max-tablet:scale-50 desktop:ml-20 tablet:ml-10 phone:ml-5",children:F.jsx("img",{src:t.src,alt:t.alt,className:"w-full h-auto"})},t.id))})})})}function NO({skillFilter:s,setSkillFilter:e}){const t=n=>{e(n.target.value)};return F.jsxs("select",{value:s,className:"bg-black",onChange:t,children:[F.jsx("option",{value:"all",children:"All"}),F.jsx("option",{value:"language",children:"Languages"}),F.jsx("option",{value:"frontend",children:"Frontend"}),F.jsx("option",{value:"backend",children:"Backend"}),F.jsx("option",{value:"tool",children:"Tools"})]})}function UO({skillFilter:s,setSkillFilter:e}){const t=te.useRef(null),[n,i]=te.useState(0);return te.useEffect(()=>{t.current&&i(t.current.offsetWidth);const r=()=>{t.current&&i(t.current.offsetWidth)};return window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[]),F.jsx("div",{className:"skills mt-10 phone:px-40 py-10 phone:max-tablet:px-3",children:F.jsxs("div",{ref:t,className:"flex justify-between relative bg-[#252525] rounded-xl px-5",children:[F.jsxs("div",{className:"flex relative items-center",children:[F.jsx("div",{className:"flex-grow relative phone:max-tablet:hidden",children:F.jsx("div",{className:"border border-accent-color absolute left-[-120px] right-5"})}),F.jsx("div",{className:"relative phone:max-tablet:hidden",children:F.jsx("div",{className:"border border-accent-color absolute left-[-120px] h-60 -z-50"})}),F.jsx("div",{className:"relative phone:max-tablet:hidden",children:F.jsx("div",{className:"border border-accent-color absolute left-[-120px] top-60 -z-50",style:{width:`calc(${n}px + 200px)`}})}),F.jsx("h1",{className:"text-accent-color",children:"My Skills"})]}),F.jsxs("div",{className:"flex items-center",children:[F.jsx(NO,{skillFilter:s,setSkillFilter:e}),F.jsx("div",{className:"relative phone:max-tablet:hidden",children:F.jsx("div",{className:"border border-accent-color absolute right-[-120px] left-5"})}),F.jsx("div",{className:"relative phone:max-tablet:hidden",children:F.jsx("div",{className:"border border-accent-color absolute right-[-120px] h-60 -z-50"})})]})]})})}function GO(){const[s,e]=te.useState("all");return F.jsxs("section",{id:"about",className:"py-20",children:[F.jsx("h1",{className:"mb-5 desktop:px-40 tablet:px-10 phone:px-3",children:"01 About Me"}),F.jsxs("div",{className:"desktop:px-40 phone:px-10 phone:max-tablet:px-3 grid desktop:grid-cols-[4fr_6fr] gap-2 phone:grid-cols-1",children:[F.jsxs("div",{className:"w-full rounded-xl flex flex-col justify-between bg-[#252525] p-5 gap-7",children:[F.jsx("div",{className:"max-w-72 self-center",children:F.jsx("img",{className:"rounded-full",src:bO,alt:""})}),F.jsxs("div",{children:[F.jsx("h2",{className:"mb-4",children:F.jsx("b",{children:"Hi, I'm Darren Francis"})}),F.jsx("p",{className:"opacity-60",children:"I'm a college student pursuing a degree in Computer Science, with a focus on full-stack and web development. I'm passionate about creating dynamic and user-friendly web applications and constantly expanding my skills in modern technologies."})]})]}),F.jsxs("div",{className:"w-full rounded-xl bg-[#252525] p-5 flex flex-col justify-between",children:[F.jsx("div",{className:"max-[270px] self-center",children:F.jsx("img",{src:MO,alt:""})}),F.jsxs("div",{children:[F.jsx("h2",{className:"mb-4",children:F.jsx("b",{children:"My passion for coding"})}),F.jsx("p",{className:"opacity-60",children:"My passion for coding extends far beyond the classroom. Outside of school, I actively work on personal projects that allow me to solve real-world problems and turn ideas into reality."})]})]})]}),F.jsx(UO,{skillFilter:s,setSkillFilter:e}),F.jsx(kO,{skillFilter:s})," "]})}const HO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0,0,256,256'%20width='30px'%20height='30px'%20fill-rule='nonzero'%3e%3cg%20fill='%23d1ff48'%20fill-rule='nonzero'%20stroke='none'%20stroke-width='1'%20stroke-linecap='butt'%20stroke-linejoin='miter'%20stroke-miterlimit='10'%20stroke-dasharray=''%20stroke-dashoffset='0'%20font-family='none'%20font-weight='none'%20font-size='none'%20text-anchor='none'%20style='mix-blend-mode:%20normal'%3e%3cg%20transform='scale(8.53333,8.53333)'%3e%3cpath%20d='M25.98047,2.99023c-0.03726,0.00118%20-0.07443,0.00444%20-0.11133,0.00977h-5.86914c-0.36064,-0.0051%20-0.69608,0.18438%20-0.87789,0.49587c-0.18181,0.3115%20-0.18181,0.69676%200,1.00825c0.18181,0.3115%200.51725,0.50097%200.87789,0.49587h3.58594l-10.29297,10.29297c-0.26124,0.25082%20-0.36648,0.62327%20-0.27512,0.97371c0.09136,0.35044%200.36503,0.62411%200.71547,0.71547c0.35044,0.09136%200.72289,-0.01388%200.97371,-0.27512l10.29297,-10.29297v3.58594c-0.0051,0.36064%200.18438,0.69608%200.49587,0.87789c0.3115,0.18181%200.69676,0.18181%201.00825,0c0.3115,-0.18181%200.50097,-0.51725%200.49587,-0.87789v-5.87305c0.04031,-0.29141%20-0.04973,-0.58579%20-0.24615,-0.80479c-0.19643,-0.219%20-0.47931,-0.34042%20-0.77338,-0.33192zM6,7c-1.09306,0%20-2,0.90694%20-2,2v15c0,1.09306%200.90694,2%202,2h15c1.09306,0%202,-0.90694%202,-2v-10v-2.57812l-2,2v2.57813v8h-15v-15h8h2h0.57813l2,-2h-2.57812h-2z'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/svg%3e",zO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20448%20512'%3e%3c!--!Font%20Awesome%20Free%206.7.2%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202024%20Fonticons,%20Inc.--%3e%3cpath%20fill='%23ffffff'%20d='M9.4%20233.4c-12.5%2012.5-12.5%2032.8%200%2045.3l160%20160c12.5%2012.5%2032.8%2012.5%2045.3%200s12.5-32.8%200-45.3L109.2%20288%20416%20288c17.7%200%2032-14.3%2032-32s-14.3-32-32-32l-306.7%200L214.6%20118.6c12.5-12.5%2012.5-32.8%200-45.3s-32.8-12.5-45.3%200l-160%20160z'/%3e%3c/svg%3e",jO="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20448%20512'%3e%3c!--!Font%20Awesome%20Free%206.7.2%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202024%20Fonticons,%20Inc.--%3e%3cpath%20fill='%23ffffff'%20d='M438.6%20278.6c12.5-12.5%2012.5-32.8%200-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3%200s-12.5%2032.8%200%2045.3L338.8%20224%2032%20224c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032l306.7%200L233.4%20393.4c-12.5%2012.5-12.5%2032.8%200%2045.3s32.8%2012.5%2045.3%200l160-160z'/%3e%3c/svg%3e",UA="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0,0,256,256'%20width='50px'%20height='50px'%20fill-rule='nonzero'%3e%3cg%20fill='%23d1ff48'%20fill-rule='nonzero'%20stroke='none'%20stroke-width='1'%20stroke-linecap='butt'%20stroke-linejoin='miter'%20stroke-miterlimit='10'%20stroke-dasharray=''%20stroke-dashoffset='0'%20font-family='none'%20font-weight='none'%20font-size='none'%20text-anchor='none'%20style='mix-blend-mode:%20normal'%3e%3cg%20transform='scale(5.12,5.12)'%3e%3cpath%20d='M17.791,46.836c0.711,-0.306%201.209,-1.013%201.209,-1.836v-5.4c0,-0.197%200.016,-0.402%200.041,-0.61c-0.014,0.004%20-0.027,0.007%20-0.041,0.01c0,0%20-3,0%20-3.6,0c-1.5,0%20-2.8,-0.6%20-3.4,-1.8c-0.7,-1.3%20-1,-3.5%20-2.8,-4.7c-0.3,-0.2%20-0.1,-0.5%200.5,-0.5c0.6,0.1%201.9,0.9%202.7,2c0.9,1.1%201.8,2%203.4,2c2.487,0%203.82,-0.125%204.622,-0.555c0.934,-1.389%202.227,-2.445%203.578,-2.445v-0.025c-5.668,-0.182%20-9.289,-2.066%20-10.975,-4.975c-3.665,0.042%20-6.856,0.405%20-8.677,0.707c-0.058,-0.327%20-0.108,-0.656%20-0.151,-0.987c1.797,-0.296%204.843,-0.647%208.345,-0.714c-0.112,-0.276%20-0.209,-0.559%20-0.291,-0.849c-3.511,-0.178%20-6.541,-0.039%20-8.187,0.097c-0.02,-0.332%20-0.047,-0.663%20-0.051,-0.999c1.649,-0.135%204.597,-0.27%208.018,-0.111c-0.079,-0.5%20-0.13,-1.011%20-0.13,-1.543c0,-1.7%200.6,-3.5%201.7,-5c-0.5,-1.7%20-1.2,-5.3%200.2,-6.6c2.7,0%204.6,1.3%205.5,2.1c1.699,-0.701%203.599,-1.101%205.699,-1.101c2.1,0%204,0.4%205.6,1.1c0.9,-0.8%202.8,-2.1%205.5,-2.1c1.5,1.4%200.7,5%200.2,6.6c1.1,1.5%201.7,3.2%201.6,5c0,0.484%20-0.045,0.951%20-0.11,1.409c3.499,-0.172%206.527,-0.034%208.204,0.102c-0.002,0.337%20-0.033,0.666%20-0.051,0.999c-1.671,-0.138%20-4.775,-0.28%20-8.359,-0.089c-0.089,0.336%20-0.197,0.663%20-0.325,0.98c3.546,0.046%206.665,0.389%208.548,0.689c-0.043,0.332%20-0.093,0.661%20-0.151,0.987c-1.912,-0.306%20-5.171,-0.664%20-8.879,-0.682c-1.665,2.878%20-5.22,4.755%20-10.777,4.974v0.031c2.6,0%205,3.9%205,6.6v5.4c0,0.823%200.498,1.53%201.209,1.836c9.161,-3.032%2015.791,-11.672%2015.791,-21.836c0,-12.682%20-10.317,-23%20-23,-23c-12.683,0%20-23,10.318%20-23,23c0,10.164%206.63,18.804%2015.791,21.836z'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/svg%3e";/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const C0="171",ch={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},uh={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},SC=0,BS=1,AC=2,VO=3,EC=0,Ex=1,zm=2,na=3,Ga=0,ss=1,So=2,jl=0,wh=1,FS=2,kS=3,NS=4,TC=5,zc=100,wC=101,MC=102,bC=103,CC=104,RC=200,IC=201,LC=202,PC=203,pv=204,mv=205,DC=206,OC=207,BC=208,FC=209,kC=210,NC=211,UC=212,GC=213,HC=214,gv=0,yv=1,vv=2,Fh=3,xv=4,_v=5,Sv=6,Av=7,R0=0,zC=1,jC=2,Oa=0,VC=1,WC=2,KC=3,GA=4,XC=5,$C=6,YC=7,US="attached",JC="detached",Tx=300,Kl=301,qc=302,i0=303,r0=304,gp=306,Qc=1e3,Ws=1001,Jf=1002,ur=1003,wx=1004,WO=1004,gh=1005,KO=1005,pi=1006,jf=1007,XO=1007,Ao=1008,$O=1008,sa=1009,HA=1010,zA=1011,qf=1012,Mx=1013,Xl=1014,rs=1015,Yh=1016,bx=1017,Cx=1018,kh=1020,jA=35902,VA=1021,WA=1022,Nr=1023,KA=1024,XA=1025,Mh=1026,Nh=1027,Rx=1028,I0=1029,$A=1030,Ix=1031,YO=1032,Lx=1033,jm=33776,Vm=33777,Wm=33778,Km=33779,Ev=35840,Tv=35841,wv=35842,Mv=35843,bv=36196,Cv=37492,Rv=37496,Iv=37808,Lv=37809,Pv=37810,Dv=37811,Ov=37812,Bv=37813,Fv=37814,kv=37815,Nv=37816,Uv=37817,Gv=37818,Hv=37819,zv=37820,jv=37821,Xm=36492,Vv=36494,Wv=36495,YA=36283,Kv=36284,Xv=36285,$v=36286,qC=2200,QC=2201,ZC=2202,Qf=2300,Zf=2301,Zy=2302,yh=2400,vh=2401,s0=2402,Px=2500,JA=2501,eR=0,qA=1,Yv=2,tR=3200,nR=3201,JO=3202,qO=3203,iu=0,iR=1,Nl="",As="srgb",Uh="srgb-linear",o0="linear",Fn="srgb",QO=0,hh=7680,ZO=7681,eB=7682,tB=7683,nB=34055,iB=34056,rB=5386,sB=512,oB=513,aB=514,lB=515,cB=516,uB=517,hB=518,GS=519,rR=512,sR=513,oR=514,QA=515,aR=516,lR=517,cR=518,uR=519,a0=35044,dB=35048,fB=35040,pB=35045,mB=35049,gB=35041,yB=35046,vB=35050,xB=35042,_B="100",HS="300 es",Ia=2e3,l0=2001;let Va=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let r=0,o=i.length;r<o;r++)i[r].call(this,e);e.target=null}}};const Dr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let mw=1234567;const bh=Math.PI/180,ep=180/Math.PI;function $s(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Dr[s&255]+Dr[s>>8&255]+Dr[s>>16&255]+Dr[s>>24&255]+"-"+Dr[e&255]+Dr[e>>8&255]+"-"+Dr[e>>16&15|64]+Dr[e>>24&255]+"-"+Dr[t&63|128]+Dr[t>>8&255]+"-"+Dr[t>>16&255]+Dr[t>>24&255]+Dr[n&255]+Dr[n>>8&255]+Dr[n>>16&255]+Dr[n>>24&255]).toLowerCase()}function nn(s,e,t){return Math.max(e,Math.min(t,s))}function ZA(s,e){return(s%e+e)%e}function SB(s,e,t,n,i){return n+(s-e)*(i-n)/(t-e)}function AB(s,e,t){return s!==e?(t-s)/(e-s):0}function $m(s,e,t){return(1-t)*s+t*e}function EB(s,e,t,n){return $m(s,e,1-Math.exp(-t*n))}function TB(s,e=1){return e-Math.abs(ZA(s,e*2)-e)}function wB(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function MB(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function bB(s,e){return s+Math.floor(Math.random()*(e-s+1))}function CB(s,e){return s+Math.random()*(e-s)}function RB(s){return s*(.5-Math.random())}function IB(s){s!==void 0&&(mw=s);let e=mw+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function LB(s){return s*bh}function PB(s){return s*ep}function DB(s){return(s&s-1)===0&&s!==0}function OB(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function BB(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function FB(s,e,t,n,i){const r=Math.cos,o=Math.sin,a=r(t/2),l=o(t/2),c=r((e+n)/2),h=o((e+n)/2),f=r((e-n)/2),p=o((e-n)/2),y=r((n-e)/2),v=o((n-e)/2);switch(i){case"XYX":s.set(a*h,l*f,l*p,a*c);break;case"YZY":s.set(l*p,a*h,l*f,a*c);break;case"ZXZ":s.set(l*f,l*p,a*h,a*c);break;case"XZX":s.set(a*h,l*v,l*y,a*c);break;case"YXY":s.set(l*y,a*h,l*v,a*c);break;case"ZYZ":s.set(l*v,l*y,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function ns(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function hn(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const hR={DEG2RAD:bh,RAD2DEG:ep,generateUUID:$s,clamp:nn,euclideanModulo:ZA,mapLinear:SB,inverseLerp:AB,lerp:$m,damp:EB,pingpong:TB,smoothstep:wB,smootherstep:MB,randInt:bB,randFloat:CB,randFloatSpread:RB,seededRandom:IB,degToRad:LB,radToDeg:PB,isPowerOfTwo:DB,ceilPowerOfTwo:OB,floorPowerOfTwo:BB,setQuaternionFromProperEuler:FB,normalize:hn,denormalize:ns};class Ue{constructor(e=0,t=0){Ue.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=nn(this.x,e.x,t.x),this.y=nn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=nn(this.x,e,t),this.y=nn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(nn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(nn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*i+e.x,this.y=r*i+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class on{constructor(e,t,n,i,r,o,a,l,c){on.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,i,r,o,a,l,c)}set(e,t,n,i,r,o,a,l,c){const h=this.elements;return h[0]=e,h[1]=i,h[2]=a,h[3]=t,h[4]=r,h[5]=l,h[6]=n,h[7]=o,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],h=n[4],f=n[7],p=n[2],y=n[5],v=n[8],_=i[0],S=i[3],A=i[6],w=i[1],M=i[4],C=i[7],I=i[2],O=i[5],k=i[8];return r[0]=o*_+a*w+l*I,r[3]=o*S+a*M+l*O,r[6]=o*A+a*C+l*k,r[1]=c*_+h*w+f*I,r[4]=c*S+h*M+f*O,r[7]=c*A+h*C+f*k,r[2]=p*_+y*w+v*I,r[5]=p*S+y*M+v*O,r[8]=p*A+y*C+v*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8];return t*o*h-t*a*c-n*r*h+n*a*l+i*r*c-i*o*l}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],f=h*o-a*c,p=a*l-h*r,y=c*r-o*l,v=t*f+n*p+i*y;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/v;return e[0]=f*_,e[1]=(i*c-h*n)*_,e[2]=(a*n-i*o)*_,e[3]=p*_,e[4]=(h*t-i*l)*_,e[5]=(i*r-a*t)*_,e[6]=y*_,e[7]=(n*l-c*t)*_,e[8]=(o*t-n*r)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,o,a){const l=Math.cos(r),c=Math.sin(r);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-i*c,i*l,-i*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(K_.makeScale(e,t)),this}rotate(e){return this.premultiply(K_.makeRotation(-e)),this}translate(e,t){return this.premultiply(K_.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const K_=new on;function dR(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}const kB={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Bf(s,e){return new kB[s](e)}function c0(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function fR(){const s=c0("canvas");return s.style.display="block",s}const gw={};function Pf(s){s in gw||(gw[s]=!0,console.warn(s))}function NB(s,e,t){return new Promise(function(n,i){function r(){switch(s.clientWaitSync(e,s.SYNC_FLUSH_COMMANDS_BIT,0)){case s.WAIT_FAILED:i();break;case s.TIMEOUT_EXPIRED:setTimeout(r,t);break;default:n()}}setTimeout(r,t)})}function UB(s){const e=s.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function GB(s){const e=s.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const yw=new on().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),vw=new on().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function HB(){const s={enabled:!0,workingColorSpace:Uh,spaces:{},convert:function(i,r,o){return this.enabled===!1||r===o||!r||!o||(this.spaces[r].transfer===Fn&&(i.r=Vl(i.r),i.g=Vl(i.g),i.b=Vl(i.b)),this.spaces[r].primaries!==this.spaces[o].primaries&&(i.applyMatrix3(this.spaces[r].toXYZ),i.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Fn&&(i.r=Vf(i.r),i.g=Vf(i.g),i.b=Vf(i.b))),i},fromWorkingColorSpace:function(i,r){return this.convert(i,this.workingColorSpace,r)},toWorkingColorSpace:function(i,r){return this.convert(i,r,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===Nl?o0:this.spaces[i].transfer},getLuminanceCoefficients:function(i,r=this.workingColorSpace){return i.fromArray(this.spaces[r].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,r,o){return i.copy(this.spaces[r].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return s.define({[Uh]:{primaries:e,whitePoint:n,transfer:o0,toXYZ:yw,fromXYZ:vw,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:As},outputColorSpaceConfig:{drawingBufferColorSpace:As}},[As]:{primaries:e,whitePoint:n,transfer:Fn,toXYZ:yw,fromXYZ:vw,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:As}}}),s}const Mn=HB();function Vl(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function Vf(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let of;class pR{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{of===void 0&&(of=c0("canvas")),of.width=e.width,of.height=e.height;const n=of.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=of}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=c0("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let o=0;o<r.length;o++)r[o]=Vl(r[o]/255)*255;return n.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Vl(t[n]/255)*255):t[n]=Vl(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let zB=0;class xh{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:zB++}),this.uuid=$s(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let r;if(Array.isArray(i)){r=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?r.push(X_(i[o].image)):r.push(X_(i[o]))}else r=X_(i);n.url=r}return t||(e.images[this.uuid]=n),n}}function X_(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?pR.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let jB=0;class ei extends Va{constructor(e=ei.DEFAULT_IMAGE,t=ei.DEFAULT_MAPPING,n=Ws,i=Ws,r=pi,o=Ao,a=Nr,l=sa,c=ei.DEFAULT_ANISOTROPY,h=Nl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:jB++}),this.uuid=$s(),this.name="",this.source=new xh(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ue(0,0),this.repeat=new Ue(1,1),this.center=new Ue(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new on,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Tx)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Qc:e.x=e.x-Math.floor(e.x);break;case Ws:e.x=e.x<0?0:1;break;case Jf:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Qc:e.y=e.y-Math.floor(e.y);break;case Ws:e.y=e.y<0?0:1;break;case Jf:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ei.DEFAULT_IMAGE=null;ei.DEFAULT_MAPPING=Tx;ei.DEFAULT_ANISOTROPY=1;class Cn{constructor(e=0,t=0,n=0,i=1){Cn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const l=e.elements,c=l[0],h=l[4],f=l[8],p=l[1],y=l[5],v=l[9],_=l[2],S=l[6],A=l[10];if(Math.abs(h-p)<.01&&Math.abs(f-_)<.01&&Math.abs(v-S)<.01){if(Math.abs(h+p)<.1&&Math.abs(f+_)<.1&&Math.abs(v+S)<.1&&Math.abs(c+y+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const M=(c+1)/2,C=(y+1)/2,I=(A+1)/2,O=(h+p)/4,k=(f+_)/4,N=(v+S)/4;return M>C&&M>I?M<.01?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(M),i=O/n,r=k/n):C>I?C<.01?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(C),n=O/i,r=N/i):I<.01?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(I),n=k/r,i=N/r),this.set(n,i,r,t),this}let w=Math.sqrt((S-v)*(S-v)+(f-_)*(f-_)+(p-h)*(p-h));return Math.abs(w)<.001&&(w=1),this.x=(S-v)/w,this.y=(f-_)/w,this.z=(p-h)/w,this.w=Math.acos((c+y+A-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=nn(this.x,e.x,t.x),this.y=nn(this.y,e.y,t.y),this.z=nn(this.z,e.z,t.z),this.w=nn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=nn(this.x,e,t),this.y=nn(this.y,e,t),this.z=nn(this.z,e,t),this.w=nn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(nn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class mR extends Va{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Cn(0,0,e,t),this.scissorTest=!1,this.viewport=new Cn(0,0,e,t);const i={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:pi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const r=new ei(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);r.flipY=!1,r.generateMipmaps=n.generateMipmaps,r.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let a=0;a<o;a++)this.textures[a]=r.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new xh(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class wo extends mR{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Dx extends ei{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=ur,this.minFilter=ur,this.wrapR=Ws,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class VB extends wo{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Dx(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class eE extends ei{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=ur,this.minFilter=ur,this.wrapR=Ws,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WB extends wo{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new eE(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class hr{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,o,a){let l=n[i+0],c=n[i+1],h=n[i+2],f=n[i+3];const p=r[o+0],y=r[o+1],v=r[o+2],_=r[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=h,e[t+3]=f;return}if(a===1){e[t+0]=p,e[t+1]=y,e[t+2]=v,e[t+3]=_;return}if(f!==_||l!==p||c!==y||h!==v){let S=1-a;const A=l*p+c*y+h*v+f*_,w=A>=0?1:-1,M=1-A*A;if(M>Number.EPSILON){const I=Math.sqrt(M),O=Math.atan2(I,A*w);S=Math.sin(S*O)/I,a=Math.sin(a*O)/I}const C=a*w;if(l=l*S+p*C,c=c*S+y*C,h=h*S+v*C,f=f*S+_*C,S===1-a){const I=1/Math.sqrt(l*l+c*c+h*h+f*f);l*=I,c*=I,h*=I,f*=I}}e[t]=l,e[t+1]=c,e[t+2]=h,e[t+3]=f}static multiplyQuaternionsFlat(e,t,n,i,r,o){const a=n[i],l=n[i+1],c=n[i+2],h=n[i+3],f=r[o],p=r[o+1],y=r[o+2],v=r[o+3];return e[t]=a*v+h*f+l*y-c*p,e[t+1]=l*v+h*p+c*f-a*y,e[t+2]=c*v+h*y+a*p-l*f,e[t+3]=h*v-a*f-l*p-c*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,i=e._y,r=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),h=a(i/2),f=a(r/2),p=l(n/2),y=l(i/2),v=l(r/2);switch(o){case"XYZ":this._x=p*h*f+c*y*v,this._y=c*y*f-p*h*v,this._z=c*h*v+p*y*f,this._w=c*h*f-p*y*v;break;case"YXZ":this._x=p*h*f+c*y*v,this._y=c*y*f-p*h*v,this._z=c*h*v-p*y*f,this._w=c*h*f+p*y*v;break;case"ZXY":this._x=p*h*f-c*y*v,this._y=c*y*f+p*h*v,this._z=c*h*v+p*y*f,this._w=c*h*f-p*y*v;break;case"ZYX":this._x=p*h*f-c*y*v,this._y=c*y*f+p*h*v,this._z=c*h*v-p*y*f,this._w=c*h*f+p*y*v;break;case"YZX":this._x=p*h*f+c*y*v,this._y=c*y*f+p*h*v,this._z=c*h*v-p*y*f,this._w=c*h*f-p*y*v;break;case"XZY":this._x=p*h*f-c*y*v,this._y=c*y*f-p*h*v,this._z=c*h*v+p*y*f,this._w=c*h*f+p*y*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],o=t[1],a=t[5],l=t[9],c=t[2],h=t[6],f=t[10],p=n+a+f;if(p>0){const y=.5/Math.sqrt(p+1);this._w=.25/y,this._x=(h-l)*y,this._y=(r-c)*y,this._z=(o-i)*y}else if(n>a&&n>f){const y=2*Math.sqrt(1+n-a-f);this._w=(h-l)/y,this._x=.25*y,this._y=(i+o)/y,this._z=(r+c)/y}else if(a>f){const y=2*Math.sqrt(1+a-n-f);this._w=(r-c)/y,this._x=(i+o)/y,this._y=.25*y,this._z=(l+h)/y}else{const y=2*Math.sqrt(1+f-n-a);this._w=(o-i)/y,this._x=(r+c)/y,this._y=(l+h)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(nn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,o=e._w,a=t._x,l=t._y,c=t._z,h=t._w;return this._x=n*h+o*a+i*c-r*l,this._y=i*h+o*l+r*a-n*c,this._z=r*h+o*c+n*l-i*a,this._w=o*h-n*a-i*l-r*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,r=this._z,o=this._w;let a=o*e._w+n*e._x+i*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;const l=1-a*a;if(l<=Number.EPSILON){const y=1-t;return this._w=y*o+t*this._w,this._x=y*n+t*this._x,this._y=y*i+t*this._y,this._z=y*r+t*this._z,this.normalize(),this}const c=Math.sqrt(l),h=Math.atan2(c,a),f=Math.sin((1-t)*h)/c,p=Math.sin(t*h)/c;return this._w=o*f+this._w*p,this._x=n*f+this._x*p,this._y=i*f+this._y*p,this._z=r*f+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class J{constructor(e=0,t=0,n=0){J.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(xw.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(xw.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*i-a*n),h=2*(a*t-r*i),f=2*(r*n-o*t);return this.x=t+l*c+o*f-a*h,this.y=n+l*h+a*c-r*f,this.z=i+l*f+r*h-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=nn(this.x,e.x,t.x),this.y=nn(this.y,e.y,t.y),this.z=nn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=nn(this.x,e,t),this.y=nn(this.y,e,t),this.z=nn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(nn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,o=t.x,a=t.y,l=t.z;return this.x=i*l-r*a,this.y=r*o-n*l,this.z=n*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return $_.copy(this).projectOnVector(e),this.sub($_)}reflect(e){return this.sub($_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(nn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const $_=new J,xw=new hr;class wr{constructor(e=new J(1/0,1/0,1/0),t=new J(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Qo.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Qo.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Qo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const r=n.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=r.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Qo):Qo.fromBufferAttribute(r,o),Qo.applyMatrix4(e.matrixWorld),this.expandByPoint(Qo);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Hg.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Hg.copy(n.boundingBox)),Hg.applyMatrix4(e.matrixWorld),this.union(Hg)}const i=e.children;for(let r=0,o=i.length;r<o;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Qo),Qo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(xm),zg.subVectors(this.max,xm),af.subVectors(e.a,xm),lf.subVectors(e.b,xm),cf.subVectors(e.c,xm),Lc.subVectors(lf,af),Pc.subVectors(cf,lf),Ku.subVectors(af,cf);let t=[0,-Lc.z,Lc.y,0,-Pc.z,Pc.y,0,-Ku.z,Ku.y,Lc.z,0,-Lc.x,Pc.z,0,-Pc.x,Ku.z,0,-Ku.x,-Lc.y,Lc.x,0,-Pc.y,Pc.x,0,-Ku.y,Ku.x,0];return!Y_(t,af,lf,cf,zg)||(t=[1,0,0,0,1,0,0,0,1],!Y_(t,af,lf,cf,zg))?!1:(jg.crossVectors(Lc,Pc),t=[jg.x,jg.y,jg.z],Y_(t,af,lf,cf,zg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Qo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Qo).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Tl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Tl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Tl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Tl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Tl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Tl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Tl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Tl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Tl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Tl=[new J,new J,new J,new J,new J,new J,new J,new J],Qo=new J,Hg=new wr,af=new J,lf=new J,cf=new J,Lc=new J,Pc=new J,Ku=new J,xm=new J,zg=new J,jg=new J,Xu=new J;function Y_(s,e,t,n,i){for(let r=0,o=s.length-3;r<=o;r+=3){Xu.fromArray(s,r);const a=i.x*Math.abs(Xu.x)+i.y*Math.abs(Xu.y)+i.z*Math.abs(Xu.z),l=e.dot(Xu),c=t.dot(Xu),h=n.dot(Xu);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}const KB=new wr,_m=new J,J_=new J;class dr{constructor(e=new J,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):KB.setFromPoints(e).getCenter(n);let i=0;for(let r=0,o=e.length;r<o;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;_m.subVectors(e,this.center);const t=_m.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.addScaledVector(_m,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(J_.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(_m.copy(e.center).add(J_)),this.expandByPoint(_m.copy(e.center).sub(J_))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const wl=new J,q_=new J,Vg=new J,Dc=new J,Q_=new J,Wg=new J,Z_=new J;class Jh{constructor(e=new J,t=new J(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,wl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=wl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(wl.copy(this.origin).addScaledVector(this.direction,t),wl.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){q_.copy(e).add(t).multiplyScalar(.5),Vg.copy(t).sub(e).normalize(),Dc.copy(this.origin).sub(q_);const r=e.distanceTo(t)*.5,o=-this.direction.dot(Vg),a=Dc.dot(this.direction),l=-Dc.dot(Vg),c=Dc.lengthSq(),h=Math.abs(1-o*o);let f,p,y,v;if(h>0)if(f=o*l-a,p=o*a-l,v=r*h,f>=0)if(p>=-v)if(p<=v){const _=1/h;f*=_,p*=_,y=f*(f+o*p+2*a)+p*(o*f+p+2*l)+c}else p=r,f=Math.max(0,-(o*p+a)),y=-f*f+p*(p+2*l)+c;else p=-r,f=Math.max(0,-(o*p+a)),y=-f*f+p*(p+2*l)+c;else p<=-v?(f=Math.max(0,-(-o*r+a)),p=f>0?-r:Math.min(Math.max(-r,-l),r),y=-f*f+p*(p+2*l)+c):p<=v?(f=0,p=Math.min(Math.max(-r,-l),r),y=p*(p+2*l)+c):(f=Math.max(0,-(o*r+a)),p=f>0?r:Math.min(Math.max(-r,-l),r),y=-f*f+p*(p+2*l)+c);else p=o>0?-r:r,f=Math.max(0,-(o*p+a)),y=-f*f+p*(p+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,f),i&&i.copy(q_).addScaledVector(Vg,p),y}intersectSphere(e,t){wl.subVectors(e.center,this.origin);const n=wl.dot(this.direction),i=wl.dot(wl)-n*n,r=e.radius*e.radius;if(i>r)return null;const o=Math.sqrt(r-i),a=n-o,l=n+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,o,a,l;const c=1/this.direction.x,h=1/this.direction.y,f=1/this.direction.z,p=this.origin;return c>=0?(n=(e.min.x-p.x)*c,i=(e.max.x-p.x)*c):(n=(e.max.x-p.x)*c,i=(e.min.x-p.x)*c),h>=0?(r=(e.min.y-p.y)*h,o=(e.max.y-p.y)*h):(r=(e.max.y-p.y)*h,o=(e.min.y-p.y)*h),n>o||r>i||((r>n||isNaN(n))&&(n=r),(o<i||isNaN(i))&&(i=o),f>=0?(a=(e.min.z-p.z)*f,l=(e.max.z-p.z)*f):(a=(e.max.z-p.z)*f,l=(e.min.z-p.z)*f),n>l||a>i)||((a>n||n!==n)&&(n=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,wl)!==null}intersectTriangle(e,t,n,i,r){Q_.subVectors(t,e),Wg.subVectors(n,e),Z_.crossVectors(Q_,Wg);let o=this.direction.dot(Z_),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Dc.subVectors(this.origin,e);const l=a*this.direction.dot(Wg.crossVectors(Dc,Wg));if(l<0)return null;const c=a*this.direction.dot(Q_.cross(Dc));if(c<0||l+c>o)return null;const h=-a*Dc.dot(Z_);return h<0?null:this.at(h/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Kt{constructor(e,t,n,i,r,o,a,l,c,h,f,p,y,v,_,S){Kt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,i,r,o,a,l,c,h,f,p,y,v,_,S)}set(e,t,n,i,r,o,a,l,c,h,f,p,y,v,_,S){const A=this.elements;return A[0]=e,A[4]=t,A[8]=n,A[12]=i,A[1]=r,A[5]=o,A[9]=a,A[13]=l,A[2]=c,A[6]=h,A[10]=f,A[14]=p,A[3]=y,A[7]=v,A[11]=_,A[15]=S,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Kt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/uf.setFromMatrixColumn(e,0).length(),r=1/uf.setFromMatrixColumn(e,1).length(),o=1/uf.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(i),c=Math.sin(i),h=Math.cos(r),f=Math.sin(r);if(e.order==="XYZ"){const p=o*h,y=o*f,v=a*h,_=a*f;t[0]=l*h,t[4]=-l*f,t[8]=c,t[1]=y+v*c,t[5]=p-_*c,t[9]=-a*l,t[2]=_-p*c,t[6]=v+y*c,t[10]=o*l}else if(e.order==="YXZ"){const p=l*h,y=l*f,v=c*h,_=c*f;t[0]=p+_*a,t[4]=v*a-y,t[8]=o*c,t[1]=o*f,t[5]=o*h,t[9]=-a,t[2]=y*a-v,t[6]=_+p*a,t[10]=o*l}else if(e.order==="ZXY"){const p=l*h,y=l*f,v=c*h,_=c*f;t[0]=p-_*a,t[4]=-o*f,t[8]=v+y*a,t[1]=y+v*a,t[5]=o*h,t[9]=_-p*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const p=o*h,y=o*f,v=a*h,_=a*f;t[0]=l*h,t[4]=v*c-y,t[8]=p*c+_,t[1]=l*f,t[5]=_*c+p,t[9]=y*c-v,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const p=o*l,y=o*c,v=a*l,_=a*c;t[0]=l*h,t[4]=_-p*f,t[8]=v*f+y,t[1]=f,t[5]=o*h,t[9]=-a*h,t[2]=-c*h,t[6]=y*f+v,t[10]=p-_*f}else if(e.order==="XZY"){const p=o*l,y=o*c,v=a*l,_=a*c;t[0]=l*h,t[4]=-f,t[8]=c*h,t[1]=p*f+_,t[5]=o*h,t[9]=y*f-v,t[2]=v*f-y,t[6]=a*h,t[10]=_*f+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(XB,e,$B)}lookAt(e,t,n){const i=this.elements;return Hs.subVectors(e,t),Hs.lengthSq()===0&&(Hs.z=1),Hs.normalize(),Oc.crossVectors(n,Hs),Oc.lengthSq()===0&&(Math.abs(n.z)===1?Hs.x+=1e-4:Hs.z+=1e-4,Hs.normalize(),Oc.crossVectors(n,Hs)),Oc.normalize(),Kg.crossVectors(Hs,Oc),i[0]=Oc.x,i[4]=Kg.x,i[8]=Hs.x,i[1]=Oc.y,i[5]=Kg.y,i[9]=Hs.y,i[2]=Oc.z,i[6]=Kg.z,i[10]=Hs.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],h=n[1],f=n[5],p=n[9],y=n[13],v=n[2],_=n[6],S=n[10],A=n[14],w=n[3],M=n[7],C=n[11],I=n[15],O=i[0],k=i[4],N=i[8],B=i[12],P=i[1],G=i[5],Z=i[9],Y=i[13],se=i[2],oe=i[6],re=i[10],ce=i[14],H=i[3],$=i[7],X=i[11],W=i[15];return r[0]=o*O+a*P+l*se+c*H,r[4]=o*k+a*G+l*oe+c*$,r[8]=o*N+a*Z+l*re+c*X,r[12]=o*B+a*Y+l*ce+c*W,r[1]=h*O+f*P+p*se+y*H,r[5]=h*k+f*G+p*oe+y*$,r[9]=h*N+f*Z+p*re+y*X,r[13]=h*B+f*Y+p*ce+y*W,r[2]=v*O+_*P+S*se+A*H,r[6]=v*k+_*G+S*oe+A*$,r[10]=v*N+_*Z+S*re+A*X,r[14]=v*B+_*Y+S*ce+A*W,r[3]=w*O+M*P+C*se+I*H,r[7]=w*k+M*G+C*oe+I*$,r[11]=w*N+M*Z+C*re+I*X,r[15]=w*B+M*Y+C*ce+I*W,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],a=e[5],l=e[9],c=e[13],h=e[2],f=e[6],p=e[10],y=e[14],v=e[3],_=e[7],S=e[11],A=e[15];return v*(+r*l*f-i*c*f-r*a*p+n*c*p+i*a*y-n*l*y)+_*(+t*l*y-t*c*p+r*o*p-i*o*y+i*c*h-r*l*h)+S*(+t*c*f-t*a*y-r*o*f+n*o*y+r*a*h-n*c*h)+A*(-i*a*h-t*l*f+t*a*p+i*o*f-n*o*p+n*l*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],f=e[9],p=e[10],y=e[11],v=e[12],_=e[13],S=e[14],A=e[15],w=f*S*c-_*p*c+_*l*y-a*S*y-f*l*A+a*p*A,M=v*p*c-h*S*c-v*l*y+o*S*y+h*l*A-o*p*A,C=h*_*c-v*f*c+v*a*y-o*_*y-h*a*A+o*f*A,I=v*f*l-h*_*l-v*a*p+o*_*p+h*a*S-o*f*S,O=t*w+n*M+i*C+r*I;if(O===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const k=1/O;return e[0]=w*k,e[1]=(_*p*r-f*S*r-_*i*y+n*S*y+f*i*A-n*p*A)*k,e[2]=(a*S*r-_*l*r+_*i*c-n*S*c-a*i*A+n*l*A)*k,e[3]=(f*l*r-a*p*r-f*i*c+n*p*c+a*i*y-n*l*y)*k,e[4]=M*k,e[5]=(h*S*r-v*p*r+v*i*y-t*S*y-h*i*A+t*p*A)*k,e[6]=(v*l*r-o*S*r-v*i*c+t*S*c+o*i*A-t*l*A)*k,e[7]=(o*p*r-h*l*r+h*i*c-t*p*c-o*i*y+t*l*y)*k,e[8]=C*k,e[9]=(v*f*r-h*_*r-v*n*y+t*_*y+h*n*A-t*f*A)*k,e[10]=(o*_*r-v*a*r+v*n*c-t*_*c-o*n*A+t*a*A)*k,e[11]=(h*a*r-o*f*r-h*n*c+t*f*c+o*n*y-t*a*y)*k,e[12]=I*k,e[13]=(h*_*i-v*f*i+v*n*p-t*_*p-h*n*S+t*f*S)*k,e[14]=(v*a*i-o*_*i-v*n*l+t*_*l+o*n*S-t*a*S)*k,e[15]=(o*f*i-h*a*i+h*n*l-t*f*l-o*n*p+t*a*p)*k,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,a=e.y,l=e.z,c=r*o,h=r*a;return this.set(c*o+n,c*a-i*l,c*l+i*a,0,c*a+i*l,h*a+n,h*l-i*o,0,c*l-i*a,h*l+i*o,r*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,o){return this.set(1,n,r,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,o=t._y,a=t._z,l=t._w,c=r+r,h=o+o,f=a+a,p=r*c,y=r*h,v=r*f,_=o*h,S=o*f,A=a*f,w=l*c,M=l*h,C=l*f,I=n.x,O=n.y,k=n.z;return i[0]=(1-(_+A))*I,i[1]=(y+C)*I,i[2]=(v-M)*I,i[3]=0,i[4]=(y-C)*O,i[5]=(1-(p+A))*O,i[6]=(S+w)*O,i[7]=0,i[8]=(v+M)*k,i[9]=(S-w)*k,i[10]=(1-(p+_))*k,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=uf.set(i[0],i[1],i[2]).length();const o=uf.set(i[4],i[5],i[6]).length(),a=uf.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],Zo.copy(this);const c=1/r,h=1/o,f=1/a;return Zo.elements[0]*=c,Zo.elements[1]*=c,Zo.elements[2]*=c,Zo.elements[4]*=h,Zo.elements[5]*=h,Zo.elements[6]*=h,Zo.elements[8]*=f,Zo.elements[9]*=f,Zo.elements[10]*=f,t.setFromRotationMatrix(Zo),n.x=r,n.y=o,n.z=a,this}makePerspective(e,t,n,i,r,o,a=Ia){const l=this.elements,c=2*r/(t-e),h=2*r/(n-i),f=(t+e)/(t-e),p=(n+i)/(n-i);let y,v;if(a===Ia)y=-(o+r)/(o-r),v=-2*o*r/(o-r);else if(a===l0)y=-o/(o-r),v=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=h,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=y,l[14]=v,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,i,r,o,a=Ia){const l=this.elements,c=1/(t-e),h=1/(n-i),f=1/(o-r),p=(t+e)*c,y=(n+i)*h;let v,_;if(a===Ia)v=(o+r)*f,_=-2*f;else if(a===l0)v=r*f,_=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-y,l[2]=0,l[6]=0,l[10]=_,l[14]=-v,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const uf=new J,Zo=new Kt,XB=new J(0,0,0),$B=new J(1,1,1),Oc=new J,Kg=new J,Hs=new J,_w=new Kt,Sw=new hr;class Js{constructor(e=0,t=0,n=0,i=Js.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,r=i[0],o=i[4],a=i[8],l=i[1],c=i[5],h=i[9],f=i[2],p=i[6],y=i[10];switch(t){case"XYZ":this._y=Math.asin(nn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,y),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-nn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,y),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-f,r),this._z=0);break;case"ZXY":this._x=Math.asin(nn(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-f,y),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,r));break;case"ZYX":this._y=Math.asin(-nn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(p,y),this._z=Math.atan2(l,r)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(nn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-f,r)):(this._x=0,this._y=Math.atan2(a,y));break;case"XZY":this._z=Math.asin(-nn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-h,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return _w.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_w,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Sw.setFromEuler(this),this.setFromQuaternion(Sw,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Js.DEFAULT_ORDER="XYZ";class Ch{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let YB=0;const Aw=new J,hf=new hr,Ml=new Kt,Xg=new J,Sm=new J,JB=new J,qB=new hr,Ew=new J(1,0,0),Tw=new J(0,1,0),ww=new J(0,0,1),Mw={type:"added"},QB={type:"removed"},df={type:"childadded",child:null},e1={type:"childremoved",child:null};class An extends Va{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:YB++}),this.uuid=$s(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=An.DEFAULT_UP.clone();const e=new J,t=new Js,n=new hr,i=new J(1,1,1);function r(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(r),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Kt},normalMatrix:{value:new on}}),this.matrix=new Kt,this.matrixWorld=new Kt,this.matrixAutoUpdate=An.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=An.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Ch,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return hf.setFromAxisAngle(e,t),this.quaternion.multiply(hf),this}rotateOnWorldAxis(e,t){return hf.setFromAxisAngle(e,t),this.quaternion.premultiply(hf),this}rotateX(e){return this.rotateOnAxis(Ew,e)}rotateY(e){return this.rotateOnAxis(Tw,e)}rotateZ(e){return this.rotateOnAxis(ww,e)}translateOnAxis(e,t){return Aw.copy(e).applyQuaternion(this.quaternion),this.position.add(Aw.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Ew,e)}translateY(e){return this.translateOnAxis(Tw,e)}translateZ(e){return this.translateOnAxis(ww,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ml.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Xg.copy(e):Xg.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Sm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ml.lookAt(Sm,Xg,this.up):Ml.lookAt(Xg,Sm,this.up),this.quaternion.setFromRotationMatrix(Ml),i&&(Ml.extractRotation(i.matrixWorld),hf.setFromRotationMatrix(Ml),this.quaternion.premultiply(hf.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Mw),df.child=e,this.dispatchEvent(df),df.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(QB),e1.child=e,this.dispatchEvent(e1),e1.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ml.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ml.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ml),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Mw),df.child=e,this.dispatchEvent(df),df.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sm,e,JB),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sm,qB,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function r(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,h=l.length;c<h;c++){const f=l[c];r(e.shapes,f)}else r(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(r(e.materials,this.material[l]));i.material=a}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(r(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),h=o(e.images),f=o(e.shapes),p=o(e.skeletons),y=o(e.animations),v=o(e.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),h.length>0&&(n.images=h),f.length>0&&(n.shapes=f),p.length>0&&(n.skeletons=p),y.length>0&&(n.animations=y),v.length>0&&(n.nodes=v)}return n.object=i,n;function o(a){const l=[];for(const c in a){const h=a[c];delete h.metadata,l.push(h)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}An.DEFAULT_UP=new J(0,1,0);An.DEFAULT_MATRIX_AUTO_UPDATE=!0;An.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ea=new J,bl=new J,t1=new J,Cl=new J,ff=new J,pf=new J,bw=new J,n1=new J,i1=new J,r1=new J,s1=new Cn,o1=new Cn,a1=new Cn;class Es{constructor(e=new J,t=new J,n=new J){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),ea.subVectors(e,t),i.cross(ea);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){ea.subVectors(i,t),bl.subVectors(n,t),t1.subVectors(e,t);const o=ea.dot(ea),a=ea.dot(bl),l=ea.dot(t1),c=bl.dot(bl),h=bl.dot(t1),f=o*c-a*a;if(f===0)return r.set(0,0,0),null;const p=1/f,y=(c*l-a*h)*p,v=(o*h-a*l)*p;return r.set(1-y-v,v,y)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Cl)===null?!1:Cl.x>=0&&Cl.y>=0&&Cl.x+Cl.y<=1}static getInterpolation(e,t,n,i,r,o,a,l){return this.getBarycoord(e,t,n,i,Cl)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(r,Cl.x),l.addScaledVector(o,Cl.y),l.addScaledVector(a,Cl.z),l)}static getInterpolatedAttribute(e,t,n,i,r,o){return s1.setScalar(0),o1.setScalar(0),a1.setScalar(0),s1.fromBufferAttribute(e,t),o1.fromBufferAttribute(e,n),a1.fromBufferAttribute(e,i),o.setScalar(0),o.addScaledVector(s1,r.x),o.addScaledVector(o1,r.y),o.addScaledVector(a1,r.z),o}static isFrontFacing(e,t,n,i){return ea.subVectors(n,t),bl.subVectors(e,t),ea.cross(bl).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ea.subVectors(this.c,this.b),bl.subVectors(this.a,this.b),ea.cross(bl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Es.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Es.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,r){return Es.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return Es.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Es.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let o,a;ff.subVectors(i,n),pf.subVectors(r,n),n1.subVectors(e,n);const l=ff.dot(n1),c=pf.dot(n1);if(l<=0&&c<=0)return t.copy(n);i1.subVectors(e,i);const h=ff.dot(i1),f=pf.dot(i1);if(h>=0&&f<=h)return t.copy(i);const p=l*f-h*c;if(p<=0&&l>=0&&h<=0)return o=l/(l-h),t.copy(n).addScaledVector(ff,o);r1.subVectors(e,r);const y=ff.dot(r1),v=pf.dot(r1);if(v>=0&&y<=v)return t.copy(r);const _=y*c-l*v;if(_<=0&&c>=0&&v<=0)return a=c/(c-v),t.copy(n).addScaledVector(pf,a);const S=h*v-y*f;if(S<=0&&f-h>=0&&y-v>=0)return bw.subVectors(r,i),a=(f-h)/(f-h+(y-v)),t.copy(i).addScaledVector(bw,a);const A=1/(S+_+p);return o=_*A,a=p*A,t.copy(n).addScaledVector(ff,o).addScaledVector(pf,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const gR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Bc={h:0,s:0,l:0},$g={h:0,s:0,l:0};function l1(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}class ut{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=As){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Mn.toWorkingColorSpace(this,t),this}setRGB(e,t,n,i=Mn.workingColorSpace){return this.r=e,this.g=t,this.b=n,Mn.toWorkingColorSpace(this,i),this}setHSL(e,t,n,i=Mn.workingColorSpace){if(e=ZA(e,1),t=nn(t,0,1),n=nn(n,0,1),t===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,o=2*n-r;this.r=l1(o,r,e+1/3),this.g=l1(o,r,e),this.b=l1(o,r,e-1/3)}return Mn.toWorkingColorSpace(this,i),this}setStyle(e,t=As){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=i[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=As){const n=gR[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Vl(e.r),this.g=Vl(e.g),this.b=Vl(e.b),this}copyLinearToSRGB(e){return this.r=Vf(e.r),this.g=Vf(e.g),this.b=Vf(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=As){return Mn.fromWorkingColorSpace(Or.copy(this),e),Math.round(nn(Or.r*255,0,255))*65536+Math.round(nn(Or.g*255,0,255))*256+Math.round(nn(Or.b*255,0,255))}getHexString(e=As){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Mn.workingColorSpace){Mn.fromWorkingColorSpace(Or.copy(this),t);const n=Or.r,i=Or.g,r=Or.b,o=Math.max(n,i,r),a=Math.min(n,i,r);let l,c;const h=(a+o)/2;if(a===o)l=0,c=0;else{const f=o-a;switch(c=h<=.5?f/(o+a):f/(2-o-a),o){case n:l=(i-r)/f+(i<r?6:0);break;case i:l=(r-n)/f+2;break;case r:l=(n-i)/f+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,t=Mn.workingColorSpace){return Mn.fromWorkingColorSpace(Or.copy(this),t),e.r=Or.r,e.g=Or.g,e.b=Or.b,e}getStyle(e=As){Mn.fromWorkingColorSpace(Or.copy(this),e);const t=Or.r,n=Or.g,i=Or.b;return e!==As?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(e,t,n){return this.getHSL(Bc),this.setHSL(Bc.h+e,Bc.s+t,Bc.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Bc),e.getHSL($g);const n=$m(Bc.h,$g.h,t),i=$m(Bc.s,$g.s,t),r=$m(Bc.l,$g.l,t);return this.setHSL(n,i,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*i,this.g=r[1]*t+r[4]*n+r[7]*i,this.b=r[2]*t+r[5]*n+r[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Or=new ut;ut.NAMES=gR;let ZB=0;class Ui extends Va{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ZB++}),this.uuid=$s(),this.name="",this.type="Material",this.blending=wh,this.side=Ga,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=pv,this.blendDst=mv,this.blendEquation=zc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ut(0,0,0),this.blendAlpha=0,this.depthFunc=Fh,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=GS,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=hh,this.stencilZFail=hh,this.stencilZPass=hh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==wh&&(n.blending=this.blending),this.side!==Ga&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==pv&&(n.blendSrc=this.blendSrc),this.blendDst!==mv&&(n.blendDst=this.blendDst),this.blendEquation!==zc&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Fh&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==GS&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==hh&&(n.stencilFail=this.stencilFail),this.stencilZFail!==hh&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==hh&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(r){const o=[];for(const a in r){const l=r[a];delete l.metadata,o.push(l)}return o}if(t){const r=i(e.textures),o=i(e.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let r=0;r!==i;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Ks extends Ui{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Js,this.combine=R0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ul=eF();function eF(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[l|256]=32768,i[l]=24,i[l|256]=24):c<-14?(n[l]=1024>>-c-14,n[l|256]=1024>>-c-14|32768,i[l]=-c-1,i[l|256]=-c-1):c<=15?(n[l]=c+15<<10,n[l|256]=c+15<<10|32768,i[l]=13,i[l|256]=13):c<128?(n[l]=31744,n[l|256]=64512,i[l]=24,i[l|256]=24):(n[l]=31744,n[l|256]=64512,i[l]=13,i[l|256]=13)}const r=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,h=0;for(;!(c&8388608);)c<<=1,h-=8388608;c&=-8388609,h+=947912704,r[l]=c|h}for(let l=1024;l<2048;++l)r[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:r,exponentTable:o,offsetTable:a}}function _s(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=nn(s,-65504,65504),Ul.floatView[0]=s;const e=Ul.uint32View[0],t=e>>23&511;return Ul.baseTable[t]+((e&8388607)>>Ul.shiftTable[t])}function km(s){const e=s>>10;return Ul.uint32View[0]=Ul.mantissaTable[Ul.offsetTable[e]+(s&1023)]+Ul.exponentTable[e],Ul.floatView[0]}const tF={toHalfFloat:_s,fromHalfFloat:km},Bi=new J,Yg=new Ue;class Rn{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=a0,this.updateRanges=[],this.gpuType=rs,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Yg.fromBufferAttribute(this,t),Yg.applyMatrix3(e),this.setXY(t,Yg.x,Yg.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Bi.fromBufferAttribute(this,t),Bi.applyMatrix3(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Bi.fromBufferAttribute(this,t),Bi.applyMatrix4(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Bi.fromBufferAttribute(this,t),Bi.applyNormalMatrix(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Bi.fromBufferAttribute(this,t),Bi.transformDirection(e),this.setXYZ(t,Bi.x,Bi.y,Bi.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=ns(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=hn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ns(t,this.array)),t}setX(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ns(t,this.array)),t}setY(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ns(t,this.array)),t}setZ(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ns(t,this.array)),t}setW(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),n=hn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),n=hn(n,this.array),i=hn(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),n=hn(n,this.array),i=hn(i,this.array),r=hn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==a0&&(e.usage=this.usage),e}}class nF extends Rn{constructor(e,t,n){super(new Int8Array(e),t,n)}}class iF extends Rn{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class rF extends Rn{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class sF extends Rn{constructor(e,t,n){super(new Int16Array(e),t,n)}}class tE extends Rn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class oF extends Rn{constructor(e,t,n){super(new Int32Array(e),t,n)}}class nE extends Rn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class aF extends Rn{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=km(this.array[e*this.itemSize]);return this.normalized&&(t=ns(t,this.array)),t}setX(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize]=_s(t),this}getY(e){let t=km(this.array[e*this.itemSize+1]);return this.normalized&&(t=ns(t,this.array)),t}setY(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+1]=_s(t),this}getZ(e){let t=km(this.array[e*this.itemSize+2]);return this.normalized&&(t=ns(t,this.array)),t}setZ(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+2]=_s(t),this}getW(e){let t=km(this.array[e*this.itemSize+3]);return this.normalized&&(t=ns(t,this.array)),t}setW(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+3]=_s(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),n=hn(n,this.array)),this.array[e+0]=_s(t),this.array[e+1]=_s(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),n=hn(n,this.array),i=hn(i,this.array)),this.array[e+0]=_s(t),this.array[e+1]=_s(n),this.array[e+2]=_s(i),this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),n=hn(n,this.array),i=hn(i,this.array),r=hn(r,this.array)),this.array[e+0]=_s(t),this.array[e+1]=_s(n),this.array[e+2]=_s(i),this.array[e+3]=_s(r),this}}class Dt extends Rn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let lF=0;const po=new Kt,c1=new An,mf=new J,zs=new wr,Am=new wr,or=new J;class rn extends Va{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:lF++}),this.uuid=$s(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(dR(e)?nE:tE)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new on().getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return po.makeRotationFromQuaternion(e),this.applyMatrix4(po),this}rotateX(e){return po.makeRotationX(e),this.applyMatrix4(po),this}rotateY(e){return po.makeRotationY(e),this.applyMatrix4(po),this}rotateZ(e){return po.makeRotationZ(e),this.applyMatrix4(po),this}translate(e,t,n){return po.makeTranslation(e,t,n),this.applyMatrix4(po),this}scale(e,t,n){return po.makeScale(e,t,n),this.applyMatrix4(po),this}lookAt(e){return c1.lookAt(e),c1.updateMatrix(),this.applyMatrix4(c1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(mf).negate(),this.translate(mf.x,mf.y,mf.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let i=0,r=e.length;i<r;i++){const o=e[i];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Dt(n,3))}else{const n=Math.min(e.length,t.count);for(let i=0;i<n;i++){const r=e[i];t.setXYZ(i,r.x,r.y,r.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new wr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new J(-1/0,-1/0,-1/0),new J(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const r=t[n];zs.setFromBufferAttribute(r),this.morphTargetsRelative?(or.addVectors(this.boundingBox.min,zs.min),this.boundingBox.expandByPoint(or),or.addVectors(this.boundingBox.max,zs.max),this.boundingBox.expandByPoint(or)):(this.boundingBox.expandByPoint(zs.min),this.boundingBox.expandByPoint(zs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new dr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new J,1/0);return}if(e){const n=this.boundingSphere.center;if(zs.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++){const a=t[r];Am.setFromBufferAttribute(a),this.morphTargetsRelative?(or.addVectors(zs.min,Am.min),zs.expandByPoint(or),or.addVectors(zs.max,Am.max),zs.expandByPoint(or)):(zs.expandByPoint(Am.min),zs.expandByPoint(Am.max))}zs.getCenter(n);let i=0;for(let r=0,o=e.count;r<o;r++)or.fromBufferAttribute(e,r),i=Math.max(i,n.distanceToSquared(or));if(t)for(let r=0,o=t.length;r<o;r++){const a=t[r],l=this.morphTargetsRelative;for(let c=0,h=a.count;c<h;c++)or.fromBufferAttribute(a,c),l&&(mf.fromBufferAttribute(e,c),or.add(mf)),i=Math.max(i,n.distanceToSquared(or))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,i=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Rn(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let N=0;N<n.count;N++)a[N]=new J,l[N]=new J;const c=new J,h=new J,f=new J,p=new Ue,y=new Ue,v=new Ue,_=new J,S=new J;function A(N,B,P){c.fromBufferAttribute(n,N),h.fromBufferAttribute(n,B),f.fromBufferAttribute(n,P),p.fromBufferAttribute(r,N),y.fromBufferAttribute(r,B),v.fromBufferAttribute(r,P),h.sub(c),f.sub(c),y.sub(p),v.sub(p);const G=1/(y.x*v.y-v.x*y.y);isFinite(G)&&(_.copy(h).multiplyScalar(v.y).addScaledVector(f,-y.y).multiplyScalar(G),S.copy(f).multiplyScalar(y.x).addScaledVector(h,-v.x).multiplyScalar(G),a[N].add(_),a[B].add(_),a[P].add(_),l[N].add(S),l[B].add(S),l[P].add(S))}let w=this.groups;w.length===0&&(w=[{start:0,count:e.count}]);for(let N=0,B=w.length;N<B;++N){const P=w[N],G=P.start,Z=P.count;for(let Y=G,se=G+Z;Y<se;Y+=3)A(e.getX(Y+0),e.getX(Y+1),e.getX(Y+2))}const M=new J,C=new J,I=new J,O=new J;function k(N){I.fromBufferAttribute(i,N),O.copy(I);const B=a[N];M.copy(B),M.sub(I.multiplyScalar(I.dot(B))).normalize(),C.crossVectors(O,B);const G=C.dot(l[N])<0?-1:1;o.setXYZW(N,M.x,M.y,M.z,G)}for(let N=0,B=w.length;N<B;++N){const P=w[N],G=P.start,Z=P.count;for(let Y=G,se=G+Z;Y<se;Y+=3)k(e.getX(Y+0)),k(e.getX(Y+1)),k(e.getX(Y+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Rn(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let p=0,y=n.count;p<y;p++)n.setXYZ(p,0,0,0);const i=new J,r=new J,o=new J,a=new J,l=new J,c=new J,h=new J,f=new J;if(e)for(let p=0,y=e.count;p<y;p+=3){const v=e.getX(p+0),_=e.getX(p+1),S=e.getX(p+2);i.fromBufferAttribute(t,v),r.fromBufferAttribute(t,_),o.fromBufferAttribute(t,S),h.subVectors(o,r),f.subVectors(i,r),h.cross(f),a.fromBufferAttribute(n,v),l.fromBufferAttribute(n,_),c.fromBufferAttribute(n,S),a.add(h),l.add(h),c.add(h),n.setXYZ(v,a.x,a.y,a.z),n.setXYZ(_,l.x,l.y,l.z),n.setXYZ(S,c.x,c.y,c.z)}else for(let p=0,y=t.count;p<y;p+=3)i.fromBufferAttribute(t,p+0),r.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),h.subVectors(o,r),f.subVectors(i,r),h.cross(f),n.setXYZ(p+0,h.x,h.y,h.z),n.setXYZ(p+1,h.x,h.y,h.z),n.setXYZ(p+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)or.fromBufferAttribute(e,t),or.normalize(),e.setXYZ(t,or.x,or.y,or.z)}toNonIndexed(){function e(a,l){const c=a.array,h=a.itemSize,f=a.normalized,p=new c.constructor(l.length*h);let y=0,v=0;for(let _=0,S=l.length;_<S;_++){a.isInterleavedBufferAttribute?y=l[_]*a.data.stride+a.offset:y=l[_]*h;for(let A=0;A<h;A++)p[v++]=c[y++]}return new Rn(p,h,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new rn,n=this.index.array,i=this.attributes;for(const a in i){const l=i[a],c=e(l,n);t.setAttribute(a,c)}const r=this.morphAttributes;for(const a in r){const l=[],c=r[a];for(let h=0,f=c.length;h<f;h++){const p=c[h],y=e(p,n);l.push(y)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const c=n[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let r=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let f=0,p=c.length;f<p;f++){const y=c[f];h.push(y.toJSON(e.data))}h.length>0&&(i[l]=h,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const i=e.attributes;for(const c in i){const h=i[c];this.setAttribute(c,h.clone(t))}const r=e.morphAttributes;for(const c in r){const h=[],f=r[c];for(let p=0,y=f.length;p<y;p++)h.push(f[p].clone(t));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,h=o.length;c<h;c++){const f=o[c];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Cw=new Kt,$u=new Jh,Jg=new dr,Rw=new J,qg=new J,Qg=new J,Zg=new J,u1=new J,ey=new J,Iw=new J,ty=new J;class Ci extends An{constructor(e=new rn,t=new Ks){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){const a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(r&&a){ey.set(0,0,0);for(let l=0,c=r.length;l<c;l++){const h=a[l],f=r[l];h!==0&&(u1.fromBufferAttribute(f,e),o?ey.addScaledVector(u1,h):ey.addScaledVector(u1.sub(t),h))}t.add(ey)}return t}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Jg.copy(n.boundingSphere),Jg.applyMatrix4(r),$u.copy(e.ray).recast(e.near),!(Jg.containsPoint($u.origin)===!1&&($u.intersectSphere(Jg,Rw)===null||$u.origin.distanceToSquared(Rw)>(e.far-e.near)**2))&&(Cw.copy(r).invert(),$u.copy(e.ray).applyMatrix4(Cw),!(n.boundingBox!==null&&$u.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,$u)))}_computeIntersections(e,t,n){let i;const r=this.geometry,o=this.material,a=r.index,l=r.attributes.position,c=r.attributes.uv,h=r.attributes.uv1,f=r.attributes.normal,p=r.groups,y=r.drawRange;if(a!==null)if(Array.isArray(o))for(let v=0,_=p.length;v<_;v++){const S=p[v],A=o[S.materialIndex],w=Math.max(S.start,y.start),M=Math.min(a.count,Math.min(S.start+S.count,y.start+y.count));for(let C=w,I=M;C<I;C+=3){const O=a.getX(C),k=a.getX(C+1),N=a.getX(C+2);i=ny(this,A,e,n,c,h,f,O,k,N),i&&(i.faceIndex=Math.floor(C/3),i.face.materialIndex=S.materialIndex,t.push(i))}}else{const v=Math.max(0,y.start),_=Math.min(a.count,y.start+y.count);for(let S=v,A=_;S<A;S+=3){const w=a.getX(S),M=a.getX(S+1),C=a.getX(S+2);i=ny(this,o,e,n,c,h,f,w,M,C),i&&(i.faceIndex=Math.floor(S/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let v=0,_=p.length;v<_;v++){const S=p[v],A=o[S.materialIndex],w=Math.max(S.start,y.start),M=Math.min(l.count,Math.min(S.start+S.count,y.start+y.count));for(let C=w,I=M;C<I;C+=3){const O=C,k=C+1,N=C+2;i=ny(this,A,e,n,c,h,f,O,k,N),i&&(i.faceIndex=Math.floor(C/3),i.face.materialIndex=S.materialIndex,t.push(i))}}else{const v=Math.max(0,y.start),_=Math.min(l.count,y.start+y.count);for(let S=v,A=_;S<A;S+=3){const w=S,M=S+1,C=S+2;i=ny(this,o,e,n,c,h,f,w,M,C),i&&(i.faceIndex=Math.floor(S/3),t.push(i))}}}}function cF(s,e,t,n,i,r,o,a){let l;if(e.side===ss?l=n.intersectTriangle(o,r,i,!0,a):l=n.intersectTriangle(i,r,o,e.side===Ga,a),l===null)return null;ty.copy(a),ty.applyMatrix4(s.matrixWorld);const c=t.ray.origin.distanceTo(ty);return c<t.near||c>t.far?null:{distance:c,point:ty.clone(),object:s}}function ny(s,e,t,n,i,r,o,a,l,c){s.getVertexPosition(a,qg),s.getVertexPosition(l,Qg),s.getVertexPosition(c,Zg);const h=cF(s,e,t,n,qg,Qg,Zg,Iw);if(h){const f=new J;Es.getBarycoord(Iw,qg,Qg,Zg,f),i&&(h.uv=Es.getInterpolatedAttribute(i,a,l,c,f,new Ue)),r&&(h.uv1=Es.getInterpolatedAttribute(r,a,l,c,f,new Ue)),o&&(h.normal=Es.getInterpolatedAttribute(o,a,l,c,f,new J),h.normal.dot(n.direction)>0&&h.normal.multiplyScalar(-1));const p={a,b:l,c,normal:new J,materialIndex:0};Es.getNormal(qg,Qg,Zg,p.normal),h.face=p,h.barycoord=f}return h}class qh extends rn{constructor(e=1,t=1,n=1,i=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};const a=this;i=Math.floor(i),r=Math.floor(r),o=Math.floor(o);const l=[],c=[],h=[],f=[];let p=0,y=0;v("z","y","x",-1,-1,n,t,e,o,r,0),v("z","y","x",1,-1,n,t,-e,o,r,1),v("x","z","y",1,1,e,n,t,i,o,2),v("x","z","y",1,-1,e,n,-t,i,o,3),v("x","y","z",1,-1,e,t,n,i,r,4),v("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(l),this.setAttribute("position",new Dt(c,3)),this.setAttribute("normal",new Dt(h,3)),this.setAttribute("uv",new Dt(f,2));function v(_,S,A,w,M,C,I,O,k,N,B){const P=C/k,G=I/N,Z=C/2,Y=I/2,se=O/2,oe=k+1,re=N+1;let ce=0,H=0;const $=new J;for(let X=0;X<re;X++){const W=X*G-Y;for(let ne=0;ne<oe;ne++){const Ee=ne*P-Z;$[_]=Ee*w,$[S]=W*M,$[A]=se,c.push($.x,$.y,$.z),$[_]=0,$[S]=0,$[A]=O>0?1:-1,h.push($.x,$.y,$.z),f.push(ne/k),f.push(1-X/N),ce+=1}}for(let X=0;X<N;X++)for(let W=0;W<k;W++){const ne=p+W+oe*X,Ee=p+W+oe*(X+1),le=p+(W+1)+oe*(X+1),ye=p+(W+1)+oe*X;l.push(ne,Ee,ye),l.push(Ee,le,ye),H+=6}a.addGroup(y,H,B),y+=H,p+=ce}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function tp(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const i=s[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function es(s){const e={};for(let t=0;t<s.length;t++){const n=tp(s[t]);for(const i in n)e[i]=n[i]}return e}function uF(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}function yR(s){const e=s.getRenderTarget();return e===null?s.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Mn.workingColorSpace}const vR={clone:tp,merge:es};var hF=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,dF=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class oa extends Ui{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=hF,this.fragmentShader=dF,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=tp(e.uniforms),this.uniformsGroups=uF(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class L0 extends An{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Kt,this.projectionMatrix=new Kt,this.projectionMatrixInverse=new Kt,this.coordinateSystem=Ia}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Fc=new J,Lw=new Ue,Pw=new Ue;let si=class extends L0{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=ep*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(bh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return ep*2*Math.atan(Math.tan(bh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Fc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Fc.x,Fc.y).multiplyScalar(-e/Fc.z),Fc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Fc.x,Fc.y).multiplyScalar(-e/Fc.z)}getViewSize(e,t){return this.getViewBounds(e,Lw,Pw),t.subVectors(Pw,Lw)}setViewOffset(e,t,n,i,r,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(bh*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;r+=o.offsetX*i/l,t-=o.offsetY*n/c,i*=o.width/l,n*=o.height/c}const a=this.filmOffset;a!==0&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const gf=-90,yf=1;class iE extends An{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new si(gf,yf,e,t);i.layers=this.layers,this.add(i);const r=new si(gf,yf,e,t);r.layers=this.layers,this.add(r);const o=new si(gf,yf,e,t);o.layers=this.layers,this.add(o);const a=new si(gf,yf,e,t);a.layers=this.layers,this.add(a);const l=new si(gf,yf,e,t);l.layers=this.layers,this.add(l);const c=new si(gf,yf,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,r,o,a,l]=t;for(const c of t)this.remove(c);if(e===Ia)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===l0)n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,o,a,l,c,h]=this.children,f=e.getRenderTarget(),p=e.getActiveCubeFace(),y=e.getActiveMipmapLevel(),v=e.xr.enabled;e.xr.enabled=!1;const _=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,r),e.setRenderTarget(n,1,i),e.render(t,o),e.setRenderTarget(n,2,i),e.render(t,a),e.setRenderTarget(n,3,i),e.render(t,l),e.setRenderTarget(n,4,i),e.render(t,c),n.texture.generateMipmaps=_,e.setRenderTarget(n,5,i),e.render(t,h),e.setRenderTarget(f,p,y),e.xr.enabled=v,n.texture.needsPMREMUpdate=!0}}class P0 extends ei{constructor(e,t,n,i,r,o,a,l,c,h){e=e!==void 0?e:[],t=t!==void 0?t:Kl,super(e,t,n,i,r,o,a,l,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class rE extends wo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new P0(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:pi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new qh(5,5,5),r=new oa({name:"CubemapFromEquirect",uniforms:tp(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:ss,blending:jl});r.uniforms.tEquirect.value=t;const o=new Ci(i,r),a=t.minFilter;return t.minFilter===Ao&&(t.minFilter=pi),new iE(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,i){const r=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,i);e.setRenderTarget(r)}}class Ox{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new ut(e),this.density=t}clone(){return new Ox(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Bx{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new ut(e),this.near=t,this.far=n}clone(){return new Bx(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Jv extends An{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Js,this.environmentIntensity=1,this.environmentRotation=new Js,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class D0{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=a0,this.updateRanges=[],this.version=0,this.uuid=$s()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=$s()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=$s()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Zr=new J;class Zc{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Zr.fromBufferAttribute(this,t),Zr.applyMatrix4(e),this.setXYZ(t,Zr.x,Zr.y,Zr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Zr.fromBufferAttribute(this,t),Zr.applyNormalMatrix(e),this.setXYZ(t,Zr.x,Zr.y,Zr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Zr.fromBufferAttribute(this,t),Zr.transformDirection(e),this.setXYZ(t,Zr.x,Zr.y,Zr.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=ns(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=hn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ns(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ns(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ns(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ns(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),n=hn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),n=hn(n,this.array),i=hn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),n=hn(n,this.array),i=hn(i,this.array),r=hn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[i+r])}return new Rn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Zc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[i+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class sE extends Ui{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ut(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let vf;const Em=new J,xf=new J,_f=new J,Sf=new Ue,Tm=new Ue,xR=new Kt,iy=new J,wm=new J,ry=new J,Dw=new Ue,h1=new Ue,Ow=new Ue;class _R extends An{constructor(e=new sE){if(super(),this.isSprite=!0,this.type="Sprite",vf===void 0){vf=new rn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new D0(t,5);vf.setIndex([0,1,2,0,2,3]),vf.setAttribute("position",new Zc(n,3,0,!1)),vf.setAttribute("uv",new Zc(n,2,3,!1))}this.geometry=vf,this.material=e,this.center=new Ue(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),xf.setFromMatrixScale(this.matrixWorld),xR.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),_f.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&xf.multiplyScalar(-_f.z);const n=this.material.rotation;let i,r;n!==0&&(r=Math.cos(n),i=Math.sin(n));const o=this.center;sy(iy.set(-.5,-.5,0),_f,o,xf,i,r),sy(wm.set(.5,-.5,0),_f,o,xf,i,r),sy(ry.set(.5,.5,0),_f,o,xf,i,r),Dw.set(0,0),h1.set(1,0),Ow.set(1,1);let a=e.ray.intersectTriangle(iy,wm,ry,!1,Em);if(a===null&&(sy(wm.set(-.5,.5,0),_f,o,xf,i,r),h1.set(0,1),a=e.ray.intersectTriangle(iy,ry,wm,!1,Em),a===null))return;const l=e.ray.origin.distanceTo(Em);l<e.near||l>e.far||t.push({distance:l,point:Em.clone(),uv:Es.getInterpolation(Em,iy,wm,ry,Dw,h1,Ow,new Ue),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function sy(s,e,t,n,i,r){Sf.subVectors(s,t).addScalar(.5).multiply(n),i!==void 0?(Tm.x=r*Sf.x-i*Sf.y,Tm.y=i*Sf.x+r*Sf.y):Tm.copy(Sf),s.copy(e),s.x+=Tm.x,s.y+=Tm.y,s.applyMatrix4(xR)}const oy=new J,Bw=new J;class SR extends An{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const r=t[n];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const i=this.levels;let r;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const i=t.splice(n,1);return this.remove(i[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){oy.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(oy);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){oy.setFromMatrixPosition(e.matrixWorld),Bw.setFromMatrixPosition(this.matrixWorld);const n=oy.distanceTo(Bw)/e.zoom;t[0].object.visible=!0;let i,r;for(i=1,r=t.length;i<r;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),n>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,r=n.length;i<r;i++){const o=n[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const Fw=new J,kw=new Cn,Nw=new Cn,fF=new J,Uw=new Kt,ay=new J,d1=new dr,Gw=new Kt,f1=new Jh;class oE extends Ci{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=US,this.bindMatrix=new Kt,this.bindMatrixInverse=new Kt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new wr),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,ay),this.boundingBox.expandByPoint(ay)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new dr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,ay),this.boundingSphere.expandByPoint(ay)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,i=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),d1.copy(this.boundingSphere),d1.applyMatrix4(i),e.ray.intersectsSphere(d1)!==!1&&(Gw.copy(i).invert(),f1.copy(e.ray).applyMatrix4(Gw),!(this.boundingBox!==null&&f1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,f1)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Cn,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===US?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===JC?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;kw.fromBufferAttribute(i.attributes.skinIndex,e),Nw.fromBufferAttribute(i.attributes.skinWeight,e),Fw.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const o=Nw.getComponent(r);if(o!==0){const a=kw.getComponent(r);Uw.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(fF.copy(Fw).applyMatrix4(Uw),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Fx extends An{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ba extends ei{constructor(e=null,t=1,n=1,i,r,o,a,l,c=ur,h=ur,f,p){super(null,o,a,l,c,h,i,r,f,p),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Hw=new Kt,pF=new Kt;class O0{constructor(e=[],t=[]){this.uuid=$s(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Kt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Kt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,o=e.length;r<o;r++){const a=e[r]?e[r].matrixWorld:pF;Hw.multiplyMatrices(a,t[r]),Hw.toArray(n,r*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new O0(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Ba(t,e,e,Nr,rs);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const r=e.bones[n];let o=t[r];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),o=new Fx),this.bones.push(o),this.boneInverses.push(new Kt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){const o=t[i];e.bones.push(o.uuid);const a=n[i];e.boneInverses.push(a.toArray())}return e}}class Gh extends Rn{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Af=new Kt,zw=new Kt,ly=[],jw=new wr,mF=new Kt,Mm=new Ci,bm=new dr;class aE extends Ci{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Gh(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,mF)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new wr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Af),jw.copy(e.boundingBox).applyMatrix4(Af),this.boundingBox.union(jw)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new dr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Af),bm.copy(e.boundingSphere).applyMatrix4(Af),this.boundingSphere.union(bm)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,i=this.morphTexture.source.data.data,r=n.length+1,o=e*r+1;for(let a=0;a<n.length;a++)n[a]=i[o+a]}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Mm.geometry=this.geometry,Mm.material=this.material,Mm.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),bm.copy(this.boundingSphere),bm.applyMatrix4(n),e.ray.intersectsSphere(bm)!==!1))for(let r=0;r<i;r++){this.getMatrixAt(r,Af),zw.multiplyMatrices(n,Af),Mm.matrixWorld=zw,Mm.raycast(e,ly);for(let o=0,a=ly.length;o<a;o++){const l=ly[o];l.instanceId=r,l.object=this,t.push(l)}ly.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Gh(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,i=n.length+1;this.morphTexture===null&&(this.morphTexture=new Ba(new Float32Array(i*this.count),i,this.count,Rx,rs));const r=this.morphTexture.source.data.data;let o=0;for(let c=0;c<n.length;c++)o+=n[c];const a=this.geometry.morphTargetsRelative?1:1-o,l=i*e;r[l]=a,r.set(n,l+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}const p1=new J,gF=new J,yF=new on;class Fl{constructor(e=new J(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=p1.subVectors(n,t).cross(gF.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(p1),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||yF.getNormalMatrix(e),i=this.coplanarPoint(p1).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Yu=new dr,cy=new J;class B0{constructor(e=new Fl,t=new Fl,n=new Fl,i=new Fl,r=new Fl,o=new Fl){this.planes=[e,t,n,i,r,o]}set(e,t,n,i,r,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Ia){const n=this.planes,i=e.elements,r=i[0],o=i[1],a=i[2],l=i[3],c=i[4],h=i[5],f=i[6],p=i[7],y=i[8],v=i[9],_=i[10],S=i[11],A=i[12],w=i[13],M=i[14],C=i[15];if(n[0].setComponents(l-r,p-c,S-y,C-A).normalize(),n[1].setComponents(l+r,p+c,S+y,C+A).normalize(),n[2].setComponents(l+o,p+h,S+v,C+w).normalize(),n[3].setComponents(l-o,p-h,S-v,C-w).normalize(),n[4].setComponents(l-a,p-f,S-_,C-M).normalize(),t===Ia)n[5].setComponents(l+a,p+f,S+_,C+M).normalize();else if(t===l0)n[5].setComponents(a,f,_,M).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Yu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Yu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Yu)}intersectsSprite(e){return Yu.center.set(0,0,0),Yu.radius=.7071067811865476,Yu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Yu)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(cy.x=i.normal.x>0?e.max.x:e.min.x,cy.y=i.normal.y>0?e.max.y:e.min.y,cy.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(cy)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function m1(s,e){return s-e}function vF(s,e){return s.z-e.z}function xF(s,e){return e.z-s.z}class _F{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,i){const r=this.pool,o=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const a=r[this.index];o.push(a),this.index++,a.start=e,a.count=t,a.z=n,a.index=i}reset(){this.list.length=0,this.index=0}}const xs=new Kt,SF=new ut(1,1,1),g1=new B0,uy=new wr,Ju=new dr,Cm=new J,Vw=new J,AF=new J,y1=new _F,Br=new Ci,hy=[];function EF(s,e,t=0){const n=e.itemSize;if(s.isInterleavedBufferAttribute||s.array.constructor!==e.array.constructor){const i=s.count;for(let r=0;r<i;r++)for(let o=0;o<n;o++)e.setComponent(r+t,o,s.getComponent(r,o))}else e.array.set(s.array,t*n);e.needsUpdate=!0}function qu(s,e){if(s.constructor!==e.constructor){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++)e[n]=s[n]}else{const t=Math.min(s.length,e.length);e.set(new s.constructor(s.buffer,0,t))}}class AR extends Ci{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}constructor(e,t,n=t*2,i){super(new rn,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Ba(t,e,e,Nr,rs);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Ba(t,e,e,I0,Xl);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Ba(t,e,e,Nr,rs);n.colorSpace=Mn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const r in e.attributes){const o=e.getAttribute(r),{array:a,itemSize:l,normalized:c}=o,h=new a.constructor(n*l),f=new Rn(h,l,c);t.setAttribute(r,f)}if(e.getIndex()!==null){const r=n>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new Rn(r,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const i=e.getAttribute(n),r=t.getAttribute(n);if(i.itemSize!==r.itemSize||i.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new wr);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,xs),this.getBoundingBoxAt(r,uy).applyMatrix4(xs),e.union(uy)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new dr);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(t[n].active===!1)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,xs),this.getBoundingSphereAt(r,Ju).applyMatrix4(xs),e.union(Ju)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let i=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(m1),i=this._availableInstanceIds.shift(),this._instanceInfo[i]=n):(i=this._instanceInfo.length,this._instanceInfo.push(n));const r=this._matricesTexture;xs.identity().toArray(r.image.data,i*16),r.needsUpdate=!0;const o=this._colorsTexture;return o&&(SF.toArray(o.image.data,i*4),o.needsUpdate=!0),this._visibilityChanged=!0,i}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const o=e.getIndex();if(o!==null&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=n===-1?o.count:n),i.indexStart!==-1&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(m1),l=this._availableGeometryIds.shift(),r[l]=i):(l=this._geometryCount,this._geometryCount++,r.push(i)),this.setGeometryAt(l,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,l}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,i=n.getIndex()!==null,r=n.getIndex(),o=t.getIndex(),a=this._geometryInfo[e];if(i&&o.count>a.reservedIndexCount||t.attributes.position.count>a.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,c=a.reservedVertexCount;a.vertexCount=t.getAttribute("position").count;for(const h in n.attributes){const f=t.getAttribute(h),p=n.getAttribute(h);EF(f,p,l);const y=f.itemSize;for(let v=f.count,_=c;v<_;v++){const S=l+v;for(let A=0;A<y;A++)p.setComponent(S,A,0)}p.needsUpdate=!0,p.addUpdateRange(l*y,c*y)}if(i){const h=a.indexStart,f=a.reservedIndexCount;a.indexCount=t.getIndex().count;for(let p=0;p<o.count;p++)r.setX(h+p,l+o.getX(p));for(let p=o.count,y=f;p<y;p++)r.setX(h+p,l);r.needsUpdate=!0,r.addUpdateRange(h,a.reservedIndexCount)}return a.start=i?a.indexStart:a.vertexStart,a.count=i?a.indexCount:a.vertexCount,a.boundingBox=null,t.boundingBox!==null&&(a.boundingBox=t.boundingBox.clone()),a.boundingSphere=null,t.boundingSphere!==null&&(a.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let i=0,r=n.length;i<r;i++)n[i].geometryIndex===e&&this.deleteInstance(i);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,i=n.map((o,a)=>a).sort((o,a)=>n[o].vertexStart-n[a].vertexStart),r=this.geometry;for(let o=0,a=n.length;o<a;o++){const l=i[o],c=n[l];if(c.active!==!1){if(r.index!==null){if(c.indexStart!==t){const{indexStart:h,vertexStart:f,reservedIndexCount:p}=c,y=r.index,v=y.array,_=e-f;for(let S=h;S<h+p;S++)v[S]=v[S]+_;y.array.copyWithin(t,h,h+p),y.addUpdateRange(t,p),c.indexStart=t}t+=c.reservedIndexCount}if(c.vertexStart!==e){const{vertexStart:h,reservedVertexCount:f}=c,p=r.attributes;for(const y in p){const v=p[y],{array:_,itemSize:S}=v;_.copyWithin(e*S,h*S,(h+f)*S),v.addUpdateRange(e*S,f*S)}c.vertexStart=e}e+=c.reservedVertexCount,c.start=r.index?c.indexStart:c.vertexStart,this._nextIndexStart=r.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(i.boundingBox===null){const r=new wr,o=n.index,a=n.attributes.position;for(let l=i.start,c=i.start+i.count;l<c;l++){let h=l;o&&(h=o.getX(h)),r.expandByPoint(Cm.fromBufferAttribute(a,h))}i.boundingBox=r}return t.copy(i.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(i.boundingSphere===null){const r=new dr;this.getBoundingBoxAt(e,uy),uy.getCenter(r.center);const o=n.index,a=n.attributes.position;let l=0;for(let c=i.start,h=i.start+i.count;c<h;c++){let f=c;o&&(f=o.getX(f)),Cm.fromBufferAttribute(a,f),l=Math.max(l,r.center.distanceToSquared(Cm))}r.radius=Math.sqrt(l),i.boundingSphere=r}return t.copy(i.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,i=this._matricesTexture.image.data;return t.toArray(i,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(m1);t[t.length-1]===n.length;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const i=new Int32Array(e),r=new Int32Array(e);qu(this._multiDrawCounts,i),qu(this._multiDrawStarts,r),this._multiDrawCounts=i,this._multiDrawStarts=r,this._maxInstanceCount=e;const o=this._indirectTexture,a=this._matricesTexture,l=this._colorsTexture;o.dispose(),this._initIndirectTexture(),qu(o.image.data,this._indirectTexture.image.data),a.dispose(),this._initMatricesTexture(),qu(a.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),qu(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(a=>a.active);if(Math.max(...n.map(a=>a.vertexStart+a.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(l=>l.indexStart+l.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new rn,this._initializeGeometry(r));const o=this.geometry;r.index&&qu(r.index.array,o.index.array);for(const a in r.attributes)qu(r.attributes[a].array,o.attributes[a].array)}raycast(e,t){const n=this._instanceInfo,i=this._geometryInfo,r=this.matrixWorld,o=this.geometry;Br.material=this.material,Br.geometry.index=o.index,Br.geometry.attributes=o.attributes,Br.geometry.boundingBox===null&&(Br.geometry.boundingBox=new wr),Br.geometry.boundingSphere===null&&(Br.geometry.boundingSphere=new dr);for(let a=0,l=n.length;a<l;a++){if(!n[a].visible||!n[a].active)continue;const c=n[a].geometryIndex,h=i[c];Br.geometry.setDrawRange(h.start,h.count),this.getMatrixAt(a,Br.matrixWorld).premultiply(r),this.getBoundingBoxAt(c,Br.geometry.boundingBox),this.getBoundingSphereAt(c,Br.geometry.boundingSphere),Br.raycast(e,hy);for(let f=0,p=hy.length;f<p;f++){const y=hy[f];y.object=this,y.batchId=a,t.push(y)}hy.length=0}Br.material=null,Br.geometry.index=null,Br.geometry.attributes={},Br.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,n,i,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._instanceInfo,c=this._multiDrawStarts,h=this._multiDrawCounts,f=this._geometryInfo,p=this.perObjectFrustumCulled,y=this._indirectTexture,v=y.image.data;p&&(xs.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),g1.setFromProjectionMatrix(xs,e.coordinateSystem));let _=0;if(this.sortObjects){xs.copy(this.matrixWorld).invert(),Cm.setFromMatrixPosition(n.matrixWorld).applyMatrix4(xs),Vw.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(xs);for(let w=0,M=l.length;w<M;w++)if(l[w].visible&&l[w].active){const C=l[w].geometryIndex;this.getMatrixAt(w,xs),this.getBoundingSphereAt(C,Ju).applyMatrix4(xs);let I=!1;if(p&&(I=!g1.intersectsSphere(Ju)),!I){const O=f[C],k=AF.subVectors(Ju.center,Cm).dot(Vw);y1.push(O.start,O.count,k,w)}}const S=y1.list,A=this.customSort;A===null?S.sort(r.transparent?xF:vF):A.call(this,S,n);for(let w=0,M=S.length;w<M;w++){const C=S[w];c[_]=C.start*a,h[_]=C.count,v[_]=C.index,_++}y1.reset()}else for(let S=0,A=l.length;S<A;S++)if(l[S].visible&&l[S].active){const w=l[S].geometryIndex;let M=!1;if(p&&(this.getMatrixAt(S,xs),this.getBoundingSphereAt(w,Ju).applyMatrix4(xs),M=!g1.intersectsSphere(Ju)),!M){const C=f[w];c[_]=C.start*a,h[_]=C.count,v[_]=S,_++}}y.needsUpdate=!0,this._multiDrawCount=_,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,r,o){this.onBeforeRender(e,null,i,r,o)}}class Hr extends Ui{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ut(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const qv=new J,Qv=new J,Ww=new Kt,Rm=new Jh,dy=new dr,v1=new J,Kw=new J;class $l extends An{constructor(e=new rn,t=new Hr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,r=t.count;i<r;i++)qv.fromBufferAttribute(t,i-1),Qv.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=qv.distanceTo(Qv);e.setAttribute("lineDistance",new Dt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),dy.copy(n.boundingSphere),dy.applyMatrix4(i),dy.radius+=r,e.ray.intersectsSphere(dy)===!1)return;Ww.copy(i).invert(),Rm.copy(e.ray).applyMatrix4(Ww);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=this.isLineSegments?2:1,h=n.index,p=n.attributes.position;if(h!==null){const y=Math.max(0,o.start),v=Math.min(h.count,o.start+o.count);for(let _=y,S=v-1;_<S;_+=c){const A=h.getX(_),w=h.getX(_+1),M=fy(this,e,Rm,l,A,w);M&&t.push(M)}if(this.isLineLoop){const _=h.getX(v-1),S=h.getX(y),A=fy(this,e,Rm,l,_,S);A&&t.push(A)}}else{const y=Math.max(0,o.start),v=Math.min(p.count,o.start+o.count);for(let _=y,S=v-1;_<S;_+=c){const A=fy(this,e,Rm,l,_,_+1);A&&t.push(A)}if(this.isLineLoop){const _=fy(this,e,Rm,l,v-1,y);_&&t.push(_)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){const a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}function fy(s,e,t,n,i,r){const o=s.geometry.attributes.position;if(qv.fromBufferAttribute(o,i),Qv.fromBufferAttribute(o,r),t.distanceSqToSegment(qv,Qv,v1,Kw)>n)return;v1.applyMatrix4(s.matrixWorld);const l=e.ray.origin.distanceTo(v1);if(!(l<e.near||l>e.far))return{distance:l,point:Kw.clone().applyMatrix4(s.matrixWorld),index:i,face:null,faceIndex:null,barycoord:null,object:s}}const Xw=new J,$w=new J;class aa extends $l{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,r=t.count;i<r;i+=2)Xw.fromBufferAttribute(t,i),$w.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Xw.distanceTo($w);e.setAttribute("lineDistance",new Dt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class lE extends $l{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class kx extends Ui{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ut(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Yw=new Kt,zS=new Jh,py=new dr,my=new J;class cE extends An{constructor(e=new rn,t=new kx){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),py.copy(n.boundingSphere),py.applyMatrix4(i),py.radius+=r,e.ray.intersectsSphere(py)===!1)return;Yw.copy(i).invert(),zS.copy(e.ray).applyMatrix4(Yw);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,f=n.attributes.position;if(c!==null){const p=Math.max(0,o.start),y=Math.min(c.count,o.start+o.count);for(let v=p,_=y;v<_;v++){const S=c.getX(v);my.fromBufferAttribute(f,S),Jw(my,S,l,i,e,t,this)}}else{const p=Math.max(0,o.start),y=Math.min(f.count,o.start+o.count);for(let v=p,_=y;v<_;v++)my.fromBufferAttribute(f,v),Jw(my,v,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){const a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}function Jw(s,e,t,n,i,r,o){const a=zS.distanceSqToPoint(s);if(a<t){const l=new J;zS.closestPointToPoint(s,l),l.applyMatrix4(n);const c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;r.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class Gl extends An{constructor(){super(),this.isGroup=!0,this.type="Group"}}class ER extends ei{constructor(e,t,n,i,r,o,a,l,c){super(e,t,n,i,r,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:pi,this.magFilter=r!==void 0?r:pi,this.generateMipmaps=!1;const h=this;function f(){h.needsUpdate=!0,e.requestVideoFrameCallback(f)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(f)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class TF extends ei{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=ur,this.minFilter=ur,this.generateMipmaps=!1,this.needsUpdate=!0}}class Nx extends ei{constructor(e,t,n,i,r,o,a,l,c,h,f,p){super(null,o,a,l,c,h,i,r,f,p),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class wF extends Nx{constructor(e,t,n,i,r,o){super(e,t,n,r,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=Ws,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class MF extends Nx{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Kl),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class bF extends ei{constructor(e,t,n,i,r,o,a,l,c){super(e,t,n,i,r,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ux extends ei{constructor(e,t,n,i,r,o,a,l,c,h=Mh){if(h!==Mh&&h!==Nh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&h===Mh&&(n=Xl),n===void 0&&h===Nh&&(n=kh),super(null,i,r,o,a,l,h,n,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:ur,this.minFilter=l!==void 0?l:ur,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class la{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),r=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const r=n.length;let o;t?o=t:o=e*n[r-1];let a=0,l=r-1,c;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),c=n[i]-o,c<0)a=i+1;else if(c>0)l=i-1;else{l=i;break}if(i=l,n[i]===o)return i/(r-1);const h=n[i],p=n[i+1]-h,y=(o-h)/p;return(i+y)/(r-1)}getTangent(e,t){let i=e-1e-4,r=e+1e-4;i<0&&(i=0),r>1&&(r=1);const o=this.getPoint(i),a=this.getPoint(r),l=t||(o.isVector2?new Ue:new J);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new J,i=[],r=[],o=[],a=new J,l=new Kt;for(let y=0;y<=e;y++){const v=y/e;i[y]=this.getTangentAt(v,new J)}r[0]=new J,o[0]=new J;let c=Number.MAX_VALUE;const h=Math.abs(i[0].x),f=Math.abs(i[0].y),p=Math.abs(i[0].z);h<=c&&(c=h,n.set(1,0,0)),f<=c&&(c=f,n.set(0,1,0)),p<=c&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),o[0].crossVectors(i[0],r[0]);for(let y=1;y<=e;y++){if(r[y]=r[y-1].clone(),o[y]=o[y-1].clone(),a.crossVectors(i[y-1],i[y]),a.length()>Number.EPSILON){a.normalize();const v=Math.acos(nn(i[y-1].dot(i[y]),-1,1));r[y].applyMatrix4(l.makeRotationAxis(a,v))}o[y].crossVectors(i[y],r[y])}if(t===!0){let y=Math.acos(nn(r[0].dot(r[e]),-1,1));y/=e,i[0].dot(a.crossVectors(r[0],r[e]))>0&&(y=-y);for(let v=1;v<=e;v++)r[v].applyMatrix4(l.makeRotationAxis(i[v],y*v)),o[v].crossVectors(i[v],r[v])}return{tangents:i,normals:r,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Gx extends la{constructor(e=0,t=0,n=1,i=1,r=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new Ue){const n=t,i=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(o?r=0:r=i),this.aClockwise===!0&&!o&&(r===i?r=-i:r=r-i);const a=this.aStartAngle+e*r;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const h=Math.cos(this.aRotation),f=Math.sin(this.aRotation),p=l-this.aX,y=c-this.aY;l=p*h-y*f+this.aX,c=p*f+y*h+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class TR extends Gx{constructor(e,t,n,i,r,o){super(e,t,n,n,i,r,o),this.isArcCurve=!0,this.type="ArcCurve"}}function uE(){let s=0,e=0,t=0,n=0;function i(r,o,a,l){s=r,e=a,t=-3*r+3*o-2*a-l,n=2*r-2*o+a+l}return{initCatmullRom:function(r,o,a,l,c){i(o,a,c*(a-r),c*(l-o))},initNonuniformCatmullRom:function(r,o,a,l,c,h,f){let p=(o-r)/c-(a-r)/(c+h)+(a-o)/h,y=(a-o)/h-(l-o)/(h+f)+(l-a)/f;p*=h,y*=h,i(o,a,p,y)},calc:function(r){const o=r*r,a=o*r;return s+e*r+t*o+n*a}}}const gy=new J,x1=new uE,_1=new uE,S1=new uE;class wR extends la{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new J){const n=t,i=this.points,r=i.length,o=(r-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/r)+1)*r:l===0&&a===r-1&&(a=r-2,l=1);let c,h;this.closed||a>0?c=i[(a-1)%r]:(gy.subVectors(i[0],i[1]).add(i[0]),c=gy);const f=i[a%r],p=i[(a+1)%r];if(this.closed||a+2<r?h=i[(a+2)%r]:(gy.subVectors(i[r-1],i[r-2]).add(i[r-1]),h=gy),this.curveType==="centripetal"||this.curveType==="chordal"){const y=this.curveType==="chordal"?.5:.25;let v=Math.pow(c.distanceToSquared(f),y),_=Math.pow(f.distanceToSquared(p),y),S=Math.pow(p.distanceToSquared(h),y);_<1e-4&&(_=1),v<1e-4&&(v=_),S<1e-4&&(S=_),x1.initNonuniformCatmullRom(c.x,f.x,p.x,h.x,v,_,S),_1.initNonuniformCatmullRom(c.y,f.y,p.y,h.y,v,_,S),S1.initNonuniformCatmullRom(c.z,f.z,p.z,h.z,v,_,S)}else this.curveType==="catmullrom"&&(x1.initCatmullRom(c.x,f.x,p.x,h.x,this.tension),_1.initCatmullRom(c.y,f.y,p.y,h.y,this.tension),S1.initCatmullRom(c.z,f.z,p.z,h.z,this.tension));return n.set(x1.calc(l),_1.calc(l),S1.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new J().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function qw(s,e,t,n,i){const r=(n-e)*.5,o=(i-t)*.5,a=s*s,l=s*a;return(2*t-2*n+r+o)*l+(-3*t+3*n-2*r-o)*a+r*s+t}function CF(s,e){const t=1-s;return t*t*e}function RF(s,e){return 2*(1-s)*s*e}function IF(s,e){return s*s*e}function Ym(s,e,t,n){return CF(s,e)+RF(s,t)+IF(s,n)}function LF(s,e){const t=1-s;return t*t*t*e}function PF(s,e){const t=1-s;return 3*t*t*s*e}function DF(s,e){return 3*(1-s)*s*s*e}function OF(s,e){return s*s*s*e}function Jm(s,e,t,n,i){return LF(s,e)+PF(s,t)+DF(s,n)+OF(s,i)}class hE extends la{constructor(e=new Ue,t=new Ue,n=new Ue,i=new Ue){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new Ue){const n=t,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(Jm(e,i.x,r.x,o.x,a.x),Jm(e,i.y,r.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class MR extends la{constructor(e=new J,t=new J,n=new J,i=new J){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new J){const n=t,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(Jm(e,i.x,r.x,o.x,a.x),Jm(e,i.y,r.y,o.y,a.y),Jm(e,i.z,r.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class dE extends la{constructor(e=new Ue,t=new Ue){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ue){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ue){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class bR extends la{constructor(e=new J,t=new J){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new J){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new J){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class fE extends la{constructor(e=new Ue,t=new Ue,n=new Ue){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Ue){const n=t,i=this.v0,r=this.v1,o=this.v2;return n.set(Ym(e,i.x,r.x,o.x),Ym(e,i.y,r.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class pE extends la{constructor(e=new J,t=new J,n=new J){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new J){const n=t,i=this.v0,r=this.v1,o=this.v2;return n.set(Ym(e,i.x,r.x,o.x),Ym(e,i.y,r.y,o.y),Ym(e,i.z,r.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class mE extends la{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ue){const n=t,i=this.points,r=(i.length-1)*e,o=Math.floor(r),a=r-o,l=i[o===0?o:o-1],c=i[o],h=i[o>i.length-2?i.length-1:o+1],f=i[o>i.length-3?i.length-1:o+2];return n.set(qw(a,l.x,c.x,h.x,f.x),qw(a,l.y,c.y,h.y,f.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new Ue().fromArray(i))}return this}}var Zv=Object.freeze({__proto__:null,ArcCurve:TR,CatmullRomCurve3:wR,CubicBezierCurve:hE,CubicBezierCurve3:MR,EllipseCurve:Gx,LineCurve:dE,LineCurve3:bR,QuadraticBezierCurve:fE,QuadraticBezierCurve3:pE,SplineCurve:mE});class CR extends la{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Zv[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const o=i[r]-n,a=this.curves[r],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const o=r[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const h=l[c];n&&n.equals(h)||(t.push(h),n=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new Zv[i.type]().fromJSON(i))}return this}}class u0 extends CR{constructor(e){super(),this.type="Path",this.currentPoint=new Ue,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new dE(this.currentPoint.clone(),new Ue(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const r=new fE(this.currentPoint.clone(),new Ue(e,t),new Ue(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,o){const a=new hE(this.currentPoint.clone(),new Ue(e,t),new Ue(n,i),new Ue(r,o));return this.curves.push(a),this.currentPoint.set(r,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new mE(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,n,i,r,o),this}absarc(e,t,n,i,r,o){return this.absellipse(e,t,n,n,i,r,o),this}ellipse(e,t,n,i,r,o,a,l){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+c,t+h,n,i,r,o,a,l),this}absellipse(e,t,n,i,r,o,a,l){const c=new Gx(e,t,n,i,r,o,a,l);if(this.curves.length>0){const f=c.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class F0 extends rn{constructor(e=[new Ue(0,-.5),new Ue(.5,0),new Ue(0,.5)],t=12,n=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=nn(i,0,Math.PI*2);const r=[],o=[],a=[],l=[],c=[],h=1/t,f=new J,p=new Ue,y=new J,v=new J,_=new J;let S=0,A=0;for(let w=0;w<=e.length-1;w++)switch(w){case 0:S=e[w+1].x-e[w].x,A=e[w+1].y-e[w].y,y.x=A*1,y.y=-S,y.z=A*0,_.copy(y),y.normalize(),l.push(y.x,y.y,y.z);break;case e.length-1:l.push(_.x,_.y,_.z);break;default:S=e[w+1].x-e[w].x,A=e[w+1].y-e[w].y,y.x=A*1,y.y=-S,y.z=A*0,v.copy(y),y.x+=_.x,y.y+=_.y,y.z+=_.z,y.normalize(),l.push(y.x,y.y,y.z),_.copy(v)}for(let w=0;w<=t;w++){const M=n+w*h*i,C=Math.sin(M),I=Math.cos(M);for(let O=0;O<=e.length-1;O++){f.x=e[O].x*C,f.y=e[O].y,f.z=e[O].x*I,o.push(f.x,f.y,f.z),p.x=w/t,p.y=O/(e.length-1),a.push(p.x,p.y);const k=l[3*O+0]*C,N=l[3*O+1],B=l[3*O+0]*I;c.push(k,N,B)}}for(let w=0;w<t;w++)for(let M=0;M<e.length-1;M++){const C=M+w*e.length,I=C,O=C+e.length,k=C+e.length+1,N=C+1;r.push(I,O,N),r.push(k,N,O)}this.setIndex(r),this.setAttribute("position",new Dt(o,3)),this.setAttribute("uv",new Dt(a,2)),this.setAttribute("normal",new Dt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new F0(e.points,e.segments,e.phiStart,e.phiLength)}}class Hx extends F0{constructor(e=1,t=1,n=4,i=8){const r=new u0;r.absarc(0,-t/2,e,Math.PI*1.5,0),r.absarc(0,t/2,e,0,Math.PI*.5),super(r.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new Hx(e.radius,e.length,e.capSegments,e.radialSegments)}}class zx extends rn{constructor(e=1,t=32,n=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const r=[],o=[],a=[],l=[],c=new J,h=new Ue;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let f=0,p=3;f<=t;f++,p+=3){const y=n+f/t*i;c.x=e*Math.cos(y),c.y=e*Math.sin(y),o.push(c.x,c.y,c.z),a.push(0,0,1),h.x=(o[p]/e+1)/2,h.y=(o[p+1]/e+1)/2,l.push(h.x,h.y)}for(let f=1;f<=t;f++)r.push(f,f+1,0);this.setIndex(r),this.setAttribute("position",new Dt(o,3)),this.setAttribute("normal",new Dt(a,3)),this.setAttribute("uv",new Dt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zx(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class yp extends rn{constructor(e=1,t=1,n=1,i=32,r=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:l};const c=this;i=Math.floor(i),r=Math.floor(r);const h=[],f=[],p=[],y=[];let v=0;const _=[],S=n/2;let A=0;w(),o===!1&&(e>0&&M(!0),t>0&&M(!1)),this.setIndex(h),this.setAttribute("position",new Dt(f,3)),this.setAttribute("normal",new Dt(p,3)),this.setAttribute("uv",new Dt(y,2));function w(){const C=new J,I=new J;let O=0;const k=(t-e)/n;for(let N=0;N<=r;N++){const B=[],P=N/r,G=P*(t-e)+e;for(let Z=0;Z<=i;Z++){const Y=Z/i,se=Y*l+a,oe=Math.sin(se),re=Math.cos(se);I.x=G*oe,I.y=-P*n+S,I.z=G*re,f.push(I.x,I.y,I.z),C.set(oe,k,re).normalize(),p.push(C.x,C.y,C.z),y.push(Y,1-P),B.push(v++)}_.push(B)}for(let N=0;N<i;N++)for(let B=0;B<r;B++){const P=_[B][N],G=_[B+1][N],Z=_[B+1][N+1],Y=_[B][N+1];(e>0||B!==0)&&(h.push(P,G,Y),O+=3),(t>0||B!==r-1)&&(h.push(G,Z,Y),O+=3)}c.addGroup(A,O,0),A+=O}function M(C){const I=v,O=new Ue,k=new J;let N=0;const B=C===!0?e:t,P=C===!0?1:-1;for(let Z=1;Z<=i;Z++)f.push(0,S*P,0),p.push(0,P,0),y.push(.5,.5),v++;const G=v;for(let Z=0;Z<=i;Z++){const se=Z/i*l+a,oe=Math.cos(se),re=Math.sin(se);k.x=B*re,k.y=S*P,k.z=B*oe,f.push(k.x,k.y,k.z),p.push(0,P,0),O.x=oe*.5+.5,O.y=re*.5*P+.5,y.push(O.x,O.y),v++}for(let Z=0;Z<i;Z++){const Y=I+Z,se=G+Z;C===!0?h.push(se,se+1,Y):h.push(se+1,se,Y),N+=3}c.addGroup(A,N,C===!0?1:2),A+=N}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yp(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class jx extends yp{constructor(e=1,t=1,n=32,i=1,r=!1,o=0,a=Math.PI*2){super(0,e,t,n,i,r,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}static fromJSON(e){return new jx(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ru extends rn{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const r=[],o=[];a(i),c(n),h(),this.setAttribute("position",new Dt(r,3)),this.setAttribute("normal",new Dt(r.slice(),3)),this.setAttribute("uv",new Dt(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(w){const M=new J,C=new J,I=new J;for(let O=0;O<t.length;O+=3)y(t[O+0],M),y(t[O+1],C),y(t[O+2],I),l(M,C,I,w)}function l(w,M,C,I){const O=I+1,k=[];for(let N=0;N<=O;N++){k[N]=[];const B=w.clone().lerp(C,N/O),P=M.clone().lerp(C,N/O),G=O-N;for(let Z=0;Z<=G;Z++)Z===0&&N===O?k[N][Z]=B:k[N][Z]=B.clone().lerp(P,Z/G)}for(let N=0;N<O;N++)for(let B=0;B<2*(O-N)-1;B++){const P=Math.floor(B/2);B%2===0?(p(k[N][P+1]),p(k[N+1][P]),p(k[N][P])):(p(k[N][P+1]),p(k[N+1][P+1]),p(k[N+1][P]))}}function c(w){const M=new J;for(let C=0;C<r.length;C+=3)M.x=r[C+0],M.y=r[C+1],M.z=r[C+2],M.normalize().multiplyScalar(w),r[C+0]=M.x,r[C+1]=M.y,r[C+2]=M.z}function h(){const w=new J;for(let M=0;M<r.length;M+=3){w.x=r[M+0],w.y=r[M+1],w.z=r[M+2];const C=S(w)/2/Math.PI+.5,I=A(w)/Math.PI+.5;o.push(C,1-I)}v(),f()}function f(){for(let w=0;w<o.length;w+=6){const M=o[w+0],C=o[w+2],I=o[w+4],O=Math.max(M,C,I),k=Math.min(M,C,I);O>.9&&k<.1&&(M<.2&&(o[w+0]+=1),C<.2&&(o[w+2]+=1),I<.2&&(o[w+4]+=1))}}function p(w){r.push(w.x,w.y,w.z)}function y(w,M){const C=w*3;M.x=e[C+0],M.y=e[C+1],M.z=e[C+2]}function v(){const w=new J,M=new J,C=new J,I=new J,O=new Ue,k=new Ue,N=new Ue;for(let B=0,P=0;B<r.length;B+=9,P+=6){w.set(r[B+0],r[B+1],r[B+2]),M.set(r[B+3],r[B+4],r[B+5]),C.set(r[B+6],r[B+7],r[B+8]),O.set(o[P+0],o[P+1]),k.set(o[P+2],o[P+3]),N.set(o[P+4],o[P+5]),I.copy(w).add(M).add(C).divideScalar(3);const G=S(I);_(O,P+0,w,G),_(k,P+2,M,G),_(N,P+4,C,G)}}function _(w,M,C,I){I<0&&w.x===1&&(o[M]=w.x-1),C.x===0&&C.z===0&&(o[M]=I/2/Math.PI+.5)}function S(w){return Math.atan2(w.z,-w.x)}function A(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ru(e.vertices,e.indices,e.radius,e.details)}}class Vx extends ru{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Vx(e.radius,e.detail)}}const yy=new J,vy=new J,A1=new J,xy=new Es;class RR extends rn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),r=Math.cos(bh*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],h=["a","b","c"],f=new Array(3),p={},y=[];for(let v=0;v<l;v+=3){o?(c[0]=o.getX(v),c[1]=o.getX(v+1),c[2]=o.getX(v+2)):(c[0]=v,c[1]=v+1,c[2]=v+2);const{a:_,b:S,c:A}=xy;if(_.fromBufferAttribute(a,c[0]),S.fromBufferAttribute(a,c[1]),A.fromBufferAttribute(a,c[2]),xy.getNormal(A1),f[0]=`${Math.round(_.x*i)},${Math.round(_.y*i)},${Math.round(_.z*i)}`,f[1]=`${Math.round(S.x*i)},${Math.round(S.y*i)},${Math.round(S.z*i)}`,f[2]=`${Math.round(A.x*i)},${Math.round(A.y*i)},${Math.round(A.z*i)}`,!(f[0]===f[1]||f[1]===f[2]||f[2]===f[0]))for(let w=0;w<3;w++){const M=(w+1)%3,C=f[w],I=f[M],O=xy[h[w]],k=xy[h[M]],N=`${C}_${I}`,B=`${I}_${C}`;B in p&&p[B]?(A1.dot(p[B].normal)<=r&&(y.push(O.x,O.y,O.z),y.push(k.x,k.y,k.z)),p[B]=null):N in p||(p[N]={index0:c[w],index1:c[M],normal:A1.clone()})}}for(const v in p)if(p[v]){const{index0:_,index1:S}=p[v];yy.fromBufferAttribute(a,_),vy.fromBufferAttribute(a,S),y.push(yy.x,yy.y,yy.z),y.push(vy.x,vy.y,vy.z)}this.setAttribute("position",new Dt(y,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Rh extends u0{constructor(e){super(e),this.uuid=$s(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new u0().fromJSON(i))}return this}}const BF={triangulate:function(s,e,t=2){const n=e&&e.length,i=n?e[0]*t:s.length;let r=IR(s,0,i,t,!0);const o=[];if(!r||r.next===r.prev)return o;let a,l,c,h,f,p,y;if(n&&(r=GF(s,e,r,t)),s.length>80*t){a=c=s[0],l=h=s[1];for(let v=t;v<i;v+=t)f=s[v],p=s[v+1],f<a&&(a=f),p<l&&(l=p),f>c&&(c=f),p>h&&(h=p);y=Math.max(c-a,h-l),y=y!==0?32767/y:0}return h0(r,o,t,a,l,y,0),o}};function IR(s,e,t,n,i){let r,o;if(i===qF(s,e,t,n)>0)for(r=e;r<t;r+=n)o=Qw(r,s[r],s[r+1],o);else for(r=t-n;r>=e;r-=n)o=Qw(r,s[r],s[r+1],o);return o&&Wx(o,o.next)&&(f0(o),o=o.next),o}function Hh(s,e){if(!s)return s;e||(e=s);let t=s,n;do if(n=!1,!t.steiner&&(Wx(t,t.next)||di(t.prev,t,t.next)===0)){if(f0(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function h0(s,e,t,n,i,r,o){if(!s)return;!o&&r&&WF(s,n,i,r);let a=s,l,c;for(;s.prev!==s.next;){if(l=s.prev,c=s.next,r?kF(s,n,i,r):FF(s)){e.push(l.i/t|0),e.push(s.i/t|0),e.push(c.i/t|0),f0(s),s=c.next,a=c.next;continue}if(s=c,s===a){o?o===1?(s=NF(Hh(s),e,t),h0(s,e,t,n,i,r,2)):o===2&&UF(s,e,t,n,i,r):h0(Hh(s),e,t,n,i,r,1);break}}}function FF(s){const e=s.prev,t=s,n=s.next;if(di(e,t,n)>=0)return!1;const i=e.x,r=t.x,o=n.x,a=e.y,l=t.y,c=n.y,h=i<r?i<o?i:o:r<o?r:o,f=a<l?a<c?a:c:l<c?l:c,p=i>r?i>o?i:o:r>o?r:o,y=a>l?a>c?a:c:l>c?l:c;let v=n.next;for(;v!==e;){if(v.x>=h&&v.x<=p&&v.y>=f&&v.y<=y&&Ff(i,a,r,l,o,c,v.x,v.y)&&di(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function kF(s,e,t,n){const i=s.prev,r=s,o=s.next;if(di(i,r,o)>=0)return!1;const a=i.x,l=r.x,c=o.x,h=i.y,f=r.y,p=o.y,y=a<l?a<c?a:c:l<c?l:c,v=h<f?h<p?h:p:f<p?f:p,_=a>l?a>c?a:c:l>c?l:c,S=h>f?h>p?h:p:f>p?f:p,A=jS(y,v,e,t,n),w=jS(_,S,e,t,n);let M=s.prevZ,C=s.nextZ;for(;M&&M.z>=A&&C&&C.z<=w;){if(M.x>=y&&M.x<=_&&M.y>=v&&M.y<=S&&M!==i&&M!==o&&Ff(a,h,l,f,c,p,M.x,M.y)&&di(M.prev,M,M.next)>=0||(M=M.prevZ,C.x>=y&&C.x<=_&&C.y>=v&&C.y<=S&&C!==i&&C!==o&&Ff(a,h,l,f,c,p,C.x,C.y)&&di(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;M&&M.z>=A;){if(M.x>=y&&M.x<=_&&M.y>=v&&M.y<=S&&M!==i&&M!==o&&Ff(a,h,l,f,c,p,M.x,M.y)&&di(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;C&&C.z<=w;){if(C.x>=y&&C.x<=_&&C.y>=v&&C.y<=S&&C!==i&&C!==o&&Ff(a,h,l,f,c,p,C.x,C.y)&&di(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function NF(s,e,t){let n=s;do{const i=n.prev,r=n.next.next;!Wx(i,r)&&LR(i,n,n.next,r)&&d0(i,r)&&d0(r,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(r.i/t|0),f0(n),f0(n.next),n=s=r),n=n.next}while(n!==s);return Hh(n)}function UF(s,e,t,n,i,r){let o=s;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&$F(o,a)){let l=PR(o,a);o=Hh(o,o.next),l=Hh(l,l.next),h0(o,e,t,n,i,r,0),h0(l,e,t,n,i,r,0);return}a=a.next}o=o.next}while(o!==s)}function GF(s,e,t,n){const i=[];let r,o,a,l,c;for(r=0,o=e.length;r<o;r++)a=e[r]*n,l=r<o-1?e[r+1]*n:s.length,c=IR(s,a,l,n,!1),c===c.next&&(c.steiner=!0),i.push(XF(c));for(i.sort(HF),r=0;r<i.length;r++)t=zF(i[r],t);return t}function HF(s,e){return s.x-e.x}function zF(s,e){const t=jF(s,e);if(!t)return e;const n=PR(t,s);return Hh(n,n.next),Hh(t,t.next)}function jF(s,e){let t=e,n=-1/0,i;const r=s.x,o=s.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const p=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=r&&p>n&&(n=p,i=t.x<t.next.x?t:t.next,p===r))return i}t=t.next}while(t!==e);if(!i)return null;const a=i,l=i.x,c=i.y;let h=1/0,f;t=i;do r>=t.x&&t.x>=l&&r!==t.x&&Ff(o<c?r:n,o,l,c,o<c?n:r,o,t.x,t.y)&&(f=Math.abs(o-t.y)/(r-t.x),d0(t,s)&&(f<h||f===h&&(t.x>i.x||t.x===i.x&&VF(i,t)))&&(i=t,h=f)),t=t.next;while(t!==a);return i}function VF(s,e){return di(s.prev,s,e.prev)<0&&di(e.next,s,s.next)<0}function WF(s,e,t,n){let i=s;do i.z===0&&(i.z=jS(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,KF(i)}function KF(s){let e,t,n,i,r,o,a,l,c=1;do{for(t=s,s=null,r=null,o=0;t;){for(o++,n=t,a=0,e=0;e<c&&(a++,n=n.nextZ,!!n);e++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,a--):(i=n,n=n.nextZ,l--),r?r.nextZ=i:s=i,i.prevZ=r,r=i;t=n}r.nextZ=null,c*=2}while(o>1);return s}function jS(s,e,t,n,i){return s=(s-t)*i|0,e=(e-n)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function XF(s){let e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function Ff(s,e,t,n,i,r,o,a){return(i-o)*(e-a)>=(s-o)*(r-a)&&(s-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(r-a)>=(i-o)*(n-a)}function $F(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!YF(s,e)&&(d0(s,e)&&d0(e,s)&&JF(s,e)&&(di(s.prev,s,e.prev)||di(s,e.prev,e))||Wx(s,e)&&di(s.prev,s,s.next)>0&&di(e.prev,e,e.next)>0)}function di(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function Wx(s,e){return s.x===e.x&&s.y===e.y}function LR(s,e,t,n){const i=Sy(di(s,e,t)),r=Sy(di(s,e,n)),o=Sy(di(t,n,s)),a=Sy(di(t,n,e));return!!(i!==r&&o!==a||i===0&&_y(s,t,e)||r===0&&_y(s,n,e)||o===0&&_y(t,s,n)||a===0&&_y(t,e,n))}function _y(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function Sy(s){return s>0?1:s<0?-1:0}function YF(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&LR(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function d0(s,e){return di(s.prev,s,s.next)<0?di(s,e,s.next)>=0&&di(s,s.prev,e)>=0:di(s,e,s.prev)<0||di(s,s.next,e)<0}function JF(s,e){let t=s,n=!1;const i=(s.x+e.x)/2,r=(s.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&i<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==s);return n}function PR(s,e){const t=new VS(s.i,s.x,s.y),n=new VS(e.i,e.x,e.y),i=s.next,r=e.prev;return s.next=e,e.prev=s,t.next=i,i.prev=t,n.next=t,t.prev=n,r.next=n,n.prev=r,n}function Qw(s,e,t,n){const i=new VS(s,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function f0(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function VS(s,e,t){this.i=s,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function qF(s,e,t,n){let i=0;for(let r=e,o=t-n;r<t;r+=n)i+=(s[o]-s[r])*(s[r+1]+s[o+1]),o=r;return i}class Fa{static area(e){const t=e.length;let n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return n*.5}static isClockWise(e){return Fa.area(e)<0}static triangulateShape(e,t){const n=[],i=[],r=[];Zw(e),eM(n,e);let o=e.length;t.forEach(Zw);for(let l=0;l<t.length;l++)i.push(o),o+=t[l].length,eM(n,t[l]);const a=BF.triangulate(n,i);for(let l=0;l<a.length;l+=3)r.push(a.slice(l,l+3));return r}}function Zw(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function eM(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class Kx extends rn{constructor(e=new Rh([new Ue(.5,.5),new Ue(-.5,.5),new Ue(-.5,-.5),new Ue(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],r=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new Dt(i,3)),this.setAttribute("uv",new Dt(r,2)),this.computeVertexNormals();function o(a){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,h=t.steps!==void 0?t.steps:1,f=t.depth!==void 0?t.depth:1;let p=t.bevelEnabled!==void 0?t.bevelEnabled:!0,y=t.bevelThickness!==void 0?t.bevelThickness:.2,v=t.bevelSize!==void 0?t.bevelSize:y-.1,_=t.bevelOffset!==void 0?t.bevelOffset:0,S=t.bevelSegments!==void 0?t.bevelSegments:3;const A=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:QF;let M,C=!1,I,O,k,N;A&&(M=A.getSpacedPoints(h),C=!0,p=!1,I=A.computeFrenetFrames(h,!1),O=new J,k=new J,N=new J),p||(S=0,y=0,v=0,_=0);const B=a.extractPoints(c);let P=B.shape;const G=B.holes;if(!Fa.isClockWise(P)){P=P.reverse();for(let Ne=0,Ge=G.length;Ne<Ge;Ne++){const Q=G[Ne];Fa.isClockWise(Q)&&(G[Ne]=Q.reverse())}}const Y=Fa.triangulateShape(P,G),se=P;for(let Ne=0,Ge=G.length;Ne<Ge;Ne++){const Q=G[Ne];P=P.concat(Q)}function oe(Ne,Ge,Q){return Ge||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ne.clone().addScaledVector(Ge,Q)}const re=P.length,ce=Y.length;function H(Ne,Ge,Q){let St,We,st;const qe=Ne.x-Ge.x,It=Ne.y-Ge.y,tt=Q.x-Ne.x,q=Q.y-Ne.y,V=qe*qe+It*It,xe=qe*q-It*tt;if(Math.abs(xe)>Number.EPSILON){const De=Math.sqrt(V),He=Math.sqrt(tt*tt+q*q),Fe=Ge.x-It/De,ht=Ge.y+qe/De,nt=Q.x-q/He,mt=Q.y+tt/He,Qt=((nt-Fe)*q-(mt-ht)*tt)/(qe*q-It*tt);St=Fe+qe*Qt-Ne.x,We=ht+It*Qt-Ne.y;const Xe=St*St+We*We;if(Xe<=2)return new Ue(St,We);st=Math.sqrt(Xe/2)}else{let De=!1;qe>Number.EPSILON?tt>Number.EPSILON&&(De=!0):qe<-Number.EPSILON?tt<-Number.EPSILON&&(De=!0):Math.sign(It)===Math.sign(q)&&(De=!0),De?(St=-It,We=qe,st=Math.sqrt(V)):(St=qe,We=It,st=Math.sqrt(V/2))}return new Ue(St/st,We/st)}const $=[];for(let Ne=0,Ge=se.length,Q=Ge-1,St=Ne+1;Ne<Ge;Ne++,Q++,St++)Q===Ge&&(Q=0),St===Ge&&(St=0),$[Ne]=H(se[Ne],se[Q],se[St]);const X=[];let W,ne=$.concat();for(let Ne=0,Ge=G.length;Ne<Ge;Ne++){const Q=G[Ne];W=[];for(let St=0,We=Q.length,st=We-1,qe=St+1;St<We;St++,st++,qe++)st===We&&(st=0),qe===We&&(qe=0),W[St]=H(Q[St],Q[st],Q[qe]);X.push(W),ne=ne.concat(W)}for(let Ne=0;Ne<S;Ne++){const Ge=Ne/S,Q=y*Math.cos(Ge*Math.PI/2),St=v*Math.sin(Ge*Math.PI/2)+_;for(let We=0,st=se.length;We<st;We++){const qe=oe(se[We],$[We],St);Ie(qe.x,qe.y,-Q)}for(let We=0,st=G.length;We<st;We++){const qe=G[We];W=X[We];for(let It=0,tt=qe.length;It<tt;It++){const q=oe(qe[It],W[It],St);Ie(q.x,q.y,-Q)}}}const Ee=v+_;for(let Ne=0;Ne<re;Ne++){const Ge=p?oe(P[Ne],ne[Ne],Ee):P[Ne];C?(k.copy(I.normals[0]).multiplyScalar(Ge.x),O.copy(I.binormals[0]).multiplyScalar(Ge.y),N.copy(M[0]).add(k).add(O),Ie(N.x,N.y,N.z)):Ie(Ge.x,Ge.y,0)}for(let Ne=1;Ne<=h;Ne++)for(let Ge=0;Ge<re;Ge++){const Q=p?oe(P[Ge],ne[Ge],Ee):P[Ge];C?(k.copy(I.normals[Ne]).multiplyScalar(Q.x),O.copy(I.binormals[Ne]).multiplyScalar(Q.y),N.copy(M[Ne]).add(k).add(O),Ie(N.x,N.y,N.z)):Ie(Q.x,Q.y,f/h*Ne)}for(let Ne=S-1;Ne>=0;Ne--){const Ge=Ne/S,Q=y*Math.cos(Ge*Math.PI/2),St=v*Math.sin(Ge*Math.PI/2)+_;for(let We=0,st=se.length;We<st;We++){const qe=oe(se[We],$[We],St);Ie(qe.x,qe.y,f+Q)}for(let We=0,st=G.length;We<st;We++){const qe=G[We];W=X[We];for(let It=0,tt=qe.length;It<tt;It++){const q=oe(qe[It],W[It],St);C?Ie(q.x,q.y+M[h-1].y,M[h-1].x+Q):Ie(q.x,q.y,f+Q)}}}le(),ye();function le(){const Ne=i.length/3;if(p){let Ge=0,Q=re*Ge;for(let St=0;St<ce;St++){const We=Y[St];ze(We[2]+Q,We[1]+Q,We[0]+Q)}Ge=h+S*2,Q=re*Ge;for(let St=0;St<ce;St++){const We=Y[St];ze(We[0]+Q,We[1]+Q,We[2]+Q)}}else{for(let Ge=0;Ge<ce;Ge++){const Q=Y[Ge];ze(Q[2],Q[1],Q[0])}for(let Ge=0;Ge<ce;Ge++){const Q=Y[Ge];ze(Q[0]+re*h,Q[1]+re*h,Q[2]+re*h)}}n.addGroup(Ne,i.length/3-Ne,0)}function ye(){const Ne=i.length/3;let Ge=0;we(se,Ge),Ge+=se.length;for(let Q=0,St=G.length;Q<St;Q++){const We=G[Q];we(We,Ge),Ge+=We.length}n.addGroup(Ne,i.length/3-Ne,1)}function we(Ne,Ge){let Q=Ne.length;for(;--Q>=0;){const St=Q;let We=Q-1;We<0&&(We=Ne.length-1);for(let st=0,qe=h+S*2;st<qe;st++){const It=re*st,tt=re*(st+1),q=Ge+St+It,V=Ge+We+It,xe=Ge+We+tt,De=Ge+St+tt;Ze(q,V,xe,De)}}}function Ie(Ne,Ge,Q){l.push(Ne),l.push(Ge),l.push(Q)}function ze(Ne,Ge,Q){rt(Ne),rt(Ge),rt(Q);const St=i.length/3,We=w.generateTopUV(n,i,St-3,St-2,St-1);ct(We[0]),ct(We[1]),ct(We[2])}function Ze(Ne,Ge,Q,St){rt(Ne),rt(Ge),rt(St),rt(Ge),rt(Q),rt(St);const We=i.length/3,st=w.generateSideWallUV(n,i,We-6,We-3,We-2,We-1);ct(st[0]),ct(st[1]),ct(st[3]),ct(st[1]),ct(st[2]),ct(st[3])}function rt(Ne){i.push(l[Ne*3+0]),i.push(l[Ne*3+1]),i.push(l[Ne*3+2])}function ct(Ne){r.push(Ne.x),r.push(Ne.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return ZF(t,n,e)}static fromJSON(e,t){const n=[];for(let r=0,o=e.shapes.length;r<o;r++){const a=t[e.shapes[r]];n.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new Zv[i.type]().fromJSON(i)),new Kx(n,e.options)}}const QF={generateTopUV:function(s,e,t,n,i){const r=e[t*3],o=e[t*3+1],a=e[n*3],l=e[n*3+1],c=e[i*3],h=e[i*3+1];return[new Ue(r,o),new Ue(a,l),new Ue(c,h)]},generateSideWallUV:function(s,e,t,n,i,r){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],c=e[n*3],h=e[n*3+1],f=e[n*3+2],p=e[i*3],y=e[i*3+1],v=e[i*3+2],_=e[r*3],S=e[r*3+1],A=e[r*3+2];return Math.abs(a-h)<Math.abs(o-c)?[new Ue(o,1-l),new Ue(c,1-f),new Ue(p,1-v),new Ue(_,1-A)]:[new Ue(a,1-l),new Ue(h,1-f),new Ue(y,1-v),new Ue(S,1-A)]}};function ZF(s,e,t){if(t.shapes=[],Array.isArray(s))for(let n=0,i=s.length;n<i;n++){const r=s[n];t.shapes.push(r.uuid)}else t.shapes.push(s.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Xx extends ru{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Xx(e.radius,e.detail)}}class k0 extends ru{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new k0(e.radius,e.detail)}}class vp extends rn{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=e/2,o=t/2,a=Math.floor(n),l=Math.floor(i),c=a+1,h=l+1,f=e/a,p=t/l,y=[],v=[],_=[],S=[];for(let A=0;A<h;A++){const w=A*p-o;for(let M=0;M<c;M++){const C=M*f-r;v.push(C,-w,0),_.push(0,0,1),S.push(M/a),S.push(1-A/l)}}for(let A=0;A<l;A++)for(let w=0;w<a;w++){const M=w+c*A,C=w+c*(A+1),I=w+1+c*(A+1),O=w+1+c*A;y.push(M,C,O),y.push(C,I,O)}this.setIndex(y),this.setAttribute("position",new Dt(v,3)),this.setAttribute("normal",new Dt(_,3)),this.setAttribute("uv",new Dt(S,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vp(e.width,e.height,e.widthSegments,e.heightSegments)}}class $x extends rn{constructor(e=.5,t=1,n=32,i=1,r=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},n=Math.max(3,n),i=Math.max(1,i);const a=[],l=[],c=[],h=[];let f=e;const p=(t-e)/i,y=new J,v=new Ue;for(let _=0;_<=i;_++){for(let S=0;S<=n;S++){const A=r+S/n*o;y.x=f*Math.cos(A),y.y=f*Math.sin(A),l.push(y.x,y.y,y.z),c.push(0,0,1),v.x=(y.x/t+1)/2,v.y=(y.y/t+1)/2,h.push(v.x,v.y)}f+=p}for(let _=0;_<i;_++){const S=_*(n+1);for(let A=0;A<n;A++){const w=A+S,M=w,C=w+n+1,I=w+n+2,O=w+1;a.push(M,C,O),a.push(C,I,O)}}this.setIndex(a),this.setAttribute("position",new Dt(l,3)),this.setAttribute("normal",new Dt(c,3)),this.setAttribute("uv",new Dt(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $x(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Yx extends rn{constructor(e=new Rh([new Ue(0,.5),new Ue(-.5,-.5),new Ue(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],r=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let h=0;h<e.length;h++)c(e[h]),this.addGroup(a,l,h),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new Dt(i,3)),this.setAttribute("normal",new Dt(r,3)),this.setAttribute("uv",new Dt(o,2));function c(h){const f=i.length/3,p=h.extractPoints(t);let y=p.shape;const v=p.holes;Fa.isClockWise(y)===!1&&(y=y.reverse());for(let S=0,A=v.length;S<A;S++){const w=v[S];Fa.isClockWise(w)===!0&&(v[S]=w.reverse())}const _=Fa.triangulateShape(y,v);for(let S=0,A=v.length;S<A;S++){const w=v[S];y=y.concat(w)}for(let S=0,A=y.length;S<A;S++){const w=y[S];i.push(w.x,w.y,0),r.push(0,0,1),o.push(w.x,w.y)}for(let S=0,A=_.length;S<A;S++){const w=_[S],M=w[0]+f,C=w[1]+f,I=w[2]+f;n.push(M,C,I),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return ek(t,e)}static fromJSON(e,t){const n=[];for(let i=0,r=e.shapes.length;i<r;i++){const o=t[e.shapes[i]];n.push(o)}return new Yx(n,e.curveSegments)}}function ek(s,e){if(e.shapes=[],Array.isArray(s))for(let t=0,n=s.length;t<n;t++){const i=s[t];e.shapes.push(i.uuid)}else e.shapes.push(s.uuid);return e}class N0 extends rn{constructor(e=1,t=32,n=16,i=0,r=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let c=0;const h=[],f=new J,p=new J,y=[],v=[],_=[],S=[];for(let A=0;A<=n;A++){const w=[],M=A/n;let C=0;A===0&&o===0?C=.5/t:A===n&&l===Math.PI&&(C=-.5/t);for(let I=0;I<=t;I++){const O=I/t;f.x=-e*Math.cos(i+O*r)*Math.sin(o+M*a),f.y=e*Math.cos(o+M*a),f.z=e*Math.sin(i+O*r)*Math.sin(o+M*a),v.push(f.x,f.y,f.z),p.copy(f).normalize(),_.push(p.x,p.y,p.z),S.push(O+C,1-M),w.push(c++)}h.push(w)}for(let A=0;A<n;A++)for(let w=0;w<t;w++){const M=h[A][w+1],C=h[A][w],I=h[A+1][w],O=h[A+1][w+1];(A!==0||o>0)&&y.push(M,C,O),(A!==n-1||l<Math.PI)&&y.push(C,I,O)}this.setIndex(y),this.setAttribute("position",new Dt(v,3)),this.setAttribute("normal",new Dt(_,3)),this.setAttribute("uv",new Dt(S,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new N0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Jx extends ru{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Jx(e.radius,e.detail)}}class qx extends rn{constructor(e=1,t=.4,n=12,i=48,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const o=[],a=[],l=[],c=[],h=new J,f=new J,p=new J;for(let y=0;y<=n;y++)for(let v=0;v<=i;v++){const _=v/i*r,S=y/n*Math.PI*2;f.x=(e+t*Math.cos(S))*Math.cos(_),f.y=(e+t*Math.cos(S))*Math.sin(_),f.z=t*Math.sin(S),a.push(f.x,f.y,f.z),h.x=e*Math.cos(_),h.y=e*Math.sin(_),p.subVectors(f,h).normalize(),l.push(p.x,p.y,p.z),c.push(v/i),c.push(y/n)}for(let y=1;y<=n;y++)for(let v=1;v<=i;v++){const _=(i+1)*y+v-1,S=(i+1)*(y-1)+v-1,A=(i+1)*(y-1)+v,w=(i+1)*y+v;o.push(_,S,w),o.push(S,A,w)}this.setIndex(o),this.setAttribute("position",new Dt(a,3)),this.setAttribute("normal",new Dt(l,3)),this.setAttribute("uv",new Dt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qx(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Qx extends rn{constructor(e=1,t=.4,n=64,i=8,r=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},n=Math.floor(n),i=Math.floor(i);const a=[],l=[],c=[],h=[],f=new J,p=new J,y=new J,v=new J,_=new J,S=new J,A=new J;for(let M=0;M<=n;++M){const C=M/n*r*Math.PI*2;w(C,r,o,e,y),w(C+.01,r,o,e,v),S.subVectors(v,y),A.addVectors(v,y),_.crossVectors(S,A),A.crossVectors(_,S),_.normalize(),A.normalize();for(let I=0;I<=i;++I){const O=I/i*Math.PI*2,k=-t*Math.cos(O),N=t*Math.sin(O);f.x=y.x+(k*A.x+N*_.x),f.y=y.y+(k*A.y+N*_.y),f.z=y.z+(k*A.z+N*_.z),l.push(f.x,f.y,f.z),p.subVectors(f,y).normalize(),c.push(p.x,p.y,p.z),h.push(M/n),h.push(I/i)}}for(let M=1;M<=n;M++)for(let C=1;C<=i;C++){const I=(i+1)*(M-1)+(C-1),O=(i+1)*M+(C-1),k=(i+1)*M+C,N=(i+1)*(M-1)+C;a.push(I,O,N),a.push(O,k,N)}this.setIndex(a),this.setAttribute("position",new Dt(l,3)),this.setAttribute("normal",new Dt(c,3)),this.setAttribute("uv",new Dt(h,2));function w(M,C,I,O,k){const N=Math.cos(M),B=Math.sin(M),P=I/C*M,G=Math.cos(P);k.x=O*(2+G)*.5*N,k.y=O*(2+G)*B*.5,k.z=O*Math.sin(P)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qx(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Zx extends rn{constructor(e=new pE(new J(-1,-1,0),new J(-1,1,0),new J(1,1,0)),t=64,n=1,i=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r};const o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new J,l=new J,c=new Ue;let h=new J;const f=[],p=[],y=[],v=[];_(),this.setIndex(v),this.setAttribute("position",new Dt(f,3)),this.setAttribute("normal",new Dt(p,3)),this.setAttribute("uv",new Dt(y,2));function _(){for(let M=0;M<t;M++)S(M);S(r===!1?t:0),w(),A()}function S(M){h=e.getPointAt(M/t,h);const C=o.normals[M],I=o.binormals[M];for(let O=0;O<=i;O++){const k=O/i*Math.PI*2,N=Math.sin(k),B=-Math.cos(k);l.x=B*C.x+N*I.x,l.y=B*C.y+N*I.y,l.z=B*C.z+N*I.z,l.normalize(),p.push(l.x,l.y,l.z),a.x=h.x+n*l.x,a.y=h.y+n*l.y,a.z=h.z+n*l.z,f.push(a.x,a.y,a.z)}}function A(){for(let M=1;M<=t;M++)for(let C=1;C<=i;C++){const I=(i+1)*(M-1)+(C-1),O=(i+1)*M+(C-1),k=(i+1)*M+C,N=(i+1)*(M-1)+C;v.push(I,O,N),v.push(O,k,N)}}function w(){for(let M=0;M<=t;M++)for(let C=0;C<=i;C++)c.x=M/t,c.y=C/i,y.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Zx(new Zv[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class DR extends rn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new J,r=new J;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,h=l.length;c<h;++c){const f=l[c],p=f.start,y=f.count;for(let v=p,_=p+y;v<_;v+=3)for(let S=0;S<3;S++){const A=a.getX(v+S),w=a.getX(v+(S+1)%3);i.fromBufferAttribute(o,A),r.fromBufferAttribute(o,w),tM(i,r,n)===!0&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const h=3*a+c,f=3*a+(c+1)%3;i.fromBufferAttribute(o,h),r.fromBufferAttribute(o,f),tM(i,r,n)===!0&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new Dt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function tM(s,e,t){const n=`${s.x},${s.y},${s.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${s.x},${s.y},${s.z}`;return t.has(n)===!0||t.has(i)===!0?!1:(t.add(n),t.add(i),!0)}var nM=Object.freeze({__proto__:null,BoxGeometry:qh,CapsuleGeometry:Hx,CircleGeometry:zx,ConeGeometry:jx,CylinderGeometry:yp,DodecahedronGeometry:Vx,EdgesGeometry:RR,ExtrudeGeometry:Kx,IcosahedronGeometry:Xx,LatheGeometry:F0,OctahedronGeometry:k0,PlaneGeometry:vp,PolyhedronGeometry:ru,RingGeometry:$x,ShapeGeometry:Yx,SphereGeometry:N0,TetrahedronGeometry:Jx,TorusGeometry:qx,TorusKnotGeometry:Qx,TubeGeometry:Zx,WireframeGeometry:DR});class OR extends Ui{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ut(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class BR extends oa{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class U0 extends Ui{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new ut(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=iu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Js,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Co extends U0{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ue(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return nn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ut(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ut(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ut(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class FR extends Ui{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ut(16777215),this.specular=new ut(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=iu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Js,this.combine=R0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class kR extends Ui{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ut(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=iu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class NR extends Ui{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=iu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class UR extends Ui{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=iu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Js,this.combine=R0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class gE extends Ui{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=tR,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class yE extends Ui{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class GR extends Ui{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ut(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=iu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class HR extends Hr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function _h(s,e,t){return!s||!t&&s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function zR(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function jR(s){function e(i,r){return s[i]-s[r]}const t=s.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n}function WS(s,e,t){const n=s.length,i=new s.constructor(n);for(let r=0,o=0;o!==n;++r){const a=t[r]*e;for(let l=0;l!==e;++l)i[o++]=s[a+l]}return i}function vE(s,e,t,n){let i=1,r=s[0];for(;r!==void 0&&r[n]===void 0;)r=s[i++];if(r===void 0)return;let o=r[n];if(o!==void 0)if(Array.isArray(o))do o=r[n],o!==void 0&&(e.push(r.time),t.push.apply(t,o)),r=s[i++];while(r!==void 0);else if(o.toArray!==void 0)do o=r[n],o!==void 0&&(e.push(r.time),o.toArray(t,t.length)),r=s[i++];while(r!==void 0);else do o=r[n],o!==void 0&&(e.push(r.time),t.push(o)),r=s[i++];while(r!==void 0)}function tk(s,e,t,n,i=30){const r=s.clone();r.name=e;const o=[];for(let l=0;l<r.tracks.length;++l){const c=r.tracks[l],h=c.getValueSize(),f=[],p=[];for(let y=0;y<c.times.length;++y){const v=c.times[y]*i;if(!(v<t||v>=n)){f.push(c.times[y]);for(let _=0;_<h;++_)p.push(c.values[y*h+_])}}f.length!==0&&(c.times=_h(f,c.times.constructor),c.values=_h(p,c.values.constructor),o.push(c))}r.tracks=o;let a=1/0;for(let l=0;l<r.tracks.length;++l)a>r.tracks[l].times[0]&&(a=r.tracks[l].times[0]);for(let l=0;l<r.tracks.length;++l)r.tracks[l].shift(-1*a);return r.resetDuration(),r}function nk(s,e=0,t=s,n=30){n<=0&&(n=30);const i=t.tracks.length,r=e/n;for(let o=0;o<i;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=s.tracks.find(function(A){return A.name===a.name&&A.ValueTypeName===l});if(c===void 0)continue;let h=0;const f=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);let p=0;const y=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=y/3);const v=a.times.length-1;let _;if(r<=a.times[0]){const A=h,w=f-h;_=a.values.slice(A,w)}else if(r>=a.times[v]){const A=v*f+h,w=A+f-h;_=a.values.slice(A,w)}else{const A=a.createInterpolant(),w=h,M=f-h;A.evaluate(r),_=A.resultBuffer.slice(w,M)}l==="quaternion"&&new hr().fromArray(_).normalize().conjugate().toArray(_);const S=c.times.length;for(let A=0;A<S;++A){const w=A*y+p;if(l==="quaternion")hr.multiplyQuaternionsFlat(c.values,w,_,0,c.values,w);else{const M=y-p*2;for(let C=0;C<M;++C)c.values[w+C]-=_[C]}}}return s.blendMode=JA,s}const ik={convertArray:_h,isTypedArray:zR,getKeyframeOrder:jR,sortedArray:WS,flattenJSON:vE,subclip:tk,makeClipAdditive:nk};class xp{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let o;n:{i:if(!(e<i)){for(let a=n+2;;){if(i===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(r=i,i=t[++n],e<i)break t}o=t.length;break n}if(!(e>=r)){const a=t[1];e<a&&(n=2,r=a);for(let l=n-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(i=r,r=t[--n-1],e>=r)break t}o=n,n=0;break n}break e}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(i=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let o=0;o!==i;++o)t[o]=n[r+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class VR extends xp{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:yh,endingEnd:yh}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,o=e+1,a=i[r],l=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case vh:r=e,a=2*t-n;break;case s0:r=i.length-2,a=t+i[r]-i[r+1];break;default:r=e,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case vh:o=e,l=2*n-t;break;case s0:o=1,l=n+i[1]-i[0];break;default:o=e-1,l=t}const c=(n-t)*.5,h=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-n),this._offsetPrev=r*h,this._offsetNext=o*h}interpolate_(e,t,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=this._offsetPrev,f=this._offsetNext,p=this._weightPrev,y=this._weightNext,v=(n-t)/(i-t),_=v*v,S=_*v,A=-p*S+2*p*_-p*v,w=(1+p)*S+(-1.5-2*p)*_+(-.5+p)*v+1,M=(-1-y)*S+(1.5+y)*_+.5*v,C=y*S-y*_;for(let I=0;I!==a;++I)r[I]=A*o[h+I]+w*o[c+I]+M*o[l+I]+C*o[f+I];return r}}class xE extends xp{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=(n-t)/(i-t),f=1-h;for(let p=0;p!==a;++p)r[p]=o[c+p]*f+o[l+p]*h;return r}}class WR extends xp{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class ca{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=_h(t,this.TimeBufferType),this.values=_h(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:_h(e.times,Array),values:_h(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new WR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new xE(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new VR(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Qf:t=this.InterpolantFactoryMethodDiscrete;break;case Zf:t=this.InterpolantFactoryMethodLinear;break;case Zy:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Qf;case this.InterpolantFactoryMethodLinear:return Zf;case this.InterpolantFactoryMethodSmooth:return Zy}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,o=i-1;for(;r!==i&&n[r]<e;)++r;for(;o!==-1&&n[o]>t;)--o;if(++o,r!==0||o!==i){r>=o&&(o=Math.max(o,1),r=o-1);const a=this.getValueSize();this.times=n.slice(r,o),this.values=this.values.slice(r*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==r;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(i!==void 0&&zR(i))for(let a=0,l=i.length;a!==l;++a){const c=i[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===Zy,r=e.length-1;let o=1;for(let a=1;a<r;++a){let l=!1;const c=e[a],h=e[a+1];if(c!==h&&(a!==1||c!==e[0]))if(i)l=!0;else{const f=a*n,p=f-n,y=f+n;for(let v=0;v!==n;++v){const _=t[f+v];if(_!==t[p+v]||_!==t[y+v]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const f=a*n,p=o*n;for(let y=0;y!==n;++y)t[p+y]=t[f+y]}++o}}if(r>0){e[o]=e[r];for(let a=r*n,l=o*n,c=0;c!==n;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}ca.prototype.TimeBufferType=Float32Array;ca.prototype.ValueBufferType=Float32Array;ca.prototype.DefaultInterpolation=Zf;class Qh extends ca{constructor(e,t,n){super(e,t,n)}}Qh.prototype.ValueTypeName="bool";Qh.prototype.ValueBufferType=Array;Qh.prototype.DefaultInterpolation=Qf;Qh.prototype.InterpolantFactoryMethodLinear=void 0;Qh.prototype.InterpolantFactoryMethodSmooth=void 0;class _E extends ca{}_E.prototype.ValueTypeName="color";class zh extends ca{}zh.prototype.ValueTypeName="number";class KR extends xp{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(i-t);let c=e*a;for(let h=c+a;c!==h;c+=4)hr.slerpFlat(r,0,o,c-a,o,c,l);return r}}class jh extends ca{InterpolantFactoryMethodLinear(e){return new KR(this.times,this.values,this.getValueSize(),e)}}jh.prototype.ValueTypeName="quaternion";jh.prototype.InterpolantFactoryMethodSmooth=void 0;class Zh extends ca{constructor(e,t,n){super(e,t,n)}}Zh.prototype.ValueTypeName="string";Zh.prototype.ValueBufferType=Array;Zh.prototype.DefaultInterpolation=Qf;Zh.prototype.InterpolantFactoryMethodLinear=void 0;Zh.prototype.InterpolantFactoryMethodSmooth=void 0;class Vh extends ca{}Vh.prototype.ValueTypeName="vector";class np{constructor(e="",t=-1,n=[],i=Px){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=$s(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(sk(n[o]).scale(i));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,o=n.length;r!==o;++r)t.push(ca.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const r=t.length,o=[];for(let a=0;a<r;a++){let l=[],c=[];l.push((a+r-1)%r,a,(a+1)%r),c.push(0,1,0);const h=jR(l);l=WS(l,1,h),c=WS(c,1,h),!i&&l[0]===0&&(l.push(r),c.push(c[0])),o.push(new zh(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],h=c.name.match(r);if(h&&h.length>1){const f=h[1];let p=i[f];p||(i[f]=p=[]),p.push(c)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(f,p,y,v,_){if(y.length!==0){const S=[],A=[];vE(y,S,A,v),S.length!==0&&_.push(new f(p,S,A))}},i=[],r=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let f=0;f<c.length;f++){const p=c[f].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const y={};let v;for(v=0;v<p.length;v++)if(p[v].morphTargets)for(let _=0;_<p[v].morphTargets.length;_++)y[p[v].morphTargets[_]]=-1;for(const _ in y){const S=[],A=[];for(let w=0;w!==p[v].morphTargets.length;++w){const M=p[v];S.push(M.time),A.push(M.morphTarget===_?1:0)}i.push(new zh(".morphTargetInfluence["+_+"]",S,A))}l=y.length*o}else{const y=".bones["+t[f].name+"]";n(Vh,y+".position",p,"pos",i),n(jh,y+".quaternion",p,"rot",i),n(Vh,y+".scale",p,"scl",i)}}return i.length===0?null:new this(r,l,i,a)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,i=e.length;n!==i;++n){const r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function rk(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return zh;case"vector":case"vector2":case"vector3":case"vector4":return Vh;case"color":return _E;case"quaternion":return jh;case"bool":case"boolean":return Qh;case"string":return Zh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function sk(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=rk(s.type);if(s.times===void 0){const t=[],n=[];vE(s.keys,t,n,"value"),s.times=t,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const Hl={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class SE{constructor(e,t,n){const i=this;let r=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(h){a++,r===!1&&i.onStart!==void 0&&i.onStart(h,o,a),r=!0},this.itemEnd=function(h){o++,i.onProgress!==void 0&&i.onProgress(h,o,a),o===a&&(r=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(h){i.onError!==void 0&&i.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,f){return c.push(h,f),this},this.removeHandler=function(h){const f=c.indexOf(h);return f!==-1&&c.splice(f,2),this},this.getHandler=function(h){for(let f=0,p=c.length;f<p;f+=2){const y=c[f],v=c[f+1];if(y.global&&(y.lastIndex=0),y.test(h))return v}return null}}}const kf=new SE;class zr{constructor(e){this.manager=e!==void 0?e:kf,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,r){n.load(e,i,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}zr.DEFAULT_MATERIAL_NAME="__DEFAULT";const Rl={};class ok extends Error{constructor(e,t){super(e),this.response=t}}class qs extends zr{constructor(e){super(e)}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=Hl.get(e);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(Rl[e]!==void 0){Rl[e].push({onLoad:t,onProgress:n,onError:i});return}Rl[e]=[],Rl[e].push({onLoad:t,onProgress:n,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const h=Rl[e],f=c.body.getReader(),p=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),y=p?parseInt(p):0,v=y!==0;let _=0;const S=new ReadableStream({start(A){w();function w(){f.read().then(({done:M,value:C})=>{if(M)A.close();else{_+=C.byteLength;const I=new ProgressEvent("progress",{lengthComputable:v,loaded:_,total:y});for(let O=0,k=h.length;O<k;O++){const N=h[O];N.onProgress&&N.onProgress(I)}A.enqueue(C),w()}},M=>{A.error(M)})}}});return new Response(S)}else throw new ok(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return c.json();default:if(a===void 0)return c.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),p=f&&f[1]?f[1].toLowerCase():void 0,y=new TextDecoder(p);return c.arrayBuffer().then(v=>y.decode(v))}}}).then(c=>{Hl.add(e,c);const h=Rl[e];delete Rl[e];for(let f=0,p=h.length;f<p;f++){const y=h[f];y.onLoad&&y.onLoad(c)}}).catch(c=>{const h=Rl[e];if(h===void 0)throw this.manager.itemError(e),c;delete Rl[e];for(let f=0,p=h.length;f<p;f++){const y=h[f];y.onError&&y.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class ak extends zr{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new qs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(r.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),r.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=np.parse(e[n]);t.push(i)}return t}}class lk extends zr{constructor(e){super(e)}load(e,t,n,i){const r=this,o=[],a=new Nx,l=new qs(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(r.withCredentials);let c=0;function h(f){l.load(e[f],function(p){const y=r.parse(p,!0);o[f]={width:y.width,height:y.height,format:y.format,mipmaps:y.mipmaps},c+=1,c===6&&(y.mipmapCount===1&&(a.minFilter=pi),a.image=o,a.format=y.format,a.needsUpdate=!0,t&&t(a))},n,i)}if(Array.isArray(e))for(let f=0,p=e.length;f<p;++f)h(f);else l.load(e,function(f){const p=r.parse(f,!0);if(p.isCubemap){const y=p.mipmaps.length/p.mipmapCount;for(let v=0;v<y;v++){o[v]={mipmaps:[]};for(let _=0;_<p.mipmapCount;_++)o[v].mipmaps.push(p.mipmaps[v*p.mipmapCount+_]),o[v].format=p.format,o[v].width=p.width,o[v].height=p.height}a.image=o}else a.image.width=p.width,a.image.height=p.height,a.mipmaps=p.mipmaps;p.mipmapCount===1&&(a.minFilter=pi),a.format=p.format,a.needsUpdate=!0,t&&t(a)},n,i);return a}}class p0 extends zr{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Hl.get(e);if(o!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o;const a=c0("img");function l(){h(),Hl.add(e,this),t&&t(this),r.manager.itemEnd(e)}function c(f){h(),i&&i(f),r.manager.itemError(e),r.manager.itemEnd(e)}function h(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(e),a.src=e,a}}class ck extends zr{constructor(e){super(e)}load(e,t,n,i){const r=new P0;r.colorSpace=As;const o=new p0(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(h){r.images[c]=h,a++,a===6&&(r.needsUpdate=!0,t&&t(r))},void 0,i)}for(let c=0;c<e.length;++c)l(c);return r}}class uk extends zr{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new Ba,a=new qs(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(r.withCredentials),a.load(e,function(l){let c;try{c=r.parse(l)}catch(h){if(i!==void 0)i(h);else{console.error(h);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:Ws,o.wrapT=c.wrapT!==void 0?c.wrapT:Ws,o.magFilter=c.magFilter!==void 0?c.magFilter:pi,o.minFilter=c.minFilter!==void 0?c.minFilter:pi,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(o.colorSpace=c.colorSpace),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Ao),c.mipmapCount===1&&(o.minFilter=pi),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c)},n,i),o}}class XR extends zr{constructor(e){super(e)}load(e,t,n,i){const r=new ei,o=new p0(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){r.image=a,r.needsUpdate=!0,t!==void 0&&t(r)},n,i),r}}class su extends An{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ut(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class $R extends su{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(An.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ut(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const E1=new Kt,iM=new J,rM=new J;class AE{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ue(512,512),this.map=null,this.mapPass=null,this.matrix=new Kt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new B0,this._frameExtents=new Ue(1,1),this._viewportCount=1,this._viewports=[new Cn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;iM.setFromMatrixPosition(e.matrixWorld),t.position.copy(iM),rM.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(rM),t.updateMatrixWorld(),E1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(E1),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(E1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class hk extends AE{constructor(){super(new si(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=ep*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(n!==t.fov||i!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class EE extends su{constructor(e,t,n=0,i=Math.PI/3,r=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(An.DEFAULT_UP),this.updateMatrix(),this.target=new An,this.distance=n,this.angle=i,this.penumbra=r,this.decay=o,this.map=null,this.shadow=new hk}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const sM=new Kt,Im=new J,T1=new J;class dk extends AE{constructor(){super(new si(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ue(4,2),this._viewportCount=6,this._viewports=[new Cn(2,1,1,1),new Cn(0,1,1,1),new Cn(3,1,1,1),new Cn(1,1,1,1),new Cn(3,0,1,1),new Cn(1,0,1,1)],this._cubeDirections=[new J(1,0,0),new J(-1,0,0),new J(0,0,1),new J(0,0,-1),new J(0,1,0),new J(0,-1,0)],this._cubeUps=[new J(0,1,0),new J(0,1,0),new J(0,1,0),new J(0,1,0),new J(0,0,1),new J(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Im.setFromMatrixPosition(e.matrixWorld),n.position.copy(Im),T1.copy(n.position),T1.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(T1),n.updateMatrixWorld(),i.makeTranslation(-Im.x,-Im.y,-Im.z),sM.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sM)}}class TE extends su{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new dk}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class ra extends L0{constructor(e=-1,t=1,n=1,i=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,o=n+e,a=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=c*this.view.offsetX,o=r+c*this.view.width,a-=h*this.view.offsetY,l=a-h*this.view.height}this.projectionMatrix.makeOrthographic(r,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class fk extends AE{constructor(){super(new ra(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class wE extends su{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(An.DEFAULT_UP),this.updateMatrix(),this.target=new An,this.shadow=new fk}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class YR extends su{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class JR extends su{constructor(e,t,n=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class qR{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new J)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*r),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*i)),t.addScaledVector(o[5],1.092548*(i*r)),t.addScaledVector(o[6],.315392*(3*r*r-1)),t.addScaledVector(o[7],1.092548*(n*r)),t.addScaledVector(o[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*r),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*i),t.addScaledVector(o[5],2*.429043*i*r),t.addScaledVector(o[6],.743125*r*r-.247708),t.addScaledVector(o[7],2*.429043*n*r),t.addScaledVector(o[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}class QR extends su{constructor(e=new qR,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class e_ extends zr{constructor(e){super(e),this.textures={}}load(e,t,n,i){const r=this,o=new qs(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(a){try{t(r.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),r.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(r){return t[r]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",r),t[r]}const i=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new ut().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const o=e.uniforms[r];switch(i.uniforms[r]={},o.type){case"t":i.uniforms[r].value=n(o.value);break;case"c":i.uniforms[r].value=new ut().setHex(o.value);break;case"v2":i.uniforms[r].value=new Ue().fromArray(o.value);break;case"v3":i.uniforms[r].value=new J().fromArray(o.value);break;case"v4":i.uniforms[r].value=new Cn().fromArray(o.value);break;case"m3":i.uniforms[r].value=new on().fromArray(o.value);break;case"m4":i.uniforms[r].value=new Kt().fromArray(o.value);break;default:i.uniforms[r].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)i.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),i.normalScale=new Ue().fromArray(r)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Ue().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return e_.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:OR,SpriteMaterial:sE,RawShaderMaterial:BR,ShaderMaterial:oa,PointsMaterial:kx,MeshPhysicalMaterial:Co,MeshStandardMaterial:U0,MeshPhongMaterial:FR,MeshToonMaterial:kR,MeshNormalMaterial:NR,MeshLambertMaterial:UR,MeshDepthMaterial:gE,MeshDistanceMaterial:yE,MeshBasicMaterial:Ks,MeshMatcapMaterial:GR,LineDashedMaterial:HR,LineBasicMaterial:Hr,Material:Ui};return new t[e]}}class Xc{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class ZR extends rn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class eI extends zr{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new qs(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(a){try{t(r.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),r.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(y,v){if(t[v]!==void 0)return t[v];const S=y.interleavedBuffers[v],A=r(y,S.buffer),w=Bf(S.type,A),M=new D0(w,S.stride);return M.uuid=S.uuid,t[v]=M,M}function r(y,v){if(n[v]!==void 0)return n[v];const S=y.arrayBuffers[v],A=new Uint32Array(S).buffer;return n[v]=A,A}const o=e.isInstancedBufferGeometry?new ZR:new rn,a=e.data.index;if(a!==void 0){const y=Bf(a.type,a.array);o.setIndex(new Rn(y,1))}const l=e.data.attributes;for(const y in l){const v=l[y];let _;if(v.isInterleavedBufferAttribute){const S=i(e.data,v.data);_=new Zc(S,v.itemSize,v.offset,v.normalized)}else{const S=Bf(v.type,v.array),A=v.isInstancedBufferAttribute?Gh:Rn;_=new A(S,v.itemSize,v.normalized)}v.name!==void 0&&(_.name=v.name),v.usage!==void 0&&_.setUsage(v.usage),o.setAttribute(y,_)}const c=e.data.morphAttributes;if(c)for(const y in c){const v=c[y],_=[];for(let S=0,A=v.length;S<A;S++){const w=v[S];let M;if(w.isInterleavedBufferAttribute){const C=i(e.data,w.data);M=new Zc(C,w.itemSize,w.offset,w.normalized)}else{const C=Bf(w.type,w.array);M=new Rn(C,w.itemSize,w.normalized)}w.name!==void 0&&(M.name=w.name),_.push(M)}o.morphAttributes[y]=_}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const f=e.data.groups||e.data.drawcalls||e.data.offsets;if(f!==void 0)for(let y=0,v=f.length;y!==v;++y){const _=f[y];o.addGroup(_.start,_.count,_.materialIndex)}const p=e.data.boundingSphere;if(p!==void 0){const y=new J;p.center!==void 0&&y.fromArray(p.center),o.boundingSphere=new dr(y,p.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class pk extends zr{constructor(e){super(e)}load(e,t,n,i){const r=this,o=this.path===""?Xc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new qs(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(f){i!==void 0&&i(f),console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message);return}const h=c.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}r.parse(c,t)},n,i)}async loadAsync(e,t){const n=this,i=this.path===""?Xc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const r=new qs(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const o=await r.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,r,l,a,n),h=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,h),this.bindLightTargets(c),t!==void 0){let f=!1;for(const p in o)if(o[p].data instanceof HTMLImageElement){f=!0;break}f===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,r),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,a,o,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const r=new Rh().fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(r){r.isBone&&(i[r.uuid]=r)}),e!==void 0)for(let r=0,o=e.length;r<o;r++){const a=new O0().fromJSON(e[r],i);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new eI;for(let r=0,o=e.length;r<o;r++){let a;const l=e[r];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(l);break;default:l.type in nM?a=nM[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const r=new e_;r.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];n[l.uuid]===void 0&&(n[l.uuid]=r.parse(l)),i[l.uuid]=n[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],r=np.parse(i);t[r.uuid]=r}return t}parseImages(e,t){const n=this,i={};let r;function o(l){return n.manager.itemStart(l),r.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return o(h)}else return l.data?{data:Bf(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new SE(t);r=new p0(l),r.setCrossOrigin(this.crossOrigin);for(let c=0,h=e.length;c<h;c++){const f=e[c],p=f.url;if(Array.isArray(p)){const y=[];for(let v=0,_=p.length;v<_;v++){const S=p[v],A=a(S);A!==null&&(A instanceof HTMLImageElement?y.push(A):y.push(new Ba(A.data,A.width,A.height)))}i[f.uuid]=new xh(y)}else{const y=a(f.url);i[f.uuid]=new xh(y)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function r(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await i.loadAsync(l)}else return o.data?{data:Bf(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new p0(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const h=[];for(let f=0,p=c.length;f<p;f++){const y=c[f],v=await r(y);v!==null&&(v instanceof HTMLImageElement?h.push(v):h.push(new Ba(v.data,v.width,v.height)))}n[l.uuid]=new xh(h)}else{const h=await r(l.url);n[l.uuid]=new xh(h)}}}return n}parseTextures(e,t){function n(r,o){return typeof r=="number"?r:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",r),o[r])}const i={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){const a=e[r];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let h;Array.isArray(c)?(h=new P0,c.length===6&&(h.needsUpdate=!0)):(c&&c.data?h=new Ba:h=new ei,c&&(h.needsUpdate=!0)),h.source=l,h.uuid=a.uuid,a.name!==void 0&&(h.name=a.name),a.mapping!==void 0&&(h.mapping=n(a.mapping,mk)),a.channel!==void 0&&(h.channel=a.channel),a.offset!==void 0&&h.offset.fromArray(a.offset),a.repeat!==void 0&&h.repeat.fromArray(a.repeat),a.center!==void 0&&h.center.fromArray(a.center),a.rotation!==void 0&&(h.rotation=a.rotation),a.wrap!==void 0&&(h.wrapS=n(a.wrap[0],oM),h.wrapT=n(a.wrap[1],oM)),a.format!==void 0&&(h.format=a.format),a.internalFormat!==void 0&&(h.internalFormat=a.internalFormat),a.type!==void 0&&(h.type=a.type),a.colorSpace!==void 0&&(h.colorSpace=a.colorSpace),a.minFilter!==void 0&&(h.minFilter=n(a.minFilter,aM)),a.magFilter!==void 0&&(h.magFilter=n(a.magFilter,aM)),a.anisotropy!==void 0&&(h.anisotropy=a.anisotropy),a.flipY!==void 0&&(h.flipY=a.flipY),a.generateMipmaps!==void 0&&(h.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(h.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(h.compareFunction=a.compareFunction),a.userData!==void 0&&(h.userData=a.userData),i[a.uuid]=h}return i}parseObject(e,t,n,i,r){let o;function a(p){return t[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",p),t[p]}function l(p){if(p!==void 0){if(Array.isArray(p)){const y=[];for(let v=0,_=p.length;v<_;v++){const S=p[v];n[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),y.push(n[S])}return y}return n[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",p),n[p]}}function c(p){return i[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",p),i[p]}let h,f;switch(e.type){case"Scene":o=new Jv,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new ut(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Bx(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Ox(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new si(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new ra(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new YR(e.color,e.intensity);break;case"DirectionalLight":o=new wE(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new TE(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new JR(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new EE(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new $R(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new QR().fromJSON(e);break;case"SkinnedMesh":h=a(e.geometry),f=l(e.material),o=new oE(h,f),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":h=a(e.geometry),f=l(e.material),o=new Ci(h,f);break;case"InstancedMesh":h=a(e.geometry),f=l(e.material);const p=e.count,y=e.instanceMatrix,v=e.instanceColor;o=new aE(h,f,p),o.instanceMatrix=new Gh(new Float32Array(y.array),16),v!==void 0&&(o.instanceColor=new Gh(new Float32Array(v.array),v.itemSize));break;case"BatchedMesh":h=a(e.geometry),f=l(e.material),o=new AR(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,f),o.geometry=h,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(_=>{const S=new wr;S.min.fromArray(_.boxMin),S.max.fromArray(_.boxMax);const A=new dr;return A.radius=_.sphereRadius,A.center.fromArray(_.sphereCenter),{boxInitialized:_.boxInitialized,box:S,sphereInitialized:_.sphereInitialized,sphere:A}}),o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=c(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=c(e.colorsTexture.uuid));break;case"LOD":o=new SR;break;case"Line":o=new $l(a(e.geometry),l(e.material));break;case"LineLoop":o=new lE(a(e.geometry),l(e.material));break;case"LineSegments":o=new aa(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new cE(a(e.geometry),l(e.material));break;case"Sprite":o=new _R(l(e.material));break;case"Group":o=new Gl;break;case"Bone":o=new Fx;break;default:o=new An}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const p=e.children;for(let y=0;y<p.length;y++)o.add(this.parseObject(p[y],t,n,i,r))}if(e.animations!==void 0){const p=e.animations;for(let y=0;y<p.length;y++){const v=p[y];o.animations.push(r[v])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const p=e.levels;for(let y=0;y<p.length;y++){const v=p[y],_=o.getObjectByProperty("uuid",v.object);_!==void 0&&o.addLevel(_,v.distance,v.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,i=e.getObjectByProperty("uuid",n);i!==void 0?t.target=i:t.target=new An}})}}const mk={UVMapping:Tx,CubeReflectionMapping:Kl,CubeRefractionMapping:qc,EquirectangularReflectionMapping:i0,EquirectangularRefractionMapping:r0,CubeUVReflectionMapping:gp},oM={RepeatWrapping:Qc,ClampToEdgeWrapping:Ws,MirroredRepeatWrapping:Jf},aM={NearestFilter:ur,NearestMipmapNearestFilter:wx,NearestMipmapLinearFilter:gh,LinearFilter:pi,LinearMipmapNearestFilter:jf,LinearMipmapLinearFilter:Ao};class tI extends zr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Hl.get(e);if(o!==void 0){if(r.manager.itemStart(e),o.then){o.then(c=>{t&&t(c),r.manager.itemEnd(e)}).catch(c=>{i&&i(c)});return}return setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(c){return Hl.add(e,c),t&&t(c),r.manager.itemEnd(e),c}).catch(function(c){i&&i(c),Hl.remove(e),r.manager.itemError(e),r.manager.itemEnd(e)});Hl.add(e,l),r.manager.itemStart(e)}}let Ay;class ME{static getContext(){return Ay===void 0&&(Ay=new(window.AudioContext||window.webkitAudioContext)),Ay}static setContext(e){Ay=e}}class gk extends zr{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new qs(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);ME.getContext().decodeAudioData(c,function(f){t(f)}).catch(a)}catch(c){a(c)}},n,i);function a(l){i?i(l):console.error(l),r.manager.itemError(e)}}}const lM=new Kt,cM=new Kt,Qu=new Kt;class yk{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new si,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new si,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Qu.copy(e.projectionMatrix);const i=t.eyeSep/2,r=i*t.near/t.focus,o=t.near*Math.tan(bh*t.fov*.5)/t.zoom;let a,l;cM.elements[12]=-i,lM.elements[12]=i,a=-o*t.aspect+r,l=o*t.aspect+r,Qu.elements[0]=2*t.near/(l-a),Qu.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Qu),a=-o*t.aspect-r,l=o*t.aspect-r,Qu.elements[0]=2*t.near/(l-a),Qu.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Qu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(cM),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(lM)}}class nI extends si{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class bE{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=uM(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=uM();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function uM(){return performance.now()}const Zu=new J,hM=new hr,vk=new J,eh=new J;class xk extends An{constructor(){super(),this.type="AudioListener",this.context=ME.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new bE}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Zu,hM,vk),eh.set(0,0,-1).applyQuaternion(hM),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Zu.x,i),t.positionY.linearRampToValueAtTime(Zu.y,i),t.positionZ.linearRampToValueAtTime(Zu.z,i),t.forwardX.linearRampToValueAtTime(eh.x,i),t.forwardY.linearRampToValueAtTime(eh.y,i),t.forwardZ.linearRampToValueAtTime(eh.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(Zu.x,Zu.y,Zu.z),t.setOrientation(eh.x,eh.y,eh.z,n.x,n.y,n.z)}}class iI extends An{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const th=new J,dM=new hr,_k=new J,nh=new J;class Sk extends iI{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(th,dM,_k),nh.set(0,0,1).applyQuaternion(dM);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(th.x,n),t.positionY.linearRampToValueAtTime(th.y,n),t.positionZ.linearRampToValueAtTime(th.z,n),t.orientationX.linearRampToValueAtTime(nh.x,n),t.orientationY.linearRampToValueAtTime(nh.y,n),t.orientationZ.linearRampToValueAtTime(nh.z,n)}else t.setPosition(th.x,th.y,th.z),t.setOrientation(nh.x,nh.y,nh.z)}}class Ak{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class rI{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,r,o;switch(t){case"quaternion":i=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,r=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)n[r+a]=n[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(n,r,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const l=t*this._origIndex;this._mixBufferRegion(n,i,l,1-r,t)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(n[l]!==n[l+t]){a.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let r=n,o=i;r!==o;++r)t[r]=t[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let o=0;o!==r;++o)e[t+o]=e[n+o]}_slerp(e,t,n,i){hr.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){const o=this._workIndex*r;hr.multiplyQuaternionsFlat(e,o,e,t,e,n),hr.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,n,i,r){const o=1-i;for(let a=0;a!==r;++a){const l=t+a;e[l]=e[l]*o+e[n+a]*i}}_lerpAdditive(e,t,n,i,r){for(let o=0;o!==r;++o){const a=t+o;e[a]=e[a]+e[n+o]*i}}}const CE="\\[\\]\\.:\\/",Ek=new RegExp("["+CE+"]","g"),RE="[^"+CE+"]",Tk="[^"+CE.replace("\\.","")+"]",wk=/((?:WC+[\/:])*)/.source.replace("WC",RE),Mk=/(WCOD+)?/.source.replace("WCOD",Tk),bk=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",RE),Ck=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",RE),Rk=new RegExp("^"+wk+Mk+bk+Ck+"$"),Ik=["material","materials","bones","map"];class Lk{constructor(e,t,n){const i=n||wn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class wn{constructor(e,t,n){this.path=t,this.parsedPath=n||wn.parseTrackName(t),this.node=wn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new wn.Composite(e,t,n):new wn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Ek,"")}static parseTrackName(e){const t=Rk.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const r=n.nodeName.substring(i+1);Ik.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(r){for(let o=0;o<r.length;o++){const a=r[o];if(a.name===t||a.uuid===t)return a;const l=n(a.children);if(l)return l}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=wn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let c=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===c){c=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[i];if(o===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(r!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}wn.Composite=Lk;wn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};wn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};wn.prototype.GetterByBindingType=[wn.prototype._getValue_direct,wn.prototype._getValue_array,wn.prototype._getValue_arrayElement,wn.prototype._getValue_toArray];wn.prototype.SetterByBindingTypeAndVersioning=[[wn.prototype._setValue_direct,wn.prototype._setValue_direct_setNeedsUpdate,wn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[wn.prototype._setValue_array,wn.prototype._setValue_array_setNeedsUpdate,wn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[wn.prototype._setValue_arrayElement,wn.prototype._setValue_arrayElement_setNeedsUpdate,wn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[wn.prototype._setValue_fromArray,wn.prototype._setValue_fromArray_setNeedsUpdate,wn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Pk{constructor(){this.isAnimationObjectGroup=!0,this.uuid=$s(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,o=r.length;let a,l=e.length,c=this.nCachedObjects_;for(let h=0,f=arguments.length;h!==f;++h){const p=arguments[h],y=p.uuid;let v=t[y];if(v===void 0){v=l++,t[y]=v,e.push(p);for(let _=0,S=o;_!==S;++_)r[_].push(new wn(p,n[_],i[_]))}else if(v<c){a=e[v];const _=--c,S=e[_];t[S.uuid]=v,e[v]=S,t[y]=_,e[_]=p;for(let A=0,w=o;A!==w;++A){const M=r[A],C=M[_];let I=M[v];M[v]=C,I===void 0&&(I=new wn(p,n[A],i[A])),M[_]=I}}else e[v]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,h=t[c];if(h!==void 0&&h>=r){const f=r++,p=e[f];t[p.uuid]=h,e[h]=p,t[c]=f,e[f]=l;for(let y=0,v=i;y!==v;++y){const _=n[y],S=_[f],A=_[h];_[h]=S,_[f]=A}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],h=c.uuid,f=t[h];if(f!==void 0)if(delete t[h],f<r){const p=--r,y=e[p],v=--o,_=e[v];t[y.uuid]=f,e[f]=y,t[_.uuid]=p,e[p]=_,e.pop();for(let S=0,A=i;S!==A;++S){const w=n[S],M=w[p],C=w[v];w[f]=M,w[p]=C,w.pop()}}else{const p=--o,y=e[p];p>0&&(t[y.uuid]=f),e[f]=y,e.pop();for(let v=0,_=i;v!==_;++v){const S=n[v];S[f]=S[p],S.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const r=this._bindings;if(i!==void 0)return r[i];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,h=this.nCachedObjects_,f=new Array(c);i=r.length,n[e]=i,o.push(e),a.push(t),r.push(f);for(let p=h,y=l.length;p!==y;++p){const v=l[p];f[p]=new wn(v,e,t)}return f}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];t[c]=n,o[n]=l,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}}class sI{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const r=t.tracks,o=r.length,a=new Array(o),l={endingStart:yh,endingEnd:yh};for(let c=0;c!==o;++c){const h=r[c].createInterpolant(null);a[c]=h,h.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=QC,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const i=this._clip.duration,r=e._clip.duration,o=r/i,a=i/r;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,r=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=r,l[1]=r+n,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const l=(e-r)*n;l<0||n===0?t=0:(this._startTime=null,t=n*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case JA:for(let h=0,f=l.length;h!==f;++h)l[h].evaluate(o),c[h].accumulateAdditive(a);break;case Px:default:for(let h=0,f=l.length;h!==f;++h)l[h].evaluate(o),c[h].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,r=this._loopCount;const o=n===ZC;if(e===0)return r===-1?i:o&&(r&1)===1?t-i:i;if(n===qC){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,r+=Math.abs(a);const l=this.repetitions-r;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(r&1)===1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=vh,i.endingEnd=vh):(e?i.endingStart=this.zeroSlopeAtStart?vh:yh:i.endingStart=s0,t?i.endingEnd=this.zeroSlopeAtEnd?vh:yh:i.endingEnd=s0)}_scheduleFading(e,t,n){const i=this._mixer,r=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=r,l[0]=t,a[1]=r+e,l[1]=n,this}}const Dk=new Float32Array(1);class Ok extends Va{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,o=e._propertyBindings,a=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let h=c[l];h===void 0&&(h={},c[l]=h);for(let f=0;f!==r;++f){const p=i[f],y=p.name;let v=h[y];if(v!==void 0)++v.referenceCount,o[f]=v;else{if(v=o[f],v!==void 0){v._cacheIndex===null&&(++v.referenceCount,this._addInactiveBinding(v,l,y));continue}const _=t&&t._propertyBindings[f].binding.parsedPath;v=new rI(wn.create(n,y,_),p.ValueTypeName,p.getValueSize()),++v.referenceCount,this._addInactiveBinding(v,l,y),o[f]=v}a[f].resultBuffer=v.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,r=this._actionsByClip[i];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const r=t[n];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const r=t[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,r=this._actionsByClip;let o=r[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,o=this._actionsByClip,a=o[r],l=a.knownActions,c=l[l.length-1],h=e._byClipCacheIndex;c._byClipCacheIndex=h,l[h]=c,l.pop(),e._byClipCacheIndex=null;const f=a.actionByRoot,p=(e._localRoot||this._root).uuid;delete f[p],l.length===0&&delete o[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const r=t[n];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,r=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,a=o[i],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[r],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new xE(new Float32Array(2),new Float32Array(2),1,Dk),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const i=t||this._root,r=i.uuid;let o=typeof e=="string"?np.findByName(i,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(n===void 0&&(o!==null?n=o.blendMode:n=Px),l!==void 0){const f=l.actionByRoot[r];if(f!==void 0&&f.blendMode===n)return f;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const h=new sI(this,o,t,n);return this._bindAction(h,c),this._addInactiveAction(h,a,r),h}existingAction(e,t){const n=t||this._root,i=n.uuid,r=typeof e=="string"?np.findByName(n,e):e,o=r?r.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==n;++c)t[c]._update(i,e,r,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(r!==void 0){const o=r.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const h=c._cacheIndex,f=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,f._cacheIndex=h,t[h]=f,t.pop(),this._removeInactiveBindingsForAction(c)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,r=i[t];if(r!==void 0)for(const o in r){const a=r[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class IE{constructor(e){this.value=e}clone(){return new IE(this.value.clone===void 0?this.value:this.value.clone())}}let Bk=0;class Fk extends Va{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Bk++}),this.name="",this.usage=a0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){const r=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<r.length;o++)this.uniforms.push(r[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class kk extends D0{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Nk{constructor(e,t,n,i,r){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const fM=new Kt;class oI{constructor(e,t,n=0,i=1/0){this.ray=new Jh(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Ch,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return fM.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(fM),this}intersectObject(e,t=!0,n=[]){return KS(e,this,n,t),n.sort(pM),n}intersectObjects(e,t=!0,n=[]){for(let i=0,r=e.length;i<r;i++)KS(e[i],this,n,t);return n.sort(pM),n}}function pM(s,e){return s.distance-e.distance}function KS(s,e,t,n){let i=!0;if(s.layers.test(e.layers)&&s.raycast(e,t)===!1&&(i=!1),i===!0&&n===!0){const r=s.children;for(let o=0,a=r.length;o<a;o++)KS(r[o],e,t,!0)}}class XS{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=nn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(nn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Uk{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class LE{constructor(e,t,n,i){LE.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,i)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,i){const r=this.elements;return r[0]=e,r[2]=t,r[1]=n,r[3]=i,this}}const mM=new Ue;class Gk{constructor(e=new Ue(1/0,1/0),t=new Ue(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=mM.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,mM).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const gM=new J,Ey=new J;class Hk{constructor(e=new J,t=new J){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){gM.subVectors(e,this.start),Ey.subVectors(this.end,this.start);const n=Ey.dot(Ey);let r=Ey.dot(gM)/n;return t&&(r=nn(r,0,1)),r}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const yM=new J;class zk extends An{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new rn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,h=a/l*Math.PI*2;i.push(Math.cos(c),Math.sin(c),1,Math.cos(h),Math.sin(h),1)}n.setAttribute("position",new Dt(i,3));const r=new Hr({fog:!1,toneMapped:!1});this.cone=new aa(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),yM.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(yM),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const kc=new J,Ty=new Kt,w1=new Kt;class jk extends aa{constructor(e){const t=aI(e),n=new rn,i=[],r=[],o=new ut(0,0,1),a=new ut(0,1,0);for(let c=0;c<t.length;c++){const h=t[c];h.parent&&h.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}n.setAttribute("position",new Dt(i,3)),n.setAttribute("color",new Dt(r,3));const l=new Hr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");w1.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){const a=t[r];a.parent&&a.parent.isBone&&(Ty.multiplyMatrices(w1,a.matrixWorld),kc.setFromMatrixPosition(Ty),i.setXYZ(o,kc.x,kc.y,kc.z),Ty.multiplyMatrices(w1,a.parent.matrixWorld),kc.setFromMatrixPosition(Ty),i.setXYZ(o+1,kc.x,kc.y,kc.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function aI(s){const e=[];s.isBone===!0&&e.push(s);for(let t=0;t<s.children.length;t++)e.push.apply(e,aI(s.children[t]));return e}class Vk extends Ci{constructor(e,t,n){const i=new N0(t,4,2),r=new Ks({wireframe:!0,fog:!1,toneMapped:!1});super(i,r),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Wk=new J,vM=new ut,xM=new ut;class Kk extends An{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new k0(t);i.rotateY(Math.PI*.5),this.material=new Ks({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),o=new Float32Array(r.count*3);i.setAttribute("color",new Rn(o,3)),this.add(new Ci(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");vM.copy(this.light.color),xM.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const r=n<i/2?vM:xM;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Wk.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Xk extends aa{constructor(e=10,t=10,n=4473924,i=8947848){n=new ut(n),i=new ut(i);const r=t/2,o=e/t,a=e/2,l=[],c=[];for(let p=0,y=0,v=-a;p<=t;p++,v+=o){l.push(-a,0,v,a,0,v),l.push(v,0,-a,v,0,a);const _=p===r?n:i;_.toArray(c,y),y+=3,_.toArray(c,y),y+=3,_.toArray(c,y),y+=3,_.toArray(c,y),y+=3}const h=new rn;h.setAttribute("position",new Dt(l,3)),h.setAttribute("color",new Dt(c,3));const f=new Hr({vertexColors:!0,toneMapped:!1});super(h,f),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class $k extends aa{constructor(e=10,t=16,n=8,i=64,r=4473924,o=8947848){r=new ut(r),o=new ut(o);const a=[],l=[];if(t>1)for(let f=0;f<t;f++){const p=f/t*(Math.PI*2),y=Math.sin(p)*e,v=Math.cos(p)*e;a.push(0,0,0),a.push(y,0,v);const _=f&1?r:o;l.push(_.r,_.g,_.b),l.push(_.r,_.g,_.b)}for(let f=0;f<n;f++){const p=f&1?r:o,y=e-e/n*f;for(let v=0;v<i;v++){let _=v/i*(Math.PI*2),S=Math.sin(_)*y,A=Math.cos(_)*y;a.push(S,0,A),l.push(p.r,p.g,p.b),_=(v+1)/i*(Math.PI*2),S=Math.sin(_)*y,A=Math.cos(_)*y,a.push(S,0,A),l.push(p.r,p.g,p.b)}}const c=new rn;c.setAttribute("position",new Dt(a,3)),c.setAttribute("color",new Dt(l,3));const h=new Hr({vertexColors:!0,toneMapped:!1});super(c,h),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _M=new J,wy=new J,SM=new J;class Yk extends An{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new rn;i.setAttribute("position",new Dt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new Hr({fog:!1,toneMapped:!1});this.lightPlane=new $l(i,r),this.add(this.lightPlane),i=new rn,i.setAttribute("position",new Dt([0,0,0,0,0,1],3)),this.targetLine=new $l(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_M.setFromMatrixPosition(this.light.matrixWorld),wy.setFromMatrixPosition(this.light.target.matrixWorld),SM.subVectors(wy,_M),this.lightPlane.lookAt(wy),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(wy),this.targetLine.scale.z=SM.length()}}const My=new J,Si=new L0;class Jk extends aa{constructor(e){const t=new rn,n=new Hr({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(v,_){l(v),l(_)}function l(v){i.push(0,0,0),r.push(0,0,0),o[v]===void 0&&(o[v]=[]),o[v].push(i.length/3-1)}t.setAttribute("position",new Dt(i,3)),t.setAttribute("color",new Dt(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new ut(16755200),h=new ut(16711680),f=new ut(43775),p=new ut(16777215),y=new ut(3355443);this.setColors(c,h,f,p,y)}setColors(e,t,n,i,r){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,r.r,r.g,r.b),a.setXYZ(41,r.r,r.g,r.b),a.setXYZ(42,r.r,r.g,r.b),a.setXYZ(43,r.r,r.g,r.b),a.setXYZ(44,r.r,r.g,r.b),a.setXYZ(45,r.r,r.g,r.b),a.setXYZ(46,r.r,r.g,r.b),a.setXYZ(47,r.r,r.g,r.b),a.setXYZ(48,r.r,r.g,r.b),a.setXYZ(49,r.r,r.g,r.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,i=1;Si.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Mi("c",t,e,Si,0,0,-1),Mi("t",t,e,Si,0,0,1),Mi("n1",t,e,Si,-n,-i,-1),Mi("n2",t,e,Si,n,-i,-1),Mi("n3",t,e,Si,-n,i,-1),Mi("n4",t,e,Si,n,i,-1),Mi("f1",t,e,Si,-n,-i,1),Mi("f2",t,e,Si,n,-i,1),Mi("f3",t,e,Si,-n,i,1),Mi("f4",t,e,Si,n,i,1),Mi("u1",t,e,Si,n*.7,i*1.1,-1),Mi("u2",t,e,Si,-n*.7,i*1.1,-1),Mi("u3",t,e,Si,0,i*2,-1),Mi("cf1",t,e,Si,-n,0,1),Mi("cf2",t,e,Si,n,0,1),Mi("cf3",t,e,Si,0,-i,1),Mi("cf4",t,e,Si,0,i,1),Mi("cn1",t,e,Si,-n,0,-1),Mi("cn2",t,e,Si,n,0,-1),Mi("cn3",t,e,Si,0,-i,-1),Mi("cn4",t,e,Si,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Mi(s,e,t,n,i,r,o){My.set(i,r,o).unproject(n);const a=e[s];if(a!==void 0){const l=t.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],My.x,My.y,My.z)}}const by=new wr;class qk extends aa{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),r=new rn;r.setIndex(new Rn(n,1)),r.setAttribute("position",new Rn(i,3)),super(r,new Hr({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&by.setFromObject(this.object),by.isEmpty())return;const t=by.min,n=by.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Qk extends aa{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new rn;r.setIndex(new Rn(n,1)),r.setAttribute("position",new Dt(i,3)),super(r,new Hr({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Zk extends $l{constructor(e,t=1,n=16776960){const i=n,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new rn;o.setAttribute("position",new Dt(r,3)),o.computeBoundingSphere(),super(o,new Hr({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new rn;l.setAttribute("position",new Dt(a,3)),l.computeBoundingSphere(),this.add(new Ci(l,new Ks({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const AM=new J;let Cy,M1;class eN extends An{constructor(e=new J(0,0,1),t=new J(0,0,0),n=1,i=16776960,r=n*.2,o=r*.2){super(),this.type="ArrowHelper",Cy===void 0&&(Cy=new rn,Cy.setAttribute("position",new Dt([0,0,0,0,1,0],3)),M1=new yp(0,.5,1,5,1),M1.translate(0,-.5,0)),this.position.copy(t),this.line=new $l(Cy,new Hr({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ci(M1,new Ks({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{AM.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(AM,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class tN extends aa{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new rn;i.setAttribute("position",new Dt(t,3)),i.setAttribute("color",new Dt(n,3));const r=new Hr({vertexColors:!0,toneMapped:!1});super(i,r),this.type="AxesHelper"}setColors(e,t,n){const i=new ut,r=this.geometry.attributes.color.array;return i.set(e),i.toArray(r,0),i.toArray(r,3),i.set(t),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class nN{constructor(){this.type="ShapePath",this.color=new ut,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new u0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,o){return this.currentPath.bezierCurveTo(e,t,n,i,r,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(A){const w=[];for(let M=0,C=A.length;M<C;M++){const I=A[M],O=new Rh;O.curves=I.curves,w.push(O)}return w}function n(A,w){const M=w.length;let C=!1;for(let I=M-1,O=0;O<M;I=O++){let k=w[I],N=w[O],B=N.x-k.x,P=N.y-k.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(k=w[O],B=-B,N=w[I],P=-P),A.y<k.y||A.y>N.y)continue;if(A.y===k.y){if(A.x===k.x)return!0}else{const G=P*(A.x-k.x)-B*(A.y-k.y);if(G===0)return!0;if(G<0)continue;C=!C}}else{if(A.y!==k.y)continue;if(N.x<=A.x&&A.x<=k.x||k.x<=A.x&&A.x<=N.x)return!0}}return C}const i=Fa.isClockWise,r=this.subPaths;if(r.length===0)return[];let o,a,l;const c=[];if(r.length===1)return a=r[0],l=new Rh,l.curves=a.curves,c.push(l),c;let h=!i(r[0].getPoints());h=e?!h:h;const f=[],p=[];let y=[],v=0,_;p[v]=void 0,y[v]=[];for(let A=0,w=r.length;A<w;A++)a=r[A],_=a.getPoints(),o=i(_),o=e?!o:o,o?(!h&&p[v]&&v++,p[v]={s:new Rh,p:_},p[v].s.curves=a.curves,h&&v++,y[v]=[]):y[v].push({h:a,p:_[0]});if(!p[0])return t(r);if(p.length>1){let A=!1,w=0;for(let M=0,C=p.length;M<C;M++)f[M]=[];for(let M=0,C=p.length;M<C;M++){const I=y[M];for(let O=0;O<I.length;O++){const k=I[O];let N=!0;for(let B=0;B<p.length;B++)n(k.p,p[B].p)&&(M!==B&&w++,N?(N=!1,f[B].push(k)):A=!0);N&&f[M].push(k)}}w>0&&A===!1&&(y=f)}let S;for(let A=0,w=p.length;A<w;A++){l=p[A].s,c.push(l),S=y[A];for(let M=0,C=S.length;M<C;M++)l.holes.push(S[M].h)}return c}}class iN extends Va{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}function rN(s,e){const t=s.image&&s.image.width?s.image.width/s.image.height:1;return t>e?(s.repeat.x=1,s.repeat.y=t/e,s.offset.x=0,s.offset.y=(1-s.repeat.y)/2):(s.repeat.x=e/t,s.repeat.y=1,s.offset.x=(1-s.repeat.x)/2,s.offset.y=0),s}function sN(s,e){const t=s.image&&s.image.width?s.image.width/s.image.height:1;return t>e?(s.repeat.x=e/t,s.repeat.y=1,s.offset.x=(1-s.repeat.x)/2,s.offset.y=0):(s.repeat.x=1,s.repeat.y=t/e,s.offset.x=0,s.offset.y=(1-s.repeat.y)/2),s}function oN(s){return s.repeat.x=1,s.repeat.y=1,s.offset.x=0,s.offset.y=0,s}function $S(s,e,t,n){const i=aN(n);switch(t){case VA:return s*e;case KA:return s*e;case XA:return s*e*2;case Rx:return s*e/i.components*i.byteLength;case I0:return s*e/i.components*i.byteLength;case $A:return s*e*2/i.components*i.byteLength;case Ix:return s*e*2/i.components*i.byteLength;case WA:return s*e*3/i.components*i.byteLength;case Nr:return s*e*4/i.components*i.byteLength;case Lx:return s*e*4/i.components*i.byteLength;case jm:case Vm:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case Wm:case Km:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case Tv:case Mv:return Math.max(s,16)*Math.max(e,8)/4;case Ev:case wv:return Math.max(s,8)*Math.max(e,8)/2;case bv:case Cv:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case Rv:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case Iv:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case Lv:return Math.floor((s+4)/5)*Math.floor((e+3)/4)*16;case Pv:return Math.floor((s+4)/5)*Math.floor((e+4)/5)*16;case Dv:return Math.floor((s+5)/6)*Math.floor((e+4)/5)*16;case Ov:return Math.floor((s+5)/6)*Math.floor((e+5)/6)*16;case Bv:return Math.floor((s+7)/8)*Math.floor((e+4)/5)*16;case Fv:return Math.floor((s+7)/8)*Math.floor((e+5)/6)*16;case kv:return Math.floor((s+7)/8)*Math.floor((e+7)/8)*16;case Nv:return Math.floor((s+9)/10)*Math.floor((e+4)/5)*16;case Uv:return Math.floor((s+9)/10)*Math.floor((e+5)/6)*16;case Gv:return Math.floor((s+9)/10)*Math.floor((e+7)/8)*16;case Hv:return Math.floor((s+9)/10)*Math.floor((e+9)/10)*16;case zv:return Math.floor((s+11)/12)*Math.floor((e+9)/10)*16;case jv:return Math.floor((s+11)/12)*Math.floor((e+11)/12)*16;case Xm:case Vv:case Wv:return Math.ceil(s/4)*Math.ceil(e/4)*16;case YA:case Kv:return Math.ceil(s/4)*Math.ceil(e/4)*8;case Xv:case $v:return Math.ceil(s/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function aN(s){switch(s){case sa:case HA:return{byteLength:1,components:1};case qf:case zA:case Yh:return{byteLength:2,components:1};case bx:case Cx:return{byteLength:2,components:4};case Xl:case Mx:case rs:return{byteLength:4,components:1};case jA:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${s}.`)}const lN={contain:rN,cover:sN,fill:oN,getByteLength:$S};class cN extends wo{constructor(e=1,t=1,n=1,i={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,{...i,count:n}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:C0}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=C0);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function lI(){let s=null,e=!1,t=null,n=null;function i(r,o){t(r,o),n=s.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=s.requestAnimationFrame(i),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){s=r}}}function uN(s){const e=new WeakMap;function t(a,l){const c=a.array,h=a.usage,f=c.byteLength,p=s.createBuffer();s.bindBuffer(l,p),s.bufferData(l,c,h),a.onUploadCallback();let y;if(c instanceof Float32Array)y=s.FLOAT;else if(c instanceof Uint16Array)a.isFloat16BufferAttribute?y=s.HALF_FLOAT:y=s.UNSIGNED_SHORT;else if(c instanceof Int16Array)y=s.SHORT;else if(c instanceof Uint32Array)y=s.UNSIGNED_INT;else if(c instanceof Int32Array)y=s.INT;else if(c instanceof Int8Array)y=s.BYTE;else if(c instanceof Uint8Array)y=s.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)y=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:p,type:y,bytesPerElement:c.BYTES_PER_ELEMENT,version:a.version,size:f}}function n(a,l,c){const h=l.array,f=l.updateRanges;if(s.bindBuffer(c,a),f.length===0)s.bufferSubData(c,0,h);else{f.sort((y,v)=>y.start-v.start);let p=0;for(let y=1;y<f.length;y++){const v=f[p],_=f[y];_.start<=v.start+v.count+1?v.count=Math.max(v.count,_.start+_.count-v.start):(++p,f[p]=_)}f.length=p+1;for(let y=0,v=f.length;y<v;y++){const _=f[y];s.bufferSubData(c,_.start*h.BYTES_PER_ELEMENT,h,_.start,_.count)}l.clearUpdateRanges()}l.onUploadCallback()}function i(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function r(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(s.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const h=e.get(a);(!h||h.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const c=e.get(a);if(c===void 0)e.set(a,t(a,l));else if(c.version<a.version){if(c.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(c.buffer,a,l),c.version=a.version}}return{get:i,remove:r,update:o}}var hN=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,dN=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,fN=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,pN=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,mN=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,gN=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,yN=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,vN=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,xN=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,_N=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,SN=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,AN=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,EN=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,TN=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,wN=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,MN=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,bN=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,CN=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,RN=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,IN=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,LN=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,PN=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,DN=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,ON=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,BN=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,FN=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,kN=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,NN=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,UN=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,GN=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,HN="gl_FragColor = linearToOutputTexel( gl_FragColor );",zN=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,jN=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,VN=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,WN=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,KN=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,XN=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,$N=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,YN=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,JN=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,qN=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,QN=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,ZN=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,e4=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,t4=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,n4=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,i4=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,r4=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,s4=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,o4=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,a4=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,l4=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,c4=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,u4=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,h4=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,d4=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,f4=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,p4=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,m4=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,g4=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,y4=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,v4=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,x4=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,_4=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,S4=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,A4=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,E4=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,T4=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,w4=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,M4=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,b4=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,C4=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,R4=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,I4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,L4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,P4=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,D4=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,O4=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,B4=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,F4=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,k4=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,N4=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,U4=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,G4=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,H4=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,z4=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,j4=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,V4=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,W4=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,K4=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,X4=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,$4=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Y4=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,J4=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,q4=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Q4=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Z4=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,eU=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,tU=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,nU=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,iU=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,rU=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,sU=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,oU=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,aU=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,lU=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,cU=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const uU=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,hU=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,dU=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fU=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,pU=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,mU=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,gU=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,yU=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,vU=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,xU=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,_U=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,SU=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,AU=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,EU=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,TU=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,wU=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,MU=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,bU=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,CU=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,RU=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,IU=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,LU=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,PU=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,DU=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,OU=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,BU=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FU=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kU=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,NU=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,UU=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,GU=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,HU=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,zU=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,jU=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,mn={alphahash_fragment:hN,alphahash_pars_fragment:dN,alphamap_fragment:fN,alphamap_pars_fragment:pN,alphatest_fragment:mN,alphatest_pars_fragment:gN,aomap_fragment:yN,aomap_pars_fragment:vN,batching_pars_vertex:xN,batching_vertex:_N,begin_vertex:SN,beginnormal_vertex:AN,bsdfs:EN,iridescence_fragment:TN,bumpmap_pars_fragment:wN,clipping_planes_fragment:MN,clipping_planes_pars_fragment:bN,clipping_planes_pars_vertex:CN,clipping_planes_vertex:RN,color_fragment:IN,color_pars_fragment:LN,color_pars_vertex:PN,color_vertex:DN,common:ON,cube_uv_reflection_fragment:BN,defaultnormal_vertex:FN,displacementmap_pars_vertex:kN,displacementmap_vertex:NN,emissivemap_fragment:UN,emissivemap_pars_fragment:GN,colorspace_fragment:HN,colorspace_pars_fragment:zN,envmap_fragment:jN,envmap_common_pars_fragment:VN,envmap_pars_fragment:WN,envmap_pars_vertex:KN,envmap_physical_pars_fragment:i4,envmap_vertex:XN,fog_vertex:$N,fog_pars_vertex:YN,fog_fragment:JN,fog_pars_fragment:qN,gradientmap_pars_fragment:QN,lightmap_pars_fragment:ZN,lights_lambert_fragment:e4,lights_lambert_pars_fragment:t4,lights_pars_begin:n4,lights_toon_fragment:r4,lights_toon_pars_fragment:s4,lights_phong_fragment:o4,lights_phong_pars_fragment:a4,lights_physical_fragment:l4,lights_physical_pars_fragment:c4,lights_fragment_begin:u4,lights_fragment_maps:h4,lights_fragment_end:d4,logdepthbuf_fragment:f4,logdepthbuf_pars_fragment:p4,logdepthbuf_pars_vertex:m4,logdepthbuf_vertex:g4,map_fragment:y4,map_pars_fragment:v4,map_particle_fragment:x4,map_particle_pars_fragment:_4,metalnessmap_fragment:S4,metalnessmap_pars_fragment:A4,morphinstance_vertex:E4,morphcolor_vertex:T4,morphnormal_vertex:w4,morphtarget_pars_vertex:M4,morphtarget_vertex:b4,normal_fragment_begin:C4,normal_fragment_maps:R4,normal_pars_fragment:I4,normal_pars_vertex:L4,normal_vertex:P4,normalmap_pars_fragment:D4,clearcoat_normal_fragment_begin:O4,clearcoat_normal_fragment_maps:B4,clearcoat_pars_fragment:F4,iridescence_pars_fragment:k4,opaque_fragment:N4,packing:U4,premultiplied_alpha_fragment:G4,project_vertex:H4,dithering_fragment:z4,dithering_pars_fragment:j4,roughnessmap_fragment:V4,roughnessmap_pars_fragment:W4,shadowmap_pars_fragment:K4,shadowmap_pars_vertex:X4,shadowmap_vertex:$4,shadowmask_pars_fragment:Y4,skinbase_vertex:J4,skinning_pars_vertex:q4,skinning_vertex:Q4,skinnormal_vertex:Z4,specularmap_fragment:eU,specularmap_pars_fragment:tU,tonemapping_fragment:nU,tonemapping_pars_fragment:iU,transmission_fragment:rU,transmission_pars_fragment:sU,uv_pars_fragment:oU,uv_pars_vertex:aU,uv_vertex:lU,worldpos_vertex:cU,background_vert:uU,background_frag:hU,backgroundCube_vert:dU,backgroundCube_frag:fU,cube_vert:pU,cube_frag:mU,depth_vert:gU,depth_frag:yU,distanceRGBA_vert:vU,distanceRGBA_frag:xU,equirect_vert:_U,equirect_frag:SU,linedashed_vert:AU,linedashed_frag:EU,meshbasic_vert:TU,meshbasic_frag:wU,meshlambert_vert:MU,meshlambert_frag:bU,meshmatcap_vert:CU,meshmatcap_frag:RU,meshnormal_vert:IU,meshnormal_frag:LU,meshphong_vert:PU,meshphong_frag:DU,meshphysical_vert:OU,meshphysical_frag:BU,meshtoon_vert:FU,meshtoon_frag:kU,points_vert:NU,points_frag:UU,shadow_vert:GU,shadow_frag:HU,sprite_vert:zU,sprite_frag:jU},ft={common:{diffuse:{value:new ut(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new on},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new on}},envmap:{envMap:{value:null},envMapRotation:{value:new on},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new on}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new on}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new on},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new on},normalScale:{value:new Ue(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new on},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new on}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new on}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new on}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ut(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0},uvTransform:{value:new on}},sprite:{diffuse:{value:new ut(16777215)},opacity:{value:1},center:{value:new Ue(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new on},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0}}},ia={basic:{uniforms:es([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.fog]),vertexShader:mn.meshbasic_vert,fragmentShader:mn.meshbasic_frag},lambert:{uniforms:es([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,ft.lights,{emissive:{value:new ut(0)}}]),vertexShader:mn.meshlambert_vert,fragmentShader:mn.meshlambert_frag},phong:{uniforms:es([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,ft.lights,{emissive:{value:new ut(0)},specular:{value:new ut(1118481)},shininess:{value:30}}]),vertexShader:mn.meshphong_vert,fragmentShader:mn.meshphong_frag},standard:{uniforms:es([ft.common,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.roughnessmap,ft.metalnessmap,ft.fog,ft.lights,{emissive:{value:new ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:mn.meshphysical_vert,fragmentShader:mn.meshphysical_frag},toon:{uniforms:es([ft.common,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.gradientmap,ft.fog,ft.lights,{emissive:{value:new ut(0)}}]),vertexShader:mn.meshtoon_vert,fragmentShader:mn.meshtoon_frag},matcap:{uniforms:es([ft.common,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,{matcap:{value:null}}]),vertexShader:mn.meshmatcap_vert,fragmentShader:mn.meshmatcap_frag},points:{uniforms:es([ft.points,ft.fog]),vertexShader:mn.points_vert,fragmentShader:mn.points_frag},dashed:{uniforms:es([ft.common,ft.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:mn.linedashed_vert,fragmentShader:mn.linedashed_frag},depth:{uniforms:es([ft.common,ft.displacementmap]),vertexShader:mn.depth_vert,fragmentShader:mn.depth_frag},normal:{uniforms:es([ft.common,ft.bumpmap,ft.normalmap,ft.displacementmap,{opacity:{value:1}}]),vertexShader:mn.meshnormal_vert,fragmentShader:mn.meshnormal_frag},sprite:{uniforms:es([ft.sprite,ft.fog]),vertexShader:mn.sprite_vert,fragmentShader:mn.sprite_frag},background:{uniforms:{uvTransform:{value:new on},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:mn.background_vert,fragmentShader:mn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new on}},vertexShader:mn.backgroundCube_vert,fragmentShader:mn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:mn.cube_vert,fragmentShader:mn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:mn.equirect_vert,fragmentShader:mn.equirect_frag},distanceRGBA:{uniforms:es([ft.common,ft.displacementmap,{referencePosition:{value:new J},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:mn.distanceRGBA_vert,fragmentShader:mn.distanceRGBA_frag},shadow:{uniforms:es([ft.lights,ft.fog,{color:{value:new ut(0)},opacity:{value:1}}]),vertexShader:mn.shadow_vert,fragmentShader:mn.shadow_frag}};ia.physical={uniforms:es([ia.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new on},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new on},clearcoatNormalScale:{value:new Ue(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new on},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new on},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new on},sheen:{value:0},sheenColor:{value:new ut(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new on},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new on},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new on},transmissionSamplerSize:{value:new Ue},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new on},attenuationDistance:{value:0},attenuationColor:{value:new ut(0)},specularColor:{value:new ut(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new on},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new on},anisotropyVector:{value:new Ue},anisotropyMap:{value:null},anisotropyMapTransform:{value:new on}}]),vertexShader:mn.meshphysical_vert,fragmentShader:mn.meshphysical_frag};const Ry={r:0,b:0,g:0},ih=new Js,VU=new Kt;function WU(s,e,t,n,i,r,o){const a=new ut(0);let l=r===!0?0:1,c,h,f=null,p=0,y=null;function v(M){let C=M.isScene===!0?M.background:null;return C&&C.isTexture&&(C=(M.backgroundBlurriness>0?t:e).get(C)),C}function _(M){let C=!1;const I=v(M);I===null?A(a,l):I&&I.isColor&&(A(I,1),C=!0);const O=s.xr.getEnvironmentBlendMode();O==="additive"?n.buffers.color.setClear(0,0,0,1,o):O==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(s.autoClear||C)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil))}function S(M,C){const I=v(C);I&&(I.isCubeTexture||I.mapping===gp)?(h===void 0&&(h=new Ci(new qh(1,1,1),new oa({name:"BackgroundCubeMaterial",uniforms:tp(ia.backgroundCube.uniforms),vertexShader:ia.backgroundCube.vertexShader,fragmentShader:ia.backgroundCube.fragmentShader,side:ss,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(O,k,N){this.matrixWorld.copyPosition(N.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(h)),ih.copy(C.backgroundRotation),ih.x*=-1,ih.y*=-1,ih.z*=-1,I.isCubeTexture&&I.isRenderTargetTexture===!1&&(ih.y*=-1,ih.z*=-1),h.material.uniforms.envMap.value=I,h.material.uniforms.flipEnvMap.value=I.isCubeTexture&&I.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=C.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=C.backgroundIntensity,h.material.uniforms.backgroundRotation.value.setFromMatrix4(VU.makeRotationFromEuler(ih)),h.material.toneMapped=Mn.getTransfer(I.colorSpace)!==Fn,(f!==I||p!==I.version||y!==s.toneMapping)&&(h.material.needsUpdate=!0,f=I,p=I.version,y=s.toneMapping),h.layers.enableAll(),M.unshift(h,h.geometry,h.material,0,0,null)):I&&I.isTexture&&(c===void 0&&(c=new Ci(new vp(2,2),new oa({name:"BackgroundMaterial",uniforms:tp(ia.background.uniforms),vertexShader:ia.background.vertexShader,fragmentShader:ia.background.fragmentShader,side:Ga,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=I,c.material.uniforms.backgroundIntensity.value=C.backgroundIntensity,c.material.toneMapped=Mn.getTransfer(I.colorSpace)!==Fn,I.matrixAutoUpdate===!0&&I.updateMatrix(),c.material.uniforms.uvTransform.value.copy(I.matrix),(f!==I||p!==I.version||y!==s.toneMapping)&&(c.material.needsUpdate=!0,f=I,p=I.version,y=s.toneMapping),c.layers.enableAll(),M.unshift(c,c.geometry,c.material,0,0,null))}function A(M,C){M.getRGB(Ry,yR(s)),n.buffers.color.setClear(Ry.r,Ry.g,Ry.b,C,o)}function w(){h!==void 0&&(h.geometry.dispose(),h.material.dispose()),c!==void 0&&(c.geometry.dispose(),c.material.dispose())}return{getClearColor:function(){return a},setClearColor:function(M,C=1){a.set(M),l=C,A(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(M){l=M,A(a,l)},render:_,addToRenderList:S,dispose:w}}function KU(s,e){const t=s.getParameter(s.MAX_VERTEX_ATTRIBS),n={},i=p(null);let r=i,o=!1;function a(P,G,Z,Y,se){let oe=!1;const re=f(Y,Z,G);r!==re&&(r=re,c(r.object)),oe=y(P,Y,Z,se),oe&&v(P,Y,Z,se),se!==null&&e.update(se,s.ELEMENT_ARRAY_BUFFER),(oe||o)&&(o=!1,C(P,G,Z,Y),se!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.get(se).buffer))}function l(){return s.createVertexArray()}function c(P){return s.bindVertexArray(P)}function h(P){return s.deleteVertexArray(P)}function f(P,G,Z){const Y=Z.wireframe===!0;let se=n[P.id];se===void 0&&(se={},n[P.id]=se);let oe=se[G.id];oe===void 0&&(oe={},se[G.id]=oe);let re=oe[Y];return re===void 0&&(re=p(l()),oe[Y]=re),re}function p(P){const G=[],Z=[],Y=[];for(let se=0;se<t;se++)G[se]=0,Z[se]=0,Y[se]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:G,enabledAttributes:Z,attributeDivisors:Y,object:P,attributes:{},index:null}}function y(P,G,Z,Y){const se=r.attributes,oe=G.attributes;let re=0;const ce=Z.getAttributes();for(const H in ce)if(ce[H].location>=0){const X=se[H];let W=oe[H];if(W===void 0&&(H==="instanceMatrix"&&P.instanceMatrix&&(W=P.instanceMatrix),H==="instanceColor"&&P.instanceColor&&(W=P.instanceColor)),X===void 0||X.attribute!==W||W&&X.data!==W.data)return!0;re++}return r.attributesNum!==re||r.index!==Y}function v(P,G,Z,Y){const se={},oe=G.attributes;let re=0;const ce=Z.getAttributes();for(const H in ce)if(ce[H].location>=0){let X=oe[H];X===void 0&&(H==="instanceMatrix"&&P.instanceMatrix&&(X=P.instanceMatrix),H==="instanceColor"&&P.instanceColor&&(X=P.instanceColor));const W={};W.attribute=X,X&&X.data&&(W.data=X.data),se[H]=W,re++}r.attributes=se,r.attributesNum=re,r.index=Y}function _(){const P=r.newAttributes;for(let G=0,Z=P.length;G<Z;G++)P[G]=0}function S(P){A(P,0)}function A(P,G){const Z=r.newAttributes,Y=r.enabledAttributes,se=r.attributeDivisors;Z[P]=1,Y[P]===0&&(s.enableVertexAttribArray(P),Y[P]=1),se[P]!==G&&(s.vertexAttribDivisor(P,G),se[P]=G)}function w(){const P=r.newAttributes,G=r.enabledAttributes;for(let Z=0,Y=G.length;Z<Y;Z++)G[Z]!==P[Z]&&(s.disableVertexAttribArray(Z),G[Z]=0)}function M(P,G,Z,Y,se,oe,re){re===!0?s.vertexAttribIPointer(P,G,Z,se,oe):s.vertexAttribPointer(P,G,Z,Y,se,oe)}function C(P,G,Z,Y){_();const se=Y.attributes,oe=Z.getAttributes(),re=G.defaultAttributeValues;for(const ce in oe){const H=oe[ce];if(H.location>=0){let $=se[ce];if($===void 0&&(ce==="instanceMatrix"&&P.instanceMatrix&&($=P.instanceMatrix),ce==="instanceColor"&&P.instanceColor&&($=P.instanceColor)),$!==void 0){const X=$.normalized,W=$.itemSize,ne=e.get($);if(ne===void 0)continue;const Ee=ne.buffer,le=ne.type,ye=ne.bytesPerElement,we=le===s.INT||le===s.UNSIGNED_INT||$.gpuType===Mx;if($.isInterleavedBufferAttribute){const Ie=$.data,ze=Ie.stride,Ze=$.offset;if(Ie.isInstancedInterleavedBuffer){for(let rt=0;rt<H.locationSize;rt++)A(H.location+rt,Ie.meshPerAttribute);P.isInstancedMesh!==!0&&Y._maxInstanceCount===void 0&&(Y._maxInstanceCount=Ie.meshPerAttribute*Ie.count)}else for(let rt=0;rt<H.locationSize;rt++)S(H.location+rt);s.bindBuffer(s.ARRAY_BUFFER,Ee);for(let rt=0;rt<H.locationSize;rt++)M(H.location+rt,W/H.locationSize,le,X,ze*ye,(Ze+W/H.locationSize*rt)*ye,we)}else{if($.isInstancedBufferAttribute){for(let Ie=0;Ie<H.locationSize;Ie++)A(H.location+Ie,$.meshPerAttribute);P.isInstancedMesh!==!0&&Y._maxInstanceCount===void 0&&(Y._maxInstanceCount=$.meshPerAttribute*$.count)}else for(let Ie=0;Ie<H.locationSize;Ie++)S(H.location+Ie);s.bindBuffer(s.ARRAY_BUFFER,Ee);for(let Ie=0;Ie<H.locationSize;Ie++)M(H.location+Ie,W/H.locationSize,le,X,W*ye,W/H.locationSize*Ie*ye,we)}}else if(re!==void 0){const X=re[ce];if(X!==void 0)switch(X.length){case 2:s.vertexAttrib2fv(H.location,X);break;case 3:s.vertexAttrib3fv(H.location,X);break;case 4:s.vertexAttrib4fv(H.location,X);break;default:s.vertexAttrib1fv(H.location,X)}}}}w()}function I(){N();for(const P in n){const G=n[P];for(const Z in G){const Y=G[Z];for(const se in Y)h(Y[se].object),delete Y[se];delete G[Z]}delete n[P]}}function O(P){if(n[P.id]===void 0)return;const G=n[P.id];for(const Z in G){const Y=G[Z];for(const se in Y)h(Y[se].object),delete Y[se];delete G[Z]}delete n[P.id]}function k(P){for(const G in n){const Z=n[G];if(Z[P.id]===void 0)continue;const Y=Z[P.id];for(const se in Y)h(Y[se].object),delete Y[se];delete Z[P.id]}}function N(){B(),o=!0,r!==i&&(r=i,c(r.object))}function B(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:a,reset:N,resetDefaultState:B,dispose:I,releaseStatesOfGeometry:O,releaseStatesOfProgram:k,initAttributes:_,enableAttribute:S,disableUnusedAttributes:w}}function XU(s,e,t){let n;function i(c){n=c}function r(c,h){s.drawArrays(n,c,h),t.update(h,n,1)}function o(c,h,f){f!==0&&(s.drawArraysInstanced(n,c,h,f),t.update(h,n,f))}function a(c,h,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,c,0,h,0,f);let y=0;for(let v=0;v<f;v++)y+=h[v];t.update(y,n,1)}function l(c,h,f,p){if(f===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let v=0;v<c.length;v++)o(c[v],h[v],p[v]);else{y.multiDrawArraysInstancedWEBGL(n,c,0,h,0,p,0,f);let v=0;for(let _=0;_<f;_++)v+=h[_]*p[_];t.update(v,n,1)}}this.setMode=i,this.render=r,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function $U(s,e,t,n){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const k=e.get("EXT_texture_filter_anisotropic");i=s.getParameter(k.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(k){return!(k!==Nr&&n.convert(k)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(k){const N=k===Yh&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(k!==sa&&n.convert(k)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_TYPE)&&k!==rs&&!N)}function l(k){if(k==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";k="mediump"}return k==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp";const h=l(c);h!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",h,"instead."),c=h);const f=t.logarithmicDepthBuffer===!0,p=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),y=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),v=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=s.getParameter(s.MAX_TEXTURE_SIZE),S=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),A=s.getParameter(s.MAX_VERTEX_ATTRIBS),w=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),M=s.getParameter(s.MAX_VARYING_VECTORS),C=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),I=v>0,O=s.getParameter(s.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:c,logarithmicDepthBuffer:f,reverseDepthBuffer:p,maxTextures:y,maxVertexTextures:v,maxTextureSize:_,maxCubemapSize:S,maxAttributes:A,maxVertexUniforms:w,maxVaryings:M,maxFragmentUniforms:C,vertexTextures:I,maxSamples:O}}function YU(s){const e=this;let t=null,n=0,i=!1,r=!1;const o=new Fl,a=new on,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,p){const y=f.length!==0||p||n!==0||i;return i=p,n=f.length,y},this.beginShadows=function(){r=!0,h(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(f,p){t=h(f,p,0)},this.setState=function(f,p,y){const v=f.clippingPlanes,_=f.clipIntersection,S=f.clipShadows,A=s.get(f);if(!i||v===null||v.length===0||r&&!S)r?h(null):c();else{const w=r?0:n,M=w*4;let C=A.clippingState||null;l.value=C,C=h(v,p,M,y);for(let I=0;I!==M;++I)C[I]=t[I];A.clippingState=C,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=w}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function h(f,p,y,v){const _=f!==null?f.length:0;let S=null;if(_!==0){if(S=l.value,v!==!0||S===null){const A=y+_*4,w=p.matrixWorldInverse;a.getNormalMatrix(w),(S===null||S.length<A)&&(S=new Float32Array(A));for(let M=0,C=y;M!==_;++M,C+=4)o.copy(f[M]).applyMatrix4(w,a),o.normal.toArray(S,C),S[C+3]=o.constant}l.value=S,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,S}}function JU(s){let e=new WeakMap;function t(o,a){return a===i0?o.mapping=Kl:a===r0&&(o.mapping=qc),o}function n(o){if(o&&o.isTexture){const a=o.mapping;if(a===i0||a===r0)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new rE(l.height);return c.fromEquirectangularTexture(s,o),e.set(o,c),o.addEventListener("dispose",i),t(c.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function r(){e=new WeakMap}return{get:n,dispose:r}}const Nf=4,EM=[.125,.215,.35,.446,.526,.582],mh=20,b1=new ra,TM=new ut;let C1=null,R1=0,I1=0,L1=!1;const dh=(1+Math.sqrt(5))/2,Ef=1/dh,wM=[new J(-dh,Ef,0),new J(dh,Ef,0),new J(-Ef,0,dh),new J(Ef,0,dh),new J(0,dh,-Ef),new J(0,dh,Ef),new J(-1,1,-1),new J(1,1,-1),new J(-1,1,1),new J(1,1,1)];class YS{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){C1=this._renderer.getRenderTarget(),R1=this._renderer.getActiveCubeFace(),I1=this._renderer.getActiveMipmapLevel(),L1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=CM(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=bM(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(C1,R1,I1),this._renderer.xr.enabled=L1,e.scissorTest=!1,Iy(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Kl||e.mapping===qc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),C1=this._renderer.getRenderTarget(),R1=this._renderer.getActiveCubeFace(),I1=this._renderer.getActiveMipmapLevel(),L1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:pi,minFilter:pi,generateMipmaps:!1,type:Yh,format:Nr,colorSpace:Uh,depthBuffer:!1},i=MM(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=MM(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=qU(r)),this._blurMaterial=QU(r,e,t)}return i}_compileMaterial(e){const t=new Ci(this._lodPlanes[0],e);this._renderer.compile(t,b1)}_sceneToCubeUV(e,t,n,i){const a=new si(90,1,t,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,f=h.autoClear,p=h.toneMapping;h.getClearColor(TM),h.toneMapping=Oa,h.autoClear=!1;const y=new Ks({name:"PMREM.Background",side:ss,depthWrite:!1,depthTest:!1}),v=new Ci(new qh,y);let _=!1;const S=e.background;S?S.isColor&&(y.color.copy(S),e.background=null,_=!0):(y.color.copy(TM),_=!0);for(let A=0;A<6;A++){const w=A%3;w===0?(a.up.set(0,l[A],0),a.lookAt(c[A],0,0)):w===1?(a.up.set(0,0,l[A]),a.lookAt(0,c[A],0)):(a.up.set(0,l[A],0),a.lookAt(0,0,c[A]));const M=this._cubeSize;Iy(i,w*M,A>2?M:0,M,M),h.setRenderTarget(i),_&&h.render(v,a),h.render(e,a)}v.geometry.dispose(),v.material.dispose(),h.toneMapping=p,h.autoClear=f,e.background=S}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===Kl||e.mapping===qc;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=CM()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=bM());const r=i?this._cubemapMaterial:this._equirectMaterial,o=new Ci(this._lodPlanes[0],r),a=r.uniforms;a.envMap.value=e;const l=this._cubeSize;Iy(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,b1)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let r=1;r<i;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),a=wM[(i-r-1)%wM.length];this._blur(e,r-1,r,o,a)}t.autoClear=n}_blur(e,t,n,i,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,i,"latitudinal",r),this._halfBlur(o,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,f=new Ci(this._lodPlanes[i],c),p=c.uniforms,y=this._sizeLods[n]-1,v=isFinite(r)?Math.PI/(2*y):2*Math.PI/(2*mh-1),_=r/v,S=isFinite(r)?1+Math.floor(h*_):mh;S>mh&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${S} samples when the maximum is set to ${mh}`);const A=[];let w=0;for(let k=0;k<mh;++k){const N=k/_,B=Math.exp(-N*N/2);A.push(B),k===0?w+=B:k<S&&(w+=2*B)}for(let k=0;k<A.length;k++)A[k]=A[k]/w;p.envMap.value=e.texture,p.samples.value=S,p.weights.value=A,p.latitudinal.value=o==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:M}=this;p.dTheta.value=v,p.mipInt.value=M-n;const C=this._sizeLods[i],I=3*C*(i>M-Nf?i-M+Nf:0),O=4*(this._cubeSize-C);Iy(t,I,O,3*C,2*C),l.setRenderTarget(t),l.render(f,b1)}}function qU(s){const e=[],t=[],n=[];let i=s;const r=s-Nf+1+EM.length;for(let o=0;o<r;o++){const a=Math.pow(2,i);t.push(a);let l=1/a;o>s-Nf?l=EM[o-s+Nf-1]:o===0&&(l=0),n.push(l);const c=1/(a-2),h=-c,f=1+c,p=[h,h,f,h,f,f,h,h,f,f,h,f],y=6,v=6,_=3,S=2,A=1,w=new Float32Array(_*v*y),M=new Float32Array(S*v*y),C=new Float32Array(A*v*y);for(let O=0;O<y;O++){const k=O%3*2/3-1,N=O>2?0:-1,B=[k,N,0,k+2/3,N,0,k+2/3,N+1,0,k,N,0,k+2/3,N+1,0,k,N+1,0];w.set(B,_*v*O),M.set(p,S*v*O);const P=[O,O,O,O,O,O];C.set(P,A*v*O)}const I=new rn;I.setAttribute("position",new Rn(w,_)),I.setAttribute("uv",new Rn(M,S)),I.setAttribute("faceIndex",new Rn(C,A)),e.push(I),i>Nf&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function MM(s,e,t){const n=new wo(s,e,t);return n.texture.mapping=gp,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Iy(s,e,t,n,i){s.viewport.set(e,t,n,i),s.scissor.set(e,t,n,i)}function QU(s,e,t){const n=new Float32Array(mh),i=new J(0,1,0);return new oa({name:"SphericalGaussianBlur",defines:{n:mh,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:PE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:jl,depthTest:!1,depthWrite:!1})}function bM(){return new oa({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:PE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:jl,depthTest:!1,depthWrite:!1})}function CM(){return new oa({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:PE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:jl,depthTest:!1,depthWrite:!1})}function PE(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function ZU(s){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){const l=a.mapping,c=l===i0||l===r0,h=l===Kl||l===qc;if(c||h){let f=e.get(a);const p=f!==void 0?f.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==p)return t===null&&(t=new YS(s)),f=c?t.fromEquirectangular(a,f):t.fromCubemap(a,f),f.texture.pmremVersion=a.pmremVersion,e.set(a,f),f.texture;if(f!==void 0)return f.texture;{const y=a.image;return c&&y&&y.height>0||h&&y&&i(y)?(t===null&&(t=new YS(s)),f=c?t.fromEquirectangular(a):t.fromCubemap(a),f.texture.pmremVersion=a.pmremVersion,e.set(a,f),a.addEventListener("dispose",r),f.texture):null}}}return a}function i(a){let l=0;const c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function r(a){const l=a.target;l.removeEventListener("dispose",r);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function e5(s){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=s.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const i=t(n);return i===null&&Pf("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function t5(s,e,t,n){const i={},r=new WeakMap;function o(f){const p=f.target;p.index!==null&&e.remove(p.index);for(const v in p.attributes)e.remove(p.attributes[v]);p.removeEventListener("dispose",o),delete i[p.id];const y=r.get(p);y&&(e.remove(y),r.delete(p)),n.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function a(f,p){return i[p.id]===!0||(p.addEventListener("dispose",o),i[p.id]=!0,t.memory.geometries++),p}function l(f){const p=f.attributes;for(const y in p)e.update(p[y],s.ARRAY_BUFFER)}function c(f){const p=[],y=f.index,v=f.attributes.position;let _=0;if(y!==null){const w=y.array;_=y.version;for(let M=0,C=w.length;M<C;M+=3){const I=w[M+0],O=w[M+1],k=w[M+2];p.push(I,O,O,k,k,I)}}else if(v!==void 0){const w=v.array;_=v.version;for(let M=0,C=w.length/3-1;M<C;M+=3){const I=M+0,O=M+1,k=M+2;p.push(I,O,O,k,k,I)}}else return;const S=new(dR(p)?nE:tE)(p,1);S.version=_;const A=r.get(f);A&&e.remove(A),r.set(f,S)}function h(f){const p=r.get(f);if(p){const y=f.index;y!==null&&p.version<y.version&&c(f)}else c(f);return r.get(f)}return{get:a,update:l,getWireframeAttribute:h}}function n5(s,e,t){let n;function i(p){n=p}let r,o;function a(p){r=p.type,o=p.bytesPerElement}function l(p,y){s.drawElements(n,y,r,p*o),t.update(y,n,1)}function c(p,y,v){v!==0&&(s.drawElementsInstanced(n,y,r,p*o,v),t.update(y,n,v))}function h(p,y,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,y,0,r,p,0,v);let S=0;for(let A=0;A<v;A++)S+=y[A];t.update(S,n,1)}function f(p,y,v,_){if(v===0)return;const S=e.get("WEBGL_multi_draw");if(S===null)for(let A=0;A<p.length;A++)c(p[A]/o,y[A],_[A]);else{S.multiDrawElementsInstancedWEBGL(n,y,0,r,p,0,_,0,v);let A=0;for(let w=0;w<v;w++)A+=y[w]*_[w];t.update(A,n,1)}}this.setMode=i,this.setIndex=a,this.render=l,this.renderInstances=c,this.renderMultiDraw=h,this.renderMultiDrawInstances=f}function i5(s){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(r,o,a){switch(t.calls++,o){case s.TRIANGLES:t.triangles+=a*(r/3);break;case s.LINES:t.lines+=a*(r/2);break;case s.LINE_STRIP:t.lines+=a*(r-1);break;case s.LINE_LOOP:t.lines+=a*r;break;case s.POINTS:t.points+=a*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}function r5(s,e,t){const n=new WeakMap,i=new Cn;function r(o,a,l){const c=o.morphTargetInfluences,h=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,f=h!==void 0?h.length:0;let p=n.get(a);if(p===void 0||p.count!==f){let P=function(){N.dispose(),n.delete(a),a.removeEventListener("dispose",P)};var y=P;p!==void 0&&p.texture.dispose();const v=a.morphAttributes.position!==void 0,_=a.morphAttributes.normal!==void 0,S=a.morphAttributes.color!==void 0,A=a.morphAttributes.position||[],w=a.morphAttributes.normal||[],M=a.morphAttributes.color||[];let C=0;v===!0&&(C=1),_===!0&&(C=2),S===!0&&(C=3);let I=a.attributes.position.count*C,O=1;I>e.maxTextureSize&&(O=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);const k=new Float32Array(I*O*4*f),N=new Dx(k,I,O,f);N.type=rs,N.needsUpdate=!0;const B=C*4;for(let G=0;G<f;G++){const Z=A[G],Y=w[G],se=M[G],oe=I*O*4*G;for(let re=0;re<Z.count;re++){const ce=re*B;v===!0&&(i.fromBufferAttribute(Z,re),k[oe+ce+0]=i.x,k[oe+ce+1]=i.y,k[oe+ce+2]=i.z,k[oe+ce+3]=0),_===!0&&(i.fromBufferAttribute(Y,re),k[oe+ce+4]=i.x,k[oe+ce+5]=i.y,k[oe+ce+6]=i.z,k[oe+ce+7]=0),S===!0&&(i.fromBufferAttribute(se,re),k[oe+ce+8]=i.x,k[oe+ce+9]=i.y,k[oe+ce+10]=i.z,k[oe+ce+11]=se.itemSize===4?i.w:1)}}p={count:f,texture:N,size:new Ue(I,O)},n.set(a,p),a.addEventListener("dispose",P)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(s,"morphTexture",o.morphTexture,t);else{let v=0;for(let S=0;S<c.length;S++)v+=c[S];const _=a.morphTargetsRelative?1:1-v;l.getUniforms().setValue(s,"morphTargetBaseInfluence",_),l.getUniforms().setValue(s,"morphTargetInfluences",c)}l.getUniforms().setValue(s,"morphTargetsTexture",p.texture,t),l.getUniforms().setValue(s,"morphTargetsTextureSize",p.size)}return{update:r}}function s5(s,e,t,n){let i=new WeakMap;function r(l){const c=n.render.frame,h=l.geometry,f=e.get(l,h);if(i.get(f)!==c&&(e.update(f),i.set(f,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.get(l)!==c&&(t.update(l.instanceMatrix,s.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,s.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const p=l.skeleton;i.get(p)!==c&&(p.update(),i.set(p,c))}return f}function o(){i=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:r,dispose:o}}const cI=new ei,RM=new Ux(1,1),uI=new Dx,hI=new eE,dI=new P0,IM=[],LM=[],PM=new Float32Array(16),DM=new Float32Array(9),OM=new Float32Array(4);function _p(s,e,t){const n=s[0];if(n<=0||n>0)return s;const i=e*t;let r=IM[i];if(r===void 0&&(r=new Float32Array(i),IM[i]=r),e!==0){n.toArray(r,0);for(let o=1,a=0;o!==e;++o)a+=t,s[o].toArray(r,a)}return r}function Ji(s,e){if(s.length!==e.length)return!1;for(let t=0,n=s.length;t<n;t++)if(s[t]!==e[t])return!1;return!0}function qi(s,e){for(let t=0,n=e.length;t<n;t++)s[t]=e[t]}function t_(s,e){let t=LM[e];t===void 0&&(t=new Int32Array(e),LM[e]=t);for(let n=0;n!==e;++n)t[n]=s.allocateTextureUnit();return t}function o5(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function a5(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ji(t,e))return;s.uniform2fv(this.addr,e),qi(t,e)}}function l5(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ji(t,e))return;s.uniform3fv(this.addr,e),qi(t,e)}}function c5(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ji(t,e))return;s.uniform4fv(this.addr,e),qi(t,e)}}function u5(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ji(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),qi(t,e)}else{if(Ji(t,n))return;OM.set(n),s.uniformMatrix2fv(this.addr,!1,OM),qi(t,n)}}function h5(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ji(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),qi(t,e)}else{if(Ji(t,n))return;DM.set(n),s.uniformMatrix3fv(this.addr,!1,DM),qi(t,n)}}function d5(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ji(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),qi(t,e)}else{if(Ji(t,n))return;PM.set(n),s.uniformMatrix4fv(this.addr,!1,PM),qi(t,n)}}function f5(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function p5(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ji(t,e))return;s.uniform2iv(this.addr,e),qi(t,e)}}function m5(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ji(t,e))return;s.uniform3iv(this.addr,e),qi(t,e)}}function g5(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ji(t,e))return;s.uniform4iv(this.addr,e),qi(t,e)}}function y5(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function v5(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ji(t,e))return;s.uniform2uiv(this.addr,e),qi(t,e)}}function x5(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ji(t,e))return;s.uniform3uiv(this.addr,e),qi(t,e)}}function _5(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ji(t,e))return;s.uniform4uiv(this.addr,e),qi(t,e)}}function S5(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i);let r;this.type===s.SAMPLER_2D_SHADOW?(RM.compareFunction=QA,r=RM):r=cI,t.setTexture2D(e||r,i)}function A5(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||hI,i)}function E5(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||dI,i)}function T5(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||uI,i)}function w5(s){switch(s){case 5126:return o5;case 35664:return a5;case 35665:return l5;case 35666:return c5;case 35674:return u5;case 35675:return h5;case 35676:return d5;case 5124:case 35670:return f5;case 35667:case 35671:return p5;case 35668:case 35672:return m5;case 35669:case 35673:return g5;case 5125:return y5;case 36294:return v5;case 36295:return x5;case 36296:return _5;case 35678:case 36198:case 36298:case 36306:case 35682:return S5;case 35679:case 36299:case 36307:return A5;case 35680:case 36300:case 36308:case 36293:return E5;case 36289:case 36303:case 36311:case 36292:return T5}}function M5(s,e){s.uniform1fv(this.addr,e)}function b5(s,e){const t=_p(e,this.size,2);s.uniform2fv(this.addr,t)}function C5(s,e){const t=_p(e,this.size,3);s.uniform3fv(this.addr,t)}function R5(s,e){const t=_p(e,this.size,4);s.uniform4fv(this.addr,t)}function I5(s,e){const t=_p(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function L5(s,e){const t=_p(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function P5(s,e){const t=_p(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function D5(s,e){s.uniform1iv(this.addr,e)}function O5(s,e){s.uniform2iv(this.addr,e)}function B5(s,e){s.uniform3iv(this.addr,e)}function F5(s,e){s.uniform4iv(this.addr,e)}function k5(s,e){s.uniform1uiv(this.addr,e)}function N5(s,e){s.uniform2uiv(this.addr,e)}function U5(s,e){s.uniform3uiv(this.addr,e)}function G5(s,e){s.uniform4uiv(this.addr,e)}function H5(s,e,t){const n=this.cache,i=e.length,r=t_(t,i);Ji(n,r)||(s.uniform1iv(this.addr,r),qi(n,r));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||cI,r[o])}function z5(s,e,t){const n=this.cache,i=e.length,r=t_(t,i);Ji(n,r)||(s.uniform1iv(this.addr,r),qi(n,r));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||hI,r[o])}function j5(s,e,t){const n=this.cache,i=e.length,r=t_(t,i);Ji(n,r)||(s.uniform1iv(this.addr,r),qi(n,r));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||dI,r[o])}function V5(s,e,t){const n=this.cache,i=e.length,r=t_(t,i);Ji(n,r)||(s.uniform1iv(this.addr,r),qi(n,r));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||uI,r[o])}function W5(s){switch(s){case 5126:return M5;case 35664:return b5;case 35665:return C5;case 35666:return R5;case 35674:return I5;case 35675:return L5;case 35676:return P5;case 5124:case 35670:return D5;case 35667:case 35671:return O5;case 35668:case 35672:return B5;case 35669:case 35673:return F5;case 5125:return k5;case 36294:return N5;case 36295:return U5;case 36296:return G5;case 35678:case 36198:case 36298:case 36306:case 35682:return H5;case 35679:case 36299:case 36307:return z5;case 35680:case 36300:case 36308:case 36293:return j5;case 36289:case 36303:case 36311:case 36292:return V5}}class K5{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=w5(t.type)}}class X5{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=W5(t.type)}}class $5{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let r=0,o=i.length;r!==o;++r){const a=i[r];a.setValue(e,t[a.id],n)}}}const P1=/(\w+)(\])?(\[|\.)?/g;function BM(s,e){s.seq.push(e),s.map[e.id]=e}function Y5(s,e,t){const n=s.name,i=n.length;for(P1.lastIndex=0;;){const r=P1.exec(n),o=P1.lastIndex;let a=r[1];const l=r[2]==="]",c=r[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===i){BM(t,c===void 0?new K5(a,s,e):new X5(a,s,e));break}else{let f=t.map[a];f===void 0&&(f=new $5(a),BM(t,f)),t=f}}}class ev{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const r=e.getActiveUniform(t,i),o=e.getUniformLocation(t,r.name);Y5(r,o,this)}}setValue(e,t,n,i){const r=this.map[t];r!==void 0&&r.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,o=t.length;r!==o;++r){const a=t[r],l=n[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const o=e[i];o.id in t&&n.push(o)}return n}}function FM(s,e,t){const n=s.createShader(e);return s.shaderSource(n,t),s.compileShader(n),n}const J5=37297;let q5=0;function Q5(s,e){const t=s.split(`
`),n=[],i=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let o=i;o<r;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join(`
`)}const kM=new on;function Z5(s){Mn._getMatrix(kM,Mn.workingColorSpace,s);const e=`mat3( ${kM.elements.map(t=>t.toFixed(4))} )`;switch(Mn.getTransfer(s)){case o0:return[e,"LinearTransferOETF"];case Fn:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",s),[e,"LinearTransferOETF"]}}function NM(s,e,t){const n=s.getShaderParameter(e,s.COMPILE_STATUS),i=s.getShaderInfoLog(e).trim();if(n&&i==="")return"";const r=/ERROR: 0:(\d+)/.exec(i);if(r){const o=parseInt(r[1]);return t.toUpperCase()+`

`+i+`

`+Q5(s.getShaderSource(e),o)}else return i}function e8(s,e){const t=Z5(e);return[`vec4 ${s}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function t8(s,e){let t;switch(e){case VC:t="Linear";break;case WC:t="Reinhard";break;case KC:t="Cineon";break;case GA:t="ACESFilmic";break;case $C:t="AgX";break;case YC:t="Neutral";break;case XC:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Ly=new J;function n8(){Mn.getLuminanceCoefficients(Ly);const s=Ly.x.toFixed(4),e=Ly.y.toFixed(4),t=Ly.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${s}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function i8(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Nm).join(`
`)}function r8(s){const e=[];for(const t in s){const n=s[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function s8(s,e){const t={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const r=s.getActiveAttrib(e,i),o=r.name;let a=1;r.type===s.FLOAT_MAT2&&(a=2),r.type===s.FLOAT_MAT3&&(a=3),r.type===s.FLOAT_MAT4&&(a=4),t[o]={type:r.type,location:s.getAttribLocation(e,o),locationSize:a}}return t}function Nm(s){return s!==""}function UM(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function GM(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const o8=/^[ \t]*#include +<([\w\d./]+)>/gm;function JS(s){return s.replace(o8,l8)}const a8=new Map;function l8(s,e){let t=mn[e];if(t===void 0){const n=a8.get(e);if(n!==void 0)t=mn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return JS(t)}const c8=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function HM(s){return s.replace(c8,u8)}function u8(s,e,t,n){let i="";for(let r=parseInt(e);r<parseInt(t);r++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return i}function zM(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	precision ${s.precision} sampler3D;
	precision ${s.precision} sampler2DArray;
	precision ${s.precision} sampler2DShadow;
	precision ${s.precision} samplerCubeShadow;
	precision ${s.precision} sampler2DArrayShadow;
	precision ${s.precision} isampler2D;
	precision ${s.precision} isampler3D;
	precision ${s.precision} isamplerCube;
	precision ${s.precision} isampler2DArray;
	precision ${s.precision} usampler2D;
	precision ${s.precision} usampler3D;
	precision ${s.precision} usamplerCube;
	precision ${s.precision} usampler2DArray;
	`;return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function h8(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===Ex?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===zm?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===na&&(e="SHADOWMAP_TYPE_VSM"),e}function d8(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case Kl:case qc:e="ENVMAP_TYPE_CUBE";break;case gp:e="ENVMAP_TYPE_CUBE_UV";break}return e}function f8(s){let e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case qc:e="ENVMAP_MODE_REFRACTION";break}return e}function p8(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case R0:e="ENVMAP_BLENDING_MULTIPLY";break;case zC:e="ENVMAP_BLENDING_MIX";break;case jC:e="ENVMAP_BLENDING_ADD";break}return e}function m8(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function g8(s,e,t,n){const i=s.getContext(),r=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=h8(t),c=d8(t),h=f8(t),f=p8(t),p=m8(t),y=i8(t),v=r8(r),_=i.createProgram();let S,A,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(S=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(Nm).join(`
`),S.length>0&&(S+=`
`),A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(Nm).join(`
`),A.length>0&&(A+=`
`)):(S=[zM(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Nm).join(`
`),A=[zM(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",t.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Oa?"#define TONE_MAPPING":"",t.toneMapping!==Oa?mn.tonemapping_pars_fragment:"",t.toneMapping!==Oa?t8("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",mn.colorspace_pars_fragment,e8("linearToOutputTexel",t.outputColorSpace),n8(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Nm).join(`
`)),o=JS(o),o=UM(o,t),o=GM(o,t),a=JS(a),a=UM(a,t),a=GM(a,t),o=HM(o),a=HM(a),t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,S=[y,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+S,A=["#define varying in",t.glslVersion===HS?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===HS?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+A);const M=w+S+o,C=w+A+a,I=FM(i,i.VERTEX_SHADER,M),O=FM(i,i.FRAGMENT_SHADER,C);i.attachShader(_,I),i.attachShader(_,O),t.index0AttributeName!==void 0?i.bindAttribLocation(_,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(_,0,"position"),i.linkProgram(_);function k(G){if(s.debug.checkShaderErrors){const Z=i.getProgramInfoLog(_).trim(),Y=i.getShaderInfoLog(I).trim(),se=i.getShaderInfoLog(O).trim();let oe=!0,re=!0;if(i.getProgramParameter(_,i.LINK_STATUS)===!1)if(oe=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(i,_,I,O);else{const ce=NM(i,I,"vertex"),H=NM(i,O,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(_,i.VALIDATE_STATUS)+`

Material Name: `+G.name+`
Material Type: `+G.type+`

Program Info Log: `+Z+`
`+ce+`
`+H)}else Z!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Z):(Y===""||se==="")&&(re=!1);re&&(G.diagnostics={runnable:oe,programLog:Z,vertexShader:{log:Y,prefix:S},fragmentShader:{log:se,prefix:A}})}i.deleteShader(I),i.deleteShader(O),N=new ev(i,_),B=s8(i,_)}let N;this.getUniforms=function(){return N===void 0&&k(this),N};let B;this.getAttributes=function(){return B===void 0&&k(this),B};let P=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return P===!1&&(P=i.getProgramParameter(_,J5)),P},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(_),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=q5++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=I,this.fragmentShader=O,this}let y8=0;class v8{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(r)===!1&&(o.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new x8(e),t.set(e,n)),n}}class x8{constructor(e){this.id=y8++,this.code=e,this.usedTimes=0}}function _8(s,e,t,n,i,r,o){const a=new Ch,l=new v8,c=new Set,h=[],f=i.logarithmicDepthBuffer,p=i.vertexTextures;let y=i.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(B){return c.add(B),B===0?"uv":`uv${B}`}function S(B,P,G,Z,Y){const se=Z.fog,oe=Y.geometry,re=B.isMeshStandardMaterial?Z.environment:null,ce=(B.isMeshStandardMaterial?t:e).get(B.envMap||re),H=ce&&ce.mapping===gp?ce.image.height:null,$=v[B.type];B.precision!==null&&(y=i.getMaxPrecision(B.precision),y!==B.precision&&console.warn("THREE.WebGLProgram.getParameters:",B.precision,"not supported, using",y,"instead."));const X=oe.morphAttributes.position||oe.morphAttributes.normal||oe.morphAttributes.color,W=X!==void 0?X.length:0;let ne=0;oe.morphAttributes.position!==void 0&&(ne=1),oe.morphAttributes.normal!==void 0&&(ne=2),oe.morphAttributes.color!==void 0&&(ne=3);let Ee,le,ye,we;if($){const ln=ia[$];Ee=ln.vertexShader,le=ln.fragmentShader}else Ee=B.vertexShader,le=B.fragmentShader,l.update(B),ye=l.getVertexShaderID(B),we=l.getFragmentShaderID(B);const Ie=s.getRenderTarget(),ze=s.state.buffers.depth.getReversed(),Ze=Y.isInstancedMesh===!0,rt=Y.isBatchedMesh===!0,ct=!!B.map,Ne=!!B.matcap,Ge=!!ce,Q=!!B.aoMap,St=!!B.lightMap,We=!!B.bumpMap,st=!!B.normalMap,qe=!!B.displacementMap,It=!!B.emissiveMap,tt=!!B.metalnessMap,q=!!B.roughnessMap,V=B.anisotropy>0,xe=B.clearcoat>0,De=B.dispersion>0,He=B.iridescence>0,Fe=B.sheen>0,ht=B.transmission>0,nt=V&&!!B.anisotropyMap,mt=xe&&!!B.clearcoatMap,Qt=xe&&!!B.clearcoatNormalMap,Xe=xe&&!!B.clearcoatRoughnessMap,At=He&&!!B.iridescenceMap,kt=He&&!!B.iridescenceThicknessMap,Gt=Fe&&!!B.sheenColorMap,vt=Fe&&!!B.sheenRoughnessMap,ue=!!B.specularMap,Be=!!B.specularColorMap,at=!!B.specularIntensityMap,ae=ht&&!!B.transmissionMap,Ye=ht&&!!B.thicknessMap,Ce=!!B.gradientMap,ke=!!B.alphaMap,pt=B.alphaTest>0,lt=!!B.alphaHash,Ft=!!B.extensions;let yn=Oa;B.toneMapped&&(Ie===null||Ie.isXRRenderTarget===!0)&&(yn=s.toneMapping);const Nn={shaderID:$,shaderType:B.type,shaderName:B.name,vertexShader:Ee,fragmentShader:le,defines:B.defines,customVertexShaderID:ye,customFragmentShaderID:we,isRawShaderMaterial:B.isRawShaderMaterial===!0,glslVersion:B.glslVersion,precision:y,batching:rt,batchingColor:rt&&Y._colorsTexture!==null,instancing:Ze,instancingColor:Ze&&Y.instanceColor!==null,instancingMorph:Ze&&Y.morphTexture!==null,supportsVertexTextures:p,outputColorSpace:Ie===null?s.outputColorSpace:Ie.isXRRenderTarget===!0?Ie.texture.colorSpace:Uh,alphaToCoverage:!!B.alphaToCoverage,map:ct,matcap:Ne,envMap:Ge,envMapMode:Ge&&ce.mapping,envMapCubeUVHeight:H,aoMap:Q,lightMap:St,bumpMap:We,normalMap:st,displacementMap:p&&qe,emissiveMap:It,normalMapObjectSpace:st&&B.normalMapType===iR,normalMapTangentSpace:st&&B.normalMapType===iu,metalnessMap:tt,roughnessMap:q,anisotropy:V,anisotropyMap:nt,clearcoat:xe,clearcoatMap:mt,clearcoatNormalMap:Qt,clearcoatRoughnessMap:Xe,dispersion:De,iridescence:He,iridescenceMap:At,iridescenceThicknessMap:kt,sheen:Fe,sheenColorMap:Gt,sheenRoughnessMap:vt,specularMap:ue,specularColorMap:Be,specularIntensityMap:at,transmission:ht,transmissionMap:ae,thicknessMap:Ye,gradientMap:Ce,opaque:B.transparent===!1&&B.blending===wh&&B.alphaToCoverage===!1,alphaMap:ke,alphaTest:pt,alphaHash:lt,combine:B.combine,mapUv:ct&&_(B.map.channel),aoMapUv:Q&&_(B.aoMap.channel),lightMapUv:St&&_(B.lightMap.channel),bumpMapUv:We&&_(B.bumpMap.channel),normalMapUv:st&&_(B.normalMap.channel),displacementMapUv:qe&&_(B.displacementMap.channel),emissiveMapUv:It&&_(B.emissiveMap.channel),metalnessMapUv:tt&&_(B.metalnessMap.channel),roughnessMapUv:q&&_(B.roughnessMap.channel),anisotropyMapUv:nt&&_(B.anisotropyMap.channel),clearcoatMapUv:mt&&_(B.clearcoatMap.channel),clearcoatNormalMapUv:Qt&&_(B.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Xe&&_(B.clearcoatRoughnessMap.channel),iridescenceMapUv:At&&_(B.iridescenceMap.channel),iridescenceThicknessMapUv:kt&&_(B.iridescenceThicknessMap.channel),sheenColorMapUv:Gt&&_(B.sheenColorMap.channel),sheenRoughnessMapUv:vt&&_(B.sheenRoughnessMap.channel),specularMapUv:ue&&_(B.specularMap.channel),specularColorMapUv:Be&&_(B.specularColorMap.channel),specularIntensityMapUv:at&&_(B.specularIntensityMap.channel),transmissionMapUv:ae&&_(B.transmissionMap.channel),thicknessMapUv:Ye&&_(B.thicknessMap.channel),alphaMapUv:ke&&_(B.alphaMap.channel),vertexTangents:!!oe.attributes.tangent&&(st||V),vertexColors:B.vertexColors,vertexAlphas:B.vertexColors===!0&&!!oe.attributes.color&&oe.attributes.color.itemSize===4,pointsUvs:Y.isPoints===!0&&!!oe.attributes.uv&&(ct||ke),fog:!!se,useFog:B.fog===!0,fogExp2:!!se&&se.isFogExp2,flatShading:B.flatShading===!0,sizeAttenuation:B.sizeAttenuation===!0,logarithmicDepthBuffer:f,reverseDepthBuffer:ze,skinning:Y.isSkinnedMesh===!0,morphTargets:oe.morphAttributes.position!==void 0,morphNormals:oe.morphAttributes.normal!==void 0,morphColors:oe.morphAttributes.color!==void 0,morphTargetsCount:W,morphTextureStride:ne,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numLightProbes:P.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:B.dithering,shadowMapEnabled:s.shadowMap.enabled&&G.length>0,shadowMapType:s.shadowMap.type,toneMapping:yn,decodeVideoTexture:ct&&B.map.isVideoTexture===!0&&Mn.getTransfer(B.map.colorSpace)===Fn,decodeVideoTextureEmissive:It&&B.emissiveMap.isVideoTexture===!0&&Mn.getTransfer(B.emissiveMap.colorSpace)===Fn,premultipliedAlpha:B.premultipliedAlpha,doubleSided:B.side===So,flipSided:B.side===ss,useDepthPacking:B.depthPacking>=0,depthPacking:B.depthPacking||0,index0AttributeName:B.index0AttributeName,extensionClipCullDistance:Ft&&B.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ft&&B.extensions.multiDraw===!0||rt)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:B.customProgramCacheKey()};return Nn.vertexUv1s=c.has(1),Nn.vertexUv2s=c.has(2),Nn.vertexUv3s=c.has(3),c.clear(),Nn}function A(B){const P=[];if(B.shaderID?P.push(B.shaderID):(P.push(B.customVertexShaderID),P.push(B.customFragmentShaderID)),B.defines!==void 0)for(const G in B.defines)P.push(G),P.push(B.defines[G]);return B.isRawShaderMaterial===!1&&(w(P,B),M(P,B),P.push(s.outputColorSpace)),P.push(B.customProgramCacheKey),P.join()}function w(B,P){B.push(P.precision),B.push(P.outputColorSpace),B.push(P.envMapMode),B.push(P.envMapCubeUVHeight),B.push(P.mapUv),B.push(P.alphaMapUv),B.push(P.lightMapUv),B.push(P.aoMapUv),B.push(P.bumpMapUv),B.push(P.normalMapUv),B.push(P.displacementMapUv),B.push(P.emissiveMapUv),B.push(P.metalnessMapUv),B.push(P.roughnessMapUv),B.push(P.anisotropyMapUv),B.push(P.clearcoatMapUv),B.push(P.clearcoatNormalMapUv),B.push(P.clearcoatRoughnessMapUv),B.push(P.iridescenceMapUv),B.push(P.iridescenceThicknessMapUv),B.push(P.sheenColorMapUv),B.push(P.sheenRoughnessMapUv),B.push(P.specularMapUv),B.push(P.specularColorMapUv),B.push(P.specularIntensityMapUv),B.push(P.transmissionMapUv),B.push(P.thicknessMapUv),B.push(P.combine),B.push(P.fogExp2),B.push(P.sizeAttenuation),B.push(P.morphTargetsCount),B.push(P.morphAttributeCount),B.push(P.numDirLights),B.push(P.numPointLights),B.push(P.numSpotLights),B.push(P.numSpotLightMaps),B.push(P.numHemiLights),B.push(P.numRectAreaLights),B.push(P.numDirLightShadows),B.push(P.numPointLightShadows),B.push(P.numSpotLightShadows),B.push(P.numSpotLightShadowsWithMaps),B.push(P.numLightProbes),B.push(P.shadowMapType),B.push(P.toneMapping),B.push(P.numClippingPlanes),B.push(P.numClipIntersection),B.push(P.depthPacking)}function M(B,P){a.disableAll(),P.supportsVertexTextures&&a.enable(0),P.instancing&&a.enable(1),P.instancingColor&&a.enable(2),P.instancingMorph&&a.enable(3),P.matcap&&a.enable(4),P.envMap&&a.enable(5),P.normalMapObjectSpace&&a.enable(6),P.normalMapTangentSpace&&a.enable(7),P.clearcoat&&a.enable(8),P.iridescence&&a.enable(9),P.alphaTest&&a.enable(10),P.vertexColors&&a.enable(11),P.vertexAlphas&&a.enable(12),P.vertexUv1s&&a.enable(13),P.vertexUv2s&&a.enable(14),P.vertexUv3s&&a.enable(15),P.vertexTangents&&a.enable(16),P.anisotropy&&a.enable(17),P.alphaHash&&a.enable(18),P.batching&&a.enable(19),P.dispersion&&a.enable(20),P.batchingColor&&a.enable(21),B.push(a.mask),a.disableAll(),P.fog&&a.enable(0),P.useFog&&a.enable(1),P.flatShading&&a.enable(2),P.logarithmicDepthBuffer&&a.enable(3),P.reverseDepthBuffer&&a.enable(4),P.skinning&&a.enable(5),P.morphTargets&&a.enable(6),P.morphNormals&&a.enable(7),P.morphColors&&a.enable(8),P.premultipliedAlpha&&a.enable(9),P.shadowMapEnabled&&a.enable(10),P.doubleSided&&a.enable(11),P.flipSided&&a.enable(12),P.useDepthPacking&&a.enable(13),P.dithering&&a.enable(14),P.transmission&&a.enable(15),P.sheen&&a.enable(16),P.opaque&&a.enable(17),P.pointsUvs&&a.enable(18),P.decodeVideoTexture&&a.enable(19),P.decodeVideoTextureEmissive&&a.enable(20),P.alphaToCoverage&&a.enable(21),B.push(a.mask)}function C(B){const P=v[B.type];let G;if(P){const Z=ia[P];G=vR.clone(Z.uniforms)}else G=B.uniforms;return G}function I(B,P){let G;for(let Z=0,Y=h.length;Z<Y;Z++){const se=h[Z];if(se.cacheKey===P){G=se,++G.usedTimes;break}}return G===void 0&&(G=new g8(s,P,B,r),h.push(G)),G}function O(B){if(--B.usedTimes===0){const P=h.indexOf(B);h[P]=h[h.length-1],h.pop(),B.destroy()}}function k(B){l.remove(B)}function N(){l.dispose()}return{getParameters:S,getProgramCacheKey:A,getUniforms:C,acquireProgram:I,releaseProgram:O,releaseShaderCache:k,programs:h,dispose:N}}function S8(){let s=new WeakMap;function e(o){return s.has(o)}function t(o){let a=s.get(o);return a===void 0&&(a={},s.set(o,a)),a}function n(o){s.delete(o)}function i(o,a,l){s.get(o)[a]=l}function r(){s=new WeakMap}return{has:e,get:t,remove:n,update:i,dispose:r}}function A8(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function jM(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function VM(){const s=[];let e=0;const t=[],n=[],i=[];function r(){e=0,t.length=0,n.length=0,i.length=0}function o(f,p,y,v,_,S){let A=s[e];return A===void 0?(A={id:f.id,object:f,geometry:p,material:y,groupOrder:v,renderOrder:f.renderOrder,z:_,group:S},s[e]=A):(A.id=f.id,A.object=f,A.geometry=p,A.material=y,A.groupOrder=v,A.renderOrder=f.renderOrder,A.z=_,A.group=S),e++,A}function a(f,p,y,v,_,S){const A=o(f,p,y,v,_,S);y.transmission>0?n.push(A):y.transparent===!0?i.push(A):t.push(A)}function l(f,p,y,v,_,S){const A=o(f,p,y,v,_,S);y.transmission>0?n.unshift(A):y.transparent===!0?i.unshift(A):t.unshift(A)}function c(f,p){t.length>1&&t.sort(f||A8),n.length>1&&n.sort(p||jM),i.length>1&&i.sort(p||jM)}function h(){for(let f=e,p=s.length;f<p;f++){const y=s[f];if(y.id===null)break;y.id=null,y.object=null,y.geometry=null,y.material=null,y.group=null}}return{opaque:t,transmissive:n,transparent:i,init:r,push:a,unshift:l,finish:h,sort:c}}function E8(){let s=new WeakMap;function e(n,i){const r=s.get(n);let o;return r===void 0?(o=new VM,s.set(n,[o])):i>=r.length?(o=new VM,r.push(o)):o=r[i],o}function t(){s=new WeakMap}return{get:e,dispose:t}}function T8(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new J,color:new ut};break;case"SpotLight":t={position:new J,direction:new J,color:new ut,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new J,color:new ut,distance:0,decay:0};break;case"HemisphereLight":t={direction:new J,skyColor:new ut,groundColor:new ut};break;case"RectAreaLight":t={color:new ut,position:new J,halfWidth:new J,halfHeight:new J};break}return s[e.id]=t,t}}}function w8(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ue};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ue};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ue,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=t,t}}}let M8=0;function b8(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function C8(s){const e=new T8,t=w8(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)n.probe.push(new J);const i=new J,r=new Kt,o=new Kt;function a(c){let h=0,f=0,p=0;for(let B=0;B<9;B++)n.probe[B].set(0,0,0);let y=0,v=0,_=0,S=0,A=0,w=0,M=0,C=0,I=0,O=0,k=0;c.sort(b8);for(let B=0,P=c.length;B<P;B++){const G=c[B],Z=G.color,Y=G.intensity,se=G.distance,oe=G.shadow&&G.shadow.map?G.shadow.map.texture:null;if(G.isAmbientLight)h+=Z.r*Y,f+=Z.g*Y,p+=Z.b*Y;else if(G.isLightProbe){for(let re=0;re<9;re++)n.probe[re].addScaledVector(G.sh.coefficients[re],Y);k++}else if(G.isDirectionalLight){const re=e.get(G);if(re.color.copy(G.color).multiplyScalar(G.intensity),G.castShadow){const ce=G.shadow,H=t.get(G);H.shadowIntensity=ce.intensity,H.shadowBias=ce.bias,H.shadowNormalBias=ce.normalBias,H.shadowRadius=ce.radius,H.shadowMapSize=ce.mapSize,n.directionalShadow[y]=H,n.directionalShadowMap[y]=oe,n.directionalShadowMatrix[y]=G.shadow.matrix,w++}n.directional[y]=re,y++}else if(G.isSpotLight){const re=e.get(G);re.position.setFromMatrixPosition(G.matrixWorld),re.color.copy(Z).multiplyScalar(Y),re.distance=se,re.coneCos=Math.cos(G.angle),re.penumbraCos=Math.cos(G.angle*(1-G.penumbra)),re.decay=G.decay,n.spot[_]=re;const ce=G.shadow;if(G.map&&(n.spotLightMap[I]=G.map,I++,ce.updateMatrices(G),G.castShadow&&O++),n.spotLightMatrix[_]=ce.matrix,G.castShadow){const H=t.get(G);H.shadowIntensity=ce.intensity,H.shadowBias=ce.bias,H.shadowNormalBias=ce.normalBias,H.shadowRadius=ce.radius,H.shadowMapSize=ce.mapSize,n.spotShadow[_]=H,n.spotShadowMap[_]=oe,C++}_++}else if(G.isRectAreaLight){const re=e.get(G);re.color.copy(Z).multiplyScalar(Y),re.halfWidth.set(G.width*.5,0,0),re.halfHeight.set(0,G.height*.5,0),n.rectArea[S]=re,S++}else if(G.isPointLight){const re=e.get(G);if(re.color.copy(G.color).multiplyScalar(G.intensity),re.distance=G.distance,re.decay=G.decay,G.castShadow){const ce=G.shadow,H=t.get(G);H.shadowIntensity=ce.intensity,H.shadowBias=ce.bias,H.shadowNormalBias=ce.normalBias,H.shadowRadius=ce.radius,H.shadowMapSize=ce.mapSize,H.shadowCameraNear=ce.camera.near,H.shadowCameraFar=ce.camera.far,n.pointShadow[v]=H,n.pointShadowMap[v]=oe,n.pointShadowMatrix[v]=G.shadow.matrix,M++}n.point[v]=re,v++}else if(G.isHemisphereLight){const re=e.get(G);re.skyColor.copy(G.color).multiplyScalar(Y),re.groundColor.copy(G.groundColor).multiplyScalar(Y),n.hemi[A]=re,A++}}S>0&&(s.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=ft.LTC_FLOAT_1,n.rectAreaLTC2=ft.LTC_FLOAT_2):(n.rectAreaLTC1=ft.LTC_HALF_1,n.rectAreaLTC2=ft.LTC_HALF_2)),n.ambient[0]=h,n.ambient[1]=f,n.ambient[2]=p;const N=n.hash;(N.directionalLength!==y||N.pointLength!==v||N.spotLength!==_||N.rectAreaLength!==S||N.hemiLength!==A||N.numDirectionalShadows!==w||N.numPointShadows!==M||N.numSpotShadows!==C||N.numSpotMaps!==I||N.numLightProbes!==k)&&(n.directional.length=y,n.spot.length=_,n.rectArea.length=S,n.point.length=v,n.hemi.length=A,n.directionalShadow.length=w,n.directionalShadowMap.length=w,n.pointShadow.length=M,n.pointShadowMap.length=M,n.spotShadow.length=C,n.spotShadowMap.length=C,n.directionalShadowMatrix.length=w,n.pointShadowMatrix.length=M,n.spotLightMatrix.length=C+I-O,n.spotLightMap.length=I,n.numSpotLightShadowsWithMaps=O,n.numLightProbes=k,N.directionalLength=y,N.pointLength=v,N.spotLength=_,N.rectAreaLength=S,N.hemiLength=A,N.numDirectionalShadows=w,N.numPointShadows=M,N.numSpotShadows=C,N.numSpotMaps=I,N.numLightProbes=k,n.version=M8++)}function l(c,h){let f=0,p=0,y=0,v=0,_=0;const S=h.matrixWorldInverse;for(let A=0,w=c.length;A<w;A++){const M=c[A];if(M.isDirectionalLight){const C=n.directional[f];C.direction.setFromMatrixPosition(M.matrixWorld),i.setFromMatrixPosition(M.target.matrixWorld),C.direction.sub(i),C.direction.transformDirection(S),f++}else if(M.isSpotLight){const C=n.spot[y];C.position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(S),C.direction.setFromMatrixPosition(M.matrixWorld),i.setFromMatrixPosition(M.target.matrixWorld),C.direction.sub(i),C.direction.transformDirection(S),y++}else if(M.isRectAreaLight){const C=n.rectArea[v];C.position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(S),o.identity(),r.copy(M.matrixWorld),r.premultiply(S),o.extractRotation(r),C.halfWidth.set(M.width*.5,0,0),C.halfHeight.set(0,M.height*.5,0),C.halfWidth.applyMatrix4(o),C.halfHeight.applyMatrix4(o),v++}else if(M.isPointLight){const C=n.point[p];C.position.setFromMatrixPosition(M.matrixWorld),C.position.applyMatrix4(S),p++}else if(M.isHemisphereLight){const C=n.hemi[_];C.direction.setFromMatrixPosition(M.matrixWorld),C.direction.transformDirection(S),_++}}}return{setup:a,setupView:l,state:n}}function WM(s){const e=new C8(s),t=[],n=[];function i(h){c.camera=h,t.length=0,n.length=0}function r(h){t.push(h)}function o(h){n.push(h)}function a(){e.setup(t)}function l(h){e.setupView(t,h)}const c={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:c,setupLights:a,setupLightsView:l,pushLight:r,pushShadow:o}}function R8(s){let e=new WeakMap;function t(i,r=0){const o=e.get(i);let a;return o===void 0?(a=new WM(s),e.set(i,[a])):r>=o.length?(a=new WM(s),o.push(a)):a=o[r],a}function n(){e=new WeakMap}return{get:t,dispose:n}}const I8=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,L8=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function P8(s,e,t){let n=new B0;const i=new Ue,r=new Ue,o=new Cn,a=new gE({depthPacking:nR}),l=new yE,c={},h=t.maxTextureSize,f={[Ga]:ss,[ss]:Ga,[So]:So},p=new oa({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ue},radius:{value:4}},vertexShader:I8,fragmentShader:L8}),y=p.clone();y.defines.HORIZONTAL_PASS=1;const v=new rn;v.setAttribute("position",new Rn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new Ci(v,p),S=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Ex;let A=this.type;this.render=function(O,k,N){if(S.enabled===!1||S.autoUpdate===!1&&S.needsUpdate===!1||O.length===0)return;const B=s.getRenderTarget(),P=s.getActiveCubeFace(),G=s.getActiveMipmapLevel(),Z=s.state;Z.setBlending(jl),Z.buffers.color.setClear(1,1,1,1),Z.buffers.depth.setTest(!0),Z.setScissorTest(!1);const Y=A!==na&&this.type===na,se=A===na&&this.type!==na;for(let oe=0,re=O.length;oe<re;oe++){const ce=O[oe],H=ce.shadow;if(H===void 0){console.warn("THREE.WebGLShadowMap:",ce,"has no shadow.");continue}if(H.autoUpdate===!1&&H.needsUpdate===!1)continue;i.copy(H.mapSize);const $=H.getFrameExtents();if(i.multiply($),r.copy(H.mapSize),(i.x>h||i.y>h)&&(i.x>h&&(r.x=Math.floor(h/$.x),i.x=r.x*$.x,H.mapSize.x=r.x),i.y>h&&(r.y=Math.floor(h/$.y),i.y=r.y*$.y,H.mapSize.y=r.y)),H.map===null||Y===!0||se===!0){const W=this.type!==na?{minFilter:ur,magFilter:ur}:{};H.map!==null&&H.map.dispose(),H.map=new wo(i.x,i.y,W),H.map.texture.name=ce.name+".shadowMap",H.camera.updateProjectionMatrix()}s.setRenderTarget(H.map),s.clear();const X=H.getViewportCount();for(let W=0;W<X;W++){const ne=H.getViewport(W);o.set(r.x*ne.x,r.y*ne.y,r.x*ne.z,r.y*ne.w),Z.viewport(o),H.updateMatrices(ce,W),n=H.getFrustum(),C(k,N,H.camera,ce,this.type)}H.isPointLightShadow!==!0&&this.type===na&&w(H,N),H.needsUpdate=!1}A=this.type,S.needsUpdate=!1,s.setRenderTarget(B,P,G)};function w(O,k){const N=e.update(_);p.defines.VSM_SAMPLES!==O.blurSamples&&(p.defines.VSM_SAMPLES=O.blurSamples,y.defines.VSM_SAMPLES=O.blurSamples,p.needsUpdate=!0,y.needsUpdate=!0),O.mapPass===null&&(O.mapPass=new wo(i.x,i.y)),p.uniforms.shadow_pass.value=O.map.texture,p.uniforms.resolution.value=O.mapSize,p.uniforms.radius.value=O.radius,s.setRenderTarget(O.mapPass),s.clear(),s.renderBufferDirect(k,null,N,p,_,null),y.uniforms.shadow_pass.value=O.mapPass.texture,y.uniforms.resolution.value=O.mapSize,y.uniforms.radius.value=O.radius,s.setRenderTarget(O.map),s.clear(),s.renderBufferDirect(k,null,N,y,_,null)}function M(O,k,N,B){let P=null;const G=N.isPointLight===!0?O.customDistanceMaterial:O.customDepthMaterial;if(G!==void 0)P=G;else if(P=N.isPointLight===!0?l:a,s.localClippingEnabled&&k.clipShadows===!0&&Array.isArray(k.clippingPlanes)&&k.clippingPlanes.length!==0||k.displacementMap&&k.displacementScale!==0||k.alphaMap&&k.alphaTest>0||k.map&&k.alphaTest>0){const Z=P.uuid,Y=k.uuid;let se=c[Z];se===void 0&&(se={},c[Z]=se);let oe=se[Y];oe===void 0&&(oe=P.clone(),se[Y]=oe,k.addEventListener("dispose",I)),P=oe}if(P.visible=k.visible,P.wireframe=k.wireframe,B===na?P.side=k.shadowSide!==null?k.shadowSide:k.side:P.side=k.shadowSide!==null?k.shadowSide:f[k.side],P.alphaMap=k.alphaMap,P.alphaTest=k.alphaTest,P.map=k.map,P.clipShadows=k.clipShadows,P.clippingPlanes=k.clippingPlanes,P.clipIntersection=k.clipIntersection,P.displacementMap=k.displacementMap,P.displacementScale=k.displacementScale,P.displacementBias=k.displacementBias,P.wireframeLinewidth=k.wireframeLinewidth,P.linewidth=k.linewidth,N.isPointLight===!0&&P.isMeshDistanceMaterial===!0){const Z=s.properties.get(P);Z.light=N}return P}function C(O,k,N,B,P){if(O.visible===!1)return;if(O.layers.test(k.layers)&&(O.isMesh||O.isLine||O.isPoints)&&(O.castShadow||O.receiveShadow&&P===na)&&(!O.frustumCulled||n.intersectsObject(O))){O.modelViewMatrix.multiplyMatrices(N.matrixWorldInverse,O.matrixWorld);const Y=e.update(O),se=O.material;if(Array.isArray(se)){const oe=Y.groups;for(let re=0,ce=oe.length;re<ce;re++){const H=oe[re],$=se[H.materialIndex];if($&&$.visible){const X=M(O,$,B,P);O.onBeforeShadow(s,O,k,N,Y,X,H),s.renderBufferDirect(N,null,Y,X,O,H),O.onAfterShadow(s,O,k,N,Y,X,H)}}}else if(se.visible){const oe=M(O,se,B,P);O.onBeforeShadow(s,O,k,N,Y,oe,null),s.renderBufferDirect(N,null,Y,oe,O,null),O.onAfterShadow(s,O,k,N,Y,oe,null)}}const Z=O.children;for(let Y=0,se=Z.length;Y<se;Y++)C(Z[Y],k,N,B,P)}function I(O){O.target.removeEventListener("dispose",I);for(const N in c){const B=c[N],P=O.target.uuid;P in B&&(B[P].dispose(),delete B[P])}}}const D8={[gv]:yv,[vv]:Sv,[xv]:Av,[Fh]:_v,[yv]:gv,[Sv]:vv,[Av]:xv,[_v]:Fh};function O8(s,e){function t(){let ae=!1;const Ye=new Cn;let Ce=null;const ke=new Cn(0,0,0,0);return{setMask:function(pt){Ce!==pt&&!ae&&(s.colorMask(pt,pt,pt,pt),Ce=pt)},setLocked:function(pt){ae=pt},setClear:function(pt,lt,Ft,yn,Nn){Nn===!0&&(pt*=yn,lt*=yn,Ft*=yn),Ye.set(pt,lt,Ft,yn),ke.equals(Ye)===!1&&(s.clearColor(pt,lt,Ft,yn),ke.copy(Ye))},reset:function(){ae=!1,Ce=null,ke.set(-1,0,0,0)}}}function n(){let ae=!1,Ye=!1,Ce=null,ke=null,pt=null;return{setReversed:function(lt){if(Ye!==lt){const Ft=e.get("EXT_clip_control");Ye?Ft.clipControlEXT(Ft.LOWER_LEFT_EXT,Ft.ZERO_TO_ONE_EXT):Ft.clipControlEXT(Ft.LOWER_LEFT_EXT,Ft.NEGATIVE_ONE_TO_ONE_EXT);const yn=pt;pt=null,this.setClear(yn)}Ye=lt},getReversed:function(){return Ye},setTest:function(lt){lt?Ie(s.DEPTH_TEST):ze(s.DEPTH_TEST)},setMask:function(lt){Ce!==lt&&!ae&&(s.depthMask(lt),Ce=lt)},setFunc:function(lt){if(Ye&&(lt=D8[lt]),ke!==lt){switch(lt){case gv:s.depthFunc(s.NEVER);break;case yv:s.depthFunc(s.ALWAYS);break;case vv:s.depthFunc(s.LESS);break;case Fh:s.depthFunc(s.LEQUAL);break;case xv:s.depthFunc(s.EQUAL);break;case _v:s.depthFunc(s.GEQUAL);break;case Sv:s.depthFunc(s.GREATER);break;case Av:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}ke=lt}},setLocked:function(lt){ae=lt},setClear:function(lt){pt!==lt&&(Ye&&(lt=1-lt),s.clearDepth(lt),pt=lt)},reset:function(){ae=!1,Ce=null,ke=null,pt=null,Ye=!1}}}function i(){let ae=!1,Ye=null,Ce=null,ke=null,pt=null,lt=null,Ft=null,yn=null,Nn=null;return{setTest:function(ln){ae||(ln?Ie(s.STENCIL_TEST):ze(s.STENCIL_TEST))},setMask:function(ln){Ye!==ln&&!ae&&(s.stencilMask(ln),Ye=ln)},setFunc:function(ln,ai,gi){(Ce!==ln||ke!==ai||pt!==gi)&&(s.stencilFunc(ln,ai,gi),Ce=ln,ke=ai,pt=gi)},setOp:function(ln,ai,gi){(lt!==ln||Ft!==ai||yn!==gi)&&(s.stencilOp(ln,ai,gi),lt=ln,Ft=ai,yn=gi)},setLocked:function(ln){ae=ln},setClear:function(ln){Nn!==ln&&(s.clearStencil(ln),Nn=ln)},reset:function(){ae=!1,Ye=null,Ce=null,ke=null,pt=null,lt=null,Ft=null,yn=null,Nn=null}}}const r=new t,o=new n,a=new i,l=new WeakMap,c=new WeakMap;let h={},f={},p=new WeakMap,y=[],v=null,_=!1,S=null,A=null,w=null,M=null,C=null,I=null,O=null,k=new ut(0,0,0),N=0,B=!1,P=null,G=null,Z=null,Y=null,se=null;const oe=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let re=!1,ce=0;const H=s.getParameter(s.VERSION);H.indexOf("WebGL")!==-1?(ce=parseFloat(/^WebGL (\d)/.exec(H)[1]),re=ce>=1):H.indexOf("OpenGL ES")!==-1&&(ce=parseFloat(/^OpenGL ES (\d)/.exec(H)[1]),re=ce>=2);let $=null,X={};const W=s.getParameter(s.SCISSOR_BOX),ne=s.getParameter(s.VIEWPORT),Ee=new Cn().fromArray(W),le=new Cn().fromArray(ne);function ye(ae,Ye,Ce,ke){const pt=new Uint8Array(4),lt=s.createTexture();s.bindTexture(ae,lt),s.texParameteri(ae,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(ae,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let Ft=0;Ft<Ce;Ft++)ae===s.TEXTURE_3D||ae===s.TEXTURE_2D_ARRAY?s.texImage3D(Ye,0,s.RGBA,1,1,ke,0,s.RGBA,s.UNSIGNED_BYTE,pt):s.texImage2D(Ye+Ft,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,pt);return lt}const we={};we[s.TEXTURE_2D]=ye(s.TEXTURE_2D,s.TEXTURE_2D,1),we[s.TEXTURE_CUBE_MAP]=ye(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),we[s.TEXTURE_2D_ARRAY]=ye(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),we[s.TEXTURE_3D]=ye(s.TEXTURE_3D,s.TEXTURE_3D,1,1),r.setClear(0,0,0,1),o.setClear(1),a.setClear(0),Ie(s.DEPTH_TEST),o.setFunc(Fh),We(!1),st(BS),Ie(s.CULL_FACE),Q(jl);function Ie(ae){h[ae]!==!0&&(s.enable(ae),h[ae]=!0)}function ze(ae){h[ae]!==!1&&(s.disable(ae),h[ae]=!1)}function Ze(ae,Ye){return f[ae]!==Ye?(s.bindFramebuffer(ae,Ye),f[ae]=Ye,ae===s.DRAW_FRAMEBUFFER&&(f[s.FRAMEBUFFER]=Ye),ae===s.FRAMEBUFFER&&(f[s.DRAW_FRAMEBUFFER]=Ye),!0):!1}function rt(ae,Ye){let Ce=y,ke=!1;if(ae){Ce=p.get(Ye),Ce===void 0&&(Ce=[],p.set(Ye,Ce));const pt=ae.textures;if(Ce.length!==pt.length||Ce[0]!==s.COLOR_ATTACHMENT0){for(let lt=0,Ft=pt.length;lt<Ft;lt++)Ce[lt]=s.COLOR_ATTACHMENT0+lt;Ce.length=pt.length,ke=!0}}else Ce[0]!==s.BACK&&(Ce[0]=s.BACK,ke=!0);ke&&s.drawBuffers(Ce)}function ct(ae){return v!==ae?(s.useProgram(ae),v=ae,!0):!1}const Ne={[zc]:s.FUNC_ADD,[wC]:s.FUNC_SUBTRACT,[MC]:s.FUNC_REVERSE_SUBTRACT};Ne[bC]=s.MIN,Ne[CC]=s.MAX;const Ge={[RC]:s.ZERO,[IC]:s.ONE,[LC]:s.SRC_COLOR,[pv]:s.SRC_ALPHA,[kC]:s.SRC_ALPHA_SATURATE,[BC]:s.DST_COLOR,[DC]:s.DST_ALPHA,[PC]:s.ONE_MINUS_SRC_COLOR,[mv]:s.ONE_MINUS_SRC_ALPHA,[FC]:s.ONE_MINUS_DST_COLOR,[OC]:s.ONE_MINUS_DST_ALPHA,[NC]:s.CONSTANT_COLOR,[UC]:s.ONE_MINUS_CONSTANT_COLOR,[GC]:s.CONSTANT_ALPHA,[HC]:s.ONE_MINUS_CONSTANT_ALPHA};function Q(ae,Ye,Ce,ke,pt,lt,Ft,yn,Nn,ln){if(ae===jl){_===!0&&(ze(s.BLEND),_=!1);return}if(_===!1&&(Ie(s.BLEND),_=!0),ae!==TC){if(ae!==S||ln!==B){if((A!==zc||C!==zc)&&(s.blendEquation(s.FUNC_ADD),A=zc,C=zc),ln)switch(ae){case wh:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case FS:s.blendFunc(s.ONE,s.ONE);break;case kS:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case NS:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ae);break}else switch(ae){case wh:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case FS:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case kS:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case NS:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ae);break}w=null,M=null,I=null,O=null,k.set(0,0,0),N=0,S=ae,B=ln}return}pt=pt||Ye,lt=lt||Ce,Ft=Ft||ke,(Ye!==A||pt!==C)&&(s.blendEquationSeparate(Ne[Ye],Ne[pt]),A=Ye,C=pt),(Ce!==w||ke!==M||lt!==I||Ft!==O)&&(s.blendFuncSeparate(Ge[Ce],Ge[ke],Ge[lt],Ge[Ft]),w=Ce,M=ke,I=lt,O=Ft),(yn.equals(k)===!1||Nn!==N)&&(s.blendColor(yn.r,yn.g,yn.b,Nn),k.copy(yn),N=Nn),S=ae,B=!1}function St(ae,Ye){ae.side===So?ze(s.CULL_FACE):Ie(s.CULL_FACE);let Ce=ae.side===ss;Ye&&(Ce=!Ce),We(Ce),ae.blending===wh&&ae.transparent===!1?Q(jl):Q(ae.blending,ae.blendEquation,ae.blendSrc,ae.blendDst,ae.blendEquationAlpha,ae.blendSrcAlpha,ae.blendDstAlpha,ae.blendColor,ae.blendAlpha,ae.premultipliedAlpha),o.setFunc(ae.depthFunc),o.setTest(ae.depthTest),o.setMask(ae.depthWrite),r.setMask(ae.colorWrite);const ke=ae.stencilWrite;a.setTest(ke),ke&&(a.setMask(ae.stencilWriteMask),a.setFunc(ae.stencilFunc,ae.stencilRef,ae.stencilFuncMask),a.setOp(ae.stencilFail,ae.stencilZFail,ae.stencilZPass)),It(ae.polygonOffset,ae.polygonOffsetFactor,ae.polygonOffsetUnits),ae.alphaToCoverage===!0?Ie(s.SAMPLE_ALPHA_TO_COVERAGE):ze(s.SAMPLE_ALPHA_TO_COVERAGE)}function We(ae){P!==ae&&(ae?s.frontFace(s.CW):s.frontFace(s.CCW),P=ae)}function st(ae){ae!==SC?(Ie(s.CULL_FACE),ae!==G&&(ae===BS?s.cullFace(s.BACK):ae===AC?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):ze(s.CULL_FACE),G=ae}function qe(ae){ae!==Z&&(re&&s.lineWidth(ae),Z=ae)}function It(ae,Ye,Ce){ae?(Ie(s.POLYGON_OFFSET_FILL),(Y!==Ye||se!==Ce)&&(s.polygonOffset(Ye,Ce),Y=Ye,se=Ce)):ze(s.POLYGON_OFFSET_FILL)}function tt(ae){ae?Ie(s.SCISSOR_TEST):ze(s.SCISSOR_TEST)}function q(ae){ae===void 0&&(ae=s.TEXTURE0+oe-1),$!==ae&&(s.activeTexture(ae),$=ae)}function V(ae,Ye,Ce){Ce===void 0&&($===null?Ce=s.TEXTURE0+oe-1:Ce=$);let ke=X[Ce];ke===void 0&&(ke={type:void 0,texture:void 0},X[Ce]=ke),(ke.type!==ae||ke.texture!==Ye)&&($!==Ce&&(s.activeTexture(Ce),$=Ce),s.bindTexture(ae,Ye||we[ae]),ke.type=ae,ke.texture=Ye)}function xe(){const ae=X[$];ae!==void 0&&ae.type!==void 0&&(s.bindTexture(ae.type,null),ae.type=void 0,ae.texture=void 0)}function De(){try{s.compressedTexImage2D.apply(s,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function He(){try{s.compressedTexImage3D.apply(s,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Fe(){try{s.texSubImage2D.apply(s,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function ht(){try{s.texSubImage3D.apply(s,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function nt(){try{s.compressedTexSubImage2D.apply(s,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function mt(){try{s.compressedTexSubImage3D.apply(s,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Qt(){try{s.texStorage2D.apply(s,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Xe(){try{s.texStorage3D.apply(s,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function At(){try{s.texImage2D.apply(s,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function kt(){try{s.texImage3D.apply(s,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Gt(ae){Ee.equals(ae)===!1&&(s.scissor(ae.x,ae.y,ae.z,ae.w),Ee.copy(ae))}function vt(ae){le.equals(ae)===!1&&(s.viewport(ae.x,ae.y,ae.z,ae.w),le.copy(ae))}function ue(ae,Ye){let Ce=c.get(Ye);Ce===void 0&&(Ce=new WeakMap,c.set(Ye,Ce));let ke=Ce.get(ae);ke===void 0&&(ke=s.getUniformBlockIndex(Ye,ae.name),Ce.set(ae,ke))}function Be(ae,Ye){const ke=c.get(Ye).get(ae);l.get(Ye)!==ke&&(s.uniformBlockBinding(Ye,ke,ae.__bindingPointIndex),l.set(Ye,ke))}function at(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),o.setReversed(!1),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),h={},$=null,X={},f={},p=new WeakMap,y=[],v=null,_=!1,S=null,A=null,w=null,M=null,C=null,I=null,O=null,k=new ut(0,0,0),N=0,B=!1,P=null,G=null,Z=null,Y=null,se=null,Ee.set(0,0,s.canvas.width,s.canvas.height),le.set(0,0,s.canvas.width,s.canvas.height),r.reset(),o.reset(),a.reset()}return{buffers:{color:r,depth:o,stencil:a},enable:Ie,disable:ze,bindFramebuffer:Ze,drawBuffers:rt,useProgram:ct,setBlending:Q,setMaterial:St,setFlipSided:We,setCullFace:st,setLineWidth:qe,setPolygonOffset:It,setScissorTest:tt,activeTexture:q,bindTexture:V,unbindTexture:xe,compressedTexImage2D:De,compressedTexImage3D:He,texImage2D:At,texImage3D:kt,updateUBOMapping:ue,uniformBlockBinding:Be,texStorage2D:Qt,texStorage3D:Xe,texSubImage2D:Fe,texSubImage3D:ht,compressedTexSubImage2D:nt,compressedTexSubImage3D:mt,scissor:Gt,viewport:vt,reset:at}}function B8(s,e,t,n,i,r,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Ue,h=new WeakMap;let f;const p=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(q,V){return y?new OffscreenCanvas(q,V):c0("canvas")}function _(q,V,xe){let De=1;const He=tt(q);if((He.width>xe||He.height>xe)&&(De=xe/Math.max(He.width,He.height)),De<1)if(typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&q instanceof ImageBitmap||typeof VideoFrame<"u"&&q instanceof VideoFrame){const Fe=Math.floor(De*He.width),ht=Math.floor(De*He.height);f===void 0&&(f=v(Fe,ht));const nt=V?v(Fe,ht):f;return nt.width=Fe,nt.height=ht,nt.getContext("2d").drawImage(q,0,0,Fe,ht),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+He.width+"x"+He.height+") to ("+Fe+"x"+ht+")."),nt}else return"data"in q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+He.width+"x"+He.height+")."),q;return q}function S(q){return q.generateMipmaps}function A(q){s.generateMipmap(q)}function w(q){return q.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:q.isWebGL3DRenderTarget?s.TEXTURE_3D:q.isWebGLArrayRenderTarget||q.isCompressedArrayTexture?s.TEXTURE_2D_ARRAY:s.TEXTURE_2D}function M(q,V,xe,De,He=!1){if(q!==null){if(s[q]!==void 0)return s[q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+q+"'")}let Fe=V;if(V===s.RED&&(xe===s.FLOAT&&(Fe=s.R32F),xe===s.HALF_FLOAT&&(Fe=s.R16F),xe===s.UNSIGNED_BYTE&&(Fe=s.R8)),V===s.RED_INTEGER&&(xe===s.UNSIGNED_BYTE&&(Fe=s.R8UI),xe===s.UNSIGNED_SHORT&&(Fe=s.R16UI),xe===s.UNSIGNED_INT&&(Fe=s.R32UI),xe===s.BYTE&&(Fe=s.R8I),xe===s.SHORT&&(Fe=s.R16I),xe===s.INT&&(Fe=s.R32I)),V===s.RG&&(xe===s.FLOAT&&(Fe=s.RG32F),xe===s.HALF_FLOAT&&(Fe=s.RG16F),xe===s.UNSIGNED_BYTE&&(Fe=s.RG8)),V===s.RG_INTEGER&&(xe===s.UNSIGNED_BYTE&&(Fe=s.RG8UI),xe===s.UNSIGNED_SHORT&&(Fe=s.RG16UI),xe===s.UNSIGNED_INT&&(Fe=s.RG32UI),xe===s.BYTE&&(Fe=s.RG8I),xe===s.SHORT&&(Fe=s.RG16I),xe===s.INT&&(Fe=s.RG32I)),V===s.RGB_INTEGER&&(xe===s.UNSIGNED_BYTE&&(Fe=s.RGB8UI),xe===s.UNSIGNED_SHORT&&(Fe=s.RGB16UI),xe===s.UNSIGNED_INT&&(Fe=s.RGB32UI),xe===s.BYTE&&(Fe=s.RGB8I),xe===s.SHORT&&(Fe=s.RGB16I),xe===s.INT&&(Fe=s.RGB32I)),V===s.RGBA_INTEGER&&(xe===s.UNSIGNED_BYTE&&(Fe=s.RGBA8UI),xe===s.UNSIGNED_SHORT&&(Fe=s.RGBA16UI),xe===s.UNSIGNED_INT&&(Fe=s.RGBA32UI),xe===s.BYTE&&(Fe=s.RGBA8I),xe===s.SHORT&&(Fe=s.RGBA16I),xe===s.INT&&(Fe=s.RGBA32I)),V===s.RGB&&xe===s.UNSIGNED_INT_5_9_9_9_REV&&(Fe=s.RGB9_E5),V===s.RGBA){const ht=He?o0:Mn.getTransfer(De);xe===s.FLOAT&&(Fe=s.RGBA32F),xe===s.HALF_FLOAT&&(Fe=s.RGBA16F),xe===s.UNSIGNED_BYTE&&(Fe=ht===Fn?s.SRGB8_ALPHA8:s.RGBA8),xe===s.UNSIGNED_SHORT_4_4_4_4&&(Fe=s.RGBA4),xe===s.UNSIGNED_SHORT_5_5_5_1&&(Fe=s.RGB5_A1)}return(Fe===s.R16F||Fe===s.R32F||Fe===s.RG16F||Fe===s.RG32F||Fe===s.RGBA16F||Fe===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Fe}function C(q,V){let xe;return q?V===null||V===Xl||V===kh?xe=s.DEPTH24_STENCIL8:V===rs?xe=s.DEPTH32F_STENCIL8:V===qf&&(xe=s.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):V===null||V===Xl||V===kh?xe=s.DEPTH_COMPONENT24:V===rs?xe=s.DEPTH_COMPONENT32F:V===qf&&(xe=s.DEPTH_COMPONENT16),xe}function I(q,V){return S(q)===!0||q.isFramebufferTexture&&q.minFilter!==ur&&q.minFilter!==pi?Math.log2(Math.max(V.width,V.height))+1:q.mipmaps!==void 0&&q.mipmaps.length>0?q.mipmaps.length:q.isCompressedTexture&&Array.isArray(q.image)?V.mipmaps.length:1}function O(q){const V=q.target;V.removeEventListener("dispose",O),N(V),V.isVideoTexture&&h.delete(V)}function k(q){const V=q.target;V.removeEventListener("dispose",k),P(V)}function N(q){const V=n.get(q);if(V.__webglInit===void 0)return;const xe=q.source,De=p.get(xe);if(De){const He=De[V.__cacheKey];He.usedTimes--,He.usedTimes===0&&B(q),Object.keys(De).length===0&&p.delete(xe)}n.remove(q)}function B(q){const V=n.get(q);s.deleteTexture(V.__webglTexture);const xe=q.source,De=p.get(xe);delete De[V.__cacheKey],o.memory.textures--}function P(q){const V=n.get(q);if(q.depthTexture&&(q.depthTexture.dispose(),n.remove(q.depthTexture)),q.isWebGLCubeRenderTarget)for(let De=0;De<6;De++){if(Array.isArray(V.__webglFramebuffer[De]))for(let He=0;He<V.__webglFramebuffer[De].length;He++)s.deleteFramebuffer(V.__webglFramebuffer[De][He]);else s.deleteFramebuffer(V.__webglFramebuffer[De]);V.__webglDepthbuffer&&s.deleteRenderbuffer(V.__webglDepthbuffer[De])}else{if(Array.isArray(V.__webglFramebuffer))for(let De=0;De<V.__webglFramebuffer.length;De++)s.deleteFramebuffer(V.__webglFramebuffer[De]);else s.deleteFramebuffer(V.__webglFramebuffer);if(V.__webglDepthbuffer&&s.deleteRenderbuffer(V.__webglDepthbuffer),V.__webglMultisampledFramebuffer&&s.deleteFramebuffer(V.__webglMultisampledFramebuffer),V.__webglColorRenderbuffer)for(let De=0;De<V.__webglColorRenderbuffer.length;De++)V.__webglColorRenderbuffer[De]&&s.deleteRenderbuffer(V.__webglColorRenderbuffer[De]);V.__webglDepthRenderbuffer&&s.deleteRenderbuffer(V.__webglDepthRenderbuffer)}const xe=q.textures;for(let De=0,He=xe.length;De<He;De++){const Fe=n.get(xe[De]);Fe.__webglTexture&&(s.deleteTexture(Fe.__webglTexture),o.memory.textures--),n.remove(xe[De])}n.remove(q)}let G=0;function Z(){G=0}function Y(){const q=G;return q>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+q+" texture units while this GPU supports only "+i.maxTextures),G+=1,q}function se(q){const V=[];return V.push(q.wrapS),V.push(q.wrapT),V.push(q.wrapR||0),V.push(q.magFilter),V.push(q.minFilter),V.push(q.anisotropy),V.push(q.internalFormat),V.push(q.format),V.push(q.type),V.push(q.generateMipmaps),V.push(q.premultiplyAlpha),V.push(q.flipY),V.push(q.unpackAlignment),V.push(q.colorSpace),V.join()}function oe(q,V){const xe=n.get(q);if(q.isVideoTexture&&qe(q),q.isRenderTargetTexture===!1&&q.version>0&&xe.__version!==q.version){const De=q.image;if(De===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(De.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{le(xe,q,V);return}}t.bindTexture(s.TEXTURE_2D,xe.__webglTexture,s.TEXTURE0+V)}function re(q,V){const xe=n.get(q);if(q.version>0&&xe.__version!==q.version){le(xe,q,V);return}t.bindTexture(s.TEXTURE_2D_ARRAY,xe.__webglTexture,s.TEXTURE0+V)}function ce(q,V){const xe=n.get(q);if(q.version>0&&xe.__version!==q.version){le(xe,q,V);return}t.bindTexture(s.TEXTURE_3D,xe.__webglTexture,s.TEXTURE0+V)}function H(q,V){const xe=n.get(q);if(q.version>0&&xe.__version!==q.version){ye(xe,q,V);return}t.bindTexture(s.TEXTURE_CUBE_MAP,xe.__webglTexture,s.TEXTURE0+V)}const $={[Qc]:s.REPEAT,[Ws]:s.CLAMP_TO_EDGE,[Jf]:s.MIRRORED_REPEAT},X={[ur]:s.NEAREST,[wx]:s.NEAREST_MIPMAP_NEAREST,[gh]:s.NEAREST_MIPMAP_LINEAR,[pi]:s.LINEAR,[jf]:s.LINEAR_MIPMAP_NEAREST,[Ao]:s.LINEAR_MIPMAP_LINEAR},W={[rR]:s.NEVER,[uR]:s.ALWAYS,[sR]:s.LESS,[QA]:s.LEQUAL,[oR]:s.EQUAL,[cR]:s.GEQUAL,[aR]:s.GREATER,[lR]:s.NOTEQUAL};function ne(q,V){if(V.type===rs&&e.has("OES_texture_float_linear")===!1&&(V.magFilter===pi||V.magFilter===jf||V.magFilter===gh||V.magFilter===Ao||V.minFilter===pi||V.minFilter===jf||V.minFilter===gh||V.minFilter===Ao)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),s.texParameteri(q,s.TEXTURE_WRAP_S,$[V.wrapS]),s.texParameteri(q,s.TEXTURE_WRAP_T,$[V.wrapT]),(q===s.TEXTURE_3D||q===s.TEXTURE_2D_ARRAY)&&s.texParameteri(q,s.TEXTURE_WRAP_R,$[V.wrapR]),s.texParameteri(q,s.TEXTURE_MAG_FILTER,X[V.magFilter]),s.texParameteri(q,s.TEXTURE_MIN_FILTER,X[V.minFilter]),V.compareFunction&&(s.texParameteri(q,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(q,s.TEXTURE_COMPARE_FUNC,W[V.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(V.magFilter===ur||V.minFilter!==gh&&V.minFilter!==Ao||V.type===rs&&e.has("OES_texture_float_linear")===!1)return;if(V.anisotropy>1||n.get(V).__currentAnisotropy){const xe=e.get("EXT_texture_filter_anisotropic");s.texParameterf(q,xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(V.anisotropy,i.getMaxAnisotropy())),n.get(V).__currentAnisotropy=V.anisotropy}}}function Ee(q,V){let xe=!1;q.__webglInit===void 0&&(q.__webglInit=!0,V.addEventListener("dispose",O));const De=V.source;let He=p.get(De);He===void 0&&(He={},p.set(De,He));const Fe=se(V);if(Fe!==q.__cacheKey){He[Fe]===void 0&&(He[Fe]={texture:s.createTexture(),usedTimes:0},o.memory.textures++,xe=!0),He[Fe].usedTimes++;const ht=He[q.__cacheKey];ht!==void 0&&(He[q.__cacheKey].usedTimes--,ht.usedTimes===0&&B(V)),q.__cacheKey=Fe,q.__webglTexture=He[Fe].texture}return xe}function le(q,V,xe){let De=s.TEXTURE_2D;(V.isDataArrayTexture||V.isCompressedArrayTexture)&&(De=s.TEXTURE_2D_ARRAY),V.isData3DTexture&&(De=s.TEXTURE_3D);const He=Ee(q,V),Fe=V.source;t.bindTexture(De,q.__webglTexture,s.TEXTURE0+xe);const ht=n.get(Fe);if(Fe.version!==ht.__version||He===!0){t.activeTexture(s.TEXTURE0+xe);const nt=Mn.getPrimaries(Mn.workingColorSpace),mt=V.colorSpace===Nl?null:Mn.getPrimaries(V.colorSpace),Qt=V.colorSpace===Nl||nt===mt?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,V.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,V.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Qt);let Xe=_(V.image,!1,i.maxTextureSize);Xe=It(V,Xe);const At=r.convert(V.format,V.colorSpace),kt=r.convert(V.type);let Gt=M(V.internalFormat,At,kt,V.colorSpace,V.isVideoTexture);ne(De,V);let vt;const ue=V.mipmaps,Be=V.isVideoTexture!==!0,at=ht.__version===void 0||He===!0,ae=Fe.dataReady,Ye=I(V,Xe);if(V.isDepthTexture)Gt=C(V.format===Nh,V.type),at&&(Be?t.texStorage2D(s.TEXTURE_2D,1,Gt,Xe.width,Xe.height):t.texImage2D(s.TEXTURE_2D,0,Gt,Xe.width,Xe.height,0,At,kt,null));else if(V.isDataTexture)if(ue.length>0){Be&&at&&t.texStorage2D(s.TEXTURE_2D,Ye,Gt,ue[0].width,ue[0].height);for(let Ce=0,ke=ue.length;Ce<ke;Ce++)vt=ue[Ce],Be?ae&&t.texSubImage2D(s.TEXTURE_2D,Ce,0,0,vt.width,vt.height,At,kt,vt.data):t.texImage2D(s.TEXTURE_2D,Ce,Gt,vt.width,vt.height,0,At,kt,vt.data);V.generateMipmaps=!1}else Be?(at&&t.texStorage2D(s.TEXTURE_2D,Ye,Gt,Xe.width,Xe.height),ae&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,Xe.width,Xe.height,At,kt,Xe.data)):t.texImage2D(s.TEXTURE_2D,0,Gt,Xe.width,Xe.height,0,At,kt,Xe.data);else if(V.isCompressedTexture)if(V.isCompressedArrayTexture){Be&&at&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Ye,Gt,ue[0].width,ue[0].height,Xe.depth);for(let Ce=0,ke=ue.length;Ce<ke;Ce++)if(vt=ue[Ce],V.format!==Nr)if(At!==null)if(Be){if(ae)if(V.layerUpdates.size>0){const pt=$S(vt.width,vt.height,V.format,V.type);for(const lt of V.layerUpdates){const Ft=vt.data.subarray(lt*pt/vt.data.BYTES_PER_ELEMENT,(lt+1)*pt/vt.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,Ce,0,0,lt,vt.width,vt.height,1,At,Ft)}V.clearLayerUpdates()}else t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,Ce,0,0,0,vt.width,vt.height,Xe.depth,At,vt.data)}else t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,Ce,Gt,vt.width,vt.height,Xe.depth,0,vt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Be?ae&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,Ce,0,0,0,vt.width,vt.height,Xe.depth,At,kt,vt.data):t.texImage3D(s.TEXTURE_2D_ARRAY,Ce,Gt,vt.width,vt.height,Xe.depth,0,At,kt,vt.data)}else{Be&&at&&t.texStorage2D(s.TEXTURE_2D,Ye,Gt,ue[0].width,ue[0].height);for(let Ce=0,ke=ue.length;Ce<ke;Ce++)vt=ue[Ce],V.format!==Nr?At!==null?Be?ae&&t.compressedTexSubImage2D(s.TEXTURE_2D,Ce,0,0,vt.width,vt.height,At,vt.data):t.compressedTexImage2D(s.TEXTURE_2D,Ce,Gt,vt.width,vt.height,0,vt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Be?ae&&t.texSubImage2D(s.TEXTURE_2D,Ce,0,0,vt.width,vt.height,At,kt,vt.data):t.texImage2D(s.TEXTURE_2D,Ce,Gt,vt.width,vt.height,0,At,kt,vt.data)}else if(V.isDataArrayTexture)if(Be){if(at&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Ye,Gt,Xe.width,Xe.height,Xe.depth),ae)if(V.layerUpdates.size>0){const Ce=$S(Xe.width,Xe.height,V.format,V.type);for(const ke of V.layerUpdates){const pt=Xe.data.subarray(ke*Ce/Xe.data.BYTES_PER_ELEMENT,(ke+1)*Ce/Xe.data.BYTES_PER_ELEMENT);t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,ke,Xe.width,Xe.height,1,At,kt,pt)}V.clearLayerUpdates()}else t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,Xe.width,Xe.height,Xe.depth,At,kt,Xe.data)}else t.texImage3D(s.TEXTURE_2D_ARRAY,0,Gt,Xe.width,Xe.height,Xe.depth,0,At,kt,Xe.data);else if(V.isData3DTexture)Be?(at&&t.texStorage3D(s.TEXTURE_3D,Ye,Gt,Xe.width,Xe.height,Xe.depth),ae&&t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,Xe.width,Xe.height,Xe.depth,At,kt,Xe.data)):t.texImage3D(s.TEXTURE_3D,0,Gt,Xe.width,Xe.height,Xe.depth,0,At,kt,Xe.data);else if(V.isFramebufferTexture){if(at)if(Be)t.texStorage2D(s.TEXTURE_2D,Ye,Gt,Xe.width,Xe.height);else{let Ce=Xe.width,ke=Xe.height;for(let pt=0;pt<Ye;pt++)t.texImage2D(s.TEXTURE_2D,pt,Gt,Ce,ke,0,At,kt,null),Ce>>=1,ke>>=1}}else if(ue.length>0){if(Be&&at){const Ce=tt(ue[0]);t.texStorage2D(s.TEXTURE_2D,Ye,Gt,Ce.width,Ce.height)}for(let Ce=0,ke=ue.length;Ce<ke;Ce++)vt=ue[Ce],Be?ae&&t.texSubImage2D(s.TEXTURE_2D,Ce,0,0,At,kt,vt):t.texImage2D(s.TEXTURE_2D,Ce,Gt,At,kt,vt);V.generateMipmaps=!1}else if(Be){if(at){const Ce=tt(Xe);t.texStorage2D(s.TEXTURE_2D,Ye,Gt,Ce.width,Ce.height)}ae&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,At,kt,Xe)}else t.texImage2D(s.TEXTURE_2D,0,Gt,At,kt,Xe);S(V)&&A(De),ht.__version=Fe.version,V.onUpdate&&V.onUpdate(V)}q.__version=V.version}function ye(q,V,xe){if(V.image.length!==6)return;const De=Ee(q,V),He=V.source;t.bindTexture(s.TEXTURE_CUBE_MAP,q.__webglTexture,s.TEXTURE0+xe);const Fe=n.get(He);if(He.version!==Fe.__version||De===!0){t.activeTexture(s.TEXTURE0+xe);const ht=Mn.getPrimaries(Mn.workingColorSpace),nt=V.colorSpace===Nl?null:Mn.getPrimaries(V.colorSpace),mt=V.colorSpace===Nl||ht===nt?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,V.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,V.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,mt);const Qt=V.isCompressedTexture||V.image[0].isCompressedTexture,Xe=V.image[0]&&V.image[0].isDataTexture,At=[];for(let ke=0;ke<6;ke++)!Qt&&!Xe?At[ke]=_(V.image[ke],!0,i.maxCubemapSize):At[ke]=Xe?V.image[ke].image:V.image[ke],At[ke]=It(V,At[ke]);const kt=At[0],Gt=r.convert(V.format,V.colorSpace),vt=r.convert(V.type),ue=M(V.internalFormat,Gt,vt,V.colorSpace),Be=V.isVideoTexture!==!0,at=Fe.__version===void 0||De===!0,ae=He.dataReady;let Ye=I(V,kt);ne(s.TEXTURE_CUBE_MAP,V);let Ce;if(Qt){Be&&at&&t.texStorage2D(s.TEXTURE_CUBE_MAP,Ye,ue,kt.width,kt.height);for(let ke=0;ke<6;ke++){Ce=At[ke].mipmaps;for(let pt=0;pt<Ce.length;pt++){const lt=Ce[pt];V.format!==Nr?Gt!==null?Be?ae&&t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,pt,0,0,lt.width,lt.height,Gt,lt.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,pt,ue,lt.width,lt.height,0,lt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Be?ae&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,pt,0,0,lt.width,lt.height,Gt,vt,lt.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,pt,ue,lt.width,lt.height,0,Gt,vt,lt.data)}}}else{if(Ce=V.mipmaps,Be&&at){Ce.length>0&&Ye++;const ke=tt(At[0]);t.texStorage2D(s.TEXTURE_CUBE_MAP,Ye,ue,ke.width,ke.height)}for(let ke=0;ke<6;ke++)if(Xe){Be?ae&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,0,0,At[ke].width,At[ke].height,Gt,vt,At[ke].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,ue,At[ke].width,At[ke].height,0,Gt,vt,At[ke].data);for(let pt=0;pt<Ce.length;pt++){const Ft=Ce[pt].image[ke].image;Be?ae&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,pt+1,0,0,Ft.width,Ft.height,Gt,vt,Ft.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,pt+1,ue,Ft.width,Ft.height,0,Gt,vt,Ft.data)}}else{Be?ae&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,0,0,Gt,vt,At[ke]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,ue,Gt,vt,At[ke]);for(let pt=0;pt<Ce.length;pt++){const lt=Ce[pt];Be?ae&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,pt+1,0,0,Gt,vt,lt.image[ke]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+ke,pt+1,ue,Gt,vt,lt.image[ke])}}}S(V)&&A(s.TEXTURE_CUBE_MAP),Fe.__version=He.version,V.onUpdate&&V.onUpdate(V)}q.__version=V.version}function we(q,V,xe,De,He,Fe){const ht=r.convert(xe.format,xe.colorSpace),nt=r.convert(xe.type),mt=M(xe.internalFormat,ht,nt,xe.colorSpace),Qt=n.get(V),Xe=n.get(xe);if(Xe.__renderTarget=V,!Qt.__hasExternalTextures){const At=Math.max(1,V.width>>Fe),kt=Math.max(1,V.height>>Fe);He===s.TEXTURE_3D||He===s.TEXTURE_2D_ARRAY?t.texImage3D(He,Fe,mt,At,kt,V.depth,0,ht,nt,null):t.texImage2D(He,Fe,mt,At,kt,0,ht,nt,null)}t.bindFramebuffer(s.FRAMEBUFFER,q),st(V)?a.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,De,He,Xe.__webglTexture,0,We(V)):(He===s.TEXTURE_2D||He>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&He<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,De,He,Xe.__webglTexture,Fe),t.bindFramebuffer(s.FRAMEBUFFER,null)}function Ie(q,V,xe){if(s.bindRenderbuffer(s.RENDERBUFFER,q),V.depthBuffer){const De=V.depthTexture,He=De&&De.isDepthTexture?De.type:null,Fe=C(V.stencilBuffer,He),ht=V.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,nt=We(V);st(V)?a.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,nt,Fe,V.width,V.height):xe?s.renderbufferStorageMultisample(s.RENDERBUFFER,nt,Fe,V.width,V.height):s.renderbufferStorage(s.RENDERBUFFER,Fe,V.width,V.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,ht,s.RENDERBUFFER,q)}else{const De=V.textures;for(let He=0;He<De.length;He++){const Fe=De[He],ht=r.convert(Fe.format,Fe.colorSpace),nt=r.convert(Fe.type),mt=M(Fe.internalFormat,ht,nt,Fe.colorSpace),Qt=We(V);xe&&st(V)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,Qt,mt,V.width,V.height):st(V)?a.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Qt,mt,V.width,V.height):s.renderbufferStorage(s.RENDERBUFFER,mt,V.width,V.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function ze(q,V){if(V&&V.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,q),!(V.depthTexture&&V.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const De=n.get(V.depthTexture);De.__renderTarget=V,(!De.__webglTexture||V.depthTexture.image.width!==V.width||V.depthTexture.image.height!==V.height)&&(V.depthTexture.image.width=V.width,V.depthTexture.image.height=V.height,V.depthTexture.needsUpdate=!0),oe(V.depthTexture,0);const He=De.__webglTexture,Fe=We(V);if(V.depthTexture.format===Mh)st(V)?a.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,He,0,Fe):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,He,0);else if(V.depthTexture.format===Nh)st(V)?a.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,He,0,Fe):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,He,0);else throw new Error("Unknown depthTexture format")}function Ze(q){const V=n.get(q),xe=q.isWebGLCubeRenderTarget===!0;if(V.__boundDepthTexture!==q.depthTexture){const De=q.depthTexture;if(V.__depthDisposeCallback&&V.__depthDisposeCallback(),De){const He=()=>{delete V.__boundDepthTexture,delete V.__depthDisposeCallback,De.removeEventListener("dispose",He)};De.addEventListener("dispose",He),V.__depthDisposeCallback=He}V.__boundDepthTexture=De}if(q.depthTexture&&!V.__autoAllocateDepthBuffer){if(xe)throw new Error("target.depthTexture not supported in Cube render targets");ze(V.__webglFramebuffer,q)}else if(xe){V.__webglDepthbuffer=[];for(let De=0;De<6;De++)if(t.bindFramebuffer(s.FRAMEBUFFER,V.__webglFramebuffer[De]),V.__webglDepthbuffer[De]===void 0)V.__webglDepthbuffer[De]=s.createRenderbuffer(),Ie(V.__webglDepthbuffer[De],q,!1);else{const He=q.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Fe=V.__webglDepthbuffer[De];s.bindRenderbuffer(s.RENDERBUFFER,Fe),s.framebufferRenderbuffer(s.FRAMEBUFFER,He,s.RENDERBUFFER,Fe)}}else if(t.bindFramebuffer(s.FRAMEBUFFER,V.__webglFramebuffer),V.__webglDepthbuffer===void 0)V.__webglDepthbuffer=s.createRenderbuffer(),Ie(V.__webglDepthbuffer,q,!1);else{const De=q.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,He=V.__webglDepthbuffer;s.bindRenderbuffer(s.RENDERBUFFER,He),s.framebufferRenderbuffer(s.FRAMEBUFFER,De,s.RENDERBUFFER,He)}t.bindFramebuffer(s.FRAMEBUFFER,null)}function rt(q,V,xe){const De=n.get(q);V!==void 0&&we(De.__webglFramebuffer,q,q.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),xe!==void 0&&Ze(q)}function ct(q){const V=q.texture,xe=n.get(q),De=n.get(V);q.addEventListener("dispose",k);const He=q.textures,Fe=q.isWebGLCubeRenderTarget===!0,ht=He.length>1;if(ht||(De.__webglTexture===void 0&&(De.__webglTexture=s.createTexture()),De.__version=V.version,o.memory.textures++),Fe){xe.__webglFramebuffer=[];for(let nt=0;nt<6;nt++)if(V.mipmaps&&V.mipmaps.length>0){xe.__webglFramebuffer[nt]=[];for(let mt=0;mt<V.mipmaps.length;mt++)xe.__webglFramebuffer[nt][mt]=s.createFramebuffer()}else xe.__webglFramebuffer[nt]=s.createFramebuffer()}else{if(V.mipmaps&&V.mipmaps.length>0){xe.__webglFramebuffer=[];for(let nt=0;nt<V.mipmaps.length;nt++)xe.__webglFramebuffer[nt]=s.createFramebuffer()}else xe.__webglFramebuffer=s.createFramebuffer();if(ht)for(let nt=0,mt=He.length;nt<mt;nt++){const Qt=n.get(He[nt]);Qt.__webglTexture===void 0&&(Qt.__webglTexture=s.createTexture(),o.memory.textures++)}if(q.samples>0&&st(q)===!1){xe.__webglMultisampledFramebuffer=s.createFramebuffer(),xe.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,xe.__webglMultisampledFramebuffer);for(let nt=0;nt<He.length;nt++){const mt=He[nt];xe.__webglColorRenderbuffer[nt]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,xe.__webglColorRenderbuffer[nt]);const Qt=r.convert(mt.format,mt.colorSpace),Xe=r.convert(mt.type),At=M(mt.internalFormat,Qt,Xe,mt.colorSpace,q.isXRRenderTarget===!0),kt=We(q);s.renderbufferStorageMultisample(s.RENDERBUFFER,kt,At,q.width,q.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+nt,s.RENDERBUFFER,xe.__webglColorRenderbuffer[nt])}s.bindRenderbuffer(s.RENDERBUFFER,null),q.depthBuffer&&(xe.__webglDepthRenderbuffer=s.createRenderbuffer(),Ie(xe.__webglDepthRenderbuffer,q,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(Fe){t.bindTexture(s.TEXTURE_CUBE_MAP,De.__webglTexture),ne(s.TEXTURE_CUBE_MAP,V);for(let nt=0;nt<6;nt++)if(V.mipmaps&&V.mipmaps.length>0)for(let mt=0;mt<V.mipmaps.length;mt++)we(xe.__webglFramebuffer[nt][mt],q,V,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+nt,mt);else we(xe.__webglFramebuffer[nt],q,V,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0);S(V)&&A(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ht){for(let nt=0,mt=He.length;nt<mt;nt++){const Qt=He[nt],Xe=n.get(Qt);t.bindTexture(s.TEXTURE_2D,Xe.__webglTexture),ne(s.TEXTURE_2D,Qt),we(xe.__webglFramebuffer,q,Qt,s.COLOR_ATTACHMENT0+nt,s.TEXTURE_2D,0),S(Qt)&&A(s.TEXTURE_2D)}t.unbindTexture()}else{let nt=s.TEXTURE_2D;if((q.isWebGL3DRenderTarget||q.isWebGLArrayRenderTarget)&&(nt=q.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),t.bindTexture(nt,De.__webglTexture),ne(nt,V),V.mipmaps&&V.mipmaps.length>0)for(let mt=0;mt<V.mipmaps.length;mt++)we(xe.__webglFramebuffer[mt],q,V,s.COLOR_ATTACHMENT0,nt,mt);else we(xe.__webglFramebuffer,q,V,s.COLOR_ATTACHMENT0,nt,0);S(V)&&A(nt),t.unbindTexture()}q.depthBuffer&&Ze(q)}function Ne(q){const V=q.textures;for(let xe=0,De=V.length;xe<De;xe++){const He=V[xe];if(S(He)){const Fe=w(q),ht=n.get(He).__webglTexture;t.bindTexture(Fe,ht),A(Fe),t.unbindTexture()}}}const Ge=[],Q=[];function St(q){if(q.samples>0){if(st(q)===!1){const V=q.textures,xe=q.width,De=q.height;let He=s.COLOR_BUFFER_BIT;const Fe=q.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,ht=n.get(q),nt=V.length>1;if(nt)for(let mt=0;mt<V.length;mt++)t.bindFramebuffer(s.FRAMEBUFFER,ht.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+mt,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,ht.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+mt,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,ht.__webglMultisampledFramebuffer),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,ht.__webglFramebuffer);for(let mt=0;mt<V.length;mt++){if(q.resolveDepthBuffer&&(q.depthBuffer&&(He|=s.DEPTH_BUFFER_BIT),q.stencilBuffer&&q.resolveStencilBuffer&&(He|=s.STENCIL_BUFFER_BIT)),nt){s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,ht.__webglColorRenderbuffer[mt]);const Qt=n.get(V[mt]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,Qt,0)}s.blitFramebuffer(0,0,xe,De,0,0,xe,De,He,s.NEAREST),l===!0&&(Ge.length=0,Q.length=0,Ge.push(s.COLOR_ATTACHMENT0+mt),q.depthBuffer&&q.resolveDepthBuffer===!1&&(Ge.push(Fe),Q.push(Fe),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,Q)),s.invalidateFramebuffer(s.READ_FRAMEBUFFER,Ge))}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),nt)for(let mt=0;mt<V.length;mt++){t.bindFramebuffer(s.FRAMEBUFFER,ht.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+mt,s.RENDERBUFFER,ht.__webglColorRenderbuffer[mt]);const Qt=n.get(V[mt]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,ht.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+mt,s.TEXTURE_2D,Qt,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,ht.__webglMultisampledFramebuffer)}else if(q.depthBuffer&&q.resolveDepthBuffer===!1&&l){const V=q.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[V])}}}function We(q){return Math.min(i.maxSamples,q.samples)}function st(q){const V=n.get(q);return q.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&V.__useRenderToTexture!==!1}function qe(q){const V=o.render.frame;h.get(q)!==V&&(h.set(q,V),q.update())}function It(q,V){const xe=q.colorSpace,De=q.format,He=q.type;return q.isCompressedTexture===!0||q.isVideoTexture===!0||xe!==Uh&&xe!==Nl&&(Mn.getTransfer(xe)===Fn?(De!==Nr||He!==sa)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",xe)),V}function tt(q){return typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement?(c.width=q.naturalWidth||q.width,c.height=q.naturalHeight||q.height):typeof VideoFrame<"u"&&q instanceof VideoFrame?(c.width=q.displayWidth,c.height=q.displayHeight):(c.width=q.width,c.height=q.height),c}this.allocateTextureUnit=Y,this.resetTextureUnits=Z,this.setTexture2D=oe,this.setTexture2DArray=re,this.setTexture3D=ce,this.setTextureCube=H,this.rebindTextures=rt,this.setupRenderTarget=ct,this.updateRenderTargetMipmap=Ne,this.updateMultisampleRenderTarget=St,this.setupDepthRenderbuffer=Ze,this.setupFrameBufferTexture=we,this.useMultisampledRTT=st}function fI(s,e){function t(n,i=Nl){let r;const o=Mn.getTransfer(i);if(n===sa)return s.UNSIGNED_BYTE;if(n===bx)return s.UNSIGNED_SHORT_4_4_4_4;if(n===Cx)return s.UNSIGNED_SHORT_5_5_5_1;if(n===jA)return s.UNSIGNED_INT_5_9_9_9_REV;if(n===HA)return s.BYTE;if(n===zA)return s.SHORT;if(n===qf)return s.UNSIGNED_SHORT;if(n===Mx)return s.INT;if(n===Xl)return s.UNSIGNED_INT;if(n===rs)return s.FLOAT;if(n===Yh)return s.HALF_FLOAT;if(n===VA)return s.ALPHA;if(n===WA)return s.RGB;if(n===Nr)return s.RGBA;if(n===KA)return s.LUMINANCE;if(n===XA)return s.LUMINANCE_ALPHA;if(n===Mh)return s.DEPTH_COMPONENT;if(n===Nh)return s.DEPTH_STENCIL;if(n===Rx)return s.RED;if(n===I0)return s.RED_INTEGER;if(n===$A)return s.RG;if(n===Ix)return s.RG_INTEGER;if(n===Lx)return s.RGBA_INTEGER;if(n===jm||n===Vm||n===Wm||n===Km)if(o===Fn)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(n===jm)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Vm)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Wm)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Km)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(n===jm)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Vm)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Wm)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Km)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===Ev||n===Tv||n===wv||n===Mv)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(n===Ev)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Tv)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===wv)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Mv)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===bv||n===Cv||n===Rv)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(n===bv||n===Cv)return o===Fn?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===Rv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===Iv||n===Lv||n===Pv||n===Dv||n===Ov||n===Bv||n===Fv||n===kv||n===Nv||n===Uv||n===Gv||n===Hv||n===zv||n===jv)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(n===Iv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Lv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Pv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Dv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Ov)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Bv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Fv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===kv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Nv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Uv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Gv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Hv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===zv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===jv)return o===Fn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Xm||n===Vv||n===Wv)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(n===Xm)return o===Fn?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Vv)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Wv)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===YA||n===Kv||n===Xv||n===$v)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(n===Xm)return r.COMPRESSED_RED_RGTC1_EXT;if(n===Kv)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Xv)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===$v)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===kh?s.UNSIGNED_INT_24_8:s[n]!==void 0?s[n]:null}return{convert:t}}const F8={type:"move"};class D1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Gl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Gl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new J,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new J),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Gl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new J,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new J),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const _ of e.hand.values()){const S=t.getJointPose(_,n),A=this._getHandJoint(c,_);S!==null&&(A.matrix.fromArray(S.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=S.radius),A.visible=S!==null}const h=c.joints["index-finger-tip"],f=c.joints["thumb-tip"],p=h.position.distanceTo(f.position),y=.02,v=.005;c.inputState.pinching&&p>y+v?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=y-v&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),r!==null&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&r!==null&&(i=r),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(F8)))}return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=r!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Gl;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}const k8=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,N8=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class U8{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const i=new ei,r=e.properties.get(i);r.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new oa({vertexShader:k8,fragmentShader:N8,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Ci(new vp(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class G8 extends Va{constructor(e,t){super();const n=this;let i=null,r=1,o=null,a="local-floor",l=1,c=null,h=null,f=null,p=null,y=null,v=null;const _=new U8,S=t.getContextAttributes();let A=null,w=null;const M=[],C=[],I=new Ue;let O=null;const k=new si;k.viewport=new Cn;const N=new si;N.viewport=new Cn;const B=[k,N],P=new nI;let G=null,Z=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(le){let ye=M[le];return ye===void 0&&(ye=new D1,M[le]=ye),ye.getTargetRaySpace()},this.getControllerGrip=function(le){let ye=M[le];return ye===void 0&&(ye=new D1,M[le]=ye),ye.getGripSpace()},this.getHand=function(le){let ye=M[le];return ye===void 0&&(ye=new D1,M[le]=ye),ye.getHandSpace()};function Y(le){const ye=C.indexOf(le.inputSource);if(ye===-1)return;const we=M[ye];we!==void 0&&(we.update(le.inputSource,le.frame,c||o),we.dispatchEvent({type:le.type,data:le.inputSource}))}function se(){i.removeEventListener("select",Y),i.removeEventListener("selectstart",Y),i.removeEventListener("selectend",Y),i.removeEventListener("squeeze",Y),i.removeEventListener("squeezestart",Y),i.removeEventListener("squeezeend",Y),i.removeEventListener("end",se),i.removeEventListener("inputsourceschange",oe);for(let le=0;le<M.length;le++){const ye=C[le];ye!==null&&(C[le]=null,M[le].disconnect(ye))}G=null,Z=null,_.reset(),e.setRenderTarget(A),y=null,p=null,f=null,i=null,w=null,Ee.stop(),n.isPresenting=!1,e.setPixelRatio(O),e.setSize(I.width,I.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(le){r=le,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(le){a=le,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(le){c=le},this.getBaseLayer=function(){return p!==null?p:y},this.getBinding=function(){return f},this.getFrame=function(){return v},this.getSession=function(){return i},this.setSession=async function(le){if(i=le,i!==null){if(A=e.getRenderTarget(),i.addEventListener("select",Y),i.addEventListener("selectstart",Y),i.addEventListener("selectend",Y),i.addEventListener("squeeze",Y),i.addEventListener("squeezestart",Y),i.addEventListener("squeezeend",Y),i.addEventListener("end",se),i.addEventListener("inputsourceschange",oe),S.xrCompatible!==!0&&await t.makeXRCompatible(),O=e.getPixelRatio(),e.getSize(I),i.renderState.layers===void 0){const ye={antialias:S.antialias,alpha:!0,depth:S.depth,stencil:S.stencil,framebufferScaleFactor:r};y=new XRWebGLLayer(i,t,ye),i.updateRenderState({baseLayer:y}),e.setPixelRatio(1),e.setSize(y.framebufferWidth,y.framebufferHeight,!1),w=new wo(y.framebufferWidth,y.framebufferHeight,{format:Nr,type:sa,colorSpace:e.outputColorSpace,stencilBuffer:S.stencil})}else{let ye=null,we=null,Ie=null;S.depth&&(Ie=S.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ye=S.stencil?Nh:Mh,we=S.stencil?kh:Xl);const ze={colorFormat:t.RGBA8,depthFormat:Ie,scaleFactor:r};f=new XRWebGLBinding(i,t),p=f.createProjectionLayer(ze),i.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),w=new wo(p.textureWidth,p.textureHeight,{format:Nr,type:sa,depthTexture:new Ux(p.textureWidth,p.textureHeight,we,void 0,void 0,void 0,void 0,void 0,void 0,ye),stencilBuffer:S.stencil,colorSpace:e.outputColorSpace,samples:S.antialias?4:0,resolveDepthBuffer:p.ignoreDepthValues===!1})}w.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await i.requestReferenceSpace(a),Ee.setContext(i),Ee.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return _.getDepthTexture()};function oe(le){for(let ye=0;ye<le.removed.length;ye++){const we=le.removed[ye],Ie=C.indexOf(we);Ie>=0&&(C[Ie]=null,M[Ie].disconnect(we))}for(let ye=0;ye<le.added.length;ye++){const we=le.added[ye];let Ie=C.indexOf(we);if(Ie===-1){for(let Ze=0;Ze<M.length;Ze++)if(Ze>=C.length){C.push(we),Ie=Ze;break}else if(C[Ze]===null){C[Ze]=we,Ie=Ze;break}if(Ie===-1)break}const ze=M[Ie];ze&&ze.connect(we)}}const re=new J,ce=new J;function H(le,ye,we){re.setFromMatrixPosition(ye.matrixWorld),ce.setFromMatrixPosition(we.matrixWorld);const Ie=re.distanceTo(ce),ze=ye.projectionMatrix.elements,Ze=we.projectionMatrix.elements,rt=ze[14]/(ze[10]-1),ct=ze[14]/(ze[10]+1),Ne=(ze[9]+1)/ze[5],Ge=(ze[9]-1)/ze[5],Q=(ze[8]-1)/ze[0],St=(Ze[8]+1)/Ze[0],We=rt*Q,st=rt*St,qe=Ie/(-Q+St),It=qe*-Q;if(ye.matrixWorld.decompose(le.position,le.quaternion,le.scale),le.translateX(It),le.translateZ(qe),le.matrixWorld.compose(le.position,le.quaternion,le.scale),le.matrixWorldInverse.copy(le.matrixWorld).invert(),ze[10]===-1)le.projectionMatrix.copy(ye.projectionMatrix),le.projectionMatrixInverse.copy(ye.projectionMatrixInverse);else{const tt=rt+qe,q=ct+qe,V=We-It,xe=st+(Ie-It),De=Ne*ct/q*tt,He=Ge*ct/q*tt;le.projectionMatrix.makePerspective(V,xe,De,He,tt,q),le.projectionMatrixInverse.copy(le.projectionMatrix).invert()}}function $(le,ye){ye===null?le.matrixWorld.copy(le.matrix):le.matrixWorld.multiplyMatrices(ye.matrixWorld,le.matrix),le.matrixWorldInverse.copy(le.matrixWorld).invert()}this.updateCamera=function(le){if(i===null)return;let ye=le.near,we=le.far;_.texture!==null&&(_.depthNear>0&&(ye=_.depthNear),_.depthFar>0&&(we=_.depthFar)),P.near=N.near=k.near=ye,P.far=N.far=k.far=we,(G!==P.near||Z!==P.far)&&(i.updateRenderState({depthNear:P.near,depthFar:P.far}),G=P.near,Z=P.far),k.layers.mask=le.layers.mask|2,N.layers.mask=le.layers.mask|4,P.layers.mask=k.layers.mask|N.layers.mask;const Ie=le.parent,ze=P.cameras;$(P,Ie);for(let Ze=0;Ze<ze.length;Ze++)$(ze[Ze],Ie);ze.length===2?H(P,k,N):P.projectionMatrix.copy(k.projectionMatrix),X(le,P,Ie)};function X(le,ye,we){we===null?le.matrix.copy(ye.matrixWorld):(le.matrix.copy(we.matrixWorld),le.matrix.invert(),le.matrix.multiply(ye.matrixWorld)),le.matrix.decompose(le.position,le.quaternion,le.scale),le.updateMatrixWorld(!0),le.projectionMatrix.copy(ye.projectionMatrix),le.projectionMatrixInverse.copy(ye.projectionMatrixInverse),le.isPerspectiveCamera&&(le.fov=ep*2*Math.atan(1/le.projectionMatrix.elements[5]),le.zoom=1)}this.getCamera=function(){return P},this.getFoveation=function(){if(!(p===null&&y===null))return l},this.setFoveation=function(le){l=le,p!==null&&(p.fixedFoveation=le),y!==null&&y.fixedFoveation!==void 0&&(y.fixedFoveation=le)},this.hasDepthSensing=function(){return _.texture!==null},this.getDepthSensingMesh=function(){return _.getMesh(P)};let W=null;function ne(le,ye){if(h=ye.getViewerPose(c||o),v=ye,h!==null){const we=h.views;y!==null&&(e.setRenderTargetFramebuffer(w,y.framebuffer),e.setRenderTarget(w));let Ie=!1;we.length!==P.cameras.length&&(P.cameras.length=0,Ie=!0);for(let Ze=0;Ze<we.length;Ze++){const rt=we[Ze];let ct=null;if(y!==null)ct=y.getViewport(rt);else{const Ge=f.getViewSubImage(p,rt);ct=Ge.viewport,Ze===0&&(e.setRenderTargetTextures(w,Ge.colorTexture,p.ignoreDepthValues?void 0:Ge.depthStencilTexture),e.setRenderTarget(w))}let Ne=B[Ze];Ne===void 0&&(Ne=new si,Ne.layers.enable(Ze),Ne.viewport=new Cn,B[Ze]=Ne),Ne.matrix.fromArray(rt.transform.matrix),Ne.matrix.decompose(Ne.position,Ne.quaternion,Ne.scale),Ne.projectionMatrix.fromArray(rt.projectionMatrix),Ne.projectionMatrixInverse.copy(Ne.projectionMatrix).invert(),Ne.viewport.set(ct.x,ct.y,ct.width,ct.height),Ze===0&&(P.matrix.copy(Ne.matrix),P.matrix.decompose(P.position,P.quaternion,P.scale)),Ie===!0&&P.cameras.push(Ne)}const ze=i.enabledFeatures;if(ze&&ze.includes("depth-sensing")){const Ze=f.getDepthInformation(we[0]);Ze&&Ze.isValid&&Ze.texture&&_.init(e,Ze,i.renderState)}}for(let we=0;we<M.length;we++){const Ie=C[we],ze=M[we];Ie!==null&&ze!==void 0&&ze.update(Ie,ye,c||o)}W&&W(le,ye),ye.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:ye}),v=null}const Ee=new lI;Ee.setAnimationLoop(ne),this.setAnimationLoop=function(le){W=le},this.dispose=function(){}}}const rh=new Js,H8=new Kt;function z8(s,e){function t(S,A){S.matrixAutoUpdate===!0&&S.updateMatrix(),A.value.copy(S.matrix)}function n(S,A){A.color.getRGB(S.fogColor.value,yR(s)),A.isFog?(S.fogNear.value=A.near,S.fogFar.value=A.far):A.isFogExp2&&(S.fogDensity.value=A.density)}function i(S,A,w,M,C){A.isMeshBasicMaterial||A.isMeshLambertMaterial?r(S,A):A.isMeshToonMaterial?(r(S,A),f(S,A)):A.isMeshPhongMaterial?(r(S,A),h(S,A)):A.isMeshStandardMaterial?(r(S,A),p(S,A),A.isMeshPhysicalMaterial&&y(S,A,C)):A.isMeshMatcapMaterial?(r(S,A),v(S,A)):A.isMeshDepthMaterial?r(S,A):A.isMeshDistanceMaterial?(r(S,A),_(S,A)):A.isMeshNormalMaterial?r(S,A):A.isLineBasicMaterial?(o(S,A),A.isLineDashedMaterial&&a(S,A)):A.isPointsMaterial?l(S,A,w,M):A.isSpriteMaterial?c(S,A):A.isShadowMaterial?(S.color.value.copy(A.color),S.opacity.value=A.opacity):A.isShaderMaterial&&(A.uniformsNeedUpdate=!1)}function r(S,A){S.opacity.value=A.opacity,A.color&&S.diffuse.value.copy(A.color),A.emissive&&S.emissive.value.copy(A.emissive).multiplyScalar(A.emissiveIntensity),A.map&&(S.map.value=A.map,t(A.map,S.mapTransform)),A.alphaMap&&(S.alphaMap.value=A.alphaMap,t(A.alphaMap,S.alphaMapTransform)),A.bumpMap&&(S.bumpMap.value=A.bumpMap,t(A.bumpMap,S.bumpMapTransform),S.bumpScale.value=A.bumpScale,A.side===ss&&(S.bumpScale.value*=-1)),A.normalMap&&(S.normalMap.value=A.normalMap,t(A.normalMap,S.normalMapTransform),S.normalScale.value.copy(A.normalScale),A.side===ss&&S.normalScale.value.negate()),A.displacementMap&&(S.displacementMap.value=A.displacementMap,t(A.displacementMap,S.displacementMapTransform),S.displacementScale.value=A.displacementScale,S.displacementBias.value=A.displacementBias),A.emissiveMap&&(S.emissiveMap.value=A.emissiveMap,t(A.emissiveMap,S.emissiveMapTransform)),A.specularMap&&(S.specularMap.value=A.specularMap,t(A.specularMap,S.specularMapTransform)),A.alphaTest>0&&(S.alphaTest.value=A.alphaTest);const w=e.get(A),M=w.envMap,C=w.envMapRotation;M&&(S.envMap.value=M,rh.copy(C),rh.x*=-1,rh.y*=-1,rh.z*=-1,M.isCubeTexture&&M.isRenderTargetTexture===!1&&(rh.y*=-1,rh.z*=-1),S.envMapRotation.value.setFromMatrix4(H8.makeRotationFromEuler(rh)),S.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,S.reflectivity.value=A.reflectivity,S.ior.value=A.ior,S.refractionRatio.value=A.refractionRatio),A.lightMap&&(S.lightMap.value=A.lightMap,S.lightMapIntensity.value=A.lightMapIntensity,t(A.lightMap,S.lightMapTransform)),A.aoMap&&(S.aoMap.value=A.aoMap,S.aoMapIntensity.value=A.aoMapIntensity,t(A.aoMap,S.aoMapTransform))}function o(S,A){S.diffuse.value.copy(A.color),S.opacity.value=A.opacity,A.map&&(S.map.value=A.map,t(A.map,S.mapTransform))}function a(S,A){S.dashSize.value=A.dashSize,S.totalSize.value=A.dashSize+A.gapSize,S.scale.value=A.scale}function l(S,A,w,M){S.diffuse.value.copy(A.color),S.opacity.value=A.opacity,S.size.value=A.size*w,S.scale.value=M*.5,A.map&&(S.map.value=A.map,t(A.map,S.uvTransform)),A.alphaMap&&(S.alphaMap.value=A.alphaMap,t(A.alphaMap,S.alphaMapTransform)),A.alphaTest>0&&(S.alphaTest.value=A.alphaTest)}function c(S,A){S.diffuse.value.copy(A.color),S.opacity.value=A.opacity,S.rotation.value=A.rotation,A.map&&(S.map.value=A.map,t(A.map,S.mapTransform)),A.alphaMap&&(S.alphaMap.value=A.alphaMap,t(A.alphaMap,S.alphaMapTransform)),A.alphaTest>0&&(S.alphaTest.value=A.alphaTest)}function h(S,A){S.specular.value.copy(A.specular),S.shininess.value=Math.max(A.shininess,1e-4)}function f(S,A){A.gradientMap&&(S.gradientMap.value=A.gradientMap)}function p(S,A){S.metalness.value=A.metalness,A.metalnessMap&&(S.metalnessMap.value=A.metalnessMap,t(A.metalnessMap,S.metalnessMapTransform)),S.roughness.value=A.roughness,A.roughnessMap&&(S.roughnessMap.value=A.roughnessMap,t(A.roughnessMap,S.roughnessMapTransform)),A.envMap&&(S.envMapIntensity.value=A.envMapIntensity)}function y(S,A,w){S.ior.value=A.ior,A.sheen>0&&(S.sheenColor.value.copy(A.sheenColor).multiplyScalar(A.sheen),S.sheenRoughness.value=A.sheenRoughness,A.sheenColorMap&&(S.sheenColorMap.value=A.sheenColorMap,t(A.sheenColorMap,S.sheenColorMapTransform)),A.sheenRoughnessMap&&(S.sheenRoughnessMap.value=A.sheenRoughnessMap,t(A.sheenRoughnessMap,S.sheenRoughnessMapTransform))),A.clearcoat>0&&(S.clearcoat.value=A.clearcoat,S.clearcoatRoughness.value=A.clearcoatRoughness,A.clearcoatMap&&(S.clearcoatMap.value=A.clearcoatMap,t(A.clearcoatMap,S.clearcoatMapTransform)),A.clearcoatRoughnessMap&&(S.clearcoatRoughnessMap.value=A.clearcoatRoughnessMap,t(A.clearcoatRoughnessMap,S.clearcoatRoughnessMapTransform)),A.clearcoatNormalMap&&(S.clearcoatNormalMap.value=A.clearcoatNormalMap,t(A.clearcoatNormalMap,S.clearcoatNormalMapTransform),S.clearcoatNormalScale.value.copy(A.clearcoatNormalScale),A.side===ss&&S.clearcoatNormalScale.value.negate())),A.dispersion>0&&(S.dispersion.value=A.dispersion),A.iridescence>0&&(S.iridescence.value=A.iridescence,S.iridescenceIOR.value=A.iridescenceIOR,S.iridescenceThicknessMinimum.value=A.iridescenceThicknessRange[0],S.iridescenceThicknessMaximum.value=A.iridescenceThicknessRange[1],A.iridescenceMap&&(S.iridescenceMap.value=A.iridescenceMap,t(A.iridescenceMap,S.iridescenceMapTransform)),A.iridescenceThicknessMap&&(S.iridescenceThicknessMap.value=A.iridescenceThicknessMap,t(A.iridescenceThicknessMap,S.iridescenceThicknessMapTransform))),A.transmission>0&&(S.transmission.value=A.transmission,S.transmissionSamplerMap.value=w.texture,S.transmissionSamplerSize.value.set(w.width,w.height),A.transmissionMap&&(S.transmissionMap.value=A.transmissionMap,t(A.transmissionMap,S.transmissionMapTransform)),S.thickness.value=A.thickness,A.thicknessMap&&(S.thicknessMap.value=A.thicknessMap,t(A.thicknessMap,S.thicknessMapTransform)),S.attenuationDistance.value=A.attenuationDistance,S.attenuationColor.value.copy(A.attenuationColor)),A.anisotropy>0&&(S.anisotropyVector.value.set(A.anisotropy*Math.cos(A.anisotropyRotation),A.anisotropy*Math.sin(A.anisotropyRotation)),A.anisotropyMap&&(S.anisotropyMap.value=A.anisotropyMap,t(A.anisotropyMap,S.anisotropyMapTransform))),S.specularIntensity.value=A.specularIntensity,S.specularColor.value.copy(A.specularColor),A.specularColorMap&&(S.specularColorMap.value=A.specularColorMap,t(A.specularColorMap,S.specularColorMapTransform)),A.specularIntensityMap&&(S.specularIntensityMap.value=A.specularIntensityMap,t(A.specularIntensityMap,S.specularIntensityMapTransform))}function v(S,A){A.matcap&&(S.matcap.value=A.matcap)}function _(S,A){const w=e.get(A).light;S.referencePosition.value.setFromMatrixPosition(w.matrixWorld),S.nearDistance.value=w.shadow.camera.near,S.farDistance.value=w.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function j8(s,e,t,n){let i={},r={},o=[];const a=s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS);function l(w,M){const C=M.program;n.uniformBlockBinding(w,C)}function c(w,M){let C=i[w.id];C===void 0&&(v(w),C=h(w),i[w.id]=C,w.addEventListener("dispose",S));const I=M.program;n.updateUBOMapping(w,I);const O=e.render.frame;r[w.id]!==O&&(p(w),r[w.id]=O)}function h(w){const M=f();w.__bindingPointIndex=M;const C=s.createBuffer(),I=w.__size,O=w.usage;return s.bindBuffer(s.UNIFORM_BUFFER,C),s.bufferData(s.UNIFORM_BUFFER,I,O),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,M,C),C}function f(){for(let w=0;w<a;w++)if(o.indexOf(w)===-1)return o.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(w){const M=i[w.id],C=w.uniforms,I=w.__cache;s.bindBuffer(s.UNIFORM_BUFFER,M);for(let O=0,k=C.length;O<k;O++){const N=Array.isArray(C[O])?C[O]:[C[O]];for(let B=0,P=N.length;B<P;B++){const G=N[B];if(y(G,O,B,I)===!0){const Z=G.__offset,Y=Array.isArray(G.value)?G.value:[G.value];let se=0;for(let oe=0;oe<Y.length;oe++){const re=Y[oe],ce=_(re);typeof re=="number"||typeof re=="boolean"?(G.__data[0]=re,s.bufferSubData(s.UNIFORM_BUFFER,Z+se,G.__data)):re.isMatrix3?(G.__data[0]=re.elements[0],G.__data[1]=re.elements[1],G.__data[2]=re.elements[2],G.__data[3]=0,G.__data[4]=re.elements[3],G.__data[5]=re.elements[4],G.__data[6]=re.elements[5],G.__data[7]=0,G.__data[8]=re.elements[6],G.__data[9]=re.elements[7],G.__data[10]=re.elements[8],G.__data[11]=0):(re.toArray(G.__data,se),se+=ce.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,Z,G.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function y(w,M,C,I){const O=w.value,k=M+"_"+C;if(I[k]===void 0)return typeof O=="number"||typeof O=="boolean"?I[k]=O:I[k]=O.clone(),!0;{const N=I[k];if(typeof O=="number"||typeof O=="boolean"){if(N!==O)return I[k]=O,!0}else if(N.equals(O)===!1)return N.copy(O),!0}return!1}function v(w){const M=w.uniforms;let C=0;const I=16;for(let k=0,N=M.length;k<N;k++){const B=Array.isArray(M[k])?M[k]:[M[k]];for(let P=0,G=B.length;P<G;P++){const Z=B[P],Y=Array.isArray(Z.value)?Z.value:[Z.value];for(let se=0,oe=Y.length;se<oe;se++){const re=Y[se],ce=_(re),H=C%I,$=H%ce.boundary,X=H+$;C+=$,X!==0&&I-X<ce.storage&&(C+=I-X),Z.__data=new Float32Array(ce.storage/Float32Array.BYTES_PER_ELEMENT),Z.__offset=C,C+=ce.storage}}}const O=C%I;return O>0&&(C+=I-O),w.__size=C,w.__cache={},this}function _(w){const M={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(M.boundary=4,M.storage=4):w.isVector2?(M.boundary=8,M.storage=8):w.isVector3||w.isColor?(M.boundary=16,M.storage=12):w.isVector4?(M.boundary=16,M.storage=16):w.isMatrix3?(M.boundary=48,M.storage=48):w.isMatrix4?(M.boundary=64,M.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),M}function S(w){const M=w.target;M.removeEventListener("dispose",S);const C=o.indexOf(M.__bindingPointIndex);o.splice(C,1),s.deleteBuffer(i[M.id]),delete i[M.id],delete r[M.id]}function A(){for(const w in i)s.deleteBuffer(i[w]);o=[],i={},r={}}return{bind:l,update:c,dispose:A}}class pI{constructor(e={}){const{canvas:t=fR(),context:n=null,depth:i=!0,stencil:r=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:f=!1,reverseDepthBuffer:p=!1}=e;this.isWebGLRenderer=!0;let y;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");y=n.getContextAttributes().alpha}else y=o;const v=new Uint32Array(4),_=new Int32Array(4);let S=null,A=null;const w=[],M=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=As,this.toneMapping=Oa,this.toneMappingExposure=1;const C=this;let I=!1,O=0,k=0,N=null,B=-1,P=null;const G=new Cn,Z=new Cn;let Y=null;const se=new ut(0);let oe=0,re=t.width,ce=t.height,H=1,$=null,X=null;const W=new Cn(0,0,re,ce),ne=new Cn(0,0,re,ce);let Ee=!1;const le=new B0;let ye=!1,we=!1;const Ie=new Kt,ze=new Kt,Ze=new J,rt=new Cn,ct={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Ne=!1;function Ge(){return N===null?H:1}let Q=n;function St(K,me){return t.getContext(K,me)}try{const K={alpha:!0,depth:i,stencil:r,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${C0}`),t.addEventListener("webglcontextlost",ke,!1),t.addEventListener("webglcontextrestored",pt,!1),t.addEventListener("webglcontextcreationerror",lt,!1),Q===null){const me="webgl2";if(Q=St(me,K),Q===null)throw St(me)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(K){throw console.error("THREE.WebGLRenderer: "+K.message),K}let We,st,qe,It,tt,q,V,xe,De,He,Fe,ht,nt,mt,Qt,Xe,At,kt,Gt,vt,ue,Be,at,ae;function Ye(){We=new e5(Q),We.init(),Be=new fI(Q,We),st=new $U(Q,We,e,Be),qe=new O8(Q,We),st.reverseDepthBuffer&&p&&qe.buffers.depth.setReversed(!0),It=new i5(Q),tt=new S8,q=new B8(Q,We,qe,tt,st,Be,It),V=new JU(C),xe=new ZU(C),De=new uN(Q),at=new KU(Q,De),He=new t5(Q,De,It,at),Fe=new s5(Q,He,De,It),Gt=new r5(Q,st,q),Xe=new YU(tt),ht=new _8(C,V,xe,We,st,at,Xe),nt=new z8(C,tt),mt=new E8,Qt=new R8(We),kt=new WU(C,V,xe,qe,Fe,y,l),At=new P8(C,Fe,st),ae=new j8(Q,It,st,qe),vt=new XU(Q,We,It),ue=new n5(Q,We,It),It.programs=ht.programs,C.capabilities=st,C.extensions=We,C.properties=tt,C.renderLists=mt,C.shadowMap=At,C.state=qe,C.info=It}Ye();const Ce=new G8(C,Q);this.xr=Ce,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){const K=We.get("WEBGL_lose_context");K&&K.loseContext()},this.forceContextRestore=function(){const K=We.get("WEBGL_lose_context");K&&K.restoreContext()},this.getPixelRatio=function(){return H},this.setPixelRatio=function(K){K!==void 0&&(H=K,this.setSize(re,ce,!1))},this.getSize=function(K){return K.set(re,ce)},this.setSize=function(K,me,Me=!0){if(Ce.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}re=K,ce=me,t.width=Math.floor(K*H),t.height=Math.floor(me*H),Me===!0&&(t.style.width=K+"px",t.style.height=me+"px"),this.setViewport(0,0,K,me)},this.getDrawingBufferSize=function(K){return K.set(re*H,ce*H).floor()},this.setDrawingBufferSize=function(K,me,Me){re=K,ce=me,H=Me,t.width=Math.floor(K*Me),t.height=Math.floor(me*Me),this.setViewport(0,0,K,me)},this.getCurrentViewport=function(K){return K.copy(G)},this.getViewport=function(K){return K.copy(W)},this.setViewport=function(K,me,Me,Re){K.isVector4?W.set(K.x,K.y,K.z,K.w):W.set(K,me,Me,Re),qe.viewport(G.copy(W).multiplyScalar(H).round())},this.getScissor=function(K){return K.copy(ne)},this.setScissor=function(K,me,Me,Re){K.isVector4?ne.set(K.x,K.y,K.z,K.w):ne.set(K,me,Me,Re),qe.scissor(Z.copy(ne).multiplyScalar(H).round())},this.getScissorTest=function(){return Ee},this.setScissorTest=function(K){qe.setScissorTest(Ee=K)},this.setOpaqueSort=function(K){$=K},this.setTransparentSort=function(K){X=K},this.getClearColor=function(K){return K.copy(kt.getClearColor())},this.setClearColor=function(){kt.setClearColor.apply(kt,arguments)},this.getClearAlpha=function(){return kt.getClearAlpha()},this.setClearAlpha=function(){kt.setClearAlpha.apply(kt,arguments)},this.clear=function(K=!0,me=!0,Me=!0){let Re=0;if(K){let de=!1;if(N!==null){const $e=N.texture.format;de=$e===Lx||$e===Ix||$e===I0}if(de){const $e=N.texture.type,ot=$e===sa||$e===Xl||$e===qf||$e===kh||$e===bx||$e===Cx,yt=kt.getClearColor(),Et=kt.getClearAlpha(),Xt=yt.r,Nt=yt.g,wt=yt.b;ot?(v[0]=Xt,v[1]=Nt,v[2]=wt,v[3]=Et,Q.clearBufferuiv(Q.COLOR,0,v)):(_[0]=Xt,_[1]=Nt,_[2]=wt,_[3]=Et,Q.clearBufferiv(Q.COLOR,0,_))}else Re|=Q.COLOR_BUFFER_BIT}me&&(Re|=Q.DEPTH_BUFFER_BIT),Me&&(Re|=Q.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Q.clear(Re)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ke,!1),t.removeEventListener("webglcontextrestored",pt,!1),t.removeEventListener("webglcontextcreationerror",lt,!1),kt.dispose(),mt.dispose(),Qt.dispose(),tt.dispose(),V.dispose(),xe.dispose(),Fe.dispose(),at.dispose(),ae.dispose(),ht.dispose(),Ce.dispose(),Ce.removeEventListener("sessionstart",Ql),Ce.removeEventListener("sessionend",ua),Zs.stop()};function ke(K){K.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function pt(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1;const K=It.autoReset,me=At.enabled,Me=At.autoUpdate,Re=At.needsUpdate,de=At.type;Ye(),It.autoReset=K,At.enabled=me,At.autoUpdate=Me,At.needsUpdate=Re,At.type=de}function lt(K){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",K.statusMessage)}function Ft(K){const me=K.target;me.removeEventListener("dispose",Ft),yn(me)}function yn(K){Nn(K),tt.remove(K)}function Nn(K){const me=tt.get(K).programs;me!==void 0&&(me.forEach(function(Me){ht.releaseProgram(Me)}),K.isShaderMaterial&&ht.releaseShaderCache(K))}this.renderBufferDirect=function(K,me,Me,Re,de,$e){me===null&&(me=ct);const ot=de.isMesh&&de.matrixWorld.determinant()<0,yt=id(K,me,Me,Re,de);qe.setMaterial(Re,ot);let Et=Me.index,Xt=1;if(Re.wireframe===!0){if(Et=He.getWireframeAttribute(Me),Et===void 0)return;Xt=2}const Nt=Me.drawRange,wt=Me.attributes.position;let xt=Nt.start*Xt,Bt=(Nt.start+Nt.count)*Xt;$e!==null&&(xt=Math.max(xt,$e.start*Xt),Bt=Math.min(Bt,($e.start+$e.count)*Xt)),Et!==null?(xt=Math.max(xt,0),Bt=Math.min(Bt,Et.count)):wt!=null&&(xt=Math.max(xt,0),Bt=Math.min(Bt,wt.count));const dn=Bt-xt;if(dn<0||dn===1/0)return;at.setup(de,Re,yt,Me,Et);let fn,Jt=vt;if(Et!==null&&(fn=De.get(Et),Jt=ue,Jt.setIndex(fn)),de.isMesh)Re.wireframe===!0?(qe.setLineWidth(Re.wireframeLinewidth*Ge()),Jt.setMode(Q.LINES)):Jt.setMode(Q.TRIANGLES);else if(de.isLine){let Lt=Re.linewidth;Lt===void 0&&(Lt=1),qe.setLineWidth(Lt*Ge()),de.isLineSegments?Jt.setMode(Q.LINES):de.isLineLoop?Jt.setMode(Q.LINE_LOOP):Jt.setMode(Q.LINE_STRIP)}else de.isPoints?Jt.setMode(Q.POINTS):de.isSprite&&Jt.setMode(Q.TRIANGLES);if(de.isBatchedMesh)if(de._multiDrawInstances!==null)Jt.renderMultiDrawInstances(de._multiDrawStarts,de._multiDrawCounts,de._multiDrawCount,de._multiDrawInstances);else if(We.get("WEBGL_multi_draw"))Jt.renderMultiDraw(de._multiDrawStarts,de._multiDrawCounts,de._multiDrawCount);else{const Lt=de._multiDrawStarts,On=de._multiDrawCounts,$t=de._multiDrawCount,yi=Et?De.get(Et).bytesPerElement:1,os=tt.get(Re).currentProgram.getUniforms();for(let Qi=0;Qi<$t;Qi++)os.setValue(Q,"_gl_DrawID",Qi),Jt.render(Lt[Qi]/yi,On[Qi])}else if(de.isInstancedMesh)Jt.renderInstances(xt,dn,de.count);else if(Me.isInstancedBufferGeometry){const Lt=Me._maxInstanceCount!==void 0?Me._maxInstanceCount:1/0,On=Math.min(Me.instanceCount,Lt);Jt.renderInstances(xt,dn,On)}else Jt.render(xt,dn)};function ln(K,me,Me){K.transparent===!0&&K.side===So&&K.forceSinglePass===!1?(K.side=ss,K.needsUpdate=!0,Zl(K,me,Me),K.side=Ga,K.needsUpdate=!0,Zl(K,me,Me),K.side=So):Zl(K,me,Me)}this.compile=function(K,me,Me=null){Me===null&&(Me=K),A=Qt.get(Me),A.init(me),M.push(A),Me.traverseVisible(function(de){de.isLight&&de.layers.test(me.layers)&&(A.pushLight(de),de.castShadow&&A.pushShadow(de))}),K!==Me&&K.traverseVisible(function(de){de.isLight&&de.layers.test(me.layers)&&(A.pushLight(de),de.castShadow&&A.pushShadow(de))}),A.setupLights();const Re=new Set;return K.traverse(function(de){if(!(de.isMesh||de.isPoints||de.isLine||de.isSprite))return;const $e=de.material;if($e)if(Array.isArray($e))for(let ot=0;ot<$e.length;ot++){const yt=$e[ot];ln(yt,Me,de),Re.add(yt)}else ln($e,Me,de),Re.add($e)}),M.pop(),A=null,Re},this.compileAsync=function(K,me,Me=null){const Re=this.compile(K,me,Me);return new Promise(de=>{function $e(){if(Re.forEach(function(ot){tt.get(ot).currentProgram.isReady()&&Re.delete(ot)}),Re.size===0){de(K);return}setTimeout($e,10)}We.get("KHR_parallel_shader_compile")!==null?$e():setTimeout($e,10)})};let ai=null;function gi(K){ai&&ai(K)}function Ql(){Zs.stop()}function ua(){Zs.start()}const Zs=new lI;Zs.setAnimationLoop(gi),typeof self<"u"&&Zs.setContext(self),this.setAnimationLoop=function(K){ai=K,Ce.setAnimationLoop(K),K===null?Zs.stop():Zs.start()},Ce.addEventListener("sessionstart",Ql),Ce.addEventListener("sessionend",ua),this.render=function(K,me){if(me!==void 0&&me.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(I===!0)return;if(K.matrixWorldAutoUpdate===!0&&K.updateMatrixWorld(),me.parent===null&&me.matrixWorldAutoUpdate===!0&&me.updateMatrixWorld(),Ce.enabled===!0&&Ce.isPresenting===!0&&(Ce.cameraAutoUpdate===!0&&Ce.updateCamera(me),me=Ce.getCamera()),K.isScene===!0&&K.onBeforeRender(C,K,me,N),A=Qt.get(K,M.length),A.init(me),M.push(A),ze.multiplyMatrices(me.projectionMatrix,me.matrixWorldInverse),le.setFromProjectionMatrix(ze),we=this.localClippingEnabled,ye=Xe.init(this.clippingPlanes,we),S=mt.get(K,w.length),S.init(),w.push(S),Ce.enabled===!0&&Ce.isPresenting===!0){const $e=C.xr.getDepthSensingMesh();$e!==null&&Rs($e,me,-1/0,C.sortObjects)}Rs(K,me,0,C.sortObjects),S.finish(),C.sortObjects===!0&&S.sort($,X),Ne=Ce.enabled===!1||Ce.isPresenting===!1||Ce.hasDepthSensing()===!1,Ne&&kt.addToRenderList(S,K),this.info.render.frame++,ye===!0&&Xe.beginShadows();const Me=A.state.shadowsArray;At.render(Me,K,me),ye===!0&&Xe.endShadows(),this.info.autoReset===!0&&this.info.reset();const Re=S.opaque,de=S.transmissive;if(A.setupLights(),me.isArrayCamera){const $e=me.cameras;if(de.length>0)for(let ot=0,yt=$e.length;ot<yt;ot++){const Et=$e[ot];Is(Re,de,K,Et)}Ne&&kt.render(K);for(let ot=0,yt=$e.length;ot<yt;ot++){const Et=$e[ot];Wa(S,K,Et,Et.viewport)}}else de.length>0&&Is(Re,de,K,me),Ne&&kt.render(K),Wa(S,K,me);N!==null&&(q.updateMultisampleRenderTarget(N),q.updateRenderTargetMipmap(N)),K.isScene===!0&&K.onAfterRender(C,K,me),at.resetDefaultState(),B=-1,P=null,M.pop(),M.length>0?(A=M[M.length-1],ye===!0&&Xe.setGlobalState(C.clippingPlanes,A.state.camera)):A=null,w.pop(),w.length>0?S=w[w.length-1]:S=null};function Rs(K,me,Me,Re){if(K.visible===!1)return;if(K.layers.test(me.layers)){if(K.isGroup)Me=K.renderOrder;else if(K.isLOD)K.autoUpdate===!0&&K.update(me);else if(K.isLight)A.pushLight(K),K.castShadow&&A.pushShadow(K);else if(K.isSprite){if(!K.frustumCulled||le.intersectsSprite(K)){Re&&rt.setFromMatrixPosition(K.matrixWorld).applyMatrix4(ze);const ot=Fe.update(K),yt=K.material;yt.visible&&S.push(K,ot,yt,Me,rt.z,null)}}else if((K.isMesh||K.isLine||K.isPoints)&&(!K.frustumCulled||le.intersectsObject(K))){const ot=Fe.update(K),yt=K.material;if(Re&&(K.boundingSphere!==void 0?(K.boundingSphere===null&&K.computeBoundingSphere(),rt.copy(K.boundingSphere.center)):(ot.boundingSphere===null&&ot.computeBoundingSphere(),rt.copy(ot.boundingSphere.center)),rt.applyMatrix4(K.matrixWorld).applyMatrix4(ze)),Array.isArray(yt)){const Et=ot.groups;for(let Xt=0,Nt=Et.length;Xt<Nt;Xt++){const wt=Et[Xt],xt=yt[wt.materialIndex];xt&&xt.visible&&S.push(K,ot,xt,Me,rt.z,wt)}}else yt.visible&&S.push(K,ot,yt,Me,rt.z,null)}}const $e=K.children;for(let ot=0,yt=$e.length;ot<yt;ot++)Rs($e[ot],me,Me,Re)}function Wa(K,me,Me,Re){const de=K.opaque,$e=K.transmissive,ot=K.transparent;A.setupLightsView(Me),ye===!0&&Xe.setGlobalState(C.clippingPlanes,Me),Re&&qe.viewport(G.copy(Re)),de.length>0&&ha(de,me,Me),$e.length>0&&ha($e,me,Me),ot.length>0&&ha(ot,me,Me),qe.buffers.depth.setTest(!0),qe.buffers.depth.setMask(!0),qe.buffers.color.setMask(!0),qe.setPolygonOffset(!1)}function Is(K,me,Me,Re){if((Me.isScene===!0?Me.overrideMaterial:null)!==null)return;A.state.transmissionRenderTarget[Re.id]===void 0&&(A.state.transmissionRenderTarget[Re.id]=new wo(1,1,{generateMipmaps:!0,type:We.has("EXT_color_buffer_half_float")||We.has("EXT_color_buffer_float")?Yh:sa,minFilter:Ao,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Mn.workingColorSpace}));const $e=A.state.transmissionRenderTarget[Re.id],ot=Re.viewport||G;$e.setSize(ot.z,ot.w);const yt=C.getRenderTarget();C.setRenderTarget($e),C.getClearColor(se),oe=C.getClearAlpha(),oe<1&&C.setClearColor(16777215,.5),C.clear(),Ne&&kt.render(Me);const Et=C.toneMapping;C.toneMapping=Oa;const Xt=Re.viewport;if(Re.viewport!==void 0&&(Re.viewport=void 0),A.setupLightsView(Re),ye===!0&&Xe.setGlobalState(C.clippingPlanes,Re),ha(K,Me,Re),q.updateMultisampleRenderTarget($e),q.updateRenderTargetMipmap($e),We.has("WEBGL_multisampled_render_to_texture")===!1){let Nt=!1;for(let wt=0,xt=me.length;wt<xt;wt++){const Bt=me[wt],dn=Bt.object,fn=Bt.geometry,Jt=Bt.material,Lt=Bt.group;if(Jt.side===So&&dn.layers.test(Re.layers)){const On=Jt.side;Jt.side=ss,Jt.needsUpdate=!0,td(dn,Me,Re,fn,Jt,Lt),Jt.side=On,Jt.needsUpdate=!0,Nt=!0}}Nt===!0&&(q.updateMultisampleRenderTarget($e),q.updateRenderTargetMipmap($e))}C.setRenderTarget(yt),C.setClearColor(se,oe),Xt!==void 0&&(Re.viewport=Xt),C.toneMapping=Et}function ha(K,me,Me){const Re=me.isScene===!0?me.overrideMaterial:null;for(let de=0,$e=K.length;de<$e;de++){const ot=K[de],yt=ot.object,Et=ot.geometry,Xt=Re===null?ot.material:Re,Nt=ot.group;yt.layers.test(Me.layers)&&td(yt,me,Me,Et,Xt,Nt)}}function td(K,me,Me,Re,de,$e){K.onBeforeRender(C,me,Me,Re,de,$e),K.modelViewMatrix.multiplyMatrices(Me.matrixWorldInverse,K.matrixWorld),K.normalMatrix.getNormalMatrix(K.modelViewMatrix),de.onBeforeRender(C,me,Me,Re,K,$e),de.transparent===!0&&de.side===So&&de.forceSinglePass===!1?(de.side=ss,de.needsUpdate=!0,C.renderBufferDirect(Me,me,Re,de,K,$e),de.side=Ga,de.needsUpdate=!0,C.renderBufferDirect(Me,me,Re,de,K,$e),de.side=So):C.renderBufferDirect(Me,me,Re,de,K,$e),K.onAfterRender(C,me,Me,Re,de,$e)}function Zl(K,me,Me){me.isScene!==!0&&(me=ct);const Re=tt.get(K),de=A.state.lights,$e=A.state.shadowsArray,ot=de.state.version,yt=ht.getParameters(K,de.state,$e,me,Me),Et=ht.getProgramCacheKey(yt);let Xt=Re.programs;Re.environment=K.isMeshStandardMaterial?me.environment:null,Re.fog=me.fog,Re.envMap=(K.isMeshStandardMaterial?xe:V).get(K.envMap||Re.environment),Re.envMapRotation=Re.environment!==null&&K.envMap===null?me.environmentRotation:K.envMapRotation,Xt===void 0&&(K.addEventListener("dispose",Ft),Xt=new Map,Re.programs=Xt);let Nt=Xt.get(Et);if(Nt!==void 0){if(Re.currentProgram===Nt&&Re.lightsStateVersion===ot)return eo(K,yt),Nt}else yt.uniforms=ht.getUniforms(K),K.onBeforeCompile(yt,C),Nt=ht.acquireProgram(yt,Et),Xt.set(Et,Nt),Re.uniforms=yt.uniforms;const wt=Re.uniforms;return(!K.isShaderMaterial&&!K.isRawShaderMaterial||K.clipping===!0)&&(wt.clippingPlanes=Xe.uniform),eo(K,yt),Re.needsLights=sd(K),Re.lightsStateVersion=ot,Re.needsLights&&(wt.ambientLightColor.value=de.state.ambient,wt.lightProbe.value=de.state.probe,wt.directionalLights.value=de.state.directional,wt.directionalLightShadows.value=de.state.directionalShadow,wt.spotLights.value=de.state.spot,wt.spotLightShadows.value=de.state.spotShadow,wt.rectAreaLights.value=de.state.rectArea,wt.ltc_1.value=de.state.rectAreaLTC1,wt.ltc_2.value=de.state.rectAreaLTC2,wt.pointLights.value=de.state.point,wt.pointLightShadows.value=de.state.pointShadow,wt.hemisphereLights.value=de.state.hemi,wt.directionalShadowMap.value=de.state.directionalShadowMap,wt.directionalShadowMatrix.value=de.state.directionalShadowMatrix,wt.spotShadowMap.value=de.state.spotShadowMap,wt.spotLightMatrix.value=de.state.spotLightMatrix,wt.spotLightMap.value=de.state.spotLightMap,wt.pointShadowMap.value=de.state.pointShadowMap,wt.pointShadowMatrix.value=de.state.pointShadowMatrix),Re.currentProgram=Nt,Re.uniformsList=null,Nt}function nd(K){if(K.uniformsList===null){const me=K.currentProgram.getUniforms();K.uniformsList=ev.seqWithValue(me.seq,K.uniforms)}return K.uniformsList}function eo(K,me){const Me=tt.get(K);Me.outputColorSpace=me.outputColorSpace,Me.batching=me.batching,Me.batchingColor=me.batchingColor,Me.instancing=me.instancing,Me.instancingColor=me.instancingColor,Me.instancingMorph=me.instancingMorph,Me.skinning=me.skinning,Me.morphTargets=me.morphTargets,Me.morphNormals=me.morphNormals,Me.morphColors=me.morphColors,Me.morphTargetsCount=me.morphTargetsCount,Me.numClippingPlanes=me.numClippingPlanes,Me.numIntersection=me.numClipIntersection,Me.vertexAlphas=me.vertexAlphas,Me.vertexTangents=me.vertexTangents,Me.toneMapping=me.toneMapping}function id(K,me,Me,Re,de){me.isScene!==!0&&(me=ct),q.resetTextureUnits();const $e=me.fog,ot=Re.isMeshStandardMaterial?me.environment:null,yt=N===null?C.outputColorSpace:N.isXRRenderTarget===!0?N.texture.colorSpace:Uh,Et=(Re.isMeshStandardMaterial?xe:V).get(Re.envMap||ot),Xt=Re.vertexColors===!0&&!!Me.attributes.color&&Me.attributes.color.itemSize===4,Nt=!!Me.attributes.tangent&&(!!Re.normalMap||Re.anisotropy>0),wt=!!Me.morphAttributes.position,xt=!!Me.morphAttributes.normal,Bt=!!Me.morphAttributes.color;let dn=Oa;Re.toneMapped&&(N===null||N.isXRRenderTarget===!0)&&(dn=C.toneMapping);const fn=Me.morphAttributes.position||Me.morphAttributes.normal||Me.morphAttributes.color,Jt=fn!==void 0?fn.length:0,Lt=tt.get(Re),On=A.state.lights;if(ye===!0&&(we===!0||K!==P)){const li=K===P&&Re.id===B;Xe.setState(Re,K,li)}let $t=!1;Re.version===Lt.__version?(Lt.needsLights&&Lt.lightsStateVersion!==On.state.version||Lt.outputColorSpace!==yt||de.isBatchedMesh&&Lt.batching===!1||!de.isBatchedMesh&&Lt.batching===!0||de.isBatchedMesh&&Lt.batchingColor===!0&&de.colorTexture===null||de.isBatchedMesh&&Lt.batchingColor===!1&&de.colorTexture!==null||de.isInstancedMesh&&Lt.instancing===!1||!de.isInstancedMesh&&Lt.instancing===!0||de.isSkinnedMesh&&Lt.skinning===!1||!de.isSkinnedMesh&&Lt.skinning===!0||de.isInstancedMesh&&Lt.instancingColor===!0&&de.instanceColor===null||de.isInstancedMesh&&Lt.instancingColor===!1&&de.instanceColor!==null||de.isInstancedMesh&&Lt.instancingMorph===!0&&de.morphTexture===null||de.isInstancedMesh&&Lt.instancingMorph===!1&&de.morphTexture!==null||Lt.envMap!==Et||Re.fog===!0&&Lt.fog!==$e||Lt.numClippingPlanes!==void 0&&(Lt.numClippingPlanes!==Xe.numPlanes||Lt.numIntersection!==Xe.numIntersection)||Lt.vertexAlphas!==Xt||Lt.vertexTangents!==Nt||Lt.morphTargets!==wt||Lt.morphNormals!==xt||Lt.morphColors!==Bt||Lt.toneMapping!==dn||Lt.morphTargetsCount!==Jt)&&($t=!0):($t=!0,Lt.__version=Re.version);let yi=Lt.currentProgram;$t===!0&&(yi=Zl(Re,me,de));let os=!1,Qi=!1,to=!1;const Ln=yi.getUniforms(),zn=Lt.uniforms;if(qe.useProgram(yi.program)&&(os=!0,Qi=!0,to=!0),Re.id!==B&&(B=Re.id,Qi=!0),os||P!==K){qe.buffers.depth.getReversed()?(Ie.copy(K.projectionMatrix),UB(Ie),GB(Ie),Ln.setValue(Q,"projectionMatrix",Ie)):Ln.setValue(Q,"projectionMatrix",K.projectionMatrix),Ln.setValue(Q,"viewMatrix",K.matrixWorldInverse);const er=Ln.map.cameraPosition;er!==void 0&&er.setValue(Q,Ze.setFromMatrixPosition(K.matrixWorld)),st.logarithmicDepthBuffer&&Ln.setValue(Q,"logDepthBufFC",2/(Math.log(K.far+1)/Math.LN2)),(Re.isMeshPhongMaterial||Re.isMeshToonMaterial||Re.isMeshLambertMaterial||Re.isMeshBasicMaterial||Re.isMeshStandardMaterial||Re.isShaderMaterial)&&Ln.setValue(Q,"isOrthographic",K.isOrthographicCamera===!0),P!==K&&(P=K,Qi=!0,to=!0)}if(de.isSkinnedMesh){Ln.setOptional(Q,de,"bindMatrix"),Ln.setOptional(Q,de,"bindMatrixInverse");const li=de.skeleton;li&&(li.boneTexture===null&&li.computeBoneTexture(),Ln.setValue(Q,"boneTexture",li.boneTexture,q))}de.isBatchedMesh&&(Ln.setOptional(Q,de,"batchingTexture"),Ln.setValue(Q,"batchingTexture",de._matricesTexture,q),Ln.setOptional(Q,de,"batchingIdTexture"),Ln.setValue(Q,"batchingIdTexture",de._indirectTexture,q),Ln.setOptional(Q,de,"batchingColorTexture"),de._colorsTexture!==null&&Ln.setValue(Q,"batchingColorTexture",de._colorsTexture,q));const Zi=Me.morphAttributes;if((Zi.position!==void 0||Zi.normal!==void 0||Zi.color!==void 0)&&Gt.update(de,Me,yi),(Qi||Lt.receiveShadow!==de.receiveShadow)&&(Lt.receiveShadow=de.receiveShadow,Ln.setValue(Q,"receiveShadow",de.receiveShadow)),Re.isMeshGouraudMaterial&&Re.envMap!==null&&(zn.envMap.value=Et,zn.flipEnvMap.value=Et.isCubeTexture&&Et.isRenderTargetTexture===!1?-1:1),Re.isMeshStandardMaterial&&Re.envMap===null&&me.environment!==null&&(zn.envMapIntensity.value=me.environmentIntensity),Qi&&(Ln.setValue(Q,"toneMappingExposure",C.toneMappingExposure),Lt.needsLights&&rd(zn,to),$e&&Re.fog===!0&&nt.refreshFogUniforms(zn,$e),nt.refreshMaterialUniforms(zn,Re,H,ce,A.state.transmissionRenderTarget[K.id]),ev.upload(Q,nd(Lt),zn,q)),Re.isShaderMaterial&&Re.uniformsNeedUpdate===!0&&(ev.upload(Q,nd(Lt),zn,q),Re.uniformsNeedUpdate=!1),Re.isSpriteMaterial&&Ln.setValue(Q,"center",de.center),Ln.setValue(Q,"modelViewMatrix",de.modelViewMatrix),Ln.setValue(Q,"normalMatrix",de.normalMatrix),Ln.setValue(Q,"modelMatrix",de.matrixWorld),Re.isShaderMaterial||Re.isRawShaderMaterial){const li=Re.uniformsGroups;for(let er=0,no=li.length;er<no;er++){const cn=li[er];ae.update(cn,yi),ae.bind(cn,yi)}}return yi}function rd(K,me){K.ambientLightColor.needsUpdate=me,K.lightProbe.needsUpdate=me,K.directionalLights.needsUpdate=me,K.directionalLightShadows.needsUpdate=me,K.pointLights.needsUpdate=me,K.pointLightShadows.needsUpdate=me,K.spotLights.needsUpdate=me,K.spotLightShadows.needsUpdate=me,K.rectAreaLights.needsUpdate=me,K.hemisphereLights.needsUpdate=me}function sd(K){return K.isMeshLambertMaterial||K.isMeshToonMaterial||K.isMeshPhongMaterial||K.isMeshStandardMaterial||K.isShadowMaterial||K.isShaderMaterial&&K.lights===!0}this.getActiveCubeFace=function(){return O},this.getActiveMipmapLevel=function(){return k},this.getRenderTarget=function(){return N},this.setRenderTargetTextures=function(K,me,Me){tt.get(K.texture).__webglTexture=me,tt.get(K.depthTexture).__webglTexture=Me;const Re=tt.get(K);Re.__hasExternalTextures=!0,Re.__autoAllocateDepthBuffer=Me===void 0,Re.__autoAllocateDepthBuffer||We.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Re.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(K,me){const Me=tt.get(K);Me.__webglFramebuffer=me,Me.__useDefaultFramebuffer=me===void 0},this.setRenderTarget=function(K,me=0,Me=0){N=K,O=me,k=Me;let Re=!0,de=null,$e=!1,ot=!1;if(K){const Et=tt.get(K);if(Et.__useDefaultFramebuffer!==void 0)qe.bindFramebuffer(Q.FRAMEBUFFER,null),Re=!1;else if(Et.__webglFramebuffer===void 0)q.setupRenderTarget(K);else if(Et.__hasExternalTextures)q.rebindTextures(K,tt.get(K.texture).__webglTexture,tt.get(K.depthTexture).__webglTexture);else if(K.depthBuffer){const wt=K.depthTexture;if(Et.__boundDepthTexture!==wt){if(wt!==null&&tt.has(wt)&&(K.width!==wt.image.width||K.height!==wt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");q.setupDepthRenderbuffer(K)}}const Xt=K.texture;(Xt.isData3DTexture||Xt.isDataArrayTexture||Xt.isCompressedArrayTexture)&&(ot=!0);const Nt=tt.get(K).__webglFramebuffer;K.isWebGLCubeRenderTarget?(Array.isArray(Nt[me])?de=Nt[me][Me]:de=Nt[me],$e=!0):K.samples>0&&q.useMultisampledRTT(K)===!1?de=tt.get(K).__webglMultisampledFramebuffer:Array.isArray(Nt)?de=Nt[Me]:de=Nt,G.copy(K.viewport),Z.copy(K.scissor),Y=K.scissorTest}else G.copy(W).multiplyScalar(H).floor(),Z.copy(ne).multiplyScalar(H).floor(),Y=Ee;if(qe.bindFramebuffer(Q.FRAMEBUFFER,de)&&Re&&qe.drawBuffers(K,de),qe.viewport(G),qe.scissor(Z),qe.setScissorTest(Y),$e){const Et=tt.get(K.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_CUBE_MAP_POSITIVE_X+me,Et.__webglTexture,Me)}else if(ot){const Et=tt.get(K.texture),Xt=me||0;Q.framebufferTextureLayer(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Et.__webglTexture,Me||0,Xt)}B=-1},this.readRenderTargetPixels=function(K,me,Me,Re,de,$e,ot){if(!(K&&K.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let yt=tt.get(K).__webglFramebuffer;if(K.isWebGLCubeRenderTarget&&ot!==void 0&&(yt=yt[ot]),yt){qe.bindFramebuffer(Q.FRAMEBUFFER,yt);try{const Et=K.texture,Xt=Et.format,Nt=Et.type;if(!st.textureFormatReadable(Xt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!st.textureTypeReadable(Nt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}me>=0&&me<=K.width-Re&&Me>=0&&Me<=K.height-de&&Q.readPixels(me,Me,Re,de,Be.convert(Xt),Be.convert(Nt),$e)}finally{const Et=N!==null?tt.get(N).__webglFramebuffer:null;qe.bindFramebuffer(Q.FRAMEBUFFER,Et)}}},this.readRenderTargetPixelsAsync=async function(K,me,Me,Re,de,$e,ot){if(!(K&&K.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let yt=tt.get(K).__webglFramebuffer;if(K.isWebGLCubeRenderTarget&&ot!==void 0&&(yt=yt[ot]),yt){const Et=K.texture,Xt=Et.format,Nt=Et.type;if(!st.textureFormatReadable(Xt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!st.textureTypeReadable(Nt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(me>=0&&me<=K.width-Re&&Me>=0&&Me<=K.height-de){qe.bindFramebuffer(Q.FRAMEBUFFER,yt);const wt=Q.createBuffer();Q.bindBuffer(Q.PIXEL_PACK_BUFFER,wt),Q.bufferData(Q.PIXEL_PACK_BUFFER,$e.byteLength,Q.STREAM_READ),Q.readPixels(me,Me,Re,de,Be.convert(Xt),Be.convert(Nt),0);const xt=N!==null?tt.get(N).__webglFramebuffer:null;qe.bindFramebuffer(Q.FRAMEBUFFER,xt);const Bt=Q.fenceSync(Q.SYNC_GPU_COMMANDS_COMPLETE,0);return Q.flush(),await NB(Q,Bt,4),Q.bindBuffer(Q.PIXEL_PACK_BUFFER,wt),Q.getBufferSubData(Q.PIXEL_PACK_BUFFER,0,$e),Q.deleteBuffer(wt),Q.deleteSync(Bt),$e}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(K,me=null,Me=0){K.isTexture!==!0&&(Pf("WebGLRenderer: copyFramebufferToTexture function signature has changed."),me=arguments[0]||null,K=arguments[1]);const Re=Math.pow(2,-Me),de=Math.floor(K.image.width*Re),$e=Math.floor(K.image.height*Re),ot=me!==null?me.x:0,yt=me!==null?me.y:0;q.setTexture2D(K,0),Q.copyTexSubImage2D(Q.TEXTURE_2D,Me,0,0,ot,yt,de,$e),qe.unbindTexture()};const od=Q.createFramebuffer(),ad=Q.createFramebuffer();this.copyTextureToTexture=function(K,me,Me=null,Re=null,de=0,$e=null){K.isTexture!==!0&&(Pf("WebGLRenderer: copyTextureToTexture function signature has changed."),Re=arguments[0]||null,K=arguments[1],me=arguments[2],$e=arguments[3]||0,Me=null),$e===null&&(de!==0?(Pf("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),$e=de,de=0):$e=0);let ot,yt,Et,Xt,Nt,wt,xt,Bt,dn;const fn=K.isCompressedTexture?K.mipmaps[$e]:K.image;if(Me!==null)ot=Me.max.x-Me.min.x,yt=Me.max.y-Me.min.y,Et=Me.isBox3?Me.max.z-Me.min.z:1,Xt=Me.min.x,Nt=Me.min.y,wt=Me.isBox3?Me.min.z:0;else{const Zi=Math.pow(2,-de);ot=Math.floor(fn.width*Zi),yt=Math.floor(fn.height*Zi),K.isDataArrayTexture?Et=fn.depth:K.isData3DTexture?Et=Math.floor(fn.depth*Zi):Et=1,Xt=0,Nt=0,wt=0}Re!==null?(xt=Re.x,Bt=Re.y,dn=Re.z):(xt=0,Bt=0,dn=0);const Jt=Be.convert(me.format),Lt=Be.convert(me.type);let On;me.isData3DTexture?(q.setTexture3D(me,0),On=Q.TEXTURE_3D):me.isDataArrayTexture||me.isCompressedArrayTexture?(q.setTexture2DArray(me,0),On=Q.TEXTURE_2D_ARRAY):(q.setTexture2D(me,0),On=Q.TEXTURE_2D),Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,me.flipY),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,me.premultiplyAlpha),Q.pixelStorei(Q.UNPACK_ALIGNMENT,me.unpackAlignment);const $t=Q.getParameter(Q.UNPACK_ROW_LENGTH),yi=Q.getParameter(Q.UNPACK_IMAGE_HEIGHT),os=Q.getParameter(Q.UNPACK_SKIP_PIXELS),Qi=Q.getParameter(Q.UNPACK_SKIP_ROWS),to=Q.getParameter(Q.UNPACK_SKIP_IMAGES);Q.pixelStorei(Q.UNPACK_ROW_LENGTH,fn.width),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,fn.height),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,Xt),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,Nt),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,wt);const Ln=K.isDataArrayTexture||K.isData3DTexture,zn=me.isDataArrayTexture||me.isData3DTexture;if(K.isDepthTexture){const Zi=tt.get(K),li=tt.get(me),er=tt.get(Zi.__renderTarget),no=tt.get(li.__renderTarget);qe.bindFramebuffer(Q.READ_FRAMEBUFFER,er.__webglFramebuffer),qe.bindFramebuffer(Q.DRAW_FRAMEBUFFER,no.__webglFramebuffer);for(let cn=0;cn<Et;cn++)Ln&&(Q.framebufferTextureLayer(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,tt.get(K).__webglTexture,de,wt+cn),Q.framebufferTextureLayer(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,tt.get(me).__webglTexture,$e,dn+cn)),Q.blitFramebuffer(Xt,Nt,ot,yt,xt,Bt,ot,yt,Q.DEPTH_BUFFER_BIT,Q.NEAREST);qe.bindFramebuffer(Q.READ_FRAMEBUFFER,null),qe.bindFramebuffer(Q.DRAW_FRAMEBUFFER,null)}else if(de!==0||K.isRenderTargetTexture||tt.has(K)){const Zi=tt.get(K),li=tt.get(me);qe.bindFramebuffer(Q.READ_FRAMEBUFFER,od),qe.bindFramebuffer(Q.DRAW_FRAMEBUFFER,ad);for(let er=0;er<Et;er++)Ln?Q.framebufferTextureLayer(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Zi.__webglTexture,de,wt+er):Q.framebufferTexture2D(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,Zi.__webglTexture,de),zn?Q.framebufferTextureLayer(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,li.__webglTexture,$e,dn+er):Q.framebufferTexture2D(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,li.__webglTexture,$e),de!==0?Q.blitFramebuffer(Xt,Nt,ot,yt,xt,Bt,ot,yt,Q.COLOR_BUFFER_BIT,Q.NEAREST):zn?Q.copyTexSubImage3D(On,$e,xt,Bt,dn+er,Xt,Nt,ot,yt):Q.copyTexSubImage2D(On,$e,xt,Bt,Xt,Nt,ot,yt);qe.bindFramebuffer(Q.READ_FRAMEBUFFER,null),qe.bindFramebuffer(Q.DRAW_FRAMEBUFFER,null)}else zn?K.isDataTexture||K.isData3DTexture?Q.texSubImage3D(On,$e,xt,Bt,dn,ot,yt,Et,Jt,Lt,fn.data):me.isCompressedArrayTexture?Q.compressedTexSubImage3D(On,$e,xt,Bt,dn,ot,yt,Et,Jt,fn.data):Q.texSubImage3D(On,$e,xt,Bt,dn,ot,yt,Et,Jt,Lt,fn):K.isDataTexture?Q.texSubImage2D(Q.TEXTURE_2D,$e,xt,Bt,ot,yt,Jt,Lt,fn.data):K.isCompressedTexture?Q.compressedTexSubImage2D(Q.TEXTURE_2D,$e,xt,Bt,fn.width,fn.height,Jt,fn.data):Q.texSubImage2D(Q.TEXTURE_2D,$e,xt,Bt,ot,yt,Jt,Lt,fn);Q.pixelStorei(Q.UNPACK_ROW_LENGTH,$t),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,yi),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,os),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,Qi),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,to),$e===0&&me.generateMipmaps&&Q.generateMipmap(On),qe.unbindTexture()},this.copyTextureToTexture3D=function(K,me,Me=null,Re=null,de=0){return K.isTexture!==!0&&(Pf("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Me=arguments[0]||null,Re=arguments[1]||null,K=arguments[2],me=arguments[3],de=arguments[4]||0),Pf('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(K,me,Me,Re,de)},this.initRenderTarget=function(K){tt.get(K).__webglFramebuffer===void 0&&q.setupRenderTarget(K)},this.initTexture=function(K){K.isCubeTexture?q.setTextureCube(K,0):K.isData3DTexture?q.setTexture3D(K,0):K.isDataArrayTexture||K.isCompressedArrayTexture?q.setTexture2DArray(K,0):q.setTexture2D(K,0),qe.unbindTexture()},this.resetState=function(){O=0,k=0,N=null,qe.reset(),at.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ia}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorspace=Mn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Mn._getUnpackColorSpace()}}const V8=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:GA,AddEquation:zc,AddOperation:jC,AdditiveAnimationBlendMode:JA,AdditiveBlending:FS,AgXToneMapping:$C,AlphaFormat:VA,AlwaysCompare:uR,AlwaysDepth:yv,AlwaysStencilFunc:GS,AmbientLight:YR,AnimationAction:sI,AnimationClip:np,AnimationLoader:ak,AnimationMixer:Ok,AnimationObjectGroup:Pk,AnimationUtils:ik,ArcCurve:TR,ArrayCamera:nI,ArrowHelper:eN,AttachedBindMode:US,Audio:iI,AudioAnalyser:Ak,AudioContext:ME,AudioListener:xk,AudioLoader:gk,AxesHelper:tN,BackSide:ss,BasicDepthPacking:tR,BasicShadowMap:EC,BatchedMesh:AR,Bone:Fx,BooleanKeyframeTrack:Qh,Box2:Gk,Box3:wr,Box3Helper:Qk,BoxGeometry:qh,BoxHelper:qk,BufferAttribute:Rn,BufferGeometry:rn,BufferGeometryLoader:eI,ByteType:HA,Cache:Hl,Camera:L0,CameraHelper:Jk,CanvasTexture:bF,CapsuleGeometry:Hx,CatmullRomCurve3:wR,CineonToneMapping:KC,CircleGeometry:zx,ClampToEdgeWrapping:Ws,Clock:bE,Color:ut,ColorKeyframeTrack:_E,ColorManagement:Mn,CompressedArrayTexture:wF,CompressedCubeTexture:MF,CompressedTexture:Nx,CompressedTextureLoader:lk,ConeGeometry:jx,ConstantAlphaFactor:GC,ConstantColorFactor:NC,Controls:iN,CubeCamera:iE,CubeReflectionMapping:Kl,CubeRefractionMapping:qc,CubeTexture:P0,CubeTextureLoader:ck,CubeUVReflectionMapping:gp,CubicBezierCurve:hE,CubicBezierCurve3:MR,CubicInterpolant:VR,CullFaceBack:BS,CullFaceFront:AC,CullFaceFrontBack:VO,CullFaceNone:SC,Curve:la,CurvePath:CR,CustomBlending:TC,CustomToneMapping:XC,CylinderGeometry:yp,Cylindrical:Uk,Data3DTexture:eE,DataArrayTexture:Dx,DataTexture:Ba,DataTextureLoader:uk,DataUtils:tF,DecrementStencilOp:tB,DecrementWrapStencilOp:iB,DefaultLoadingManager:kf,DepthFormat:Mh,DepthStencilFormat:Nh,DepthTexture:Ux,DetachedBindMode:JC,DirectionalLight:wE,DirectionalLightHelper:Yk,DiscreteInterpolant:WR,DodecahedronGeometry:Vx,DoubleSide:So,DstAlphaFactor:DC,DstColorFactor:BC,DynamicCopyUsage:vB,DynamicDrawUsage:dB,DynamicReadUsage:mB,EdgesGeometry:RR,EllipseCurve:Gx,EqualCompare:oR,EqualDepth:xv,EqualStencilFunc:aB,EquirectangularReflectionMapping:i0,EquirectangularRefractionMapping:r0,Euler:Js,EventDispatcher:Va,ExtrudeGeometry:Kx,FileLoader:qs,Float16BufferAttribute:aF,Float32BufferAttribute:Dt,FloatType:rs,Fog:Bx,FogExp2:Ox,FramebufferTexture:TF,FrontSide:Ga,Frustum:B0,GLBufferAttribute:Nk,GLSL1:_B,GLSL3:HS,GreaterCompare:aR,GreaterDepth:Sv,GreaterEqualCompare:cR,GreaterEqualDepth:_v,GreaterEqualStencilFunc:hB,GreaterStencilFunc:cB,GridHelper:Xk,Group:Gl,HalfFloatType:Yh,HemisphereLight:$R,HemisphereLightHelper:Kk,IcosahedronGeometry:Xx,ImageBitmapLoader:tI,ImageLoader:p0,ImageUtils:pR,IncrementStencilOp:eB,IncrementWrapStencilOp:nB,InstancedBufferAttribute:Gh,InstancedBufferGeometry:ZR,InstancedInterleavedBuffer:kk,InstancedMesh:aE,Int16BufferAttribute:sF,Int32BufferAttribute:oF,Int8BufferAttribute:nF,IntType:Mx,InterleavedBuffer:D0,InterleavedBufferAttribute:Zc,Interpolant:xp,InterpolateDiscrete:Qf,InterpolateLinear:Zf,InterpolateSmooth:Zy,InvertStencilOp:rB,KeepStencilOp:hh,KeyframeTrack:ca,LOD:SR,LatheGeometry:F0,Layers:Ch,LessCompare:sR,LessDepth:vv,LessEqualCompare:QA,LessEqualDepth:Fh,LessEqualStencilFunc:lB,LessStencilFunc:oB,Light:su,LightProbe:QR,Line:$l,Line3:Hk,LineBasicMaterial:Hr,LineCurve:dE,LineCurve3:bR,LineDashedMaterial:HR,LineLoop:lE,LineSegments:aa,LinearFilter:pi,LinearInterpolant:xE,LinearMipMapLinearFilter:$O,LinearMipMapNearestFilter:XO,LinearMipmapLinearFilter:Ao,LinearMipmapNearestFilter:jf,LinearSRGBColorSpace:Uh,LinearToneMapping:VC,LinearTransfer:o0,Loader:zr,LoaderUtils:Xc,LoadingManager:SE,LoopOnce:qC,LoopPingPong:ZC,LoopRepeat:QC,LuminanceAlphaFormat:XA,LuminanceFormat:KA,MOUSE:ch,Material:Ui,MaterialLoader:e_,MathUtils:hR,Matrix2:LE,Matrix3:on,Matrix4:Kt,MaxEquation:CC,Mesh:Ci,MeshBasicMaterial:Ks,MeshDepthMaterial:gE,MeshDistanceMaterial:yE,MeshLambertMaterial:UR,MeshMatcapMaterial:GR,MeshNormalMaterial:NR,MeshPhongMaterial:FR,MeshPhysicalMaterial:Co,MeshStandardMaterial:U0,MeshToonMaterial:kR,MinEquation:bC,MirroredRepeatWrapping:Jf,MixOperation:zC,MultiplyBlending:NS,MultiplyOperation:R0,NearestFilter:ur,NearestMipMapLinearFilter:KO,NearestMipMapNearestFilter:WO,NearestMipmapLinearFilter:gh,NearestMipmapNearestFilter:wx,NeutralToneMapping:YC,NeverCompare:rR,NeverDepth:gv,NeverStencilFunc:sB,NoBlending:jl,NoColorSpace:Nl,NoToneMapping:Oa,NormalAnimationBlendMode:Px,NormalBlending:wh,NotEqualCompare:lR,NotEqualDepth:Av,NotEqualStencilFunc:uB,NumberKeyframeTrack:zh,Object3D:An,ObjectLoader:pk,ObjectSpaceNormalMap:iR,OctahedronGeometry:k0,OneFactor:IC,OneMinusConstantAlphaFactor:HC,OneMinusConstantColorFactor:UC,OneMinusDstAlphaFactor:OC,OneMinusDstColorFactor:FC,OneMinusSrcAlphaFactor:mv,OneMinusSrcColorFactor:PC,OrthographicCamera:ra,PCFShadowMap:Ex,PCFSoftShadowMap:zm,PMREMGenerator:YS,Path:u0,PerspectiveCamera:si,Plane:Fl,PlaneGeometry:vp,PlaneHelper:Zk,PointLight:TE,PointLightHelper:Vk,Points:cE,PointsMaterial:kx,PolarGridHelper:$k,PolyhedronGeometry:ru,PositionalAudio:Sk,PropertyBinding:wn,PropertyMixer:rI,QuadraticBezierCurve:fE,QuadraticBezierCurve3:pE,Quaternion:hr,QuaternionKeyframeTrack:jh,QuaternionLinearInterpolant:KR,RED_GREEN_RGTC2_Format:Xv,RED_RGTC1_Format:YA,REVISION:C0,RGBADepthPacking:nR,RGBAFormat:Nr,RGBAIntegerFormat:Lx,RGBA_ASTC_10x10_Format:Hv,RGBA_ASTC_10x5_Format:Nv,RGBA_ASTC_10x6_Format:Uv,RGBA_ASTC_10x8_Format:Gv,RGBA_ASTC_12x10_Format:zv,RGBA_ASTC_12x12_Format:jv,RGBA_ASTC_4x4_Format:Iv,RGBA_ASTC_5x4_Format:Lv,RGBA_ASTC_5x5_Format:Pv,RGBA_ASTC_6x5_Format:Dv,RGBA_ASTC_6x6_Format:Ov,RGBA_ASTC_8x5_Format:Bv,RGBA_ASTC_8x6_Format:Fv,RGBA_ASTC_8x8_Format:kv,RGBA_BPTC_Format:Xm,RGBA_ETC2_EAC_Format:Rv,RGBA_PVRTC_2BPPV1_Format:Mv,RGBA_PVRTC_4BPPV1_Format:wv,RGBA_S3TC_DXT1_Format:Vm,RGBA_S3TC_DXT3_Format:Wm,RGBA_S3TC_DXT5_Format:Km,RGBDepthPacking:JO,RGBFormat:WA,RGBIntegerFormat:YO,RGB_BPTC_SIGNED_Format:Vv,RGB_BPTC_UNSIGNED_Format:Wv,RGB_ETC1_Format:bv,RGB_ETC2_Format:Cv,RGB_PVRTC_2BPPV1_Format:Tv,RGB_PVRTC_4BPPV1_Format:Ev,RGB_S3TC_DXT1_Format:jm,RGDepthPacking:qO,RGFormat:$A,RGIntegerFormat:Ix,RawShaderMaterial:BR,Ray:Jh,Raycaster:oI,RectAreaLight:JR,RedFormat:Rx,RedIntegerFormat:I0,ReinhardToneMapping:WC,RenderTarget:mR,RepeatWrapping:Qc,ReplaceStencilOp:ZO,ReverseSubtractEquation:MC,RingGeometry:$x,SIGNED_RED_GREEN_RGTC2_Format:$v,SIGNED_RED_RGTC1_Format:Kv,SRGBColorSpace:As,SRGBTransfer:Fn,Scene:Jv,ShaderChunk:mn,ShaderLib:ia,ShaderMaterial:oa,ShadowMaterial:OR,Shape:Rh,ShapeGeometry:Yx,ShapePath:nN,ShapeUtils:Fa,ShortType:zA,Skeleton:O0,SkeletonHelper:jk,SkinnedMesh:oE,Source:xh,Sphere:dr,SphereGeometry:N0,Spherical:XS,SphericalHarmonics3:qR,SplineCurve:mE,SpotLight:EE,SpotLightHelper:zk,Sprite:_R,SpriteMaterial:sE,SrcAlphaFactor:pv,SrcAlphaSaturateFactor:kC,SrcColorFactor:LC,StaticCopyUsage:yB,StaticDrawUsage:a0,StaticReadUsage:pB,StereoCamera:yk,StreamCopyUsage:xB,StreamDrawUsage:fB,StreamReadUsage:gB,StringKeyframeTrack:Zh,SubtractEquation:wC,SubtractiveBlending:kS,TOUCH:uh,TangentSpaceNormalMap:iu,TetrahedronGeometry:Jx,Texture:ei,TextureLoader:XR,TextureUtils:lN,TorusGeometry:qx,TorusKnotGeometry:Qx,Triangle:Es,TriangleFanDrawMode:Yv,TriangleStripDrawMode:qA,TrianglesDrawMode:eR,TubeGeometry:Zx,UVMapping:Tx,Uint16BufferAttribute:tE,Uint32BufferAttribute:nE,Uint8BufferAttribute:iF,Uint8ClampedBufferAttribute:rF,Uniform:IE,UniformsGroup:Fk,UniformsLib:ft,UniformsUtils:vR,UnsignedByteType:sa,UnsignedInt248Type:kh,UnsignedInt5999Type:jA,UnsignedIntType:Xl,UnsignedShort4444Type:bx,UnsignedShort5551Type:Cx,UnsignedShortType:qf,VSMShadowMap:na,Vector2:Ue,Vector3:J,Vector4:Cn,VectorKeyframeTrack:Vh,VideoTexture:ER,WebGL3DRenderTarget:WB,WebGLArrayRenderTarget:VB,WebGLCoordinateSystem:Ia,WebGLCubeRenderTarget:rE,WebGLMultipleRenderTargets:cN,WebGLRenderTarget:wo,WebGLRenderer:pI,WebGLUtils:fI,WebGPUCoordinateSystem:l0,WireframeGeometry:DR,WrapAroundEnding:s0,ZeroCurvatureEnding:yh,ZeroFactor:RC,ZeroSlopeEnding:vh,ZeroStencilOp:QO,createCanvasElement:fR},Symbol.toStringTag,{value:"Module"}));var O1={exports:{}},Nc={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KM;function W8(){return KM||(KM=1,Nc.ConcurrentRoot=1,Nc.ContinuousEventPriority=4,Nc.DefaultEventPriority=16,Nc.DiscreteEventPriority=1,Nc.IdleEventPriority=536870912,Nc.LegacyRoot=0),Nc}var XM;function K8(){return XM||(XM=1,O1.exports=W8()),O1.exports}var Uf=K8();function X8(s){let e;const t=new Set,n=(c,h)=>{const f=typeof c=="function"?c(e):c;if(f!==e){const p=e;e=h?f:Object.assign({},e,f),t.forEach(y=>y(e,p))}},i=()=>e,r=(c,h=i,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let p=h(e);function y(){const v=h(e);if(!f(p,v)){const _=p;c(p=v,_)}}return t.add(y),()=>t.delete(y)},l={setState:n,getState:i,subscribe:(c,h,f)=>h||f?r(c,h,f):(t.add(c),()=>t.delete(c)),destroy:()=>t.clear()};return e=s(n,i,l),l}const $8=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),$M=$8?te.useEffect:te.useLayoutEffect;function Y8(s){const e=typeof s=="function"?X8(s):s,t=(n=e.getState,i=Object.is)=>{const[,r]=te.useReducer(S=>S+1,0),o=e.getState(),a=te.useRef(o),l=te.useRef(n),c=te.useRef(i),h=te.useRef(!1),f=te.useRef();f.current===void 0&&(f.current=n(o));let p,y=!1;(a.current!==o||l.current!==n||c.current!==i||h.current)&&(p=n(o),y=!i(f.current,p)),$M(()=>{y&&(f.current=p),a.current=o,l.current=n,c.current=i,h.current=!1});const v=te.useRef(o);$M(()=>{const S=()=>{try{const w=e.getState(),M=l.current(w);c.current(f.current,M)||(a.current=w,f.current=M,r())}catch{h.current=!0,r()}},A=e.subscribe(S);return e.getState()!==v.current&&S(),A},[]);const _=y?p:f.current;return te.useDebugValue(_),_};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[t,e];return{next(){const i=n.length<=0;return{value:n.shift(),done:i}}}},t}const J8=s=>typeof s=="object"&&typeof s.then=="function",Sh=[];function mI(s,e,t=(n,i)=>n===i){if(s===e)return!0;if(!s||!e)return!1;const n=s.length;if(e.length!==n)return!1;for(let i=0;i<n;i++)if(!t(s[i],e[i]))return!1;return!0}function gI(s,e=null,t=!1,n={}){e===null&&(e=[s]);for(const r of Sh)if(mI(e,r.keys,r.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return n.lifespan&&n.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,n.lifespan)),r.response;if(!t)throw r.promise}const i={keys:e,equal:n.equal,remove:()=>{const r=Sh.indexOf(i);r!==-1&&Sh.splice(r,1)},promise:(J8(s)?s:s(...e)).then(r=>{i.response=r,n.lifespan&&n.lifespan>0&&(i.timeout=setTimeout(i.remove,n.lifespan))}).catch(r=>i.error=r)};if(Sh.push(i),!t)throw i.promise}const yI=(s,e,t)=>gI(s,e,!1,t),q8=(s,e,t)=>void gI(s,e,!0,t),Q8=s=>{if(s===void 0||s.length===0)Sh.splice(0,Sh.length);else{const e=Sh.find(t=>mI(s,t.keys,t.equal));e&&e.remove()}};var B1={exports:{}},F1={exports:{}},k1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YM;function Z8(){return YM||(YM=1,function(s){function e(H,$){var X=H.length;H.push($);e:for(;0<X;){var W=X-1>>>1,ne=H[W];if(0<i(ne,$))H[W]=$,H[X]=ne,X=W;else break e}}function t(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var $=H[0],X=H.pop();if(X!==$){H[0]=X;e:for(var W=0,ne=H.length,Ee=ne>>>1;W<Ee;){var le=2*(W+1)-1,ye=H[le],we=le+1,Ie=H[we];if(0>i(ye,X))we<ne&&0>i(Ie,ye)?(H[W]=Ie,H[we]=X,W=we):(H[W]=ye,H[le]=X,W=le);else if(we<ne&&0>i(Ie,X))H[W]=Ie,H[we]=X,W=we;else break e}}return $}function i(H,$){var X=H.sortIndex-$.sortIndex;return X!==0?X:H.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;s.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();s.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,f=null,p=3,y=!1,v=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(H){for(var $=t(c);$!==null;){if($.callback===null)n(c);else if($.startTime<=H)n(c),$.sortIndex=$.expirationTime,e(l,$);else break;$=t(c)}}function C(H){if(_=!1,M(H),!v)if(t(l)!==null)v=!0,re(I);else{var $=t(c);$!==null&&ce(C,$.startTime-H)}}function I(H,$){v=!1,_&&(_=!1,A(N),N=-1),y=!0;var X=p;try{for(M($),f=t(l);f!==null&&(!(f.expirationTime>$)||H&&!G());){var W=f.callback;if(typeof W=="function"){f.callback=null,p=f.priorityLevel;var ne=W(f.expirationTime<=$);$=s.unstable_now(),typeof ne=="function"?f.callback=ne:f===t(l)&&n(l),M($)}else n(l);f=t(l)}if(f!==null)var Ee=!0;else{var le=t(c);le!==null&&ce(C,le.startTime-$),Ee=!1}return Ee}finally{f=null,p=X,y=!1}}var O=!1,k=null,N=-1,B=5,P=-1;function G(){return!(s.unstable_now()-P<B)}function Z(){if(k!==null){var H=s.unstable_now();P=H;var $=!0;try{$=k(!0,H)}finally{$?Y():(O=!1,k=null)}}else O=!1}var Y;if(typeof w=="function")Y=function(){w(Z)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,oe=se.port2;se.port1.onmessage=Z,Y=function(){oe.postMessage(null)}}else Y=function(){S(Z,0)};function re(H){k=H,O||(O=!0,Y())}function ce(H,$){N=S(function(){H(s.unstable_now())},$)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(H){H.callback=null},s.unstable_continueExecution=function(){v||y||(v=!0,re(I))},s.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<H?Math.floor(1e3/H):5},s.unstable_getCurrentPriorityLevel=function(){return p},s.unstable_getFirstCallbackNode=function(){return t(l)},s.unstable_next=function(H){switch(p){case 1:case 2:case 3:var $=3;break;default:$=p}var X=p;p=$;try{return H()}finally{p=X}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(H,$){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var X=p;p=H;try{return $()}finally{p=X}},s.unstable_scheduleCallback=function(H,$,X){var W=s.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?W+X:W):X=W,H){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=X+ne,H={id:h++,callback:$,priorityLevel:H,startTime:X,expirationTime:ne,sortIndex:-1},X>W?(H.sortIndex=X,e(c,H),t(l)===null&&H===t(c)&&(_?(A(N),N=-1):_=!0,ce(C,X-W))):(H.sortIndex=ne,e(l,H),v||y||(v=!0,re(I))),H},s.unstable_shouldYield=G,s.unstable_wrapCallback=function(H){var $=p;return function(){var X=p;p=$;try{return H.apply(this,arguments)}finally{p=X}}}}(k1)),k1}var JM;function e6(){return JM||(JM=1,F1.exports=Z8()),F1.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N1,qM;function t6(){return qM||(qM=1,N1=function(e){var t={},n=T0(),i=e6(),r=Object.assign;function o(m){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+m,E=1;E<arguments.length;E++)g+="&args[]="+encodeURIComponent(arguments[E]);return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),v=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),C=Symbol.for("react.offscreen"),I=Symbol.iterator;function O(m){return m===null||typeof m!="object"?null:(m=I&&m[I]||m["@@iterator"],typeof m=="function"?m:null)}function k(m){if(m==null)return null;if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case h:return"Fragment";case c:return"Portal";case p:return"Profiler";case f:return"StrictMode";case S:return"Suspense";case A:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case v:return(m.displayName||"Context")+".Consumer";case y:return(m._context.displayName||"Context")+".Provider";case _:var g=m.render;return m=m.displayName,m||(m=g.displayName||g.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case w:return g=m.displayName||null,g!==null?g:k(m.type)||"Memo";case M:g=m._payload,m=m._init;try{return k(m(g))}catch{}}return null}function N(m){var g=m.type;switch(m.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return m=g.render,m=m.displayName||m.name||"",g.displayName||(m!==""?"ForwardRef("+m+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return k(g);case 8:return g===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function B(m){var g=m,E=m;if(m.alternate)for(;g.return;)g=g.return;else{m=g;do g=m,g.flags&4098&&(E=g.return),m=g.return;while(m)}return g.tag===3?E:null}function P(m){if(B(m)!==m)throw Error(o(188))}function G(m){var g=m.alternate;if(!g){if(g=B(m),g===null)throw Error(o(188));return g!==m?null:m}for(var E=m,b=g;;){var L=E.return;if(L===null)break;var U=L.alternate;if(U===null){if(b=L.return,b!==null){E=b;continue}break}if(L.child===U.child){for(U=L.child;U;){if(U===E)return P(L),m;if(U===b)return P(L),g;U=U.sibling}throw Error(o(188))}if(E.return!==b.return)E=L,b=U;else{for(var ee=!1,pe=L.child;pe;){if(pe===E){ee=!0,E=L,b=U;break}if(pe===b){ee=!0,b=L,E=U;break}pe=pe.sibling}if(!ee){for(pe=U.child;pe;){if(pe===E){ee=!0,E=U,b=L;break}if(pe===b){ee=!0,b=U,E=L;break}pe=pe.sibling}if(!ee)throw Error(o(189))}}if(E.alternate!==b)throw Error(o(190))}if(E.tag!==3)throw Error(o(188));return E.stateNode.current===E?m:g}function Z(m){return m=G(m),m!==null?Y(m):null}function Y(m){if(m.tag===5||m.tag===6)return m;for(m=m.child;m!==null;){var g=Y(m);if(g!==null)return g;m=m.sibling}return null}function se(m){if(m.tag===5||m.tag===6)return m;for(m=m.child;m!==null;){if(m.tag!==4){var g=se(m);if(g!==null)return g}m=m.sibling}return null}var oe=Array.isArray,re=e.getPublicInstance,ce=e.getRootHostContext,H=e.getChildHostContext,$=e.prepareForCommit,X=e.resetAfterCommit,W=e.createInstance,ne=e.appendInitialChild,Ee=e.finalizeInitialChildren,le=e.prepareUpdate,ye=e.shouldSetTextContent,we=e.createTextInstance,Ie=e.scheduleTimeout,ze=e.cancelTimeout,Ze=e.noTimeout,rt=e.isPrimaryRenderer,ct=e.supportsMutation,Ne=e.supportsPersistence,Ge=e.supportsHydration,Q=e.getInstanceFromNode,St=e.preparePortalMount,We=e.getCurrentEventPriority,st=e.detachDeletedInstance,qe=e.supportsMicrotasks,It=e.scheduleMicrotask,tt=e.supportsTestSelectors,q=e.findFiberRoot,V=e.getBoundingRect,xe=e.getTextContent,De=e.isHiddenSubtree,He=e.matchAccessibilityRole,Fe=e.setFocusIfFocusable,ht=e.setupIntersectionObserver,nt=e.appendChild,mt=e.appendChildToContainer,Qt=e.commitTextUpdate,Xe=e.commitMount,At=e.commitUpdate,kt=e.insertBefore,Gt=e.insertInContainerBefore,vt=e.removeChild,ue=e.removeChildFromContainer,Be=e.resetTextContent,at=e.hideInstance,ae=e.hideTextInstance,Ye=e.unhideInstance,Ce=e.unhideTextInstance,ke=e.clearContainer,pt=e.cloneInstance,lt=e.createContainerChildSet,Ft=e.appendChildToContainerChildSet,yn=e.finalizeContainerChildren,Nn=e.replaceContainerChildren,ln=e.cloneHiddenInstance,ai=e.cloneHiddenTextInstance,gi=e.canHydrateInstance,Ql=e.canHydrateTextInstance,ua=e.canHydrateSuspenseInstance,Zs=e.isSuspenseInstancePending,Rs=e.isSuspenseInstanceFallback,Wa=e.registerSuspenseInstanceRetry,Is=e.getNextHydratableSibling,ha=e.getFirstHydratableChild,td=e.getFirstHydratableChildWithinContainer,Zl=e.getFirstHydratableChildWithinSuspenseInstance,nd=e.hydrateInstance,eo=e.hydrateTextInstance,id=e.hydrateSuspenseInstance,rd=e.getNextHydratableInstanceAfterSuspenseInstance,sd=e.commitHydratedContainer,od=e.commitHydratedSuspenseInstance,ad=e.clearSuspenseBoundary,K=e.clearSuspenseBoundaryFromContainer,me=e.shouldDeleteUnhydratedTailInstances,Me=e.didNotMatchHydratedContainerTextInstance,Re=e.didNotMatchHydratedTextInstance,de;function $e(m){if(de===void 0)try{throw Error()}catch(E){var g=E.stack.trim().match(/\n( *(at )?)/);de=g&&g[1]||""}return`
`+de+m}var ot=!1;function yt(m,g){if(!m||ot)return"";ot=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(Qe){var b=Qe}Reflect.construct(m,[],g)}else{try{g.call()}catch(Qe){b=Qe}m.call(g.prototype)}else{try{throw Error()}catch(Qe){b=Qe}m()}}catch(Qe){if(Qe&&b&&typeof Qe.stack=="string"){for(var L=Qe.stack.split(`
`),U=b.stack.split(`
`),ee=L.length-1,pe=U.length-1;1<=ee&&0<=pe&&L[ee]!==U[pe];)pe--;for(;1<=ee&&0<=pe;ee--,pe--)if(L[ee]!==U[pe]){if(ee!==1||pe!==1)do if(ee--,pe--,0>pe||L[ee]!==U[pe]){var Oe=`
`+L[ee].replace(" at new "," at ");return m.displayName&&Oe.includes("<anonymous>")&&(Oe=Oe.replace("<anonymous>",m.displayName)),Oe}while(1<=ee&&0<=pe);break}}}finally{ot=!1,Error.prepareStackTrace=E}return(m=m?m.displayName||m.name:"")?$e(m):""}var Et=Object.prototype.hasOwnProperty,Xt=[],Nt=-1;function wt(m){return{current:m}}function xt(m){0>Nt||(m.current=Xt[Nt],Xt[Nt]=null,Nt--)}function Bt(m,g){Nt++,Xt[Nt]=m.current,m.current=g}var dn={},fn=wt(dn),Jt=wt(!1),Lt=dn;function On(m,g){var E=m.type.contextTypes;if(!E)return dn;var b=m.stateNode;if(b&&b.__reactInternalMemoizedUnmaskedChildContext===g)return b.__reactInternalMemoizedMaskedChildContext;var L={},U;for(U in E)L[U]=g[U];return b&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=g,m.__reactInternalMemoizedMaskedChildContext=L),L}function $t(m){return m=m.childContextTypes,m!=null}function yi(){xt(Jt),xt(fn)}function os(m,g,E){if(fn.current!==dn)throw Error(o(168));Bt(fn,g),Bt(Jt,E)}function Qi(m,g,E){var b=m.stateNode;if(g=g.childContextTypes,typeof b.getChildContext!="function")return E;b=b.getChildContext();for(var L in b)if(!(L in g))throw Error(o(108,N(m)||"Unknown",L));return r({},E,b)}function to(m){return m=(m=m.stateNode)&&m.__reactInternalMemoizedMergedChildContext||dn,Lt=fn.current,Bt(fn,m),Bt(Jt,Jt.current),!0}function Ln(m,g,E){var b=m.stateNode;if(!b)throw Error(o(169));E?(m=Qi(m,g,Lt),b.__reactInternalMemoizedMergedChildContext=m,xt(Jt),xt(fn),Bt(fn,m)):xt(Jt),Bt(Jt,E)}var zn=Math.clz32?Math.clz32:er,Zi=Math.log,li=Math.LN2;function er(m){return m>>>=0,m===0?32:31-(Zi(m)/li|0)|0}var no=64,cn=4194304;function ec(m){switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return m&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return m}}function au(m,g){var E=m.pendingLanes;if(E===0)return 0;var b=0,L=m.suspendedLanes,U=m.pingedLanes,ee=E&268435455;if(ee!==0){var pe=ee&~L;pe!==0?b=ec(pe):(U&=ee,U!==0&&(b=ec(U)))}else ee=E&~L,ee!==0?b=ec(ee):U!==0&&(b=ec(U));if(b===0)return 0;if(g!==0&&g!==b&&!(g&L)&&(L=b&-b,U=g&-g,L>=U||L===16&&(U&4194240)!==0))return g;if(b&4&&(b|=E&16),g=m.entangledLanes,g!==0)for(m=m.entanglements,g&=b;0<g;)E=31-zn(g),L=1<<E,b|=m[E],g&=~L;return b}function Ap(m,g){switch(m){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function K0(m,g){for(var E=m.suspendedLanes,b=m.pingedLanes,L=m.expirationTimes,U=m.pendingLanes;0<U;){var ee=31-zn(U),pe=1<<ee,Oe=L[ee];Oe===-1?(!(pe&E)||pe&b)&&(L[ee]=Ap(pe,g)):Oe<=g&&(m.expiredLanes|=pe),U&=~pe}}function ld(m){return m=m.pendingLanes&-1073741825,m!==0?m:m&1073741824?1073741824:0}function cd(m){for(var g=[],E=0;31>E;E++)g.push(m);return g}function Ka(m,g,E){m.pendingLanes|=g,g!==536870912&&(m.suspendedLanes=0,m.pingedLanes=0),m=m.eventTimes,g=31-zn(g),m[g]=E}function ud(m,g){var E=m.pendingLanes&~g;m.pendingLanes=g,m.suspendedLanes=0,m.pingedLanes=0,m.expiredLanes&=g,m.mutableReadLanes&=g,m.entangledLanes&=g,g=m.entanglements;var b=m.eventTimes;for(m=m.expirationTimes;0<E;){var L=31-zn(E),U=1<<L;g[L]=0,b[L]=-1,m[L]=-1,E&=~U}}function io(m,g){var E=m.entangledLanes|=g;for(m=m.entanglements;E;){var b=31-zn(E),L=1<<b;L&g|m[b]&g&&(m[b]|=g),E&=~L}}var pn=0;function Ro(m){return m&=-m,1<m?4<m?m&268435455?16:536870912:4:1}var Xa=i.unstable_scheduleCallback,tc=i.unstable_cancelCallback,da=i.unstable_shouldYield,u_=i.unstable_requestPaint,Ei=i.unstable_now,$a=i.unstable_ImmediatePriority,h_=i.unstable_UserBlockingPriority,hd=i.unstable_NormalPriority,dd=i.unstable_IdlePriority,lu=null,ro=null;function cu(m){if(ro&&typeof ro.onCommitFiberRoot=="function")try{ro.onCommitFiberRoot(lu,m,void 0,(m.current.flags&128)===128)}catch{}}function uu(m,g){return m===g&&(m!==0||1/m===1/g)||m!==m&&g!==g}var mr=typeof Object.is=="function"?Object.is:uu,as=null,fd=!1,Ep=!1;function pd(m){as===null?as=[m]:as.push(m)}function md(m){fd=!0,pd(m)}function ls(){if(!Ep&&as!==null){Ep=!0;var m=0,g=pn;try{var E=as;for(pn=1;m<E.length;m++){var b=E[m];do b=b(!0);while(b!==null)}as=null,fd=!1}catch(L){throw as!==null&&(as=as.slice(m+1)),Xa($a,ls),L}finally{pn=g,Ep=!1}}return null}var X0=a.ReactCurrentBatchConfig;function Ls(m,g){if(mr(m,g))return!0;if(typeof m!="object"||m===null||typeof g!="object"||g===null)return!1;var E=Object.keys(m),b=Object.keys(g);if(E.length!==b.length)return!1;for(b=0;b<E.length;b++){var L=E[b];if(!Et.call(g,L)||!mr(m[L],g[L]))return!1}return!0}function Tp(m){switch(m.tag){case 5:return $e(m.type);case 16:return $e("Lazy");case 13:return $e("Suspense");case 19:return $e("SuspenseList");case 0:case 2:case 15:return m=yt(m.type,!1),m;case 11:return m=yt(m.type.render,!1),m;case 1:return m=yt(m.type,!0),m;default:return""}}function Mr(m,g){if(m&&m.defaultProps){g=r({},g),m=m.defaultProps;for(var E in m)g[E]===void 0&&(g[E]=m[E]);return g}return g}var hu=wt(null),Ya=null,Io=null,gd=null;function gr(){gd=Io=Ya=null}function Ja(m,g,E){rt?(Bt(hu,g._currentValue),g._currentValue=E):(Bt(hu,g._currentValue2),g._currentValue2=E)}function du(m){var g=hu.current;xt(hu),rt?m._currentValue=g:m._currentValue2=g}function qa(m,g,E){for(;m!==null;){var b=m.alternate;if((m.childLanes&g)!==g?(m.childLanes|=g,b!==null&&(b.childLanes|=g)):b!==null&&(b.childLanes&g)!==g&&(b.childLanes|=g),m===E)break;m=m.return}}function nc(m,g){Ya=m,gd=Io=null,m=m.dependencies,m!==null&&m.firstContext!==null&&(m.lanes&g&&(Pi=!0),m.firstContext=null)}function br(m){var g=rt?m._currentValue:m._currentValue2;if(gd!==m)if(m={context:m,memoizedValue:g,next:null},Io===null){if(Ya===null)throw Error(o(308));Io=m,Ya.dependencies={lanes:0,firstContext:m}}else Io=Io.next=m;return g}var cs=null,us=!1;function ic(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wp(m,g){m=m.updateQueue,g.updateQueue===m&&(g.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,effects:m.effects})}function Lo(m,g){return{eventTime:m,lane:g,tag:0,payload:null,callback:null,next:null}}function fa(m,g){var E=m.updateQueue;E!==null&&(E=E.shared,ui!==null&&m.mode&1&&!(sn&2)?(m=E.interleaved,m===null?(g.next=g,cs===null?cs=[E]:cs.push(E)):(g.next=m.next,m.next=g),E.interleaved=g):(m=E.pending,m===null?g.next=g:(g.next=m.next,m.next=g),E.pending=g))}function yd(m,g,E){if(g=g.updateQueue,g!==null&&(g=g.shared,(E&4194240)!==0)){var b=g.lanes;b&=m.pendingLanes,E|=b,g.lanes=E,io(m,E)}}function vd(m,g){var E=m.updateQueue,b=m.alternate;if(b!==null&&(b=b.updateQueue,E===b)){var L=null,U=null;if(E=E.firstBaseUpdate,E!==null){do{var ee={eventTime:E.eventTime,lane:E.lane,tag:E.tag,payload:E.payload,callback:E.callback,next:null};U===null?L=U=ee:U=U.next=ee,E=E.next}while(E!==null);U===null?L=U=g:U=U.next=g}else L=U=g;E={baseState:b.baseState,firstBaseUpdate:L,lastBaseUpdate:U,shared:b.shared,effects:b.effects},m.updateQueue=E;return}m=E.lastBaseUpdate,m===null?E.firstBaseUpdate=g:m.next=g,E.lastBaseUpdate=g}function xd(m,g,E,b){var L=m.updateQueue;us=!1;var U=L.firstBaseUpdate,ee=L.lastBaseUpdate,pe=L.shared.pending;if(pe!==null){L.shared.pending=null;var Oe=pe,Qe=Oe.next;Oe.next=null,ee===null?U=Qe:ee.next=Qe,ee=Oe;var Tt=m.alternate;Tt!==null&&(Tt=Tt.updateQueue,pe=Tt.lastBaseUpdate,pe!==ee&&(pe===null?Tt.firstBaseUpdate=Qe:pe.next=Qe,Tt.lastBaseUpdate=Oe))}if(U!==null){var Zt=L.baseState;ee=0,Tt=Qe=Oe=null,pe=U;do{var Ut=pe.lane,un=pe.eventTime;if((b&Ut)===Ut){Tt!==null&&(Tt=Tt.next={eventTime:un,lane:0,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null});e:{var gt=m,Ki=pe;switch(Ut=g,un=E,Ki.tag){case 1:if(gt=Ki.payload,typeof gt=="function"){Zt=gt.call(un,Zt,Ut);break e}Zt=gt;break e;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=Ki.payload,Ut=typeof gt=="function"?gt.call(un,Zt,Ut):gt,Ut==null)break e;Zt=r({},Zt,Ut);break e;case 2:us=!0}}pe.callback!==null&&pe.lane!==0&&(m.flags|=64,Ut=L.effects,Ut===null?L.effects=[pe]:Ut.push(pe))}else un={eventTime:un,lane:Ut,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},Tt===null?(Qe=Tt=un,Oe=Zt):Tt=Tt.next=un,ee|=Ut;if(pe=pe.next,pe===null){if(pe=L.shared.pending,pe===null)break;Ut=pe,pe=Ut.next,Ut.next=null,L.lastBaseUpdate=Ut,L.shared.pending=null}}while(!0);if(Tt===null&&(Oe=Zt),L.baseState=Oe,L.firstBaseUpdate=Qe,L.lastBaseUpdate=Tt,g=L.shared.interleaved,g!==null){L=g;do ee|=L.lane,L=L.next;while(L!==g)}else U===null&&(L.shared.lanes=0);lo|=ee,m.lanes=ee,m.memoizedState=Zt}}function $0(m,g,E){if(m=g.effects,g.effects=null,m!==null)for(g=0;g<m.length;g++){var b=m[g],L=b.callback;if(L!==null){if(b.callback=null,b=E,typeof L!="function")throw Error(o(191,L));L.call(b)}}}var Y0=new n.Component().refs;function Mp(m,g,E,b){g=m.memoizedState,E=E(b,g),E=E==null?g:r({},g,E),m.memoizedState=E,m.lanes===0&&(m.updateQueue.baseState=E)}var _d={isMounted:function(m){return(m=m._reactInternals)?B(m)===m:!1},enqueueSetState:function(m,g,E){m=m._reactInternals;var b=En(),L=Ns(m),U=Lo(b,L);U.payload=g,E!=null&&(U.callback=E),fa(m,U),g=ir(m,L,b),g!==null&&yd(g,m,L)},enqueueReplaceState:function(m,g,E){m=m._reactInternals;var b=En(),L=Ns(m),U=Lo(b,L);U.tag=1,U.payload=g,E!=null&&(U.callback=E),fa(m,U),g=ir(m,L,b),g!==null&&yd(g,m,L)},enqueueForceUpdate:function(m,g){m=m._reactInternals;var E=En(),b=Ns(m),L=Lo(E,b);L.tag=2,g!=null&&(L.callback=g),fa(m,L),g=ir(m,b,E),g!==null&&yd(g,m,b)}};function bp(m,g,E,b,L,U,ee){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(b,U,ee):g.prototype&&g.prototype.isPureReactComponent?!Ls(E,b)||!Ls(L,U):!0}function J0(m,g,E){var b=!1,L=dn,U=g.contextType;return typeof U=="object"&&U!==null?U=br(U):(L=$t(g)?Lt:fn.current,b=g.contextTypes,U=(b=b!=null)?On(m,L):dn),g=new g(E,U),m.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=_d,m.stateNode=g,g._reactInternals=m,b&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=L,m.__reactInternalMemoizedMaskedChildContext=U),g}function q0(m,g,E,b){m=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(E,b),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(E,b),g.state!==m&&_d.enqueueReplaceState(g,g.state,null)}function Cp(m,g,E,b){var L=m.stateNode;L.props=E,L.state=m.memoizedState,L.refs=Y0,ic(m);var U=g.contextType;typeof U=="object"&&U!==null?L.context=br(U):(U=$t(g)?Lt:fn.current,L.context=On(m,U)),L.state=m.memoizedState,U=g.getDerivedStateFromProps,typeof U=="function"&&(Mp(m,g,U,E),L.state=m.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(g=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),g!==L.state&&_d.enqueueReplaceState(L,L.state,null),xd(m,E,L,b),L.state=m.memoizedState),typeof L.componentDidMount=="function"&&(m.flags|=4194308)}var rc=[],pa=0,Sd=null,Ad=0,hs=[],jr=0,Qa=null,Po=1,Do="";function Za(m,g){rc[pa++]=Ad,rc[pa++]=Sd,Sd=m,Ad=g}function Q0(m,g,E){hs[jr++]=Po,hs[jr++]=Do,hs[jr++]=Qa,Qa=m;var b=Po;m=Do;var L=32-zn(b)-1;b&=~(1<<L),E+=1;var U=32-zn(g)+L;if(30<U){var ee=L-L%5;U=(b&(1<<ee)-1).toString(32),b>>=ee,L-=ee,Po=1<<32-zn(g)+L|E<<L|b,Do=U+m}else Po=1<<U|E<<L|b,Do=m}function Rp(m){m.return!==null&&(Za(m,1),Q0(m,1,0))}function Ip(m){for(;m===Sd;)Sd=rc[--pa],rc[pa]=null,Ad=rc[--pa],rc[pa]=null;for(;m===Qa;)Qa=hs[--jr],hs[jr]=null,Do=hs[--jr],hs[jr]=null,Po=hs[--jr],hs[jr]=null}var yr=null,Hi=null,Xn=!1,sc=!1,ds=null;function Lp(m,g){var E=Jr(5,null,null,0);E.elementType="DELETED",E.stateNode=g,E.return=m,g=m.deletions,g===null?(m.deletions=[E],m.flags|=16):g.push(E)}function Pp(m,g){switch(m.tag){case 5:return g=gi(g,m.type,m.pendingProps),g!==null?(m.stateNode=g,yr=m,Hi=ha(g),!0):!1;case 6:return g=Ql(g,m.pendingProps),g!==null?(m.stateNode=g,yr=m,Hi=null,!0):!1;case 13:if(g=ua(g),g!==null){var E=Qa!==null?{id:Po,overflow:Do}:null;return m.memoizedState={dehydrated:g,treeContext:E,retryLane:1073741824},E=Jr(18,null,null,0),E.stateNode=g,E.return=m,m.child=E,yr=m,Hi=null,!0}return!1;default:return!1}}function Ed(m){return(m.mode&1)!==0&&(m.flags&128)===0}function ma(m){if(Xn){var g=Hi;if(g){var E=g;if(!Pp(m,g)){if(Ed(m))throw Error(o(418));g=Is(E);var b=yr;g&&Pp(m,g)?Lp(b,E):(m.flags=m.flags&-4097|2,Xn=!1,yr=m)}}else{if(Ed(m))throw Error(o(418));m.flags=m.flags&-4097|2,Xn=!1,yr=m}}}function Z0(m){for(m=m.return;m!==null&&m.tag!==5&&m.tag!==3&&m.tag!==13;)m=m.return;yr=m}function fu(m){if(!Ge||m!==yr)return!1;if(!Xn)return Z0(m),Xn=!0,!1;if(m.tag!==3&&(m.tag!==5||me(m.type)&&!ye(m.type,m.memoizedProps))){var g=Hi;if(g){if(Ed(m)){for(m=Hi;m;)m=Is(m);throw Error(o(418))}for(;g;)Lp(m,g),g=Is(g)}}if(Z0(m),m.tag===13){if(!Ge)throw Error(o(316));if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(o(317));Hi=rd(m)}else Hi=yr?Is(m.stateNode):null;return!0}function oc(){Ge&&(Hi=yr=null,sc=Xn=!1)}function Td(m){ds===null?ds=[m]:ds.push(m)}function ac(m,g,E){if(m=E.ref,m!==null&&typeof m!="function"&&typeof m!="object"){if(E._owner){if(E=E._owner,E){if(E.tag!==1)throw Error(o(309));var b=E.stateNode}if(!b)throw Error(o(147,m));var L=b,U=""+m;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===U?g.ref:(g=function(ee){var pe=L.refs;pe===Y0&&(pe=L.refs={}),ee===null?delete pe[U]:pe[U]=ee},g._stringRef=U,g)}if(typeof m!="string")throw Error(o(284));if(!E._owner)throw Error(o(290,m))}return m}function ga(m,g){throw m=Object.prototype.toString.call(g),Error(o(31,m==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":m))}function lc(m){var g=m._init;return g(m._payload)}function eg(m){function g(Te,ge){if(m){var Pe=Te.deletions;Pe===null?(Te.deletions=[ge],Te.flags|=16):Pe.push(ge)}}function E(Te,ge){if(!m)return null;for(;ge!==null;)g(Te,ge),ge=ge.sibling;return null}function b(Te,ge){for(Te=new Map;ge!==null;)ge.key!==null?Te.set(ge.key,ge):Te.set(ge.index,ge),ge=ge.sibling;return Te}function L(Te,ge){return Te=Xo(Te,ge),Te.index=0,Te.sibling=null,Te}function U(Te,ge,Pe){return Te.index=Pe,m?(Pe=Te.alternate,Pe!==null?(Pe=Pe.index,Pe<ge?(Te.flags|=2,ge):Pe):(Te.flags|=2,ge)):(Te.flags|=1048576,ge)}function ee(Te){return m&&Te.alternate===null&&(Te.flags|=2),Te}function pe(Te,ge,Pe,dt){return ge===null||ge.tag!==6?(ge=qd(Pe,Te.mode,dt),ge.return=Te,ge):(ge=L(ge,Pe),ge.return=Te,ge)}function Oe(Te,ge,Pe,dt){var Pt=Pe.type;return Pt===h?Tt(Te,ge,Pe.props.children,dt,Pe.key):ge!==null&&(ge.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===M&&lc(Pt)===ge.type)?(dt=L(ge,Pe.props),dt.ref=ac(Te,ge,Pe),dt.return=Te,dt):(dt=Jd(Pe.type,Pe.key,Pe.props,null,Te.mode,dt),dt.ref=ac(Te,ge,Pe),dt.return=Te,dt)}function Qe(Te,ge,Pe,dt){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==Pe.containerInfo||ge.stateNode.implementation!==Pe.implementation?(ge=Qd(Pe,Te.mode,dt),ge.return=Te,ge):(ge=L(ge,Pe.children||[]),ge.return=Te,ge)}function Tt(Te,ge,Pe,dt,Pt){return ge===null||ge.tag!==7?(ge=Sl(Pe,Te.mode,dt,Pt),ge.return=Te,ge):(ge=L(ge,Pe),ge.return=Te,ge)}function Zt(Te,ge,Pe){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=qd(""+ge,Te.mode,Pe),ge.return=Te,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case l:return Pe=Jd(ge.type,ge.key,ge.props,null,Te.mode,Pe),Pe.ref=ac(Te,null,ge),Pe.return=Te,Pe;case c:return ge=Qd(ge,Te.mode,Pe),ge.return=Te,ge;case M:var dt=ge._init;return Zt(Te,dt(ge._payload),Pe)}if(oe(ge)||O(ge))return ge=Sl(ge,Te.mode,Pe,null),ge.return=Te,ge;ga(Te,ge)}return null}function Ut(Te,ge,Pe,dt){var Pt=ge!==null?ge.key:null;if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return Pt!==null?null:pe(Te,ge,""+Pe,dt);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case l:return Pe.key===Pt?Oe(Te,ge,Pe,dt):null;case c:return Pe.key===Pt?Qe(Te,ge,Pe,dt):null;case M:return Pt=Pe._init,Ut(Te,ge,Pt(Pe._payload),dt)}if(oe(Pe)||O(Pe))return Pt!==null?null:Tt(Te,ge,Pe,dt,null);ga(Te,Pe)}return null}function un(Te,ge,Pe,dt,Pt){if(typeof dt=="string"&&dt!==""||typeof dt=="number")return Te=Te.get(Pe)||null,pe(ge,Te,""+dt,Pt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case l:return Te=Te.get(dt.key===null?Pe:dt.key)||null,Oe(ge,Te,dt,Pt);case c:return Te=Te.get(dt.key===null?Pe:dt.key)||null,Qe(ge,Te,dt,Pt);case M:var tn=dt._init;return un(Te,ge,Pe,tn(dt._payload),Pt)}if(oe(dt)||O(dt))return Te=Te.get(Pe)||null,Tt(ge,Te,dt,Pt,null);ga(ge,dt)}return null}function gt(Te,ge,Pe,dt){for(var Pt=null,tn=null,en=ge,_n=ge=0,xi=null;en!==null&&_n<Pe.length;_n++){en.index>_n?(xi=en,en=null):xi=en.sibling;var xn=Ut(Te,en,Pe[_n],dt);if(xn===null){en===null&&(en=xi);break}m&&en&&xn.alternate===null&&g(Te,en),ge=U(xn,ge,_n),tn===null?Pt=xn:tn.sibling=xn,tn=xn,en=xi}if(_n===Pe.length)return E(Te,en),Xn&&Za(Te,_n),Pt;if(en===null){for(;_n<Pe.length;_n++)en=Zt(Te,Pe[_n],dt),en!==null&&(ge=U(en,ge,_n),tn===null?Pt=en:tn.sibling=en,tn=en);return Xn&&Za(Te,_n),Pt}for(en=b(Te,en);_n<Pe.length;_n++)xi=un(en,Te,_n,Pe[_n],dt),xi!==null&&(m&&xi.alternate!==null&&en.delete(xi.key===null?_n:xi.key),ge=U(xi,ge,_n),tn===null?Pt=xi:tn.sibling=xi,tn=xi);return m&&en.forEach(function($o){return g(Te,$o)}),Xn&&Za(Te,_n),Pt}function Ki(Te,ge,Pe,dt){var Pt=O(Pe);if(typeof Pt!="function")throw Error(o(150));if(Pe=Pt.call(Pe),Pe==null)throw Error(o(151));for(var tn=Pt=null,en=ge,_n=ge=0,xi=null,xn=Pe.next();en!==null&&!xn.done;_n++,xn=Pe.next()){en.index>_n?(xi=en,en=null):xi=en.sibling;var $o=Ut(Te,en,xn.value,dt);if($o===null){en===null&&(en=xi);break}m&&en&&$o.alternate===null&&g(Te,en),ge=U($o,ge,_n),tn===null?Pt=$o:tn.sibling=$o,tn=$o,en=xi}if(xn.done)return E(Te,en),Xn&&Za(Te,_n),Pt;if(en===null){for(;!xn.done;_n++,xn=Pe.next())xn=Zt(Te,xn.value,dt),xn!==null&&(ge=U(xn,ge,_n),tn===null?Pt=xn:tn.sibling=xn,tn=xn);return Xn&&Za(Te,_n),Pt}for(en=b(Te,en);!xn.done;_n++,xn=Pe.next())xn=un(en,Te,_n,xn.value,dt),xn!==null&&(m&&xn.alternate!==null&&en.delete(xn.key===null?_n:xn.key),ge=U(xn,ge,_n),tn===null?Pt=xn:tn.sibling=xn,tn=xn);return m&&en.forEach(function(cm){return g(Te,cm)}),Xn&&Za(Te,_n),Pt}function qr(Te,ge,Pe,dt){if(typeof Pe=="object"&&Pe!==null&&Pe.type===h&&Pe.key===null&&(Pe=Pe.props.children),typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case l:e:{for(var Pt=Pe.key,tn=ge;tn!==null;){if(tn.key===Pt){if(Pt=Pe.type,Pt===h){if(tn.tag===7){E(Te,tn.sibling),ge=L(tn,Pe.props.children),ge.return=Te,Te=ge;break e}}else if(tn.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===M&&lc(Pt)===tn.type){E(Te,tn.sibling),ge=L(tn,Pe.props),ge.ref=ac(Te,tn,Pe),ge.return=Te,Te=ge;break e}E(Te,tn);break}else g(Te,tn);tn=tn.sibling}Pe.type===h?(ge=Sl(Pe.props.children,Te.mode,dt,Pe.key),ge.return=Te,Te=ge):(dt=Jd(Pe.type,Pe.key,Pe.props,null,Te.mode,dt),dt.ref=ac(Te,ge,Pe),dt.return=Te,Te=dt)}return ee(Te);case c:e:{for(tn=Pe.key;ge!==null;){if(ge.key===tn)if(ge.tag===4&&ge.stateNode.containerInfo===Pe.containerInfo&&ge.stateNode.implementation===Pe.implementation){E(Te,ge.sibling),ge=L(ge,Pe.children||[]),ge.return=Te,Te=ge;break e}else{E(Te,ge);break}else g(Te,ge);ge=ge.sibling}ge=Qd(Pe,Te.mode,dt),ge.return=Te,Te=ge}return ee(Te);case M:return tn=Pe._init,qr(Te,ge,tn(Pe._payload),dt)}if(oe(Pe))return gt(Te,ge,Pe,dt);if(O(Pe))return Ki(Te,ge,Pe,dt);ga(Te,Pe)}return typeof Pe=="string"&&Pe!==""||typeof Pe=="number"?(Pe=""+Pe,ge!==null&&ge.tag===6?(E(Te,ge.sibling),ge=L(ge,Pe),ge.return=Te,Te=ge):(E(Te,ge),ge=qd(Pe,Te.mode,dt),ge.return=Te,Te=ge),ee(Te)):E(Te,ge)}return qr}var Oo=eg(!0),tg=eg(!1),cc={},Cr=wt(cc),el=wt(cc),tl=wt(cc);function Ps(m){if(m===cc)throw Error(o(174));return m}function wd(m,g){Bt(tl,g),Bt(el,m),Bt(Cr,cc),m=ce(g),xt(Cr),Bt(Cr,m)}function uc(){xt(Cr),xt(el),xt(tl)}function ng(m){var g=Ps(tl.current),E=Ps(Cr.current);g=H(E,m.type,g),E!==g&&(Bt(el,m),Bt(Cr,g))}function Dp(m){el.current===m&&(xt(Cr),xt(el))}var Qn=wt(0);function Md(m){for(var g=m;g!==null;){if(g.tag===13){var E=g.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||Zs(E)||Rs(E)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===m)break;for(;g.sibling===null;){if(g.return===null||g.return===m)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var Vr=[];function nl(){for(var m=0;m<Vr.length;m++){var g=Vr[m];rt?g._workInProgressVersionPrimary=null:g._workInProgressVersionSecondary=null}Vr.length=0}var pu=a.ReactCurrentDispatcher,Wr=a.ReactCurrentBatchConfig,il=0,Zn=null,Ri=null,Ii=null,bd=!1,so=!1,rl=0,mu=0;function Li(){throw Error(o(321))}function Cd(m,g){if(g===null)return!1;for(var E=0;E<g.length&&E<m.length;E++)if(!mr(m[E],g[E]))return!1;return!0}function hc(m,g,E,b,L,U){if(il=U,Zn=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,pu.current=m===null||m.memoizedState===null?Up:Gp,m=E(b,L),so){U=0;do{if(so=!1,rl=0,25<=U)throw Error(o(301));U+=1,Ii=Ri=null,g.updateQueue=null,pu.current=Hp,m=E(b,L)}while(so)}if(pu.current=mc,g=Ri!==null&&Ri.next!==null,il=0,Ii=Ri=Zn=null,bd=!1,g)throw Error(o(300));return m}function ya(){var m=rl!==0;return rl=0,m}function Ds(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ii===null?Zn.memoizedState=Ii=m:Ii=Ii.next=m,Ii}function Os(){if(Ri===null){var m=Zn.alternate;m=m!==null?m.memoizedState:null}else m=Ri.next;var g=Ii===null?Zn.memoizedState:Ii.next;if(g!==null)Ii=g,Ri=m;else{if(m===null)throw Error(o(310));Ri=m,m={memoizedState:Ri.memoizedState,baseState:Ri.baseState,baseQueue:Ri.baseQueue,queue:Ri.queue,next:null},Ii===null?Zn.memoizedState=Ii=m:Ii=Ii.next=m}return Ii}function oo(m,g){return typeof g=="function"?g(m):g}function gu(m){var g=Os(),E=g.queue;if(E===null)throw Error(o(311));E.lastRenderedReducer=m;var b=Ri,L=b.baseQueue,U=E.pending;if(U!==null){if(L!==null){var ee=L.next;L.next=U.next,U.next=ee}b.baseQueue=L=U,E.pending=null}if(L!==null){U=L.next,b=b.baseState;var pe=ee=null,Oe=null,Qe=U;do{var Tt=Qe.lane;if((il&Tt)===Tt)Oe!==null&&(Oe=Oe.next={lane:0,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null}),b=Qe.hasEagerState?Qe.eagerState:m(b,Qe.action);else{var Zt={lane:Tt,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null};Oe===null?(pe=Oe=Zt,ee=b):Oe=Oe.next=Zt,Zn.lanes|=Tt,lo|=Tt}Qe=Qe.next}while(Qe!==null&&Qe!==U);Oe===null?ee=b:Oe.next=pe,mr(b,g.memoizedState)||(Pi=!0),g.memoizedState=b,g.baseState=ee,g.baseQueue=Oe,E.lastRenderedState=b}if(m=E.interleaved,m!==null){L=m;do U=L.lane,Zn.lanes|=U,lo|=U,L=L.next;while(L!==m)}else L===null&&(E.lanes=0);return[g.memoizedState,E.dispatch]}function yu(m){var g=Os(),E=g.queue;if(E===null)throw Error(o(311));E.lastRenderedReducer=m;var b=E.dispatch,L=E.pending,U=g.memoizedState;if(L!==null){E.pending=null;var ee=L=L.next;do U=m(U,ee.action),ee=ee.next;while(ee!==L);mr(U,g.memoizedState)||(Pi=!0),g.memoizedState=U,g.baseQueue===null&&(g.baseState=U),E.lastRenderedState=U}return[U,b]}function Op(){}function Bp(m,g){var E=Zn,b=Os(),L=g(),U=!mr(b.memoizedState,L);if(U&&(b.memoizedState=L,Pi=!0),b=b.queue,dc(Bo.bind(null,E,b,m),[m]),b.getSnapshot!==g||U||Ii!==null&&Ii.memoizedState.tag&1){if(E.flags|=2048,xu(9,kp.bind(null,E,b,L,g),void 0,null),ui===null)throw Error(o(349));il&30||Fp(E,g,L)}return L}function Fp(m,g,E){m.flags|=16384,m={getSnapshot:g,value:E},g=Zn.updateQueue,g===null?(g={lastEffect:null,stores:null},Zn.updateQueue=g,g.stores=[m]):(E=g.stores,E===null?g.stores=[m]:E.push(m))}function kp(m,g,E,b){g.value=E,g.getSnapshot=b,Rd(g)&&ir(m,1,-1)}function Bo(m,g,E){return E(function(){Rd(g)&&ir(m,1,-1)})}function Rd(m){var g=m.getSnapshot;m=m.value;try{var E=g();return!mr(m,E)}catch{return!0}}function vu(m){var g=Ds();return typeof m=="function"&&(m=m()),g.memoizedState=g.baseState=m,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oo,lastRenderedState:m},g.queue=m,m=m.dispatch=d_.bind(null,Zn,m),[g.memoizedState,m]}function xu(m,g,E,b){return m={tag:m,create:g,destroy:E,deps:b,next:null},g=Zn.updateQueue,g===null?(g={lastEffect:null,stores:null},Zn.updateQueue=g,g.lastEffect=m.next=m):(E=g.lastEffect,E===null?g.lastEffect=m.next=m:(b=E.next,E.next=m,m.next=b,g.lastEffect=m)),m}function ig(){return Os().memoizedState}function va(m,g,E,b){var L=Ds();Zn.flags|=m,L.memoizedState=xu(1|g,E,void 0,b===void 0?null:b)}function Id(m,g,E,b){var L=Os();b=b===void 0?null:b;var U=void 0;if(Ri!==null){var ee=Ri.memoizedState;if(U=ee.destroy,b!==null&&Cd(b,ee.deps)){L.memoizedState=xu(g,E,U,b);return}}Zn.flags|=m,L.memoizedState=xu(1|g,E,U,b)}function Ld(m,g){return va(8390656,8,m,g)}function dc(m,g){return Id(2048,8,m,g)}function Un(m,g){return Id(4,2,m,g)}function Pd(m,g){return Id(4,4,m,g)}function _u(m,g){if(typeof g=="function")return m=m(),g(m),function(){g(null)};if(g!=null)return m=m(),g.current=m,function(){g.current=null}}function fc(m,g,E){return E=E!=null?E.concat([m]):null,Id(4,4,_u.bind(null,g,m),E)}function Dd(){}function Od(m,g){var E=Os();g=g===void 0?null:g;var b=E.memoizedState;return b!==null&&g!==null&&Cd(g,b[1])?b[0]:(E.memoizedState=[m,g],m)}function pc(m,g){var E=Os();g=g===void 0?null:g;var b=E.memoizedState;return b!==null&&g!==null&&Cd(g,b[1])?b[0]:(m=m(),E.memoizedState=[m,g],m)}function Bd(m,g){var E=pn;pn=E!==0&&4>E?E:4,m(!0);var b=Wr.transition;Wr.transition={};try{m(!1),g()}finally{pn=E,Wr.transition=b}}function sl(){return Os().memoizedState}function rg(m,g,E){var b=Ns(m);E={lane:b,action:E,hasEagerState:!1,eagerState:null,next:null},sg(m)?Np(g,E):(Su(m,g,E),E=En(),m=ir(m,b,E),m!==null&&Au(m,g,b))}function d_(m,g,E){var b=Ns(m),L={lane:b,action:E,hasEagerState:!1,eagerState:null,next:null};if(sg(m))Np(g,L);else{Su(m,g,L);var U=m.alternate;if(m.lanes===0&&(U===null||U.lanes===0)&&(U=g.lastRenderedReducer,U!==null))try{var ee=g.lastRenderedState,pe=U(ee,E);if(L.hasEagerState=!0,L.eagerState=pe,mr(pe,ee))return}catch{}finally{}E=En(),m=ir(m,b,E),m!==null&&Au(m,g,b)}}function sg(m){var g=m.alternate;return m===Zn||g!==null&&g===Zn}function Np(m,g){so=bd=!0;var E=m.pending;E===null?g.next=g:(g.next=E.next,E.next=g),m.pending=g}function Su(m,g,E){ui!==null&&m.mode&1&&!(sn&2)?(m=g.interleaved,m===null?(E.next=E,cs===null?cs=[g]:cs.push(g)):(E.next=m.next,m.next=E),g.interleaved=E):(m=g.pending,m===null?E.next=E:(E.next=m.next,m.next=E),g.pending=E)}function Au(m,g,E){if(E&4194240){var b=g.lanes;b&=m.pendingLanes,E|=b,g.lanes=E,io(m,E)}}var mc={readContext:br,useCallback:Li,useContext:Li,useEffect:Li,useImperativeHandle:Li,useInsertionEffect:Li,useLayoutEffect:Li,useMemo:Li,useReducer:Li,useRef:Li,useState:Li,useDebugValue:Li,useDeferredValue:Li,useTransition:Li,useMutableSource:Li,useSyncExternalStore:Li,useId:Li,unstable_isNewReconciler:!1},Up={readContext:br,useCallback:function(m,g){return Ds().memoizedState=[m,g===void 0?null:g],m},useContext:br,useEffect:Ld,useImperativeHandle:function(m,g,E){return E=E!=null?E.concat([m]):null,va(4194308,4,_u.bind(null,g,m),E)},useLayoutEffect:function(m,g){return va(4194308,4,m,g)},useInsertionEffect:function(m,g){return va(4,2,m,g)},useMemo:function(m,g){var E=Ds();return g=g===void 0?null:g,m=m(),E.memoizedState=[m,g],m},useReducer:function(m,g,E){var b=Ds();return g=E!==void 0?E(g):g,b.memoizedState=b.baseState=g,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:g},b.queue=m,m=m.dispatch=rg.bind(null,Zn,m),[b.memoizedState,m]},useRef:function(m){var g=Ds();return m={current:m},g.memoizedState=m},useState:vu,useDebugValue:Dd,useDeferredValue:function(m){var g=vu(m),E=g[0],b=g[1];return Ld(function(){var L=Wr.transition;Wr.transition={};try{b(m)}finally{Wr.transition=L}},[m]),E},useTransition:function(){var m=vu(!1),g=m[0];return m=Bd.bind(null,m[1]),Ds().memoizedState=m,[g,m]},useMutableSource:function(){},useSyncExternalStore:function(m,g,E){var b=Zn,L=Ds();if(Xn){if(E===void 0)throw Error(o(407));E=E()}else{if(E=g(),ui===null)throw Error(o(349));il&30||Fp(b,g,E)}L.memoizedState=E;var U={value:E,getSnapshot:g};return L.queue=U,Ld(Bo.bind(null,b,U,m),[m]),b.flags|=2048,xu(9,kp.bind(null,b,U,E,g),void 0,null),E},useId:function(){var m=Ds(),g=ui.identifierPrefix;if(Xn){var E=Do,b=Po;E=(b&~(1<<32-zn(b)-1)).toString(32)+E,g=":"+g+"R"+E,E=rl++,0<E&&(g+="H"+E.toString(32)),g+=":"}else E=mu++,g=":"+g+"r"+E.toString(32)+":";return m.memoizedState=g},unstable_isNewReconciler:!1},Gp={readContext:br,useCallback:Od,useContext:br,useEffect:dc,useImperativeHandle:fc,useInsertionEffect:Un,useLayoutEffect:Pd,useMemo:pc,useReducer:gu,useRef:ig,useState:function(){return gu(oo)},useDebugValue:Dd,useDeferredValue:function(m){var g=gu(oo),E=g[0],b=g[1];return dc(function(){var L=Wr.transition;Wr.transition={};try{b(m)}finally{Wr.transition=L}},[m]),E},useTransition:function(){var m=gu(oo)[0],g=Os().memoizedState;return[m,g]},useMutableSource:Op,useSyncExternalStore:Bp,useId:sl,unstable_isNewReconciler:!1},Hp={readContext:br,useCallback:Od,useContext:br,useEffect:dc,useImperativeHandle:fc,useInsertionEffect:Un,useLayoutEffect:Pd,useMemo:pc,useReducer:yu,useRef:ig,useState:function(){return yu(oo)},useDebugValue:Dd,useDeferredValue:function(m){var g=yu(oo),E=g[0],b=g[1];return dc(function(){var L=Wr.transition;Wr.transition={};try{b(m)}finally{Wr.transition=L}},[m]),E},useTransition:function(){var m=yu(oo)[0],g=Os().memoizedState;return[m,g]},useMutableSource:Op,useSyncExternalStore:Bp,useId:sl,unstable_isNewReconciler:!1};function zp(m,g){try{var E="",b=g;do E+=Tp(b),b=b.return;while(b);var L=E}catch(U){L=`
Error generating stack: `+U.message+`
`+U.stack}return{value:m,source:g,stack:L}}function Fd(m,g){try{console.error(g.value)}catch(E){setTimeout(function(){throw E})}}var f_=typeof WeakMap=="function"?WeakMap:Map;function og(m,g,E){E=Lo(-1,E),E.tag=3,E.payload={element:null};var b=g.value;return E.callback=function(){Sc||(Sc=!0,Vn=b),Fd(m,g)},E}function kd(m,g,E){E=Lo(-1,E),E.tag=3;var b=m.type.getDerivedStateFromError;if(typeof b=="function"){var L=g.value;E.payload=function(){return b(L)},E.callback=function(){Fd(m,g)}}var U=m.stateNode;return U!==null&&typeof U.componentDidCatch=="function"&&(E.callback=function(){Fd(m,g),typeof b!="function"&&(ks===null?ks=new Set([this]):ks.add(this));var ee=g.stack;this.componentDidCatch(g.value,{componentStack:ee!==null?ee:""})}),E}function Fo(m,g,E){var b=m.pingCache;if(b===null){b=m.pingCache=new f_;var L=new Set;b.set(g,L)}else L=b.get(g),L===void 0&&(L=new Set,b.set(g,L));L.has(E)||(L.add(E),m=om.bind(null,m,g,E),g.then(m,m))}function jp(m){do{var g;if((g=m.tag===13)&&(g=m.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return m;m=m.return}while(m!==null);return null}function ol(m,g,E,b,L){return m.mode&1?(m.flags|=65536,m.lanes=L,m):(m===g?m.flags|=65536:(m.flags|=128,E.flags|=131072,E.flags&=-52805,E.tag===1&&(E.alternate===null?E.tag=17:(g=Lo(-1,1),g.tag=2,fa(E,g))),E.lanes|=1),m)}function Ti(m){m.flags|=4}function gc(m,g){if(m!==null&&m.child===g.child)return!0;if(g.flags&16)return!1;for(m=g.child;m!==null;){if(m.flags&12854||m.subtreeFlags&12854)return!1;m=m.sibling}return!0}var Kr,al,Nd,Ud;if(ct)Kr=function(m,g){for(var E=g.child;E!==null;){if(E.tag===5||E.tag===6)ne(m,E.stateNode);else if(E.tag!==4&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===g)break;for(;E.sibling===null;){if(E.return===null||E.return===g)return;E=E.return}E.sibling.return=E.return,E=E.sibling}},al=function(){},Nd=function(m,g,E,b,L){if(m=m.memoizedProps,m!==b){var U=g.stateNode,ee=Ps(Cr.current);E=le(U,E,m,b,L,ee),(g.updateQueue=E)&&Ti(g)}},Ud=function(m,g,E,b){E!==b&&Ti(g)};else if(Ne){Kr=function(m,g,E,b){for(var L=g.child;L!==null;){if(L.tag===5){var U=L.stateNode;E&&b&&(U=ln(U,L.type,L.memoizedProps,L)),ne(m,U)}else if(L.tag===6)U=L.stateNode,E&&b&&(U=ai(U,L.memoizedProps,L)),ne(m,U);else if(L.tag!==4){if(L.tag===22&&L.memoizedState!==null)U=L.child,U!==null&&(U.return=L),Kr(m,L,!0,!0);else if(L.child!==null){L.child.return=L,L=L.child;continue}}if(L===g)break;for(;L.sibling===null;){if(L.return===null||L.return===g)return;L=L.return}L.sibling.return=L.return,L=L.sibling}};var xa=function(m,g,E,b){for(var L=g.child;L!==null;){if(L.tag===5){var U=L.stateNode;E&&b&&(U=ln(U,L.type,L.memoizedProps,L)),Ft(m,U)}else if(L.tag===6)U=L.stateNode,E&&b&&(U=ai(U,L.memoizedProps,L)),Ft(m,U);else if(L.tag!==4){if(L.tag===22&&L.memoizedState!==null)U=L.child,U!==null&&(U.return=L),xa(m,L,!0,!0);else if(L.child!==null){L.child.return=L,L=L.child;continue}}if(L===g)break;for(;L.sibling===null;){if(L.return===null||L.return===g)return;L=L.return}L.sibling.return=L.return,L=L.sibling}};al=function(m,g){var E=g.stateNode;if(!gc(m,g)){m=E.containerInfo;var b=lt(m);xa(b,g,!1,!1),E.pendingChildren=b,Ti(g),yn(m,b)}},Nd=function(m,g,E,b,L){var U=m.stateNode,ee=m.memoizedProps;if((m=gc(m,g))&&ee===b)g.stateNode=U;else{var pe=g.stateNode,Oe=Ps(Cr.current),Qe=null;ee!==b&&(Qe=le(pe,E,ee,b,L,Oe)),m&&Qe===null?g.stateNode=U:(U=pt(U,Qe,E,ee,b,g,m,pe),Ee(U,E,b,L,Oe)&&Ti(g),g.stateNode=U,m?Ti(g):Kr(U,g,!1,!1))}},Ud=function(m,g,E,b){E!==b?(m=Ps(tl.current),E=Ps(Cr.current),g.stateNode=we(b,m,E,g),Ti(g)):g.stateNode=m.stateNode}}else al=function(){},Nd=function(){},Ud=function(){};function ko(m,g){if(!Xn)switch(m.tailMode){case"hidden":g=m.tail;for(var E=null;g!==null;)g.alternate!==null&&(E=g),g=g.sibling;E===null?m.tail=null:E.sibling=null;break;case"collapsed":E=m.tail;for(var b=null;E!==null;)E.alternate!==null&&(b=E),E=E.sibling;b===null?g||m.tail===null?m.tail=null:m.tail.sibling=null:b.sibling=null}}function ci(m){var g=m.alternate!==null&&m.alternate.child===m.child,E=0,b=0;if(g)for(var L=m.child;L!==null;)E|=L.lanes|L.childLanes,b|=L.subtreeFlags&14680064,b|=L.flags&14680064,L.return=m,L=L.sibling;else for(L=m.child;L!==null;)E|=L.lanes|L.childLanes,b|=L.subtreeFlags,b|=L.flags,L.return=m,L=L.sibling;return m.subtreeFlags|=b,m.childLanes=E,g}function Gd(m,g,E){var b=g.pendingProps;switch(Ip(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ci(g),null;case 1:return $t(g.type)&&yi(),ci(g),null;case 3:return b=g.stateNode,uc(),xt(Jt),xt(fn),nl(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(m===null||m.child===null)&&(fu(g)?Ti(g):m===null||m.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,ds!==null&&(Bu(ds),ds=null))),al(m,g),ci(g),null;case 5:Dp(g),E=Ps(tl.current);var L=g.type;if(m!==null&&g.stateNode!=null)Nd(m,g,L,b,E),m.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!b){if(g.stateNode===null)throw Error(o(166));return ci(g),null}if(m=Ps(Cr.current),fu(g)){if(!Ge)throw Error(o(175));m=nd(g.stateNode,g.type,g.memoizedProps,E,m,g,!sc),g.updateQueue=m,m!==null&&Ti(g)}else{var U=W(L,b,E,m,g);Kr(U,g,!1,!1),g.stateNode=U,Ee(U,L,b,E,m)&&Ti(g)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return ci(g),null;case 6:if(m&&g.stateNode!=null)Ud(m,g,m.memoizedProps,b);else{if(typeof b!="string"&&g.stateNode===null)throw Error(o(166));if(m=Ps(tl.current),E=Ps(Cr.current),fu(g)){if(!Ge)throw Error(o(176));if(m=g.stateNode,b=g.memoizedProps,(E=eo(m,b,g,!sc))&&(L=yr,L!==null))switch(U=(L.mode&1)!==0,L.tag){case 3:Me(L.stateNode.containerInfo,m,b,U);break;case 5:Re(L.type,L.memoizedProps,L.stateNode,m,b,U)}E&&Ti(g)}else g.stateNode=we(b,m,E,g)}return ci(g),null;case 13:if(xt(Qn),b=g.memoizedState,Xn&&Hi!==null&&g.mode&1&&!(g.flags&128)){for(m=Hi;m;)m=Is(m);return oc(),g.flags|=98560,g}if(b!==null&&b.dehydrated!==null){if(b=fu(g),m===null){if(!b)throw Error(o(318));if(!Ge)throw Error(o(344));if(m=g.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(o(317));id(m,g)}else oc(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;return ci(g),null}return ds!==null&&(Bu(ds),ds=null),g.flags&128?(g.lanes=E,g):(b=b!==null,E=!1,m===null?fu(g):E=m.memoizedState!==null,b&&!E&&(g.child.flags|=8192,g.mode&1&&(m===null||Qn.current&1?ni===0&&(ni=3):Xd())),g.updateQueue!==null&&(g.flags|=4),ci(g),null);case 4:return uc(),al(m,g),m===null&&St(g.stateNode.containerInfo),ci(g),null;case 10:return du(g.type._context),ci(g),null;case 17:return $t(g.type)&&yi(),ci(g),null;case 19:if(xt(Qn),L=g.memoizedState,L===null)return ci(g),null;if(b=(g.flags&128)!==0,U=L.rendering,U===null)if(b)ko(L,!1);else{if(ni!==0||m!==null&&m.flags&128)for(m=g.child;m!==null;){if(U=Md(m),U!==null){for(g.flags|=128,ko(L,!1),m=U.updateQueue,m!==null&&(g.updateQueue=m,g.flags|=4),g.subtreeFlags=0,m=E,b=g.child;b!==null;)E=b,L=m,E.flags&=14680066,U=E.alternate,U===null?(E.childLanes=0,E.lanes=L,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=U.childLanes,E.lanes=U.lanes,E.child=U.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=U.memoizedProps,E.memoizedState=U.memoizedState,E.updateQueue=U.updateQueue,E.type=U.type,L=U.dependencies,E.dependencies=L===null?null:{lanes:L.lanes,firstContext:L.firstContext}),b=b.sibling;return Bt(Qn,Qn.current&1|2),g.child}m=m.sibling}L.tail!==null&&Ei()>Aa&&(g.flags|=128,b=!0,ko(L,!1),g.lanes=4194304)}else{if(!b)if(m=Md(U),m!==null){if(g.flags|=128,b=!0,m=m.updateQueue,m!==null&&(g.updateQueue=m,g.flags|=4),ko(L,!0),L.tail===null&&L.tailMode==="hidden"&&!U.alternate&&!Xn)return ci(g),null}else 2*Ei()-L.renderingStartTime>Aa&&E!==1073741824&&(g.flags|=128,b=!0,ko(L,!1),g.lanes=4194304);L.isBackwards?(U.sibling=g.child,g.child=U):(m=L.last,m!==null?m.sibling=U:g.child=U,L.last=U)}return L.tail!==null?(g=L.tail,L.rendering=g,L.tail=g.sibling,L.renderingStartTime=Ei(),g.sibling=null,m=Qn.current,Bt(Qn,b?m&1|2:m&1),g):(ci(g),null);case 22:case 23:return Fu(),b=g.memoizedState!==null,m!==null&&m.memoizedState!==null!==b&&(g.flags|=8192),b&&g.mode&1?nr&1073741824&&(ci(g),ct&&g.subtreeFlags&6&&(g.flags|=8192)):ci(g),null;case 24:return null;case 25:return null}throw Error(o(156,g.tag))}var Vp=a.ReactCurrentOwner,Pi=!1;function ti(m,g,E,b){g.child=m===null?tg(g,null,E,b):Oo(g,m.child,E,b)}function Gn(m,g,E,b,L){E=E.render;var U=g.ref;return nc(g,L),b=hc(m,g,E,b,U,L),E=ya(),m!==null&&!Pi?(g.updateQueue=m.updateQueue,g.flags&=-2053,m.lanes&=~L,Rr(m,g,L)):(Xn&&E&&Rp(g),g.flags|=1,ti(m,g,b,L),g.child)}function Bn(m,g,E,b,L){if(m===null){var U=E.type;return typeof U=="function"&&!Yd(U)&&U.defaultProps===void 0&&E.compare===null&&E.defaultProps===void 0?(g.tag=15,g.type=U,No(m,g,U,b,L)):(m=Jd(E.type,null,b,g,g.mode,L),m.ref=g.ref,m.return=g,g.child=m)}if(U=m.child,!(m.lanes&L)){var ee=U.memoizedProps;if(E=E.compare,E=E!==null?E:Ls,E(ee,b)&&m.ref===g.ref)return Rr(m,g,L)}return g.flags|=1,m=Xo(U,b),m.ref=g.ref,m.return=g,g.child=m}function No(m,g,E,b,L){if(m!==null&&Ls(m.memoizedProps,b)&&m.ref===g.ref)if(Pi=!1,(m.lanes&L)!==0)m.flags&131072&&(Pi=!0);else return g.lanes=m.lanes,Rr(m,g,L);return Uo(m,g,E,b,L)}function zi(m,g,E){var b=g.pendingProps,L=b.children,U=m!==null?m.memoizedState:null;if(b.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null},Bt(gl,nr),nr|=E;else if(E&1073741824)g.memoizedState={baseLanes:0,cachePool:null},b=U!==null?U.baseLanes:E,Bt(gl,nr),nr|=b;else return m=U!==null?U.baseLanes|E:E,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:m,cachePool:null},g.updateQueue=null,Bt(gl,nr),nr|=m,null;else U!==null?(b=U.baseLanes|E,g.memoizedState=null):b=E,Bt(gl,nr),nr|=b;return ti(m,g,L,E),g.child}function vr(m,g){var E=g.ref;(m===null&&E!==null||m!==null&&m.ref!==E)&&(g.flags|=512,g.flags|=2097152)}function Uo(m,g,E,b,L){var U=$t(E)?Lt:fn.current;return U=On(g,U),nc(g,L),E=hc(m,g,E,b,U,L),b=ya(),m!==null&&!Pi?(g.updateQueue=m.updateQueue,g.flags&=-2053,m.lanes&=~L,Rr(m,g,L)):(Xn&&b&&Rp(g),g.flags|=1,ti(m,g,E,L),g.child)}function ll(m,g,E,b,L){if($t(E)){var U=!0;to(g)}else U=!1;if(nc(g,L),g.stateNode===null)m!==null&&(m.alternate=null,g.alternate=null,g.flags|=2),J0(g,E,b),Cp(g,E,b,L),b=!0;else if(m===null){var ee=g.stateNode,pe=g.memoizedProps;ee.props=pe;var Oe=ee.context,Qe=E.contextType;typeof Qe=="object"&&Qe!==null?Qe=br(Qe):(Qe=$t(E)?Lt:fn.current,Qe=On(g,Qe));var Tt=E.getDerivedStateFromProps,Zt=typeof Tt=="function"||typeof ee.getSnapshotBeforeUpdate=="function";Zt||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(pe!==b||Oe!==Qe)&&q0(g,ee,b,Qe),us=!1;var Ut=g.memoizedState;ee.state=Ut,xd(g,b,ee,L),Oe=g.memoizedState,pe!==b||Ut!==Oe||Jt.current||us?(typeof Tt=="function"&&(Mp(g,E,Tt,b),Oe=g.memoizedState),(pe=us||bp(g,E,pe,b,Ut,Oe,Qe))?(Zt||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount()),typeof ee.componentDidMount=="function"&&(g.flags|=4194308)):(typeof ee.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=b,g.memoizedState=Oe),ee.props=b,ee.state=Oe,ee.context=Qe,b=pe):(typeof ee.componentDidMount=="function"&&(g.flags|=4194308),b=!1)}else{ee=g.stateNode,wp(m,g),pe=g.memoizedProps,Qe=g.type===g.elementType?pe:Mr(g.type,pe),ee.props=Qe,Zt=g.pendingProps,Ut=ee.context,Oe=E.contextType,typeof Oe=="object"&&Oe!==null?Oe=br(Oe):(Oe=$t(E)?Lt:fn.current,Oe=On(g,Oe));var un=E.getDerivedStateFromProps;(Tt=typeof un=="function"||typeof ee.getSnapshotBeforeUpdate=="function")||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(pe!==Zt||Ut!==Oe)&&q0(g,ee,b,Oe),us=!1,Ut=g.memoizedState,ee.state=Ut,xd(g,b,ee,L);var gt=g.memoizedState;pe!==Zt||Ut!==gt||Jt.current||us?(typeof un=="function"&&(Mp(g,E,un,b),gt=g.memoizedState),(Qe=us||bp(g,E,Qe,b,Ut,gt,Oe)||!1)?(Tt||typeof ee.UNSAFE_componentWillUpdate!="function"&&typeof ee.componentWillUpdate!="function"||(typeof ee.componentWillUpdate=="function"&&ee.componentWillUpdate(b,gt,Oe),typeof ee.UNSAFE_componentWillUpdate=="function"&&ee.UNSAFE_componentWillUpdate(b,gt,Oe)),typeof ee.componentDidUpdate=="function"&&(g.flags|=4),typeof ee.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof ee.componentDidUpdate!="function"||pe===m.memoizedProps&&Ut===m.memoizedState||(g.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||pe===m.memoizedProps&&Ut===m.memoizedState||(g.flags|=1024),g.memoizedProps=b,g.memoizedState=gt),ee.props=b,ee.state=gt,ee.context=Oe,b=Qe):(typeof ee.componentDidUpdate!="function"||pe===m.memoizedProps&&Ut===m.memoizedState||(g.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||pe===m.memoizedProps&&Ut===m.memoizedState||(g.flags|=1024),b=!1)}return tr(m,g,E,b,U,L)}function tr(m,g,E,b,L,U){vr(m,g);var ee=(g.flags&128)!==0;if(!b&&!ee)return L&&Ln(g,E,!1),Rr(m,g,U);b=g.stateNode,Vp.current=g;var pe=ee&&typeof E.getDerivedStateFromError!="function"?null:b.render();return g.flags|=1,m!==null&&ee?(g.child=Oo(g,m.child,null,U),g.child=Oo(g,null,pe,U)):ti(m,g,pe,U),g.memoizedState=b.state,L&&Ln(g,E,!0),g.child}function Eu(m){var g=m.stateNode;g.pendingContext?os(m,g.pendingContext,g.pendingContext!==g.context):g.context&&os(m,g.context,!1),wd(m,g.containerInfo)}function Wp(m,g,E,b,L){return oc(),Td(L),g.flags|=256,ti(m,g,E,b),g.child}var Tu={dehydrated:null,treeContext:null,retryLane:0};function cl(m){return{baseLanes:m,cachePool:null}}function Kp(m,g,E){var b=g.pendingProps,L=Qn.current,U=!1,ee=(g.flags&128)!==0,pe;if((pe=ee)||(pe=m!==null&&m.memoizedState===null?!1:(L&2)!==0),pe?(U=!0,g.flags&=-129):(m===null||m.memoizedState!==null)&&(L|=1),Bt(Qn,L&1),m===null)return ma(g),m=g.memoizedState,m!==null&&(m=m.dehydrated,m!==null)?(g.mode&1?Rs(m)?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(L=b.children,m=b.fallback,U?(b=g.mode,U=g.child,L={mode:"hidden",children:L},!(b&1)&&U!==null?(U.childLanes=0,U.pendingProps=L):U=Uu(L,b,0,null),m=Sl(m,b,E,null),U.return=g,m.return=g,U.sibling=m,g.child=U,g.child.memoizedState=cl(E),g.memoizedState=Tu,m):Bs(g,L));if(L=m.memoizedState,L!==null){if(pe=L.dehydrated,pe!==null){if(ee)return g.flags&256?(g.flags&=-257,Mu(m,g,E,Error(o(422)))):g.memoizedState!==null?(g.child=m.child,g.flags|=128,null):(U=b.fallback,L=g.mode,b=Uu({mode:"visible",children:b.children},L,0,null),U=Sl(U,L,E,null),U.flags|=2,b.return=g,U.return=g,b.sibling=U,g.child=b,g.mode&1&&Oo(g,m.child,null,E),g.child.memoizedState=cl(E),g.memoizedState=Tu,U);if(!(g.mode&1))g=Mu(m,g,E,null);else if(Rs(pe))g=Mu(m,g,E,Error(o(419)));else if(b=(E&m.childLanes)!==0,Pi||b){if(b=ui,b!==null){switch(E&-E){case 4:U=2;break;case 16:U=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:U=32;break;case 536870912:U=268435456;break;default:U=0}b=U&(b.suspendedLanes|E)?0:U,b!==0&&b!==L.retryLane&&(L.retryLane=b,ir(m,b,-1))}Xd(),g=Mu(m,g,E,Error(o(421)))}else Zs(pe)?(g.flags|=128,g.child=m.child,g=hg.bind(null,m),Wa(pe,g),g=null):(E=L.treeContext,Ge&&(Hi=Zl(pe),yr=g,Xn=!0,ds=null,sc=!1,E!==null&&(hs[jr++]=Po,hs[jr++]=Do,hs[jr++]=Qa,Po=E.id,Do=E.overflow,Qa=g)),g=Bs(g,g.pendingProps.children),g.flags|=4096);return g}return U?(b=Hd(m,g,b.children,b.fallback,E),U=g.child,L=m.child.memoizedState,U.memoizedState=L===null?cl(E):{baseLanes:L.baseLanes|E,cachePool:null},U.childLanes=m.childLanes&~E,g.memoizedState=Tu,b):(E=wu(m,g,b.children,E),g.memoizedState=null,E)}return U?(b=Hd(m,g,b.children,b.fallback,E),U=g.child,L=m.child.memoizedState,U.memoizedState=L===null?cl(E):{baseLanes:L.baseLanes|E,cachePool:null},U.childLanes=m.childLanes&~E,g.memoizedState=Tu,b):(E=wu(m,g,b.children,E),g.memoizedState=null,E)}function Bs(m,g){return g=Uu({mode:"visible",children:g},m.mode,0,null),g.return=m,m.child=g}function wu(m,g,E,b){var L=m.child;return m=L.sibling,E=Xo(L,{mode:"visible",children:E}),!(g.mode&1)&&(E.lanes=b),E.return=g,E.sibling=null,m!==null&&(b=g.deletions,b===null?(g.deletions=[m],g.flags|=16):b.push(m)),g.child=E}function Hd(m,g,E,b,L){var U=g.mode;m=m.child;var ee=m.sibling,pe={mode:"hidden",children:E};return!(U&1)&&g.child!==m?(E=g.child,E.childLanes=0,E.pendingProps=pe,g.deletions=null):(E=Xo(m,pe),E.subtreeFlags=m.subtreeFlags&14680064),ee!==null?b=Xo(ee,b):(b=Sl(b,U,L,null),b.flags|=2),b.return=g,E.return=g,E.sibling=b,g.child=E,b}function Mu(m,g,E,b){return b!==null&&Td(b),Oo(g,m.child,null,E),m=Bs(g,g.pendingProps.children),m.flags|=2,g.memoizedState=null,m}function ag(m,g,E){m.lanes|=g;var b=m.alternate;b!==null&&(b.lanes|=g),qa(m.return,g,E)}function ao(m,g,E,b,L){var U=m.memoizedState;U===null?m.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:b,tail:E,tailMode:L}:(U.isBackwards=g,U.rendering=null,U.renderingStartTime=0,U.last=b,U.tail=E,U.tailMode=L)}function ul(m,g,E){var b=g.pendingProps,L=b.revealOrder,U=b.tail;if(ti(m,g,b.children,E),b=Qn.current,b&2)b=b&1|2,g.flags|=128;else{if(m!==null&&m.flags&128)e:for(m=g.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&ag(m,E,g);else if(m.tag===19)ag(m,E,g);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===g)break e;for(;m.sibling===null;){if(m.return===null||m.return===g)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}b&=1}if(Bt(Qn,b),!(g.mode&1))g.memoizedState=null;else switch(L){case"forwards":for(E=g.child,L=null;E!==null;)m=E.alternate,m!==null&&Md(m)===null&&(L=E),E=E.sibling;E=L,E===null?(L=g.child,g.child=null):(L=E.sibling,E.sibling=null),ao(g,!1,L,E,U);break;case"backwards":for(E=null,L=g.child,g.child=null;L!==null;){if(m=L.alternate,m!==null&&Md(m)===null){g.child=L;break}m=L.sibling,L.sibling=E,E=L,L=m}ao(g,!0,E,null,U);break;case"together":ao(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Rr(m,g,E){if(m!==null&&(g.dependencies=m.dependencies),lo|=g.lanes,!(E&g.childLanes))return null;if(m!==null&&g.child!==m.child)throw Error(o(153));if(g.child!==null){for(m=g.child,E=Xo(m,m.pendingProps),g.child=E,E.return=g;m.sibling!==null;)m=m.sibling,E=E.sibling=Xo(m,m.pendingProps),E.return=g;E.sibling=null}return g.child}function zd(m,g,E){switch(g.tag){case 3:Eu(g),oc();break;case 5:ng(g);break;case 1:$t(g.type)&&to(g);break;case 4:wd(g,g.stateNode.containerInfo);break;case 10:Ja(g,g.type._context,g.memoizedProps.value);break;case 13:var b=g.memoizedState;if(b!==null)return b.dehydrated!==null?(Bt(Qn,Qn.current&1),g.flags|=128,null):E&g.child.childLanes?Kp(m,g,E):(Bt(Qn,Qn.current&1),m=Rr(m,g,E),m!==null?m.sibling:null);Bt(Qn,Qn.current&1);break;case 19:if(b=(E&g.childLanes)!==0,m.flags&128){if(b)return ul(m,g,E);g.flags|=128}var L=g.memoizedState;if(L!==null&&(L.rendering=null,L.tail=null,L.lastEffect=null),Bt(Qn,Qn.current),b)break;return null;case 22:case 23:return g.lanes=0,zi(m,g,E)}return Rr(m,g,E)}function jd(m,g){switch(Ip(g),g.tag){case 1:return $t(g.type)&&yi(),m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 3:return uc(),xt(Jt),xt(fn),nl(),m=g.flags,m&65536&&!(m&128)?(g.flags=m&-65537|128,g):null;case 5:return Dp(g),null;case 13:if(xt(Qn),m=g.memoizedState,m!==null&&m.dehydrated!==null){if(g.alternate===null)throw Error(o(340));oc()}return m=g.flags,m&65536?(g.flags=m&-65537|128,g):null;case 19:return xt(Qn),null;case 4:return uc(),null;case 10:return du(g.type._context),null;case 22:case 23:return Fu(),null;case 24:return null;default:return null}}var xr=!1,Di=!1,hl=typeof WeakSet=="function"?WeakSet:Set,it=null;function fs(m,g){var E=m.ref;if(E!==null)if(typeof E=="function")try{E(null)}catch(b){Sr(m,g,b)}else E.current=null}function Go(m,g,E){try{E()}catch(b){Sr(m,g,b)}}var Xp=!1;function $p(m,g){for($(m.containerInfo),it=g;it!==null;)if(m=it,g=m.child,(m.subtreeFlags&1028)!==0&&g!==null)g.return=m,it=g;else for(;it!==null;){m=it;try{var E=m.alternate;if(m.flags&1024)switch(m.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var b=E.memoizedProps,L=E.memoizedState,U=m.stateNode,ee=U.getSnapshotBeforeUpdate(m.elementType===m.type?b:Mr(m.type,b),L);U.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:ct&&ke(m.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(pe){Sr(m,m.return,pe)}if(g=m.sibling,g!==null){g.return=m.return,it=g;break}it=m.return}return E=Xp,Xp=!1,E}function Ho(m,g,E){var b=g.updateQueue;if(b=b!==null?b.lastEffect:null,b!==null){var L=b=b.next;do{if((L.tag&m)===m){var U=L.destroy;L.destroy=void 0,U!==void 0&&Go(g,E,U)}L=L.next}while(L!==b)}}function ji(m,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var E=g=g.next;do{if((E.tag&m)===m){var b=E.create;E.destroy=b()}E=E.next}while(E!==g)}}function _r(m){var g=m.ref;if(g!==null){var E=m.stateNode;switch(m.tag){case 5:m=re(E);break;default:m=E}typeof g=="function"?g(m):g.current=m}}function jn(m,g,E){if(ro&&typeof ro.onCommitFiberUnmount=="function")try{ro.onCommitFiberUnmount(lu,g)}catch{}switch(g.tag){case 0:case 11:case 14:case 15:if(m=g.updateQueue,m!==null&&(m=m.lastEffect,m!==null)){var b=m=m.next;do{var L=b,U=L.destroy;L=L.tag,U!==void 0&&(L&2||L&4)&&Go(g,E,U),b=b.next}while(b!==m)}break;case 1:if(fs(g,E),m=g.stateNode,typeof m.componentWillUnmount=="function")try{m.props=g.memoizedProps,m.state=g.memoizedState,m.componentWillUnmount()}catch(ee){Sr(g,E,ee)}break;case 5:fs(g,E);break;case 4:ct?qp(m,g,E):Ne&&Ne&&(g=g.stateNode.containerInfo,E=lt(g),Nn(g,E))}}function ps(m,g,E){for(var b=g;;)if(jn(m,b,E),b.child===null||ct&&b.tag===4){if(b===g)break;for(;b.sibling===null;){if(b.return===null||b.return===g)return;b=b.return}b.sibling.return=b.return,b=b.sibling}else b.child.return=b,b=b.child}function Yp(m){var g=m.alternate;g!==null&&(m.alternate=null,Yp(g)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(g=m.stateNode,g!==null&&st(g)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}function Jp(m){return m.tag===5||m.tag===3||m.tag===4}function Vd(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||Jp(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function Wd(m){if(ct){e:{for(var g=m.return;g!==null;){if(Jp(g))break e;g=g.return}throw Error(o(160))}var E=g;switch(E.tag){case 5:g=E.stateNode,E.flags&32&&(Be(g),E.flags&=-33),E=Vd(m),yc(m,E,g);break;case 3:case 4:g=E.stateNode.containerInfo,E=Vd(m),Kd(m,E,g);break;default:throw Error(o(161))}}}function Kd(m,g,E){var b=m.tag;if(b===5||b===6)m=m.stateNode,g?Gt(E,m,g):mt(E,m);else if(b!==4&&(m=m.child,m!==null))for(Kd(m,g,E),m=m.sibling;m!==null;)Kd(m,g,E),m=m.sibling}function yc(m,g,E){var b=m.tag;if(b===5||b===6)m=m.stateNode,g?kt(E,m,g):nt(E,m);else if(b!==4&&(m=m.child,m!==null))for(yc(m,g,E),m=m.sibling;m!==null;)yc(m,g,E),m=m.sibling}function qp(m,g,E){for(var b=g,L=!1,U,ee;;){if(!L){L=b.return;e:for(;;){if(L===null)throw Error(o(160));switch(U=L.stateNode,L.tag){case 5:ee=!1;break e;case 3:U=U.containerInfo,ee=!0;break e;case 4:U=U.containerInfo,ee=!0;break e}L=L.return}L=!0}if(b.tag===5||b.tag===6)ps(m,b,E),ee?ue(U,b.stateNode):vt(U,b.stateNode);else if(b.tag===18)ee?K(U,b.stateNode):ad(U,b.stateNode);else if(b.tag===4){if(b.child!==null){U=b.stateNode.containerInfo,ee=!0,b.child.return=b,b=b.child;continue}}else if(jn(m,b,E),b.child!==null){b.child.return=b,b=b.child;continue}if(b===g)break;for(;b.sibling===null;){if(b.return===null||b.return===g)return;b=b.return,b.tag===4&&(L=!1)}b.sibling.return=b.return,b=b.sibling}}function _a(m,g){if(ct){switch(g.tag){case 0:case 11:case 14:case 15:Ho(3,g,g.return),ji(3,g),Ho(5,g,g.return);return;case 1:return;case 5:var E=g.stateNode;if(E!=null){var b=g.memoizedProps;m=m!==null?m.memoizedProps:b;var L=g.type,U=g.updateQueue;g.updateQueue=null,U!==null&&At(E,U,L,m,b,g)}return;case 6:if(g.stateNode===null)throw Error(o(162));E=g.memoizedProps,Qt(g.stateNode,m!==null?m.memoizedProps:E,E);return;case 3:Ge&&m!==null&&m.memoizedState.isDehydrated&&sd(g.stateNode.containerInfo);return;case 12:return;case 13:vc(g);return;case 19:vc(g);return;case 17:return}throw Error(o(163))}switch(g.tag){case 0:case 11:case 14:case 15:Ho(3,g,g.return),ji(3,g),Ho(5,g,g.return);return;case 12:return;case 13:vc(g);return;case 19:vc(g);return;case 3:Ge&&m!==null&&m.memoizedState.isDehydrated&&sd(g.stateNode.containerInfo);break;case 22:case 23:return}e:if(Ne){switch(g.tag){case 1:case 5:case 6:break e;case 3:case 4:g=g.stateNode,Nn(g.containerInfo,g.pendingChildren);break e}throw Error(o(163))}}function vc(m){var g=m.updateQueue;if(g!==null){m.updateQueue=null;var E=m.stateNode;E===null&&(E=m.stateNode=new hl),g.forEach(function(b){var L=dg.bind(null,m,b);E.has(b)||(E.add(b),b.then(L,L))})}}function p_(m,g){for(it=g;it!==null;){g=it;var E=g.deletions;if(E!==null)for(var b=0;b<E.length;b++){var L=E[b];try{var U=m;ct?qp(U,L,g):ps(U,L,g);var ee=L.alternate;ee!==null&&(ee.return=null),L.return=null}catch(Pt){Sr(L,g,Pt)}}if(E=g.child,g.subtreeFlags&12854&&E!==null)E.return=g,it=E;else for(;it!==null;){g=it;try{var pe=g.flags;if(pe&32&&ct&&Be(g.stateNode),pe&512){var Oe=g.alternate;if(Oe!==null){var Qe=Oe.ref;Qe!==null&&(typeof Qe=="function"?Qe(null):Qe.current=null)}}if(pe&8192)switch(g.tag){case 13:if(g.memoizedState!==null){var Tt=g.alternate;(Tt===null||Tt.memoizedState===null)&&(Du=Ei())}break;case 22:var Zt=g.memoizedState!==null,Ut=g.alternate,un=Ut!==null&&Ut.memoizedState!==null;if(E=g,ct){e:if(b=E,L=Zt,U=null,ct)for(var gt=b;;){if(gt.tag===5){if(U===null){U=gt;var Ki=gt.stateNode;L?at(Ki):Ye(gt.stateNode,gt.memoizedProps)}}else if(gt.tag===6){if(U===null){var qr=gt.stateNode;L?ae(qr):Ce(qr,gt.memoizedProps)}}else if((gt.tag!==22&&gt.tag!==23||gt.memoizedState===null||gt===b)&&gt.child!==null){gt.child.return=gt,gt=gt.child;continue}if(gt===b)break;for(;gt.sibling===null;){if(gt.return===null||gt.return===b)break e;U===gt&&(U=null),gt=gt.return}U===gt&&(U=null),gt.sibling.return=gt.return,gt=gt.sibling}}if(Zt&&!un&&E.mode&1){it=E;for(var Te=E.child;Te!==null;){for(E=it=Te;it!==null;){b=it;var ge=b.child;switch(b.tag){case 0:case 11:case 14:case 15:Ho(4,b,b.return);break;case 1:fs(b,b.return);var Pe=b.stateNode;if(typeof Pe.componentWillUnmount=="function"){var dt=b.return;try{Pe.props=b.memoizedProps,Pe.state=b.memoizedState,Pe.componentWillUnmount()}catch(Pt){Sr(b,dt,Pt)}}break;case 5:fs(b,b.return);break;case 22:if(b.memoizedState!==null){Zp(E);continue}}ge!==null?(ge.return=b,it=ge):Zp(E)}Te=Te.sibling}}}switch(pe&4102){case 2:Wd(g),g.flags&=-3;break;case 6:Wd(g),g.flags&=-3,_a(g.alternate,g);break;case 4096:g.flags&=-4097;break;case 4100:g.flags&=-4097,_a(g.alternate,g);break;case 4:_a(g.alternate,g)}}catch(Pt){Sr(g,g.return,Pt)}if(E=g.sibling,E!==null){E.return=g.return,it=E;break}it=g.return}}}function bu(m,g,E){it=m,Cu(m)}function Cu(m,g,E){for(var b=(m.mode&1)!==0;it!==null;){var L=it,U=L.child;if(L.tag===22&&b){var ee=L.memoizedState!==null||xr;if(!ee){var pe=L.alternate,Oe=pe!==null&&pe.memoizedState!==null||Di;pe=xr;var Qe=Di;if(xr=ee,(Di=Oe)&&!Qe)for(it=L;it!==null;)ee=it,Oe=ee.child,ee.tag===22&&ee.memoizedState!==null?dl(L):Oe!==null?(Oe.return=ee,it=Oe):dl(L);for(;U!==null;)it=U,Cu(U),U=U.sibling;it=L,xr=pe,Di=Qe}Qp(m)}else L.subtreeFlags&8772&&U!==null?(U.return=L,it=U):Qp(m)}}function Qp(m){for(;it!==null;){var g=it;if(g.flags&8772){var E=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:Di||ji(5,g);break;case 1:var b=g.stateNode;if(g.flags&4&&!Di)if(E===null)b.componentDidMount();else{var L=g.elementType===g.type?E.memoizedProps:Mr(g.type,E.memoizedProps);b.componentDidUpdate(L,E.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var U=g.updateQueue;U!==null&&$0(g,U,b);break;case 3:var ee=g.updateQueue;if(ee!==null){if(E=null,g.child!==null)switch(g.child.tag){case 5:E=re(g.child.stateNode);break;case 1:E=g.child.stateNode}$0(g,ee,E)}break;case 5:var pe=g.stateNode;E===null&&g.flags&4&&Xe(pe,g.type,g.memoizedProps,g);break;case 6:break;case 4:break;case 12:break;case 13:if(Ge&&g.memoizedState===null){var Oe=g.alternate;if(Oe!==null){var Qe=Oe.memoizedState;if(Qe!==null){var Tt=Qe.dehydrated;Tt!==null&&od(Tt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Di||g.flags&512&&_r(g)}catch(Zt){Sr(g,g.return,Zt)}}if(g===m){it=null;break}if(E=g.sibling,E!==null){E.return=g.return,it=E;break}it=g.return}}function Zp(m){for(;it!==null;){var g=it;if(g===m){it=null;break}var E=g.sibling;if(E!==null){E.return=g.return,it=E;break}it=g.return}}function dl(m){for(;it!==null;){var g=it;try{switch(g.tag){case 0:case 11:case 15:var E=g.return;try{ji(4,g)}catch(Oe){Sr(g,E,Oe)}break;case 1:var b=g.stateNode;if(typeof b.componentDidMount=="function"){var L=g.return;try{b.componentDidMount()}catch(Oe){Sr(g,L,Oe)}}var U=g.return;try{_r(g)}catch(Oe){Sr(g,U,Oe)}break;case 5:var ee=g.return;try{_r(g)}catch(Oe){Sr(g,ee,Oe)}}}catch(Oe){Sr(g,g.return,Oe)}if(g===m){it=null;break}var pe=g.sibling;if(pe!==null){pe.return=g.return,it=pe;break}it=g.return}}var Ru=0,fl=1,pl=2,zo=3,xc=4;if(typeof Symbol=="function"&&Symbol.for){var ml=Symbol.for;Ru=ml("selector.component"),fl=ml("selector.has_pseudo_class"),pl=ml("selector.role"),zo=ml("selector.test_id"),xc=ml("selector.text")}function Iu(m){var g=Q(m);if(g!=null){if(typeof g.memoizedProps["data-testname"]!="string")throw Error(o(364));return g}if(m=q(m),m===null)throw Error(o(362));return m.stateNode.current}function Lu(m,g){switch(g.$$typeof){case Ru:if(m.type===g.value)return!0;break;case fl:e:{g=g.value,m=[m,0];for(var E=0;E<m.length;){var b=m[E++],L=m[E++],U=g[L];if(b.tag!==5||!De(b)){for(;U!=null&&Lu(b,U);)L++,U=g[L];if(L===g.length){g=!0;break e}else for(b=b.child;b!==null;)m.push(b,L),b=b.sibling}}g=!1}return g;case pl:if(m.tag===5&&He(m.stateNode,g.value))return!0;break;case xc:if((m.tag===5||m.tag===6)&&(m=xe(m),m!==null&&0<=m.indexOf(g.value)))return!0;break;case zo:if(m.tag===5&&(m=m.memoizedProps["data-testname"],typeof m=="string"&&m.toLowerCase()===g.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function Sa(m){switch(m.$$typeof){case Ru:return"<"+(k(m.value)||"Unknown")+">";case fl:return":has("+(Sa(m)||"")+")";case pl:return'[role="'+m.value+'"]';case xc:return'"'+m.value+'"';case zo:return'[data-testname="'+m.value+'"]';default:throw Error(o(365))}}function Xr(m,g){var E=[];m=[m,0];for(var b=0;b<m.length;){var L=m[b++],U=m[b++],ee=g[U];if(L.tag!==5||!De(L)){for(;ee!=null&&Lu(L,ee);)U++,ee=g[U];if(U===g.length)E.push(L);else for(L=L.child;L!==null;)m.push(L,U),L=L.sibling}}return E}function jo(m,g){if(!tt)throw Error(o(363));m=Iu(m),m=Xr(m,g),g=[],m=Array.from(m);for(var E=0;E<m.length;){var b=m[E++];if(b.tag===5)De(b)||g.push(b.stateNode);else for(b=b.child;b!==null;)m.push(b),b=b.sibling}return g}var em=Math.ceil,Pu=a.ReactCurrentDispatcher,Fs=a.ReactCurrentOwner,Pn=a.ReactCurrentBatchConfig,sn=0,ui=null,Dn=null,$n=0,nr=0,gl=wt(0),ni=0,_c=null,lo=0,$r=0,yl=0,Vo=null,vi=null,Du=0,Aa=1/0;function vl(){Aa=Ei()+500}var Sc=!1,Vn=null,ks=null,Ac=!1,co=null,xl=0,_l=0,Wo=null,Hn=-1,ii=0;function En(){return sn&6?Ei():Hn!==-1?Hn:Hn=Ei()}function Ns(m){return m.mode&1?sn&2&&$n!==0?$n&-$n:X0.transition!==null?(ii===0&&(m=no,no<<=1,!(no&4194240)&&(no=64),ii=m),ii):(m=pn,m!==0?m:We()):1}function ir(m,g,E){if(50<_l)throw _l=0,Wo=null,Error(o(185));var b=Ea(m,g);return b===null?null:(Ka(b,g,E),(!(sn&2)||b!==ui)&&(b===ui&&(!(sn&2)&&($r|=g),ni===4&&Wi(b,$n)),Ir(b,E),g===1&&sn===0&&!(m.mode&1)&&(vl(),fd&&ls())),b)}function Ea(m,g){m.lanes|=g;var E=m.alternate;for(E!==null&&(E.lanes|=g),E=m,m=m.return;m!==null;)m.childLanes|=g,E=m.alternate,E!==null&&(E.childLanes|=g),E=m,m=m.return;return E.tag===3?E.stateNode:null}function Ir(m,g){var E=m.callbackNode;K0(m,g);var b=au(m,m===ui?$n:0);if(b===0)E!==null&&tc(E),m.callbackNode=null,m.callbackPriority=0;else if(g=b&-b,m.callbackPriority!==g){if(E!=null&&tc(E),g===1)m.tag===0?md(Yr.bind(null,m)):pd(Yr.bind(null,m)),qe?It(function(){sn===0&&ls()}):Xa($a,ls),E=null;else{switch(Ro(b)){case 1:E=$a;break;case 4:E=h_;break;case 16:E=hd;break;case 536870912:E=dd;break;default:E=hd}E=$d(E,Vi.bind(null,m))}m.callbackPriority=g,m.callbackNode=E}}function Vi(m,g){if(Hn=-1,ii=0,sn&6)throw Error(o(327));var E=m.callbackNode;if(uo()&&m.callbackNode!==E)return null;var b=au(m,m===ui?$n:0);if(b===0)return null;if(b&30||b&m.expiredLanes||g)g=ku(m,b);else{g=b;var L=sn;sn|=2;var U=im();(ui!==m||$n!==g)&&(vl(),Ko(m,g));do try{cg();break}catch(pe){nm(m,pe)}while(!0);gr(),Pu.current=U,sn=L,Dn!==null?g=0:(ui=null,$n=0,g=ni)}if(g!==0){if(g===2&&(L=ld(m),L!==0&&(b=L,g=Ou(m,L))),g===1)throw E=_c,Ko(m,0),Wi(m,b),Ir(m,Ei()),E;if(g===6)Wi(m,b);else{if(L=m.current.alternate,!(b&30)&&!tm(L)&&(g=ku(m,b),g===2&&(U=ld(m),U!==0&&(b=U,g=Ou(m,U))),g===1))throw E=_c,Ko(m,0),Wi(m,b),Ir(m,Ei()),E;switch(m.finishedWork=L,m.finishedLanes=b,g){case 0:case 1:throw Error(o(345));case 2:Us(m,vi);break;case 3:if(Wi(m,b),(b&130023424)===b&&(g=Du+500-Ei(),10<g)){if(au(m,0)!==0)break;if(L=m.suspendedLanes,(L&b)!==b){En(),m.pingedLanes|=m.suspendedLanes&L;break}m.timeoutHandle=Ie(Us.bind(null,m,vi),g);break}Us(m,vi);break;case 4:if(Wi(m,b),(b&4194240)===b)break;for(g=m.eventTimes,L=-1;0<b;){var ee=31-zn(b);U=1<<ee,ee=g[ee],ee>L&&(L=ee),b&=~U}if(b=L,b=Ei()-b,b=(120>b?120:480>b?480:1080>b?1080:1920>b?1920:3e3>b?3e3:4320>b?4320:1960*em(b/1960))-b,10<b){m.timeoutHandle=Ie(Us.bind(null,m,vi),b);break}Us(m,vi);break;case 5:Us(m,vi);break;default:throw Error(o(329))}}}return Ir(m,Ei()),m.callbackNode===E?Vi.bind(null,m):null}function Ou(m,g){var E=Vo;return m.current.memoizedState.isDehydrated&&(Ko(m,g).flags|=256),m=ku(m,g),m!==2&&(g=vi,vi=E,g!==null&&Bu(g)),m}function Bu(m){vi===null?vi=m:vi.push.apply(vi,m)}function tm(m){for(var g=m;;){if(g.flags&16384){var E=g.updateQueue;if(E!==null&&(E=E.stores,E!==null))for(var b=0;b<E.length;b++){var L=E[b],U=L.getSnapshot;L=L.value;try{if(!mr(U(),L))return!1}catch{return!1}}}if(E=g.child,g.subtreeFlags&16384&&E!==null)E.return=g,g=E;else{if(g===m)break;for(;g.sibling===null;){if(g.return===null||g.return===m)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Wi(m,g){for(g&=~yl,g&=~$r,m.suspendedLanes|=g,m.pingedLanes&=~g,m=m.expirationTimes;0<g;){var E=31-zn(g),b=1<<E;m[E]=-1,g&=~b}}function Yr(m){if(sn&6)throw Error(o(327));uo();var g=au(m,0);if(!(g&1))return Ir(m,Ei()),null;var E=ku(m,g);if(m.tag!==0&&E===2){var b=ld(m);b!==0&&(g=b,E=Ou(m,b))}if(E===1)throw E=_c,Ko(m,0),Wi(m,g),Ir(m,Ei()),E;if(E===6)throw Error(o(345));return m.finishedWork=m.current.alternate,m.finishedLanes=g,Us(m,vi),Ir(m,Ei()),null}function Ec(m){co!==null&&co.tag===0&&!(sn&6)&&uo();var g=sn;sn|=1;var E=Pn.transition,b=pn;try{if(Pn.transition=null,pn=1,m)return m()}finally{pn=b,Pn.transition=E,sn=g,!(sn&6)&&ls()}}function Fu(){nr=gl.current,xt(gl)}function Ko(m,g){m.finishedWork=null,m.finishedLanes=0;var E=m.timeoutHandle;if(E!==Ze&&(m.timeoutHandle=Ze,ze(E)),Dn!==null)for(E=Dn.return;E!==null;){var b=E;switch(Ip(b),b.tag){case 1:b=b.type.childContextTypes,b!=null&&yi();break;case 3:uc(),xt(Jt),xt(fn),nl();break;case 5:Dp(b);break;case 4:uc();break;case 13:xt(Qn);break;case 19:xt(Qn);break;case 10:du(b.type._context);break;case 22:case 23:Fu()}E=E.return}if(ui=m,Dn=m=Xo(m.current,null),$n=nr=g,ni=0,_c=null,yl=$r=lo=0,vi=Vo=null,cs!==null){for(g=0;g<cs.length;g++)if(E=cs[g],b=E.interleaved,b!==null){E.interleaved=null;var L=b.next,U=E.pending;if(U!==null){var ee=U.next;U.next=L,b.next=ee}E.pending=b}cs=null}return m}function nm(m,g){do{var E=Dn;try{if(gr(),pu.current=mc,bd){for(var b=Zn.memoizedState;b!==null;){var L=b.queue;L!==null&&(L.pending=null),b=b.next}bd=!1}if(il=0,Ii=Ri=Zn=null,so=!1,rl=0,Fs.current=null,E===null||E.return===null){ni=1,_c=g,Dn=null;break}e:{var U=m,ee=E.return,pe=E,Oe=g;if(g=$n,pe.flags|=32768,Oe!==null&&typeof Oe=="object"&&typeof Oe.then=="function"){var Qe=Oe,Tt=pe,Zt=Tt.tag;if(!(Tt.mode&1)&&(Zt===0||Zt===11||Zt===15)){var Ut=Tt.alternate;Ut?(Tt.updateQueue=Ut.updateQueue,Tt.memoizedState=Ut.memoizedState,Tt.lanes=Ut.lanes):(Tt.updateQueue=null,Tt.memoizedState=null)}var un=jp(ee);if(un!==null){un.flags&=-257,ol(un,ee,pe,U,g),un.mode&1&&Fo(U,Qe,g),g=un,Oe=Qe;var gt=g.updateQueue;if(gt===null){var Ki=new Set;Ki.add(Oe),g.updateQueue=Ki}else gt.add(Oe);break e}else{if(!(g&1)){Fo(U,Qe,g),Xd();break e}Oe=Error(o(426))}}else if(Xn&&pe.mode&1){var qr=jp(ee);if(qr!==null){!(qr.flags&65536)&&(qr.flags|=256),ol(qr,ee,pe,U,g),Td(Oe);break e}}U=Oe,ni!==4&&(ni=2),Vo===null?Vo=[U]:Vo.push(U),Oe=zp(Oe,pe),pe=ee;do{switch(pe.tag){case 3:pe.flags|=65536,g&=-g,pe.lanes|=g;var Te=og(pe,Oe,g);vd(pe,Te);break e;case 1:U=Oe;var ge=pe.type,Pe=pe.stateNode;if(!(pe.flags&128)&&(typeof ge.getDerivedStateFromError=="function"||Pe!==null&&typeof Pe.componentDidCatch=="function"&&(ks===null||!ks.has(Pe)))){pe.flags|=65536,g&=-g,pe.lanes|=g;var dt=kd(pe,U,g);vd(pe,dt);break e}}pe=pe.return}while(pe!==null)}sm(E)}catch(Pt){g=Pt,Dn===E&&E!==null&&(Dn=E=E.return);continue}break}while(!0)}function im(){var m=Pu.current;return Pu.current=mc,m===null?mc:m}function Xd(){(ni===0||ni===3||ni===2)&&(ni=4),ui===null||!(lo&268435455)&&!($r&268435455)||Wi(ui,$n)}function ku(m,g){var E=sn;sn|=2;var b=im();ui===m&&$n===g||Ko(m,g);do try{lg();break}catch(L){nm(m,L)}while(!0);if(gr(),sn=E,Pu.current=b,Dn!==null)throw Error(o(261));return ui=null,$n=0,ni}function lg(){for(;Dn!==null;)rm(Dn)}function cg(){for(;Dn!==null&&!da();)rm(Dn)}function rm(m){var g=lm(m.alternate,m,nr);m.memoizedProps=m.pendingProps,g===null?sm(m):Dn=g,Fs.current=null}function sm(m){var g=m;do{var E=g.alternate;if(m=g.return,g.flags&32768){if(E=jd(E,g),E!==null){E.flags&=32767,Dn=E;return}if(m!==null)m.flags|=32768,m.subtreeFlags=0,m.deletions=null;else{ni=6,Dn=null;return}}else if(E=Gd(E,g,nr),E!==null){Dn=E;return}if(g=g.sibling,g!==null){Dn=g;return}Dn=g=m}while(g!==null);ni===0&&(ni=5)}function Us(m,g){var E=pn,b=Pn.transition;try{Pn.transition=null,pn=1,ug(m,g,E)}finally{Pn.transition=b,pn=E}return null}function ug(m,g,E){do uo();while(co!==null);if(sn&6)throw Error(o(327));var b=m.finishedWork,L=m.finishedLanes;if(b===null)return null;if(m.finishedWork=null,m.finishedLanes=0,b===m.current)throw Error(o(177));m.callbackNode=null,m.callbackPriority=0;var U=b.lanes|b.childLanes;if(ud(m,U),m===ui&&(Dn=ui=null,$n=0),!(b.subtreeFlags&2064)&&!(b.flags&2064)||Ac||(Ac=!0,$d(hd,function(){return uo(),null})),U=(b.flags&15990)!==0,b.subtreeFlags&15990||U){U=Pn.transition,Pn.transition=null;var ee=pn;pn=1;var pe=sn;sn|=4,Fs.current=null,$p(m,b),p_(m,b),X(m.containerInfo),m.current=b,bu(b),u_(),sn=pe,pn=ee,Pn.transition=U}else m.current=b;if(Ac&&(Ac=!1,co=m,xl=L),U=m.pendingLanes,U===0&&(ks=null),cu(b.stateNode),Ir(m,Ei()),g!==null)for(E=m.onRecoverableError,b=0;b<g.length;b++)E(g[b]);if(Sc)throw Sc=!1,m=Vn,Vn=null,m;return xl&1&&m.tag!==0&&uo(),U=m.pendingLanes,U&1?m===Wo?_l++:(_l=0,Wo=m):_l=0,ls(),null}function uo(){if(co!==null){var m=Ro(xl),g=Pn.transition,E=pn;try{if(Pn.transition=null,pn=16>m?16:m,co===null)var b=!1;else{if(m=co,co=null,xl=0,sn&6)throw Error(o(331));var L=sn;for(sn|=4,it=m.current;it!==null;){var U=it,ee=U.child;if(it.flags&16){var pe=U.deletions;if(pe!==null){for(var Oe=0;Oe<pe.length;Oe++){var Qe=pe[Oe];for(it=Qe;it!==null;){var Tt=it;switch(Tt.tag){case 0:case 11:case 15:Ho(8,Tt,U)}var Zt=Tt.child;if(Zt!==null)Zt.return=Tt,it=Zt;else for(;it!==null;){Tt=it;var Ut=Tt.sibling,un=Tt.return;if(Yp(Tt),Tt===Qe){it=null;break}if(Ut!==null){Ut.return=un,it=Ut;break}it=un}}}var gt=U.alternate;if(gt!==null){var Ki=gt.child;if(Ki!==null){gt.child=null;do{var qr=Ki.sibling;Ki.sibling=null,Ki=qr}while(Ki!==null)}}it=U}}if(U.subtreeFlags&2064&&ee!==null)ee.return=U,it=ee;else e:for(;it!==null;){if(U=it,U.flags&2048)switch(U.tag){case 0:case 11:case 15:Ho(9,U,U.return)}var Te=U.sibling;if(Te!==null){Te.return=U.return,it=Te;break e}it=U.return}}var ge=m.current;for(it=ge;it!==null;){ee=it;var Pe=ee.child;if(ee.subtreeFlags&2064&&Pe!==null)Pe.return=ee,it=Pe;else e:for(ee=ge;it!==null;){if(pe=it,pe.flags&2048)try{switch(pe.tag){case 0:case 11:case 15:ji(9,pe)}}catch(Pt){Sr(pe,pe.return,Pt)}if(pe===ee){it=null;break e}var dt=pe.sibling;if(dt!==null){dt.return=pe.return,it=dt;break e}it=pe.return}}if(sn=L,ls(),ro&&typeof ro.onPostCommitFiberRoot=="function")try{ro.onPostCommitFiberRoot(lu,m)}catch{}b=!0}return b}finally{pn=E,Pn.transition=g}}return!1}function Nu(m,g,E){g=zp(E,g),g=og(m,g,1),fa(m,g),g=En(),m=Ea(m,1),m!==null&&(Ka(m,1,g),Ir(m,g))}function Sr(m,g,E){if(m.tag===3)Nu(m,m,E);else for(;g!==null;){if(g.tag===3){Nu(g,m,E);break}else if(g.tag===1){var b=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(ks===null||!ks.has(b))){m=zp(E,m),m=kd(g,m,1),fa(g,m),m=En(),g=Ea(g,1),g!==null&&(Ka(g,1,m),Ir(g,m));break}}g=g.return}}function om(m,g,E){var b=m.pingCache;b!==null&&b.delete(g),g=En(),m.pingedLanes|=m.suspendedLanes&E,ui===m&&($n&E)===E&&(ni===4||ni===3&&($n&130023424)===$n&&500>Ei()-Du?Ko(m,0):yl|=E),Ir(m,g)}function am(m,g){g===0&&(m.mode&1?(g=cn,cn<<=1,!(cn&130023424)&&(cn=4194304)):g=1);var E=En();m=Ea(m,g),m!==null&&(Ka(m,g,E),Ir(m,E))}function hg(m){var g=m.memoizedState,E=0;g!==null&&(E=g.retryLane),am(m,E)}function dg(m,g){var E=0;switch(m.tag){case 13:var b=m.stateNode,L=m.memoizedState;L!==null&&(E=L.retryLane);break;case 19:b=m.stateNode;break;default:throw Error(o(314))}b!==null&&b.delete(g),am(m,E)}var lm;lm=function(m,g,E){if(m!==null)if(m.memoizedProps!==g.pendingProps||Jt.current)Pi=!0;else{if(!(m.lanes&E)&&!(g.flags&128))return Pi=!1,zd(m,g,E);Pi=!!(m.flags&131072)}else Pi=!1,Xn&&g.flags&1048576&&Q0(g,Ad,g.index);switch(g.lanes=0,g.tag){case 2:var b=g.type;m!==null&&(m.alternate=null,g.alternate=null,g.flags|=2),m=g.pendingProps;var L=On(g,fn.current);nc(g,E),L=hc(null,g,b,m,L,E);var U=ya();return g.flags|=1,typeof L=="object"&&L!==null&&typeof L.render=="function"&&L.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,$t(b)?(U=!0,to(g)):U=!1,g.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,ic(g),L.updater=_d,g.stateNode=L,L._reactInternals=g,Cp(g,b,m,E),g=tr(null,g,b,!0,U,E)):(g.tag=0,Xn&&U&&Rp(g),ti(null,g,L,E),g=g.child),g;case 16:b=g.elementType;e:{switch(m!==null&&(m.alternate=null,g.alternate=null,g.flags|=2),m=g.pendingProps,L=b._init,b=L(b._payload),g.type=b,L=g.tag=m_(b),m=Mr(b,m),L){case 0:g=Uo(null,g,b,m,E);break e;case 1:g=ll(null,g,b,m,E);break e;case 11:g=Gn(null,g,b,m,E);break e;case 14:g=Bn(null,g,b,Mr(b.type,m),E);break e}throw Error(o(306,b,""))}return g;case 0:return b=g.type,L=g.pendingProps,L=g.elementType===b?L:Mr(b,L),Uo(m,g,b,L,E);case 1:return b=g.type,L=g.pendingProps,L=g.elementType===b?L:Mr(b,L),ll(m,g,b,L,E);case 3:e:{if(Eu(g),m===null)throw Error(o(387));b=g.pendingProps,U=g.memoizedState,L=U.element,wp(m,g),xd(g,b,null,E);var ee=g.memoizedState;if(b=ee.element,Ge&&U.isDehydrated)if(U={element:b,isDehydrated:!1,cache:ee.cache,transitions:ee.transitions},g.updateQueue.baseState=U,g.memoizedState=U,g.flags&256){L=Error(o(423)),g=Wp(m,g,b,E,L);break e}else if(b!==L){L=Error(o(424)),g=Wp(m,g,b,E,L);break e}else for(Ge&&(Hi=td(g.stateNode.containerInfo),yr=g,Xn=!0,ds=null,sc=!1),E=tg(g,null,b,E),g.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling;else{if(oc(),b===L){g=Rr(m,g,E);break e}ti(m,g,b,E)}g=g.child}return g;case 5:return ng(g),m===null&&ma(g),b=g.type,L=g.pendingProps,U=m!==null?m.memoizedProps:null,ee=L.children,ye(b,L)?ee=null:U!==null&&ye(b,U)&&(g.flags|=32),vr(m,g),ti(m,g,ee,E),g.child;case 6:return m===null&&ma(g),null;case 13:return Kp(m,g,E);case 4:return wd(g,g.stateNode.containerInfo),b=g.pendingProps,m===null?g.child=Oo(g,null,b,E):ti(m,g,b,E),g.child;case 11:return b=g.type,L=g.pendingProps,L=g.elementType===b?L:Mr(b,L),Gn(m,g,b,L,E);case 7:return ti(m,g,g.pendingProps,E),g.child;case 8:return ti(m,g,g.pendingProps.children,E),g.child;case 12:return ti(m,g,g.pendingProps.children,E),g.child;case 10:e:{if(b=g.type._context,L=g.pendingProps,U=g.memoizedProps,ee=L.value,Ja(g,b,ee),U!==null)if(mr(U.value,ee)){if(U.children===L.children&&!Jt.current){g=Rr(m,g,E);break e}}else for(U=g.child,U!==null&&(U.return=g);U!==null;){var pe=U.dependencies;if(pe!==null){ee=U.child;for(var Oe=pe.firstContext;Oe!==null;){if(Oe.context===b){if(U.tag===1){Oe=Lo(-1,E&-E),Oe.tag=2;var Qe=U.updateQueue;if(Qe!==null){Qe=Qe.shared;var Tt=Qe.pending;Tt===null?Oe.next=Oe:(Oe.next=Tt.next,Tt.next=Oe),Qe.pending=Oe}}U.lanes|=E,Oe=U.alternate,Oe!==null&&(Oe.lanes|=E),qa(U.return,E,g),pe.lanes|=E;break}Oe=Oe.next}}else if(U.tag===10)ee=U.type===g.type?null:U.child;else if(U.tag===18){if(ee=U.return,ee===null)throw Error(o(341));ee.lanes|=E,pe=ee.alternate,pe!==null&&(pe.lanes|=E),qa(ee,E,g),ee=U.sibling}else ee=U.child;if(ee!==null)ee.return=U;else for(ee=U;ee!==null;){if(ee===g){ee=null;break}if(U=ee.sibling,U!==null){U.return=ee.return,ee=U;break}ee=ee.return}U=ee}ti(m,g,L.children,E),g=g.child}return g;case 9:return L=g.type,b=g.pendingProps.children,nc(g,E),L=br(L),b=b(L),g.flags|=1,ti(m,g,b,E),g.child;case 14:return b=g.type,L=Mr(b,g.pendingProps),L=Mr(b.type,L),Bn(m,g,b,L,E);case 15:return No(m,g,g.type,g.pendingProps,E);case 17:return b=g.type,L=g.pendingProps,L=g.elementType===b?L:Mr(b,L),m!==null&&(m.alternate=null,g.alternate=null,g.flags|=2),g.tag=1,$t(b)?(m=!0,to(g)):m=!1,nc(g,E),J0(g,b,L),Cp(g,b,L,E),tr(null,g,b,!0,m,E);case 19:return ul(m,g,E);case 22:return zi(m,g,E)}throw Error(o(156,g.tag))};function $d(m,g){return Xa(m,g)}function fg(m,g,E,b){this.tag=m,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jr(m,g,E,b){return new fg(m,g,E,b)}function Yd(m){return m=m.prototype,!(!m||!m.isReactComponent)}function m_(m){if(typeof m=="function")return Yd(m)?1:0;if(m!=null){if(m=m.$$typeof,m===_)return 11;if(m===w)return 14}return 2}function Xo(m,g){var E=m.alternate;return E===null?(E=Jr(m.tag,g,m.key,m.mode),E.elementType=m.elementType,E.type=m.type,E.stateNode=m.stateNode,E.alternate=m,m.alternate=E):(E.pendingProps=g,E.type=m.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=m.flags&14680064,E.childLanes=m.childLanes,E.lanes=m.lanes,E.child=m.child,E.memoizedProps=m.memoizedProps,E.memoizedState=m.memoizedState,E.updateQueue=m.updateQueue,g=m.dependencies,E.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},E.sibling=m.sibling,E.index=m.index,E.ref=m.ref,E}function Jd(m,g,E,b,L,U){var ee=2;if(b=m,typeof m=="function")Yd(m)&&(ee=1);else if(typeof m=="string")ee=5;else e:switch(m){case h:return Sl(E.children,L,U,g);case f:ee=8,L|=8;break;case p:return m=Jr(12,E,g,L|2),m.elementType=p,m.lanes=U,m;case S:return m=Jr(13,E,g,L),m.elementType=S,m.lanes=U,m;case A:return m=Jr(19,E,g,L),m.elementType=A,m.lanes=U,m;case C:return Uu(E,L,U,g);default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case y:ee=10;break e;case v:ee=9;break e;case _:ee=11;break e;case w:ee=14;break e;case M:ee=16,b=null;break e}throw Error(o(130,m==null?m:typeof m,""))}return g=Jr(ee,E,g,L),g.elementType=m,g.type=b,g.lanes=U,g}function Sl(m,g,E,b){return m=Jr(7,m,b,g),m.lanes=E,m}function Uu(m,g,E,b){return m=Jr(22,m,b,g),m.elementType=C,m.lanes=E,m.stateNode={},m}function qd(m,g,E){return m=Jr(6,m,null,g),m.lanes=E,m}function Qd(m,g,E){return g=Jr(4,m.children!==null?m.children:[],m.key,g),g.lanes=E,g.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},g}function Zd(m,g,E,b,L){this.tag=g,this.containerInfo=m,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ze,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cd(0),this.expirationTimes=cd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cd(0),this.identifierPrefix=b,this.onRecoverableError=L,Ge&&(this.mutableSourceEagerHydrationData=null)}function pg(m,g,E,b,L,U,ee,pe,Oe){return m=new Zd(m,g,E,pe,Oe),g===1?(g=1,U===!0&&(g|=8)):g=0,U=Jr(3,null,null,g),m.current=U,U.stateNode=m,U.memoizedState={element:b,isDehydrated:E,cache:null,transitions:null},ic(U),m}function mg(m){if(!m)return dn;m=m._reactInternals;e:{if(B(m)!==m||m.tag!==1)throw Error(o(170));var g=m;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if($t(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(o(171))}if(m.tag===1){var E=m.type;if($t(E))return Qi(m,E,g)}return g}function gg(m){var g=m._reactInternals;if(g===void 0)throw typeof m.render=="function"?Error(o(188)):(m=Object.keys(m).join(","),Error(o(268,m)));return m=Z(g),m===null?null:m.stateNode}function ms(m,g){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var E=m.retryLane;m.retryLane=E!==0&&E<g?E:g}}function Gu(m,g){ms(m,g),(m=m.alternate)&&ms(m,g)}function ef(m){return m=Z(m),m===null?null:m.stateNode}function yg(){return null}return t.attemptContinuousHydration=function(m){if(m.tag===13){var g=En();ir(m,134217728,g),Gu(m,134217728)}},t.attemptHydrationAtCurrentPriority=function(m){if(m.tag===13){var g=En(),E=Ns(m);ir(m,E,g),Gu(m,E)}},t.attemptSynchronousHydration=function(m){switch(m.tag){case 3:var g=m.stateNode;if(g.current.memoizedState.isDehydrated){var E=ec(g.pendingLanes);E!==0&&(io(g,E|1),Ir(g,Ei()),!(sn&6)&&(vl(),ls()))}break;case 13:var b=En();Ec(function(){return ir(m,1,b)}),Gu(m,1)}},t.batchedUpdates=function(m,g){var E=sn;sn|=1;try{return m(g)}finally{sn=E,sn===0&&(vl(),fd&&ls())}},t.createComponentSelector=function(m){return{$$typeof:Ru,value:m}},t.createContainer=function(m,g,E,b,L,U,ee){return pg(m,g,!1,null,E,b,L,U,ee)},t.createHasPseudoClassSelector=function(m){return{$$typeof:fl,value:m}},t.createHydrationContainer=function(m,g,E,b,L,U,ee,pe,Oe){return m=pg(E,b,!0,m,L,U,ee,pe,Oe),m.context=mg(null),E=m.current,b=En(),L=Ns(E),U=Lo(b,L),U.callback=g??null,fa(E,U),m.current.lanes=L,Ka(m,L,b),Ir(m,b),m},t.createPortal=function(m,g,E){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:b==null?null:""+b,children:m,containerInfo:g,implementation:E}},t.createRoleSelector=function(m){return{$$typeof:pl,value:m}},t.createTestNameSelector=function(m){return{$$typeof:zo,value:m}},t.createTextSelector=function(m){return{$$typeof:xc,value:m}},t.deferredUpdates=function(m){var g=pn,E=Pn.transition;try{return Pn.transition=null,pn=16,m()}finally{pn=g,Pn.transition=E}},t.discreteUpdates=function(m,g,E,b,L){var U=pn,ee=Pn.transition;try{return Pn.transition=null,pn=1,m(g,E,b,L)}finally{pn=U,Pn.transition=ee,sn===0&&vl()}},t.findAllNodes=jo,t.findBoundingRects=function(m,g){if(!tt)throw Error(o(363));g=jo(m,g),m=[];for(var E=0;E<g.length;E++)m.push(V(g[E]));for(g=m.length-1;0<g;g--){E=m[g];for(var b=E.x,L=b+E.width,U=E.y,ee=U+E.height,pe=g-1;0<=pe;pe--)if(g!==pe){var Oe=m[pe],Qe=Oe.x,Tt=Qe+Oe.width,Zt=Oe.y,Ut=Zt+Oe.height;if(b>=Qe&&U>=Zt&&L<=Tt&&ee<=Ut){m.splice(g,1);break}else if(b!==Qe||E.width!==Oe.width||Ut<U||Zt>ee){if(!(U!==Zt||E.height!==Oe.height||Tt<b||Qe>L)){Qe>b&&(Oe.width+=Qe-b,Oe.x=b),Tt<L&&(Oe.width=L-Qe),m.splice(g,1);break}}else{Zt>U&&(Oe.height+=Zt-U,Oe.y=U),Ut<ee&&(Oe.height=ee-Zt),m.splice(g,1);break}}}return m},t.findHostInstance=gg,t.findHostInstanceWithNoPortals=function(m){return m=G(m),m=m!==null?se(m):null,m===null?null:m.stateNode},t.findHostInstanceWithWarning=function(m){return gg(m)},t.flushControlled=function(m){var g=sn;sn|=1;var E=Pn.transition,b=pn;try{Pn.transition=null,pn=1,m()}finally{pn=b,Pn.transition=E,sn=g,sn===0&&(vl(),ls())}},t.flushPassiveEffects=uo,t.flushSync=Ec,t.focusWithin=function(m,g){if(!tt)throw Error(o(363));for(m=Iu(m),g=Xr(m,g),g=Array.from(g),m=0;m<g.length;){var E=g[m++];if(!De(E)){if(E.tag===5&&Fe(E.stateNode))return!0;for(E=E.child;E!==null;)g.push(E),E=E.sibling}}return!1},t.getCurrentUpdatePriority=function(){return pn},t.getFindAllNodesFailureDescription=function(m,g){if(!tt)throw Error(o(363));var E=0,b=[];m=[Iu(m),0];for(var L=0;L<m.length;){var U=m[L++],ee=m[L++],pe=g[ee];if((U.tag!==5||!De(U))&&(Lu(U,pe)&&(b.push(Sa(pe)),ee++,ee>E&&(E=ee)),ee<g.length))for(U=U.child;U!==null;)m.push(U,ee),U=U.sibling}if(E<g.length){for(m=[];E<g.length;E++)m.push(Sa(g[E]));return`findAllNodes was able to match part of the selector:
  `+(b.join(" > ")+`

No matching component was found for:
  `)+m.join(" > ")}return null},t.getPublicRootInstance=function(m){if(m=m.current,!m.child)return null;switch(m.child.tag){case 5:return re(m.child.stateNode);default:return m.child.stateNode}},t.injectIntoDevTools=function(m){if(m={bundleType:m.bundleType,version:m.version,rendererPackageName:m.rendererPackageName,rendererConfig:m.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:ef,findFiberByHostInstance:m.findFiberByHostInstance||yg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")m=!1;else{var g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(g.isDisabled||!g.supportsFiber)m=!0;else{try{lu=g.inject(m),ro=g}catch{}m=!!g.checkDCE}}return m},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(m,g,E,b){if(!tt)throw Error(o(363));m=jo(m,g);var L=ht(m,E,b).disconnect;return{disconnect:function(){L()}}},t.registerMutableSourceForHydration=function(m,g){var E=g._getVersion;E=E(g._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[g,E]:m.mutableSourceEagerHydrationData.push(g,E)},t.runWithPriority=function(m,g){var E=pn;try{return pn=m,g()}finally{pn=E}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(m,g,E,b){var L=g.current,U=En(),ee=Ns(L);return E=mg(E),g.context===null?g.context=E:g.pendingContext=E,g=Lo(U,ee),g.payload={element:m},b=b===void 0?null:b,b!==null&&(g.callback=b),fa(L,g),m=ir(L,ee,U),m!==null&&yd(m,L,ee),ee},t}),N1}var QM;function n6(){return QM||(QM=1,B1.exports=t6()),B1.exports}var i6=n6();const r6=_x(i6);var U1={exports:{}},G1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZM;function s6(){return ZM||(ZM=1,function(s){function e(H,$){var X=H.length;H.push($);e:for(;0<X;){var W=X-1>>>1,ne=H[W];if(0<i(ne,$))H[W]=$,H[X]=ne,X=W;else break e}}function t(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var $=H[0],X=H.pop();if(X!==$){H[0]=X;e:for(var W=0,ne=H.length,Ee=ne>>>1;W<Ee;){var le=2*(W+1)-1,ye=H[le],we=le+1,Ie=H[we];if(0>i(ye,X))we<ne&&0>i(Ie,ye)?(H[W]=Ie,H[we]=X,W=we):(H[W]=ye,H[le]=X,W=le);else if(we<ne&&0>i(Ie,X))H[W]=Ie,H[we]=X,W=we;else break e}}return $}function i(H,$){var X=H.sortIndex-$.sortIndex;return X!==0?X:H.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;s.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();s.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,f=null,p=3,y=!1,v=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(H){for(var $=t(c);$!==null;){if($.callback===null)n(c);else if($.startTime<=H)n(c),$.sortIndex=$.expirationTime,e(l,$);else break;$=t(c)}}function C(H){if(_=!1,M(H),!v)if(t(l)!==null)v=!0,re(I);else{var $=t(c);$!==null&&ce(C,$.startTime-H)}}function I(H,$){v=!1,_&&(_=!1,A(N),N=-1),y=!0;var X=p;try{for(M($),f=t(l);f!==null&&(!(f.expirationTime>$)||H&&!G());){var W=f.callback;if(typeof W=="function"){f.callback=null,p=f.priorityLevel;var ne=W(f.expirationTime<=$);$=s.unstable_now(),typeof ne=="function"?f.callback=ne:f===t(l)&&n(l),M($)}else n(l);f=t(l)}if(f!==null)var Ee=!0;else{var le=t(c);le!==null&&ce(C,le.startTime-$),Ee=!1}return Ee}finally{f=null,p=X,y=!1}}var O=!1,k=null,N=-1,B=5,P=-1;function G(){return!(s.unstable_now()-P<B)}function Z(){if(k!==null){var H=s.unstable_now();P=H;var $=!0;try{$=k(!0,H)}finally{$?Y():(O=!1,k=null)}}else O=!1}var Y;if(typeof w=="function")Y=function(){w(Z)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,oe=se.port2;se.port1.onmessage=Z,Y=function(){oe.postMessage(null)}}else Y=function(){S(Z,0)};function re(H){k=H,O||(O=!0,Y())}function ce(H,$){N=S(function(){H(s.unstable_now())},$)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(H){H.callback=null},s.unstable_continueExecution=function(){v||y||(v=!0,re(I))},s.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<H?Math.floor(1e3/H):5},s.unstable_getCurrentPriorityLevel=function(){return p},s.unstable_getFirstCallbackNode=function(){return t(l)},s.unstable_next=function(H){switch(p){case 1:case 2:case 3:var $=3;break;default:$=p}var X=p;p=$;try{return H()}finally{p=X}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(H,$){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var X=p;p=H;try{return $()}finally{p=X}},s.unstable_scheduleCallback=function(H,$,X){var W=s.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?W+X:W):X=W,H){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=X+ne,H={id:h++,callback:$,priorityLevel:H,startTime:X,expirationTime:ne,sortIndex:-1},X>W?(H.sortIndex=X,e(c,H),t(l)===null&&H===t(c)&&(_?(A(N),N=-1):_=!0,ce(C,X-W))):(H.sortIndex=ne,e(l,H),v||y||(v=!0,re(I))),H},s.unstable_shouldYield=G,s.unstable_wrapCallback=function(H){var $=p;return function(){var X=p;p=$;try{return H.apply(this,arguments)}finally{p=X}}}}(G1)),G1}var e2;function o6(){return e2||(e2=1,U1.exports=s6()),U1.exports}var t2=o6();const DE={},a6=s=>void Object.assign(DE,s);function l6(s,e){function t(h,{args:f=[],attach:p,...y},v){let _=`${h[0].toUpperCase()}${h.slice(1)}`,S;if(h==="primitive"){if(y.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const A=y.object;S=Df(A,{type:h,root:v,attach:p,primitive:!0})}else{const A=DE[_];if(!A)throw new Error(`R3F: ${_} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(f))throw new Error("R3F: The args prop must be an array!");S=Df(new A(...f),{type:h,root:v,attach:p,memoizedProps:{args:f}})}return S.__r3f.attach===void 0&&(S instanceof rn?S.__r3f.attach="geometry":S instanceof Ui&&(S.__r3f.attach="material")),_!=="inject"&&j1(S,y),S}function n(h,f){let p=!1;if(f){var y,v;(y=f.__r3f)!=null&&y.attach?z1(h,f,f.__r3f.attach):f.isObject3D&&h.isObject3D&&(h.add(f),p=!0),p||(v=h.__r3f)==null||v.objects.push(f),f.__r3f||Df(f,{}),f.__r3f.parent=h,QS(f),Of(f)}}function i(h,f,p){let y=!1;if(f){var v,_;if((v=f.__r3f)!=null&&v.attach)z1(h,f,f.__r3f.attach);else if(f.isObject3D&&h.isObject3D){f.parent=h,f.dispatchEvent({type:"added"}),h.dispatchEvent({type:"childadded",child:f});const S=h.children.filter(w=>w!==f),A=S.indexOf(p);h.children=[...S.slice(0,A),f,...S.slice(A)],y=!0}y||(_=h.__r3f)==null||_.objects.push(f),f.__r3f||Df(f,{}),f.__r3f.parent=h,QS(f),Of(f)}}function r(h,f,p=!1){h&&[...h].forEach(y=>o(f,y,p))}function o(h,f,p){if(f){var y,v,_;if(f.__r3f&&(f.__r3f.parent=null),(y=h.__r3f)!=null&&y.objects&&(h.__r3f.objects=h.__r3f.objects.filter(C=>C!==f)),(v=f.__r3f)!=null&&v.attach)o2(h,f,f.__r3f.attach);else if(f.isObject3D&&h.isObject3D){var S;h.remove(f),(S=f.__r3f)!=null&&S.root&&y6(tv(f),f)}const w=(_=f.__r3f)==null?void 0:_.primitive,M=!w&&(p===void 0?f.dispose!==null:p);if(!w){var A;r((A=f.__r3f)==null?void 0:A.objects,f,M),r(f.children,f,M)}if(delete f.__r3f,M&&f.dispose&&f.type!=="Scene"){const C=()=>{try{f.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?t2.unstable_scheduleCallback(t2.unstable_IdlePriority,C):C()}Of(h)}}function a(h,f,p,y){var v;const _=(v=h.__r3f)==null?void 0:v.parent;if(!_)return;const S=t(f,p,h.__r3f.root);if(h.children){for(const A of h.children)A.__r3f&&n(S,A);h.children=h.children.filter(A=>!A.__r3f)}h.__r3f.objects.forEach(A=>n(S,A)),h.__r3f.objects=[],h.__r3f.autoRemovedBeforeAppend||o(_,h),S.parent&&(S.__r3f.autoRemovedBeforeAppend=!0),n(_,S),S.raycast&&S.__r3f.eventCount&&tv(S).getState().internal.interaction.push(S),[y,y.alternate].forEach(A=>{A!==null&&(A.stateNode=S,A.ref&&(typeof A.ref=="function"?A.ref(S):A.ref.current=S))})}const l=()=>{};return{reconciler:r6({createInstance:t,removeChild:o,appendChild:n,appendInitialChild:n,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(h,f)=>{if(!f)return;const p=h.getState().scene;p.__r3f&&(p.__r3f.root=h,n(p,f))},removeChildFromContainer:(h,f)=>{f&&o(h.getState().scene,f)},insertInContainerBefore:(h,f,p)=>{if(!f||!p)return;const y=h.getState().scene;y.__r3f&&i(y,f,p)},getRootHostContext:()=>null,getChildHostContext:h=>h,finalizeInitialChildren(h){var f;return!!((f=h==null?void 0:h.__r3f)!=null?f:{}).handlers},prepareUpdate(h,f,p,y){var v;if(((v=h==null?void 0:h.__r3f)!=null?v:{}).primitive&&y.object&&y.object!==h)return[!0];{const{args:S=[],children:A,...w}=y,{args:M=[],children:C,...I}=p;if(!Array.isArray(S))throw new Error("R3F: the args prop must be an array!");if(S.some((k,N)=>k!==M[N]))return[!0];const O=TI(h,w,I,!0);return O.changes.length?[!1,O]:null}},commitUpdate(h,[f,p],y,v,_,S){f?a(h,y,_,S):j1(h,p)},commitMount(h,f,p,y){var v;const _=(v=h.__r3f)!=null?v:{};h.raycast&&_.handlers&&_.eventCount&&tv(h).getState().internal.interaction.push(h)},getPublicInstance:h=>h,prepareForCommit:()=>null,preparePortalMount:h=>Df(h.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(h){var f;const{attach:p,parent:y}=(f=h.__r3f)!=null?f:{};p&&y&&o2(y,h,p),h.isObject3D&&(h.visible=!1),Of(h)},unhideInstance(h,f){var p;const{attach:y,parent:v}=(p=h.__r3f)!=null?p:{};y&&v&&z1(v,h,y),(h.isObject3D&&f.visible==null||f.visible)&&(h.visible=!0),Of(h)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():Uf.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Yn.fun(performance.now)?performance.now:Yn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Yn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Yn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:j1}}var n2,i2;const H1=s=>"colorSpace"in s||"outputColorSpace"in s,vI=()=>{var s;return(s=DE.ColorManagement)!=null?s:null},xI=s=>s&&s.isOrthographicCamera,c6=s=>s&&s.hasOwnProperty("current"),G0=typeof window<"u"&&((n2=window.document)!=null&&n2.createElement||((i2=window.navigator)==null?void 0:i2.product)==="ReactNative")?te.useLayoutEffect:te.useEffect;function _I(s){const e=te.useRef(s);return G0(()=>void(e.current=s),[s]),e}function u6({set:s}){return G0(()=>(s(new Promise(()=>null)),()=>s(!1)),[s]),null}class SI extends te.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}SI.getDerivedStateFromError=()=>({error:!0});const AI="__default",r2=new Map,h6=s=>s&&!!s.memoized&&!!s.changes;function EI(s){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(s)?Math.min(Math.max(s[0],t),s[1]):s}const Lm=s=>{var e;return(e=s.__r3f)==null?void 0:e.root.getState()};function tv(s){let e=s.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Yn={obj:s=>s===Object(s)&&!Yn.arr(s)&&typeof s!="function",fun:s=>typeof s=="function",str:s=>typeof s=="string",num:s=>typeof s=="number",boo:s=>typeof s=="boolean",und:s=>s===void 0,arr:s=>Array.isArray(s),equ(s,e,{arrays:t="shallow",objects:n="reference",strict:i=!0}={}){if(typeof s!=typeof e||!!s!=!!e)return!1;if(Yn.str(s)||Yn.num(s)||Yn.boo(s))return s===e;const r=Yn.obj(s);if(r&&n==="reference")return s===e;const o=Yn.arr(s);if(o&&t==="reference")return s===e;if((o||r)&&s===e)return!0;let a;for(a in s)if(!(a in e))return!1;if(r&&t==="shallow"&&n==="shallow"){for(a in i?e:s)if(!Yn.equ(s[a],e[a],{strict:i,objects:"reference"}))return!1}else for(a in i?e:s)if(s[a]!==e[a])return!1;if(Yn.und(a)){if(o&&s.length===0&&e.length===0||r&&Object.keys(s).length===0&&Object.keys(e).length===0)return!0;if(s!==e)return!1}return!0}};function d6(s){const e={nodes:{},materials:{}};return s&&s.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function f6(s){s.dispose&&s.type!=="Scene"&&s.dispose();for(const e in s)e.dispose==null||e.dispose(),delete s[e]}function Df(s,e){const t=s;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},s}function qS(s,e){let t=s;if(e.includes("-")){const n=e.split("-"),i=n.pop();return t=n.reduce((r,o)=>r[o],s),{target:t,key:i}}else return{target:t,key:e}}const s2=/-\d+$/;function z1(s,e,t){if(Yn.str(t)){if(s2.test(t)){const r=t.replace(s2,""),{target:o,key:a}=qS(s,r);Array.isArray(o[a])||(o[a]=[])}const{target:n,key:i}=qS(s,t);e.__r3f.previousAttach=n[i],n[i]=e}else e.__r3f.previousAttach=t(s,e)}function o2(s,e,t){var n,i;if(Yn.str(t)){const{target:r,key:o}=qS(s,t),a=e.__r3f.previousAttach;a===void 0?delete r[o]:r[o]=a}else(n=e.__r3f)==null||n.previousAttach==null||n.previousAttach(s,e);(i=e.__r3f)==null||delete i.previousAttach}function TI(s,{children:e,key:t,ref:n,...i},{children:r,key:o,ref:a,...l}={},c=!1){const h=s.__r3f,f=Object.entries(i),p=[];if(c){const v=Object.keys(l);for(let _=0;_<v.length;_++)i.hasOwnProperty(v[_])||f.unshift([v[_],AI+"remove"])}f.forEach(([v,_])=>{var S;if((S=s.__r3f)!=null&&S.primitive&&v==="object"||Yn.equ(_,l[v]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(v))return p.push([v,_,!0,[]]);let A=[];v.includes("-")&&(A=v.split("-")),p.push([v,_,!1,A]);for(const w in i){const M=i[w];w.startsWith(`${v}-`)&&p.push([w,M,!1,w.split("-")])}});const y={...i};return h!=null&&h.memoizedProps&&h!=null&&h.memoizedProps.args&&(y.args=h.memoizedProps.args),h!=null&&h.memoizedProps&&h!=null&&h.memoizedProps.attach&&(y.attach=h.memoizedProps.attach),{memoized:y,changes:p}}const p6=typeof process<"u"&&!1;function j1(s,e){var t;const n=s.__r3f,i=n==null?void 0:n.root,r=i==null||i.getState==null?void 0:i.getState(),{memoized:o,changes:a}=h6(e)?e:TI(s,e),l=n==null?void 0:n.eventCount;s.__r3f&&(s.__r3f.memoizedProps=o);for(let h=0;h<a.length;h++){let[f,p,y,v]=a[h];if(H1(s)){const w="srgb",M="srgb-linear";f==="encoding"?(f="colorSpace",p=p===3001?w:M):f==="outputEncoding"&&(f="outputColorSpace",p=p===3001?w:M)}let _=s,S=_[f];if(v.length&&(S=v.reduce((A,w)=>A[w],s),!(S&&S.set))){const[A,...w]=v.reverse();_=w.reverse().reduce((M,C)=>M[C],s),f=A}if(p===AI+"remove")if(_.constructor){let A=r2.get(_.constructor);A||(A=new _.constructor,r2.set(_.constructor,A)),p=A[f]}else p=0;if(y&&n)p?n.handlers[f]=p:delete n.handlers[f],n.eventCount=Object.keys(n.handlers).length;else if(S&&S.set&&(S.copy||S instanceof Ch)){if(Array.isArray(p))S.fromArray?S.fromArray(p):S.set(...p);else if(S.copy&&p&&p.constructor&&(p6?S.constructor.name===p.constructor.name:S.constructor===p.constructor))S.copy(p);else if(p!==void 0){const A=S instanceof ut;!A&&S.setScalar?S.setScalar(p):S instanceof Ch&&p instanceof Ch?S.mask=p.mask:S.set(p),!vI()&&r&&!r.linear&&A&&S.convertSRGBToLinear()}}else if(_[f]=p,_[f]instanceof ei&&_[f].format===Nr&&_[f].type===sa&&r){const A=_[f];H1(A)&&H1(r.gl)?A.colorSpace=r.gl.outputColorSpace:A.encoding=r.gl.outputEncoding}Of(s)}if(n&&n.parent&&s.raycast&&l!==n.eventCount){const h=tv(s).getState().internal,f=h.interaction.indexOf(s);f>-1&&h.interaction.splice(f,1),n.eventCount&&h.interaction.push(s)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=s.__r3f)!=null&&t.parent&&QS(s),s}function Of(s){var e,t;const n=(e=s.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function QS(s){s.onUpdate==null||s.onUpdate(s)}function m6(s,e){s.manual||(xI(s)?(s.left=e.width/-2,s.right=e.width/2,s.top=e.height/2,s.bottom=e.height/-2):s.aspect=e.width/e.height,s.updateProjectionMatrix(),s.updateMatrixWorld())}function Py(s){return(s.eventObject||s.object).uuid+"/"+s.index+s.instanceId}function g6(){var s;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Uf.DefaultEventPriority;switch((s=e.event)==null?void 0:s.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Uf.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Uf.ContinuousEventPriority;default:return Uf.DefaultEventPriority}}function wI(s,e,t,n){const i=t.get(e);i&&(t.delete(e),t.size===0&&(s.delete(n),i.target.releasePointerCapture(n)))}function y6(s,e){const{internal:t}=s.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,i)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((n,i)=>{wI(t.capturedMap,e,n,i)})}function v6(s){function e(l){const{internal:c}=s.getState(),h=l.offsetX-c.initialClick[0],f=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(h*h+f*f))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(h=>{var f;return(f=c.__r3f)==null?void 0:f.handlers["onPointer"+h]}))}function n(l,c){const h=s.getState(),f=new Set,p=[],y=c?c(h.internal.interaction):h.internal.interaction;for(let A=0;A<y.length;A++){const w=Lm(y[A]);w&&(w.raycaster.camera=void 0)}h.previousRoot||h.events.compute==null||h.events.compute(l,h);function v(A){const w=Lm(A);if(!w||!w.events.enabled||w.raycaster.camera===null)return[];if(w.raycaster.camera===void 0){var M;w.events.compute==null||w.events.compute(l,w,(M=w.previousRoot)==null?void 0:M.getState()),w.raycaster.camera===void 0&&(w.raycaster.camera=null)}return w.raycaster.camera?w.raycaster.intersectObject(A,!0):[]}let _=y.flatMap(v).sort((A,w)=>{const M=Lm(A.object),C=Lm(w.object);return!M||!C?A.distance-w.distance:C.events.priority-M.events.priority||A.distance-w.distance}).filter(A=>{const w=Py(A);return f.has(w)?!1:(f.add(w),!0)});h.events.filter&&(_=h.events.filter(_,h));for(const A of _){let w=A.object;for(;w;){var S;(S=w.__r3f)!=null&&S.eventCount&&p.push({...A,eventObject:w}),w=w.parent}}if("pointerId"in l&&h.internal.capturedMap.has(l.pointerId))for(let A of h.internal.capturedMap.get(l.pointerId).values())f.has(Py(A.intersection))||p.push(A.intersection);return p}function i(l,c,h,f){const p=s.getState();if(l.length){const y={stopped:!1};for(const v of l){const _=Lm(v.object)||p,{raycaster:S,pointer:A,camera:w,internal:M}=_,C=new J(A.x,A.y,0).unproject(w),I=P=>{var G,Z;return(G=(Z=M.capturedMap.get(P))==null?void 0:Z.has(v.eventObject))!=null?G:!1},O=P=>{const G={intersection:v,target:c.target};M.capturedMap.has(P)?M.capturedMap.get(P).set(v.eventObject,G):M.capturedMap.set(P,new Map([[v.eventObject,G]])),c.target.setPointerCapture(P)},k=P=>{const G=M.capturedMap.get(P);G&&wI(M.capturedMap,v.eventObject,G,P)};let N={};for(let P in c){let G=c[P];typeof G!="function"&&(N[P]=G)}let B={...v,...N,pointer:A,intersections:l,stopped:y.stopped,delta:h,unprojectedPoint:C,ray:S.ray,camera:w,stopPropagation(){const P="pointerId"in c&&M.capturedMap.get(c.pointerId);if((!P||P.has(v.eventObject))&&(B.stopped=y.stopped=!0,M.hovered.size&&Array.from(M.hovered.values()).find(G=>G.eventObject===v.eventObject))){const G=l.slice(0,l.indexOf(v));r([...G,v])}},target:{hasPointerCapture:I,setPointerCapture:O,releasePointerCapture:k},currentTarget:{hasPointerCapture:I,setPointerCapture:O,releasePointerCapture:k},nativeEvent:c};if(f(B),y.stopped===!0)break}}return l}function r(l){const{internal:c}=s.getState();for(const h of c.hovered.values())if(!l.length||!l.find(f=>f.object===h.object&&f.index===h.index&&f.instanceId===h.instanceId)){const p=h.eventObject.__r3f,y=p==null?void 0:p.handlers;if(c.hovered.delete(Py(h)),p!=null&&p.eventCount){const v={...h,intersections:l};y.onPointerOut==null||y.onPointerOut(v),y.onPointerLeave==null||y.onPointerLeave(v)}}}function o(l,c){for(let h=0;h<c.length;h++){const f=c[h].__r3f;f==null||f.handlers.onPointerMissed==null||f.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return c=>{const{internal:h}=s.getState();"pointerId"in c&&h.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{h.capturedMap.has(c.pointerId)&&(h.capturedMap.delete(c.pointerId),r([]))})}}return function(h){const{onPointerMissed:f,internal:p}=s.getState();p.lastEvent.current=h;const y=l==="onPointerMove",v=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",S=n(h,y?t:void 0),A=v?e(h):0;l==="onPointerDown"&&(p.initialClick=[h.offsetX,h.offsetY],p.initialHits=S.map(M=>M.eventObject)),v&&!S.length&&A<=2&&(o(h,p.interaction),f&&f(h)),y&&r(S);function w(M){const C=M.eventObject,I=C.__r3f,O=I==null?void 0:I.handlers;if(I!=null&&I.eventCount)if(y){if(O.onPointerOver||O.onPointerEnter||O.onPointerOut||O.onPointerLeave){const k=Py(M),N=p.hovered.get(k);N?N.stopped&&M.stopPropagation():(p.hovered.set(k,M),O.onPointerOver==null||O.onPointerOver(M),O.onPointerEnter==null||O.onPointerEnter(M))}O.onPointerMove==null||O.onPointerMove(M)}else{const k=O[l];k?(!v||p.initialHits.includes(C))&&(o(h,p.interaction.filter(N=>!p.initialHits.includes(N))),k(M)):v&&p.initialHits.includes(C)&&o(h,p.interaction.filter(N=>!p.initialHits.includes(N)))}}i(S,h,A,w)}}return{handlePointer:a}}const MI=s=>!!(s!=null&&s.render),bI=te.createContext(null),x6=(s,e)=>{const t=Y8((a,l)=>{const c=new J,h=new J,f=new J;function p(A=l().camera,w=h,M=l().size){const{width:C,height:I,top:O,left:k}=M,N=C/I;w instanceof J?f.copy(w):f.set(...w);const B=A.getWorldPosition(c).distanceTo(f);if(xI(A))return{width:C/A.zoom,height:I/A.zoom,top:O,left:k,factor:1,distance:B,aspect:N};{const P=A.fov*Math.PI/180,G=2*Math.tan(P/2)*B,Z=G*(C/I);return{width:Z,height:G,top:O,left:k,factor:C/Z,distance:B,aspect:N}}}let y;const v=A=>a(w=>({performance:{...w.performance,current:A}})),_=new Ue;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(A=1)=>s(l(),A),advance:(A,w)=>e(A,w,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new bE,pointer:_,mouse:_,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const A=l();y&&clearTimeout(y),A.performance.current!==A.performance.min&&v(A.performance.min),y=setTimeout(()=>v(l().performance.max),A.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:p},setEvents:A=>a(w=>({...w,events:{...w.events,...A}})),setSize:(A,w,M,C,I)=>{const O=l().camera,k={width:A,height:w,top:C||0,left:I||0,updateStyle:M};a(N=>({size:k,viewport:{...N.viewport,...p(O,h,k)}}))},setDpr:A=>a(w=>{const M=EI(A);return{viewport:{...w.viewport,dpr:M,initialDpr:w.viewport.initialDpr||M}}}),setFrameloop:(A="always")=>{const w=l().clock;w.stop(),w.elapsedTime=0,A!=="never"&&(w.start(),w.elapsedTime=0),a(()=>({frameloop:A}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:te.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(A,w,M)=>{const C=l().internal;return C.priority=C.priority+(w>0?1:0),C.subscribers.push({ref:A,priority:w,store:M}),C.subscribers=C.subscribers.sort((I,O)=>I.priority-O.priority),()=>{const I=l().internal;I!=null&&I.subscribers&&(I.priority=I.priority-(w>0?1:0),I.subscribers=I.subscribers.filter(O=>O.ref!==A))}}}}}),n=t.getState();let i=n.size,r=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:h,set:f}=t.getState();if(l.width!==i.width||l.height!==i.height||c.dpr!==r){var p;i=l,r=c.dpr,m6(a,l),h.setPixelRatio(c.dpr);const y=(p=l.updateStyle)!=null?p:typeof HTMLCanvasElement<"u"&&h.domElement instanceof HTMLCanvasElement;h.setSize(l.width,l.height,y)}a!==o&&(o=a,f(y=>({viewport:{...y.viewport,...y.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>s(a)),t};let Dy,_6=new Set,S6=new Set,A6=new Set;function V1(s,e){if(s.size)for(const{callback:t}of s.values())t(e)}function Pm(s,e){switch(s){case"before":return V1(_6,e);case"after":return V1(S6,e);case"tail":return V1(A6,e)}}let W1,K1;function X1(s,e,t){let n=e.clock.getDelta();for(e.frameloop==="never"&&typeof s=="number"&&(n=s-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=s),W1=e.internal.subscribers,Dy=0;Dy<W1.length;Dy++)K1=W1[Dy],K1.ref.current(K1.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function E6(s){let e=!1,t=!1,n,i,r;function o(c){i=requestAnimationFrame(o),e=!0,n=0,Pm("before",c),t=!0;for(const f of s.values()){var h;r=f.store.getState(),r.internal.active&&(r.frameloop==="always"||r.internal.frames>0)&&!((h=r.gl.xr)!=null&&h.isPresenting)&&(n+=X1(c,r))}if(t=!1,Pm("after",c),n===0)return Pm("tail",c),e=!1,cancelAnimationFrame(i)}function a(c,h=1){var f;if(!c)return s.forEach(p=>a(p.store.getState(),h));(f=c.gl.xr)!=null&&f.isPresenting||!c.internal.active||c.frameloop==="never"||(h>1?c.internal.frames=Math.min(60,c.internal.frames+h):t?c.internal.frames=2:c.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(c,h=!0,f,p){if(h&&Pm("before",c),f)X1(c,f,p);else for(const y of s.values())X1(c,y.store.getState());h&&Pm("after",c)}return{loop:o,invalidate:a,advance:l}}function CI(){const s=te.useContext(bI);if(!s)throw new Error("R3F: Hooks can only be used within the Canvas component!");return s}function ki(s=t=>t,e){return CI()(s,e)}function OE(s,e=0){const t=CI(),n=t.getState().internal.subscribe,i=_I(s);return G0(()=>n(i,e,t),[e,n,t]),null}const a2=new WeakMap;function RI(s,e){return function(t,...n){let i=a2.get(t);return i||(i=new t,a2.set(t,i)),s&&s(i),Promise.all(n.map(r=>new Promise((o,a)=>i.load(r,l=>{l.scene&&Object.assign(l,d6(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${r}: ${l==null?void 0:l.message}`))))))}}function H0(s,e,t,n){const i=Array.isArray(e)?e:[e],r=yI(RI(t,n),[s,...i],{equal:Yn.equ});return Array.isArray(e)?r:r[0]}H0.preload=function(s,e,t){const n=Array.isArray(e)?e:[e];return q8(RI(t),[s,...n])};H0.clear=function(s,e){const t=Array.isArray(e)?e:[e];return Q8([s,...t])};const ip=new Map,{invalidate:l2,advance:c2}=E6(ip),{reconciler:ex,applyProps:Tf}=l6(ip,g6),wf={objects:"shallow",strict:!1},T6=(s,e)=>{const t=typeof s=="function"?s(e):s;return MI(t)?t:new pI({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...s})};function w6(s,e){const t=typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement;if(e){const{width:n,height:i,top:r,left:o,updateStyle:a=t}=e;return{width:n,height:i,top:r,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&s.parentElement){const{width:n,height:i,top:r,left:o}=s.parentElement.getBoundingClientRect();return{width:n,height:i,top:r,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas)return{width:s.width,height:s.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function M6(s){const e=ip.get(s),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,r=n||x6(l2,c2),o=t||ex.createContainer(r,Uf.ConcurrentRoot,null,!1,null,"",i,null);e||ip.set(s,{fiber:o,store:r});let a,l=!1,c;return{configure(h={}){let{gl:f,size:p,scene:y,events:v,onCreated:_,shadows:S=!1,linear:A=!1,flat:w=!1,legacy:M=!1,orthographic:C=!1,frameloop:I="always",dpr:O=[1,2],performance:k,raycaster:N,camera:B,onPointerMissed:P}=h,G=r.getState(),Z=G.gl;G.gl||G.set({gl:Z=T6(f,s)});let Y=G.raycaster;Y||G.set({raycaster:Y=new oI});const{params:se,...oe}=N||{};if(Yn.equ(oe,Y,wf)||Tf(Y,{...oe}),Yn.equ(se,Y.params,wf)||Tf(Y,{params:{...Y.params,...se}}),!G.camera||G.camera===c&&!Yn.equ(c,B,wf)){c=B;const X=B instanceof L0,W=X?B:C?new ra(0,0,0,0,.1,1e3):new si(75,0,.1,1e3);X||(W.position.z=5,B&&(Tf(W,B),("aspect"in B||"left"in B||"right"in B||"bottom"in B||"top"in B)&&(W.manual=!0,W.updateProjectionMatrix())),!G.camera&&!(B!=null&&B.rotation)&&W.lookAt(0,0,0)),G.set({camera:W}),Y.camera=W}if(!G.scene){let X;y instanceof Jv?X=y:(X=new Jv,y&&Tf(X,y)),G.set({scene:Df(X)})}if(!G.xr){var re;const X=(Ee,le)=>{const ye=r.getState();ye.frameloop!=="never"&&c2(Ee,!0,ye,le)},W=()=>{const Ee=r.getState();Ee.gl.xr.enabled=Ee.gl.xr.isPresenting,Ee.gl.xr.setAnimationLoop(Ee.gl.xr.isPresenting?X:null),Ee.gl.xr.isPresenting||l2(Ee)},ne={connect(){const Ee=r.getState().gl;Ee.xr.addEventListener("sessionstart",W),Ee.xr.addEventListener("sessionend",W)},disconnect(){const Ee=r.getState().gl;Ee.xr.removeEventListener("sessionstart",W),Ee.xr.removeEventListener("sessionend",W)}};typeof((re=Z.xr)==null?void 0:re.addEventListener)=="function"&&ne.connect(),G.set({xr:ne})}if(Z.shadowMap){const X=Z.shadowMap.enabled,W=Z.shadowMap.type;if(Z.shadowMap.enabled=!!S,Yn.boo(S))Z.shadowMap.type=zm;else if(Yn.str(S)){var ce;const ne={basic:EC,percentage:Ex,soft:zm,variance:na};Z.shadowMap.type=(ce=ne[S])!=null?ce:zm}else Yn.obj(S)&&Object.assign(Z.shadowMap,S);(X!==Z.shadowMap.enabled||W!==Z.shadowMap.type)&&(Z.shadowMap.needsUpdate=!0)}const H=vI();H&&("enabled"in H?H.enabled=!M:"legacyMode"in H&&(H.legacyMode=M)),l||Tf(Z,{outputEncoding:A?3e3:3001,toneMapping:w?Oa:GA}),G.legacy!==M&&G.set(()=>({legacy:M})),G.linear!==A&&G.set(()=>({linear:A})),G.flat!==w&&G.set(()=>({flat:w})),f&&!Yn.fun(f)&&!MI(f)&&!Yn.equ(f,Z,wf)&&Tf(Z,f),v&&!G.events.handlers&&G.set({events:v(r)});const $=w6(s,p);return Yn.equ($,G.size,wf)||G.setSize($.width,$.height,$.updateStyle,$.top,$.left),O&&G.viewport.dpr!==EI(O)&&G.setDpr(O),G.frameloop!==I&&G.setFrameloop(I),G.onPointerMissed||G.set({onPointerMissed:P}),k&&!Yn.equ(k,G.performance,wf)&&G.set(X=>({performance:{...X.performance,...k}})),a=_,l=!0,this},render(h){return l||this.configure(),ex.updateContainer(F.jsx(b6,{store:r,children:h,onCreated:a,rootElement:s}),o,null,()=>{}),r},unmount(){II(s)}}}function b6({store:s,children:e,onCreated:t,rootElement:n}){return G0(()=>{const i=s.getState();i.set(r=>({internal:{...r.internal,active:!0}})),t&&t(i),s.getState().events.connected||i.events.connect==null||i.events.connect(n)},[]),F.jsx(bI.Provider,{value:s,children:e})}function II(s,e){const t=ip.get(s),n=t==null?void 0:t.fiber;if(n){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),ex.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{var r,o,a,l;i.events.disconnect==null||i.events.disconnect(),(r=i.gl)==null||(o=r.renderLists)==null||o.dispose==null||o.dispose(),(a=i.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),f6(i),ip.delete(s)}catch{}},500)})}}ex.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:te.version});const $1={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function C6(s){const{handlePointer:e}=v6(s);return{priority:1,enabled:!0,compute(t,n,i){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys($1).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:i}=s.getState();(t=i.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var n;const{set:i,events:r}=s.getState();r.disconnect==null||r.disconnect(),i(o=>({events:{...o.events,connected:t}})),Object.entries((n=r.handlers)!=null?n:[]).forEach(([o,a])=>{const[l,c]=$1[o];t.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:t,events:n}=s.getState();if(n.connected){var i;Object.entries((i=n.handlers)!=null?i:[]).forEach(([r,o])=>{if(n&&n.connected instanceof HTMLElement){const[a]=$1[r];n.connected.removeEventListener(a,o)}}),t(r=>({events:{...r.events,connected:void 0}}))}}}}var Y1,u2;function R6(){if(u2)return Y1;u2=1;function s(e,t,n){var i,r,o,a,l;t==null&&(t=100);function c(){var f=Date.now()-a;f<t&&f>=0?i=setTimeout(c,t-f):(i=null,n||(l=e.apply(o,r),o=r=null))}var h=function(){o=this,r=arguments,a=Date.now();var f=n&&!i;return i||(i=setTimeout(c,t)),f&&(l=e.apply(o,r),o=r=null),l};return h.clear=function(){i&&(clearTimeout(i),i=null)},h.flush=function(){i&&(l=e.apply(o,r),o=r=null,clearTimeout(i),i=null)},h}return s.debounce=s,Y1=s,Y1}var I6=R6();const h2=_x(I6);var L6=Object.defineProperty,P6=Object.defineProperties,D6=Object.getOwnPropertyDescriptors,d2=Object.getOwnPropertySymbols,O6=Object.prototype.hasOwnProperty,B6=Object.prototype.propertyIsEnumerable,f2=(s,e,t)=>e in s?L6(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,p2=(s,e)=>{for(var t in e||(e={}))O6.call(e,t)&&f2(s,t,e[t]);if(d2)for(var t of d2(e))B6.call(e,t)&&f2(s,t,e[t]);return s},F6=(s,e)=>P6(s,D6(e)),m2,g2;typeof window<"u"&&((m2=window.document)!=null&&m2.createElement||((g2=window.navigator)==null?void 0:g2.product)==="ReactNative")?te.useLayoutEffect:te.useEffect;function LI(s,e,t){if(!s)return;if(t(s)===!0)return s;let n=s.child;for(;n;){const i=LI(n,e,t);if(i)return i;n=n.sibling}}function PI(s){try{return Object.defineProperties(s,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return s}}const y2=console.error;console.error=function(){const s=[...arguments].join("");if(s!=null&&s.startsWith("Warning:")&&s.includes("useContext")){console.error=y2;return}return y2.apply(this,arguments)};const BE=PI(te.createContext(null));class DI extends te.Component{render(){return te.createElement(BE.Provider,{value:this._reactInternals},this.props.children)}}function k6(){const s=te.useContext(BE);if(s===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=te.useId();return te.useMemo(()=>{for(const n of[s,s==null?void 0:s.alternate]){if(!n)continue;const i=LI(n,!1,r=>{let o=r.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[s,e])}function N6(){const s=k6(),[e]=te.useState(()=>new Map);e.clear();let t=s;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==BE&&!e.has(i)&&e.set(i,te.useContext(PI(i)))}t=t.return}return e}function U6(){const s=N6();return te.useMemo(()=>Array.from(s.keys()).reduce((e,t)=>n=>te.createElement(e,null,te.createElement(t.Provider,F6(p2({},n),{value:s.get(t)}))),e=>te.createElement(DI,p2({},e))),[s])}function G6({debounce:s,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||typeof window<"u"&&window.ResizeObserver,[r,o]=te.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0});if(!i)return r.width=1280,r.height=800,[()=>{},r,()=>{}];const a=te.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:r,orientationHandler:null}),l=s?typeof s=="number"?s:s.scroll:null,c=s?typeof s=="number"?s:s.resize:null,h=te.useRef(!1);te.useEffect(()=>(h.current=!0,()=>void(h.current=!1)));const[f,p,y]=te.useMemo(()=>{const A=()=>{if(!a.current.element)return;const{left:w,top:M,width:C,height:I,bottom:O,right:k,x:N,y:B}=a.current.element.getBoundingClientRect(),P={left:w,top:M,width:C,height:I,bottom:O,right:k,x:N,y:B};a.current.element instanceof HTMLElement&&n&&(P.height=a.current.element.offsetHeight,P.width=a.current.element.offsetWidth),Object.freeze(P),h.current&&!V6(a.current.lastBounds,P)&&o(a.current.lastBounds=P)};return[A,c?h2(A,c):A,l?h2(A,l):A]},[o,n,l,c]);function v(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(A=>A.removeEventListener("scroll",y,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function _(){var A;a.current.element&&(a.current.resizeObserver=new i(p),(A=a.current.resizeObserver)==null||A.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(w=>w.addEventListener("scroll",y,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{y()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const S=A=>{!A||A===a.current.element||(v(),a.current.element=A,a.current.scrollContainers=OI(A),_())};return z6(y,!!e),H6(p),te.useEffect(()=>{v(),_()},[e,y,p]),te.useEffect(()=>v,[]),[S,r,f]}function H6(s){te.useEffect(()=>{const e=s;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[s])}function z6(s,e){te.useEffect(()=>{if(e){const t=s;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[s,e])}function OI(s){const e=[];if(!s||s===document.body)return e;const{overflow:t,overflowX:n,overflowY:i}=window.getComputedStyle(s);return[t,n,i].some(r=>r==="auto"||r==="scroll")&&e.push(s),[...e,...OI(s.parentElement)]}const j6=["x","y","top","bottom","left","right","width","height"],V6=(s,e)=>j6.every(t=>s[t]===e[t]),W6=te.forwardRef(function({children:e,fallback:t,resize:n,style:i,gl:r,events:o=C6,eventSource:a,eventPrefix:l,shadows:c,linear:h,flat:f,legacy:p,orthographic:y,frameloop:v,dpr:_,performance:S,raycaster:A,camera:w,scene:M,onPointerMissed:C,onCreated:I,...O},k){te.useMemo(()=>a6(V8),[]);const N=U6(),[B,P]=G6({scroll:!0,debounce:{scroll:50,resize:0},...n}),G=te.useRef(null),Z=te.useRef(null);te.useImperativeHandle(k,()=>G.current);const Y=_I(C),[se,oe]=te.useState(!1),[re,ce]=te.useState(!1);if(se)throw se;if(re)throw re;const H=te.useRef(null);G0(()=>{const X=G.current;P.width>0&&P.height>0&&X&&(H.current||(H.current=M6(X)),H.current.configure({gl:r,events:o,shadows:c,linear:h,flat:f,legacy:p,orthographic:y,frameloop:v,dpr:_,performance:S,raycaster:A,camera:w,scene:M,size:P,onPointerMissed:(...W)=>Y.current==null?void 0:Y.current(...W),onCreated:W=>{W.events.connect==null||W.events.connect(a?c6(a)?a.current:a:Z.current),l&&W.setEvents({compute:(ne,Ee)=>{const le=ne[l+"X"],ye=ne[l+"Y"];Ee.pointer.set(le/Ee.size.width*2-1,-(ye/Ee.size.height)*2+1),Ee.raycaster.setFromCamera(Ee.pointer,Ee.camera)}}),I==null||I(W)}}),H.current.render(F.jsx(N,{children:F.jsx(SI,{set:ce,children:F.jsx(te.Suspense,{fallback:F.jsx(u6,{set:oe}),children:e})})})))}),te.useEffect(()=>{const X=G.current;if(X)return()=>II(X)},[]);const $=a?"none":"auto";return F.jsx("div",{ref:Z,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:$,...i},...O,children:F.jsx("div",{ref:B,style:{width:"100%",height:"100%"},children:F.jsx("canvas",{ref:G,style:{display:"block"},children:t})})})}),BI=te.forwardRef(function(e,t){return F.jsx(DI,{children:F.jsx(W6,{...e,ref:t})})});function rp(){return rp=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},rp.apply(null,arguments)}const z0=new J,FE=new J,K6=new J,v2=new Ue;function X6(s,e,t){const n=z0.setFromMatrixPosition(s.matrixWorld);n.project(e);const i=t.width/2,r=t.height/2;return[n.x*i+i,-(n.y*r)+r]}function $6(s,e){const t=z0.setFromMatrixPosition(s.matrixWorld),n=FE.setFromMatrixPosition(e.matrixWorld),i=t.sub(n),r=e.getWorldDirection(K6);return i.angleTo(r)>Math.PI/2}function Y6(s,e,t,n){const i=z0.setFromMatrixPosition(s.matrixWorld),r=i.clone();r.project(e),v2.set(r.x,r.y),t.setFromCamera(v2,e);const o=t.intersectObjects(n,!0);if(o.length){const a=o[0].distance;return i.distanceTo(t.ray.origin)<a}return!0}function J6(s,e){if(e instanceof ra)return e.zoom;if(e instanceof si){const t=z0.setFromMatrixPosition(s.matrixWorld),n=FE.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,r=t.distanceTo(n);return 1/(2*Math.tan(i/2)*r)}else return 1}function q6(s,e,t){if(e instanceof si||e instanceof ra){const n=z0.setFromMatrixPosition(s.matrixWorld),i=FE.setFromMatrixPosition(e.matrixWorld),r=n.distanceTo(i),o=(t[1]-t[0])/(e.far-e.near),a=t[1]-o*e.far;return Math.round(o*r+a)}}const ZS=s=>Math.abs(s)<1e-10?0:s;function FI(s,e,t=""){let n="matrix3d(";for(let i=0;i!==16;i++)n+=ZS(e[i]*s.elements[i])+(i!==15?",":")");return t+n}const Q6=(s=>e=>FI(e,s))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Z6=(s=>(e,t)=>FI(e,s(t),"translate(-50%,-50%)"))(s=>[1/s,1/s,1/s,1,-1/s,-1/s,-1/s,-1,1/s,1/s,1/s,1,1,1,1,1]);function e9(s){return s&&typeof s=="object"&&"current"in s}const t9=te.forwardRef(({children:s,eps:e=.001,style:t,className:n,prepend:i,center:r,fullscreen:o,portal:a,distanceFactor:l,sprite:c=!1,transform:h=!1,occlude:f,onOcclude:p,castShadow:y,receiveShadow:v,material:_,geometry:S,zIndexRange:A=[16777271,0],calculatePosition:w=X6,as:M="div",wrapperClass:C,pointerEvents:I="auto",...O},k)=>{const{gl:N,camera:B,scene:P,size:G,raycaster:Z,events:Y,viewport:se}=ki(),[oe]=te.useState(()=>document.createElement(M)),re=te.useRef(),ce=te.useRef(null),H=te.useRef(0),$=te.useRef([0,0]),X=te.useRef(null),W=te.useRef(null),ne=(a==null?void 0:a.current)||Y.connected||N.domElement.parentNode,Ee=te.useRef(null),le=te.useRef(!1),ye=te.useMemo(()=>f&&f!=="blending"||Array.isArray(f)&&f.length&&e9(f[0]),[f]);te.useLayoutEffect(()=>{const rt=N.domElement;f&&f==="blending"?(rt.style.zIndex=`${Math.floor(A[0]/2)}`,rt.style.position="absolute",rt.style.pointerEvents="none"):(rt.style.zIndex=null,rt.style.position=null,rt.style.pointerEvents=null)},[f]),te.useLayoutEffect(()=>{if(ce.current){const rt=re.current=Zb.createRoot(oe);if(P.updateMatrixWorld(),h)oe.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const ct=w(ce.current,B,G);oe.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${ct[0]}px,${ct[1]}px,0);transform-origin:0 0;`}return ne&&(i?ne.prepend(oe):ne.appendChild(oe)),()=>{ne&&ne.removeChild(oe),rt.unmount()}}},[ne,h]),te.useLayoutEffect(()=>{C&&(oe.className=C)},[C]);const we=te.useMemo(()=>h?{position:"absolute",top:0,left:0,width:G.width,height:G.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:r?"translate3d(-50%,-50%,0)":"none",...o&&{top:-G.height/2,left:-G.width/2,width:G.width,height:G.height},...t},[t,r,o,G,h]),Ie=te.useMemo(()=>({position:"absolute",pointerEvents:I}),[I]);te.useLayoutEffect(()=>{if(le.current=!1,h){var rt;(rt=re.current)==null||rt.render(te.createElement("div",{ref:X,style:we},te.createElement("div",{ref:W,style:Ie},te.createElement("div",{ref:k,className:n,style:t,children:s}))))}else{var ct;(ct=re.current)==null||ct.render(te.createElement("div",{ref:k,style:we,className:n,children:s}))}});const ze=te.useRef(!0);OE(rt=>{if(ce.current){B.updateMatrixWorld(),ce.current.updateWorldMatrix(!0,!1);const ct=h?$.current:w(ce.current,B,G);if(h||Math.abs(H.current-B.zoom)>e||Math.abs($.current[0]-ct[0])>e||Math.abs($.current[1]-ct[1])>e){const Ne=$6(ce.current,B);let Ge=!1;ye&&(Array.isArray(f)?Ge=f.map(st=>st.current):f!=="blending"&&(Ge=[P]));const Q=ze.current;if(Ge){const st=Y6(ce.current,B,Z,Ge);ze.current=st&&!Ne}else ze.current=!Ne;Q!==ze.current&&(p?p(!ze.current):oe.style.display=ze.current?"block":"none");const St=Math.floor(A[0]/2),We=f?ye?[A[0],St]:[St-1,0]:A;if(oe.style.zIndex=`${q6(ce.current,B,We)}`,h){const[st,qe]=[G.width/2,G.height/2],It=B.projectionMatrix.elements[5]*qe,{isOrthographicCamera:tt,top:q,left:V,bottom:xe,right:De}=B,He=Q6(B.matrixWorldInverse),Fe=tt?`scale(${It})translate(${ZS(-(De+V)/2)}px,${ZS((q+xe)/2)}px)`:`translateZ(${It}px)`;let ht=ce.current.matrixWorld;c&&(ht=B.matrixWorldInverse.clone().transpose().copyPosition(ht).scale(ce.current.scale),ht.elements[3]=ht.elements[7]=ht.elements[11]=0,ht.elements[15]=1),oe.style.width=G.width+"px",oe.style.height=G.height+"px",oe.style.perspective=tt?"":`${It}px`,X.current&&W.current&&(X.current.style.transform=`${Fe}${He}translate(${st}px,${qe}px)`,W.current.style.transform=Z6(ht,1/((l||10)/400)))}else{const st=l===void 0?1:J6(ce.current,B)*l;oe.style.transform=`translate3d(${ct[0]}px,${ct[1]}px,0) scale(${st})`}$.current=ct,H.current=B.zoom}}if(!ye&&Ee.current&&!le.current)if(h){if(X.current){const ct=X.current.children[0];if(ct!=null&&ct.clientWidth&&ct!=null&&ct.clientHeight){const{isOrthographicCamera:Ne}=B;if(Ne||S)O.scale&&(Array.isArray(O.scale)?O.scale instanceof J?Ee.current.scale.copy(O.scale.clone().divideScalar(1)):Ee.current.scale.set(1/O.scale[0],1/O.scale[1],1/O.scale[2]):Ee.current.scale.setScalar(1/O.scale));else{const Ge=(l||10)/400,Q=ct.clientWidth*Ge,St=ct.clientHeight*Ge;Ee.current.scale.set(Q,St,1)}le.current=!0}}}else{const ct=oe.children[0];if(ct!=null&&ct.clientWidth&&ct!=null&&ct.clientHeight){const Ne=1/se.factor,Ge=ct.clientWidth*Ne,Q=ct.clientHeight*Ne;Ee.current.scale.set(Ge,Q,1),le.current=!0}Ee.current.lookAt(rt.camera.position)}});const Ze=te.useMemo(()=>({vertexShader:h?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[h]);return te.createElement("group",rp({},O,{ref:ce}),f&&!ye&&te.createElement("mesh",{castShadow:y,receiveShadow:v,ref:Ee},S||te.createElement("planeGeometry",null),_||te.createElement("shaderMaterial",{side:So,vertexShader:Ze.vertexShader,fragmentShader:Ze.fragmentShader})))}),x2=s=>{let e;const t=new Set,n=(c,h)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const p=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(y=>y(e,p))}},i=()=>e,a={setState:n,getState:i,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=s(n,i,a);return a},n9=s=>s?x2(s):x2,i9=s=>s;function r9(s,e=i9){const t=nw.useSyncExternalStore(s.subscribe,()=>e(s.getState()),()=>e(s.getInitialState()));return nw.useDebugValue(t),t}const _2=s=>{const e=n9(s),t=n=>r9(e,n);return Object.assign(t,e),t},s9=s=>s?_2(s):_2;let Dm=0;const o9=s9(s=>(kf.onStart=(e,t,n)=>{s({active:!0,item:e,loaded:t,total:n,progress:(t-Dm)/(n-Dm)*100})},kf.onLoad=()=>{s({active:!1})},kf.onError=e=>s(t=>({errors:[...t.errors,e]})),kf.onProgress=(e,t,n)=>{t===n&&(Dm=n),s({active:!0,item:e,loaded:t,total:n,progress:(t-Dm)/(n-Dm)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),a9=parseInt(C0.replace(/\D+/g,""));function S2(s,e){if(e===eR)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),s;if(e===Yv||e===qA){let t=s.getIndex();if(t===null){const o=[],a=s.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);s.setIndex(o),t=s.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),s}const n=t.count-2,i=[];if(t)if(e===Yv)for(let o=1;o<=n;o++)i.push(t.getX(0)),i.push(t.getX(o)),i.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(i.push(t.getX(o)),i.push(t.getX(o+1)),i.push(t.getX(o+2))):(i.push(t.getX(o+2)),i.push(t.getX(o+1)),i.push(t.getX(o)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=s.clone();return r.setIndex(i),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),s}var l9=Object.defineProperty,c9=(s,e,t)=>e in s?l9(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,u9=(s,e,t)=>(c9(s,e+"",t),t);class h9{constructor(){u9(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let r=0,o=i.length;r<o;r++)i[r].call(this,e);e.target=null}}}var d9=Object.defineProperty,f9=(s,e,t)=>e in s?d9(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Vt=(s,e,t)=>(f9(s,typeof e!="symbol"?e+"":e,t),t);const Oy=new Jh,A2=new Fl,p9=Math.cos(70*(Math.PI/180)),E2=(s,e)=>(s%e+e)%e;let m9=class extends h9{constructor(e,t){super(),Vt(this,"object"),Vt(this,"domElement"),Vt(this,"enabled",!0),Vt(this,"target",new J),Vt(this,"minDistance",0),Vt(this,"maxDistance",1/0),Vt(this,"minZoom",0),Vt(this,"maxZoom",1/0),Vt(this,"minPolarAngle",0),Vt(this,"maxPolarAngle",Math.PI),Vt(this,"minAzimuthAngle",-1/0),Vt(this,"maxAzimuthAngle",1/0),Vt(this,"enableDamping",!1),Vt(this,"dampingFactor",.05),Vt(this,"enableZoom",!0),Vt(this,"zoomSpeed",1),Vt(this,"enableRotate",!0),Vt(this,"rotateSpeed",1),Vt(this,"enablePan",!0),Vt(this,"panSpeed",1),Vt(this,"screenSpacePanning",!0),Vt(this,"keyPanSpeed",7),Vt(this,"zoomToCursor",!1),Vt(this,"autoRotate",!1),Vt(this,"autoRotateSpeed",2),Vt(this,"reverseOrbit",!1),Vt(this,"reverseHorizontalOrbit",!1),Vt(this,"reverseVerticalOrbit",!1),Vt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Vt(this,"mouseButtons",{LEFT:ch.ROTATE,MIDDLE:ch.DOLLY,RIGHT:ch.PAN}),Vt(this,"touches",{ONE:uh.ROTATE,TWO:uh.DOLLY_PAN}),Vt(this,"target0"),Vt(this,"position0"),Vt(this,"zoom0"),Vt(this,"_domElementKeyEvents",null),Vt(this,"getPolarAngle"),Vt(this,"getAzimuthalAngle"),Vt(this,"setPolarAngle"),Vt(this,"setAzimuthalAngle"),Vt(this,"getDistance"),Vt(this,"getZoomScale"),Vt(this,"listenToKeyEvents"),Vt(this,"stopListenToKeyEvents"),Vt(this,"saveState"),Vt(this,"reset"),Vt(this,"update"),Vt(this,"connect"),Vt(this,"dispose"),Vt(this,"dollyIn"),Vt(this,"dollyOut"),Vt(this,"getScale"),Vt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=ue=>{let Be=E2(ue,2*Math.PI),at=h.phi;at<0&&(at+=2*Math.PI),Be<0&&(Be+=2*Math.PI);let ae=Math.abs(Be-at);2*Math.PI-ae<ae&&(Be<at?Be+=2*Math.PI:at+=2*Math.PI),f.phi=Be-at,n.update()},this.setAzimuthalAngle=ue=>{let Be=E2(ue,2*Math.PI),at=h.theta;at<0&&(at+=2*Math.PI),Be<0&&(Be+=2*Math.PI);let ae=Math.abs(Be-at);2*Math.PI-ae<ae&&(Be<at?Be+=2*Math.PI:at+=2*Math.PI),f.theta=Be-at,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ue=>{ue.addEventListener("keydown",nt),this._domElementKeyEvents=ue},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",nt),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),l=a.NONE},this.update=(()=>{const ue=new J,Be=new J(0,1,0),at=new hr().setFromUnitVectors(e.up,Be),ae=at.clone().invert(),Ye=new J,Ce=new hr,ke=2*Math.PI;return function(){const lt=n.object.position;at.setFromUnitVectors(e.up,Be),ae.copy(at).invert(),ue.copy(lt).sub(n.target),ue.applyQuaternion(at),h.setFromVector3(ue),n.autoRotate&&l===a.NONE&&se(Z()),n.enableDamping?(h.theta+=f.theta*n.dampingFactor,h.phi+=f.phi*n.dampingFactor):(h.theta+=f.theta,h.phi+=f.phi);let Ft=n.minAzimuthAngle,yn=n.maxAzimuthAngle;isFinite(Ft)&&isFinite(yn)&&(Ft<-Math.PI?Ft+=ke:Ft>Math.PI&&(Ft-=ke),yn<-Math.PI?yn+=ke:yn>Math.PI&&(yn-=ke),Ft<=yn?h.theta=Math.max(Ft,Math.min(yn,h.theta)):h.theta=h.theta>(Ft+yn)/2?Math.max(Ft,h.theta):Math.min(yn,h.theta)),h.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,h.phi)),h.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(y,n.dampingFactor):n.target.add(y),n.zoomToCursor&&B||n.object.isOrthographicCamera?h.radius=Ee(h.radius):h.radius=Ee(h.radius*p),ue.setFromSpherical(h),ue.applyQuaternion(ae),lt.copy(n.target).add(ue),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(f.theta*=1-n.dampingFactor,f.phi*=1-n.dampingFactor,y.multiplyScalar(1-n.dampingFactor)):(f.set(0,0,0),y.set(0,0,0));let Nn=!1;if(n.zoomToCursor&&B){let ln=null;if(n.object instanceof si&&n.object.isPerspectiveCamera){const ai=ue.length();ln=Ee(ai*p);const gi=ai-ln;n.object.position.addScaledVector(k,gi),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const ai=new J(N.x,N.y,0);ai.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/p)),n.object.updateProjectionMatrix(),Nn=!0;const gi=new J(N.x,N.y,0);gi.unproject(n.object),n.object.position.sub(gi).add(ai),n.object.updateMatrixWorld(),ln=ue.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;ln!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(ln).add(n.object.position):(Oy.origin.copy(n.object.position),Oy.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Oy.direction))<p9?e.lookAt(n.target):(A2.setFromNormalAndCoplanarPoint(n.object.up,n.target),Oy.intersectPlane(A2,n.target))))}else n.object instanceof ra&&n.object.isOrthographicCamera&&(Nn=p!==1,Nn&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/p)),n.object.updateProjectionMatrix()));return p=1,B=!1,Nn||Ye.distanceToSquared(n.object.position)>c||8*(1-Ce.dot(n.object.quaternion))>c?(n.dispatchEvent(i),Ye.copy(n.object.position),Ce.copy(n.object.quaternion),Nn=!1,!0):!1}})(),this.connect=ue=>{n.domElement=ue,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Xe),n.domElement.addEventListener("pointerdown",V),n.domElement.addEventListener("pointercancel",De),n.domElement.addEventListener("wheel",ht)},this.dispose=()=>{var ue,Be,at,ae,Ye,Ce;n.domElement&&(n.domElement.style.touchAction="auto"),(ue=n.domElement)==null||ue.removeEventListener("contextmenu",Xe),(Be=n.domElement)==null||Be.removeEventListener("pointerdown",V),(at=n.domElement)==null||at.removeEventListener("pointercancel",De),(ae=n.domElement)==null||ae.removeEventListener("wheel",ht),(Ye=n.domElement)==null||Ye.ownerDocument.removeEventListener("pointermove",xe),(Ce=n.domElement)==null||Ce.ownerDocument.removeEventListener("pointerup",De),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",nt)};const n=this,i={type:"change"},r={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,h=new XS,f=new XS;let p=1;const y=new J,v=new Ue,_=new Ue,S=new Ue,A=new Ue,w=new Ue,M=new Ue,C=new Ue,I=new Ue,O=new Ue,k=new J,N=new Ue;let B=!1;const P=[],G={};function Z(){return 2*Math.PI/60/60*n.autoRotateSpeed}function Y(){return Math.pow(.95,n.zoomSpeed)}function se(ue){n.reverseOrbit||n.reverseHorizontalOrbit?f.theta+=ue:f.theta-=ue}function oe(ue){n.reverseOrbit||n.reverseVerticalOrbit?f.phi+=ue:f.phi-=ue}const re=(()=>{const ue=new J;return function(at,ae){ue.setFromMatrixColumn(ae,0),ue.multiplyScalar(-at),y.add(ue)}})(),ce=(()=>{const ue=new J;return function(at,ae){n.screenSpacePanning===!0?ue.setFromMatrixColumn(ae,1):(ue.setFromMatrixColumn(ae,0),ue.crossVectors(n.object.up,ue)),ue.multiplyScalar(at),y.add(ue)}})(),H=(()=>{const ue=new J;return function(at,ae){const Ye=n.domElement;if(Ye&&n.object instanceof si&&n.object.isPerspectiveCamera){const Ce=n.object.position;ue.copy(Ce).sub(n.target);let ke=ue.length();ke*=Math.tan(n.object.fov/2*Math.PI/180),re(2*at*ke/Ye.clientHeight,n.object.matrix),ce(2*ae*ke/Ye.clientHeight,n.object.matrix)}else Ye&&n.object instanceof ra&&n.object.isOrthographicCamera?(re(at*(n.object.right-n.object.left)/n.object.zoom/Ye.clientWidth,n.object.matrix),ce(ae*(n.object.top-n.object.bottom)/n.object.zoom/Ye.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function $(ue){n.object instanceof si&&n.object.isPerspectiveCamera||n.object instanceof ra&&n.object.isOrthographicCamera?p=ue:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function X(ue){$(p/ue)}function W(ue){$(p*ue)}function ne(ue){if(!n.zoomToCursor||!n.domElement)return;B=!0;const Be=n.domElement.getBoundingClientRect(),at=ue.clientX-Be.left,ae=ue.clientY-Be.top,Ye=Be.width,Ce=Be.height;N.x=at/Ye*2-1,N.y=-(ae/Ce)*2+1,k.set(N.x,N.y,1).unproject(n.object).sub(n.object.position).normalize()}function Ee(ue){return Math.max(n.minDistance,Math.min(n.maxDistance,ue))}function le(ue){v.set(ue.clientX,ue.clientY)}function ye(ue){ne(ue),C.set(ue.clientX,ue.clientY)}function we(ue){A.set(ue.clientX,ue.clientY)}function Ie(ue){_.set(ue.clientX,ue.clientY),S.subVectors(_,v).multiplyScalar(n.rotateSpeed);const Be=n.domElement;Be&&(se(2*Math.PI*S.x/Be.clientHeight),oe(2*Math.PI*S.y/Be.clientHeight)),v.copy(_),n.update()}function ze(ue){I.set(ue.clientX,ue.clientY),O.subVectors(I,C),O.y>0?X(Y()):O.y<0&&W(Y()),C.copy(I),n.update()}function Ze(ue){w.set(ue.clientX,ue.clientY),M.subVectors(w,A).multiplyScalar(n.panSpeed),H(M.x,M.y),A.copy(w),n.update()}function rt(ue){ne(ue),ue.deltaY<0?W(Y()):ue.deltaY>0&&X(Y()),n.update()}function ct(ue){let Be=!1;switch(ue.code){case n.keys.UP:H(0,n.keyPanSpeed),Be=!0;break;case n.keys.BOTTOM:H(0,-n.keyPanSpeed),Be=!0;break;case n.keys.LEFT:H(n.keyPanSpeed,0),Be=!0;break;case n.keys.RIGHT:H(-n.keyPanSpeed,0),Be=!0;break}Be&&(ue.preventDefault(),n.update())}function Ne(){if(P.length==1)v.set(P[0].pageX,P[0].pageY);else{const ue=.5*(P[0].pageX+P[1].pageX),Be=.5*(P[0].pageY+P[1].pageY);v.set(ue,Be)}}function Ge(){if(P.length==1)A.set(P[0].pageX,P[0].pageY);else{const ue=.5*(P[0].pageX+P[1].pageX),Be=.5*(P[0].pageY+P[1].pageY);A.set(ue,Be)}}function Q(){const ue=P[0].pageX-P[1].pageX,Be=P[0].pageY-P[1].pageY,at=Math.sqrt(ue*ue+Be*Be);C.set(0,at)}function St(){n.enableZoom&&Q(),n.enablePan&&Ge()}function We(){n.enableZoom&&Q(),n.enableRotate&&Ne()}function st(ue){if(P.length==1)_.set(ue.pageX,ue.pageY);else{const at=vt(ue),ae=.5*(ue.pageX+at.x),Ye=.5*(ue.pageY+at.y);_.set(ae,Ye)}S.subVectors(_,v).multiplyScalar(n.rotateSpeed);const Be=n.domElement;Be&&(se(2*Math.PI*S.x/Be.clientHeight),oe(2*Math.PI*S.y/Be.clientHeight)),v.copy(_)}function qe(ue){if(P.length==1)w.set(ue.pageX,ue.pageY);else{const Be=vt(ue),at=.5*(ue.pageX+Be.x),ae=.5*(ue.pageY+Be.y);w.set(at,ae)}M.subVectors(w,A).multiplyScalar(n.panSpeed),H(M.x,M.y),A.copy(w)}function It(ue){const Be=vt(ue),at=ue.pageX-Be.x,ae=ue.pageY-Be.y,Ye=Math.sqrt(at*at+ae*ae);I.set(0,Ye),O.set(0,Math.pow(I.y/C.y,n.zoomSpeed)),X(O.y),C.copy(I)}function tt(ue){n.enableZoom&&It(ue),n.enablePan&&qe(ue)}function q(ue){n.enableZoom&&It(ue),n.enableRotate&&st(ue)}function V(ue){var Be,at;n.enabled!==!1&&(P.length===0&&((Be=n.domElement)==null||Be.ownerDocument.addEventListener("pointermove",xe),(at=n.domElement)==null||at.ownerDocument.addEventListener("pointerup",De)),At(ue),ue.pointerType==="touch"?mt(ue):He(ue))}function xe(ue){n.enabled!==!1&&(ue.pointerType==="touch"?Qt(ue):Fe(ue))}function De(ue){var Be,at,ae;kt(ue),P.length===0&&((Be=n.domElement)==null||Be.releasePointerCapture(ue.pointerId),(at=n.domElement)==null||at.ownerDocument.removeEventListener("pointermove",xe),(ae=n.domElement)==null||ae.ownerDocument.removeEventListener("pointerup",De)),n.dispatchEvent(o),l=a.NONE}function He(ue){let Be;switch(ue.button){case 0:Be=n.mouseButtons.LEFT;break;case 1:Be=n.mouseButtons.MIDDLE;break;case 2:Be=n.mouseButtons.RIGHT;break;default:Be=-1}switch(Be){case ch.DOLLY:if(n.enableZoom===!1)return;ye(ue),l=a.DOLLY;break;case ch.ROTATE:if(ue.ctrlKey||ue.metaKey||ue.shiftKey){if(n.enablePan===!1)return;we(ue),l=a.PAN}else{if(n.enableRotate===!1)return;le(ue),l=a.ROTATE}break;case ch.PAN:if(ue.ctrlKey||ue.metaKey||ue.shiftKey){if(n.enableRotate===!1)return;le(ue),l=a.ROTATE}else{if(n.enablePan===!1)return;we(ue),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(r)}function Fe(ue){if(n.enabled!==!1)switch(l){case a.ROTATE:if(n.enableRotate===!1)return;Ie(ue);break;case a.DOLLY:if(n.enableZoom===!1)return;ze(ue);break;case a.PAN:if(n.enablePan===!1)return;Ze(ue);break}}function ht(ue){n.enabled===!1||n.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(ue.preventDefault(),n.dispatchEvent(r),rt(ue),n.dispatchEvent(o))}function nt(ue){n.enabled===!1||n.enablePan===!1||ct(ue)}function mt(ue){switch(Gt(ue),P.length){case 1:switch(n.touches.ONE){case uh.ROTATE:if(n.enableRotate===!1)return;Ne(),l=a.TOUCH_ROTATE;break;case uh.PAN:if(n.enablePan===!1)return;Ge(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(n.touches.TWO){case uh.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;St(),l=a.TOUCH_DOLLY_PAN;break;case uh.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;We(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(r)}function Qt(ue){switch(Gt(ue),l){case a.TOUCH_ROTATE:if(n.enableRotate===!1)return;st(ue),n.update();break;case a.TOUCH_PAN:if(n.enablePan===!1)return;qe(ue),n.update();break;case a.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;tt(ue),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;q(ue),n.update();break;default:l=a.NONE}}function Xe(ue){n.enabled!==!1&&ue.preventDefault()}function At(ue){P.push(ue)}function kt(ue){delete G[ue.pointerId];for(let Be=0;Be<P.length;Be++)if(P[Be].pointerId==ue.pointerId){P.splice(Be,1);return}}function Gt(ue){let Be=G[ue.pointerId];Be===void 0&&(Be=new Ue,G[ue.pointerId]=Be),Be.set(ue.pageX,ue.pageY)}function vt(ue){const Be=ue.pointerId===P[0].pointerId?P[1]:P[0];return G[Be.pointerId]}this.dollyIn=(ue=Y())=>{W(ue),n.update()},this.dollyOut=(ue=Y())=>{X(ue),n.update()},this.getScale=()=>p,this.setScale=ue=>{$(ue),n.update()},this.getZoomScale=()=>Y(),t!==void 0&&this.connect(t),this.update()}};function tx(s){if(typeof TextDecoder<"u")return new TextDecoder().decode(s);let e="";for(let t=0,n=s.length;t<n;t++)e+=String.fromCharCode(s[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Ah="srgb",Wl="srgb-linear",T2=3001,g9=3e3;class kE extends zr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new S9(t)}),this.register(function(t){return new A9(t)}),this.register(function(t){return new L9(t)}),this.register(function(t){return new P9(t)}),this.register(function(t){return new D9(t)}),this.register(function(t){return new T9(t)}),this.register(function(t){return new w9(t)}),this.register(function(t){return new M9(t)}),this.register(function(t){return new b9(t)}),this.register(function(t){return new _9(t)}),this.register(function(t){return new C9(t)}),this.register(function(t){return new E9(t)}),this.register(function(t){return new I9(t)}),this.register(function(t){return new R9(t)}),this.register(function(t){return new v9(t)}),this.register(function(t){return new O9(t)}),this.register(function(t){return new B9(t)})}load(e,t,n,i){const r=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const c=Xc.extractUrlBase(e);o=Xc.resolveURL(c,this.path)}else o=Xc.extractUrlBase(e);this.manager.itemStart(e);const a=function(c){i?i(c):console.error(c),r.manager.itemError(e),r.manager.itemEnd(e)},l=new qs(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{r.parse(c,o,function(h){t(h),r.manager.itemEnd(e)},a)}catch(h){a(h)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let r;const o={},a={};if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(tx(new Uint8Array(e.slice(0,4)))===kI){try{o[vn.KHR_BINARY_GLTF]=new F9(e)}catch(h){i&&i(h);return}r=JSON.parse(o[vn.KHR_BINARY_GLTF].content)}else r=JSON.parse(tx(new Uint8Array(e)));else r=e;if(r.asset===void 0||r.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new Y9(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const h=this.pluginCallbacks[c](l);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[h.name]=h,o[h.name]=!0}if(r.extensionsUsed)for(let c=0;c<r.extensionsUsed.length;++c){const h=r.extensionsUsed[c],f=r.extensionsRequired||[];switch(h){case vn.KHR_MATERIALS_UNLIT:o[h]=new x9;break;case vn.KHR_DRACO_MESH_COMPRESSION:o[h]=new k9(r,this.dracoLoader);break;case vn.KHR_TEXTURE_TRANSFORM:o[h]=new N9;break;case vn.KHR_MESH_QUANTIZATION:o[h]=new U9;break;default:f.indexOf(h)>=0&&a[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(n,i)}parseAsync(e,t){const n=this;return new Promise(function(i,r){n.parse(e,t,i,r)})}}function y9(){let s={};return{get:function(e){return s[e]},add:function(e,t){s[e]=t},remove:function(e){delete s[e]},removeAll:function(){s={}}}}const vn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class v9{constructor(e){this.parser=e,this.name=vn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const r=t.json,l=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let c;const h=new ut(16777215);l.color!==void 0&&h.setRGB(l.color[0],l.color[1],l.color[2],Wl);const f=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new wE(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new TE(h),c.distance=f;break;case"spot":c=new EE(h),c.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Pl(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),i=Promise.resolve(c),t.cache.add(n,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],a=(r.extensions&&r.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}}class x9{constructor(){this.name=vn.KHR_MATERIALS_UNLIT}getMaterialType(){return Ks}extendParams(e,t,n){const i=[];e.color=new ut(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const o=r.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Wl),e.opacity=o[3]}r.baseColorTexture!==void 0&&i.push(n.assignTexture(e,"map",r.baseColorTexture,Ah))}return Promise.all(i)}}class _9{constructor(e){this.parser=e,this.name=vn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class S9{constructor(e){this.parser=e,this.name=vn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Co}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(r.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ue(a,a)}return Promise.all(r)}}class A9{constructor(e){this.parser=e,this.name=vn.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Co}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class E9{constructor(e){this.parser=e,this.name=vn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Co}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&r.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(r)}}class T9{constructor(e){this.parser=e,this.name=vn.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Co}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new ut(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=i.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Wl)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&r.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Ah)),o.sheenRoughnessTexture!==void 0&&r.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(r)}}class w9{constructor(e){this.parser=e,this.name=vn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Co}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&r.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(r)}}class M9{constructor(e){this.parser=e,this.name=vn.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Co}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&r.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new ut().setRGB(a[0],a[1],a[2],Wl),Promise.all(r)}}class b9{constructor(e){this.parser=e,this.name=vn.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Co}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class C9{constructor(e){this.parser=e,this.name=vn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Co}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&r.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new ut().setRGB(a[0],a[1],a[2],Wl),o.specularColorTexture!==void 0&&r.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,Ah)),Promise.all(r)}}class R9{constructor(e){this.parser=e,this.name=vn.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Co}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&r.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(r)}}class I9{constructor(e){this.parser=e,this.name=vn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Co}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],o=i.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&r.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(r)}}class L9{constructor(e){this.parser=e,this.name=vn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const r=i.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,o)}}class P9{constructor(e){this.parser=e,this.name=vn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],a=i.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class D9{constructor(e){this.parser=e,this.name=vn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],a=i.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class O9{constructor(e){this.name=vn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const i=n.extensions[this.name],r=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(a){const l=i.byteOffset||0,c=i.byteLength||0,h=i.count,f=i.byteStride,p=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(h,f,p,i.mode,i.filter).then(function(y){return y.buffer}):o.ready.then(function(){const y=new ArrayBuffer(h*f);return o.decodeGltfBuffer(new Uint8Array(y),h,f,p,i.mode,i.filter),y})})}else return null}}class B9{constructor(e){this.name=vn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const i=t.meshes[n.mesh];for(const c of i.primitives)if(c.mode!==vo.TRIANGLES&&c.mode!==vo.TRIANGLE_STRIP&&c.mode!==vo.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=n.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(h=>(l[c]=h,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const h=c.pop(),f=h.isGroup?h.children:[h],p=c[0].count,y=[];for(const v of f){const _=new Kt,S=new J,A=new hr,w=new J(1,1,1),M=new aE(v.geometry,v.material,p);for(let C=0;C<p;C++)l.TRANSLATION&&S.fromBufferAttribute(l.TRANSLATION,C),l.ROTATION&&A.fromBufferAttribute(l.ROTATION,C),l.SCALE&&w.fromBufferAttribute(l.SCALE,C),M.setMatrixAt(C,_.compose(S,A,w));for(const C in l)if(C==="_COLOR_0"){const I=l[C];M.instanceColor=new Gh(I.array,I.itemSize,I.normalized)}else C!=="TRANSLATION"&&C!=="ROTATION"&&C!=="SCALE"&&v.geometry.setAttribute(C,l[C]);An.prototype.copy.call(M,v),this.parser.assignFinalMaterial(M),y.push(M)}return h.isGroup?(h.clear(),h.add(...y),h):y[0]}))}}const kI="glTF",Om=12,w2={JSON:1313821514,BIN:5130562};class F9{constructor(e){this.name=vn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Om);if(this.header={magic:tx(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==kI)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-Om,i=new DataView(e,Om);let r=0;for(;r<n;){const o=i.getUint32(r,!0);r+=4;const a=i.getUint32(r,!0);if(r+=4,a===w2.JSON){const l=new Uint8Array(e,Om+r,o);this.content=tx(l)}else if(a===w2.BIN){const l=Om+r;this.body=e.slice(l,l+o)}r+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class k9{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=vn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const h in o){const f=eA[h]||h.toLowerCase();a[f]=o[h]}for(const h in e.attributes){const f=eA[h]||h.toLowerCase();if(o[h]!==void 0){const p=n.accessors[e.attributes[h]],y=Wf[p.componentType];c[f]=y.name,l[f]=p.normalized===!0}}return t.getDependency("bufferView",r).then(function(h){return new Promise(function(f,p){i.decodeDracoFile(h,function(y){for(const v in y.attributes){const _=y.attributes[v],S=l[v];S!==void 0&&(_.normalized=S)}f(y)},a,c,Wl,p)})})}}class N9{constructor(){this.name=vn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class U9{constructor(){this.name=vn.KHR_MESH_QUANTIZATION}}class NI extends xp{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i*3+i;for(let o=0;o!==i;o++)t[o]=n[r+o];return t}interpolate_(e,t,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,h=i-t,f=(n-t)/h,p=f*f,y=p*f,v=e*c,_=v-c,S=-2*y+3*p,A=y-p,w=1-S,M=A-p+f;for(let C=0;C!==a;C++){const I=o[_+C+a],O=o[_+C+l]*h,k=o[v+C+a],N=o[v+C]*h;r[C]=w*I+M*O+S*k+A*N}return r}}const G9=new hr;class H9 extends NI{interpolate_(e,t,n,i){const r=super.interpolate_(e,t,n,i);return G9.fromArray(r).normalize().toArray(r),r}}const vo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Wf={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},M2={9728:ur,9729:pi,9984:wx,9985:jf,9986:gh,9987:Ao},b2={33071:Ws,33648:Jf,10497:Qc},J1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},eA={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...a9>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Uc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},z9={CUBICSPLINE:void 0,LINEAR:Zf,STEP:Qf},q1={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function j9(s){return s.DefaultMaterial===void 0&&(s.DefaultMaterial=new U0({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ga})),s.DefaultMaterial}function sh(s,e,t){for(const n in t.extensions)s[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Pl(s,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(s.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function V9(s,e,t){let n=!1,i=!1,r=!1;for(let c=0,h=e.length;c<h;c++){const f=e[c];if(f.POSITION!==void 0&&(n=!0),f.NORMAL!==void 0&&(i=!0),f.COLOR_0!==void 0&&(r=!0),n&&i&&r)break}if(!n&&!i&&!r)return Promise.resolve(s);const o=[],a=[],l=[];for(let c=0,h=e.length;c<h;c++){const f=e[c];if(n){const p=f.POSITION!==void 0?t.getDependency("accessor",f.POSITION):s.attributes.position;o.push(p)}if(i){const p=f.NORMAL!==void 0?t.getDependency("accessor",f.NORMAL):s.attributes.normal;a.push(p)}if(r){const p=f.COLOR_0!==void 0?t.getDependency("accessor",f.COLOR_0):s.attributes.color;l.push(p)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[0],f=c[1],p=c[2];return n&&(s.morphAttributes.position=h),i&&(s.morphAttributes.normal=f),r&&(s.morphAttributes.color=p),s.morphTargetsRelative=!0,s})}function W9(s,e){if(s.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)s.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(s.morphTargetInfluences.length===t.length){s.morphTargetDictionary={};for(let n=0,i=t.length;n<i;n++)s.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function K9(s){let e;const t=s.extensions&&s.extensions[vn.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+Q1(t.attributes):e=s.indices+":"+Q1(s.attributes)+":"+s.mode,s.targets!==void 0)for(let n=0,i=s.targets.length;n<i;n++)e+=":"+Q1(s.targets[n]);return e}function Q1(s){let e="";const t=Object.keys(s).sort();for(let n=0,i=t.length;n<i;n++)e+=t[n]+":"+s[t[n]]+";";return e}function tA(s){switch(s){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function X9(s){return s.search(/\.jpe?g($|\?)/i)>0||s.search(/^data\:image\/jpeg/)===0?"image/jpeg":s.search(/\.webp($|\?)/i)>0||s.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const $9=new Kt;class Y9{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new y9,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=!1,r=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,r=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||i&&r<98?this.textureLoader=new XR(this.options.manager):this.textureLoader=new tI(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new qs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:n,userData:{}};return sh(r,a,i),Pl(a,i),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,r=t.length;i<r;i++){const o=t[i].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let i=0,r=e.length;i<r;i++){const o=e[i];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),r=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,h]of o.children.entries())r(h,a.children[c])};return r(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const r=e(t[i]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":i=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(r,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[vn.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(r,o){n.load(Xc.resolveURL(t.uri,i.path),r,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const i=t.byteLength||0,r=t.byteOffset||0;return n.slice(r,r+i)})}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const o=J1[i.type],a=Wf[i.componentType],l=i.normalized===!0,c=new a(i.count*o);return Promise.resolve(new Rn(c,o,l))}const r=[];return i.bufferView!==void 0?r.push(this.getDependency("bufferView",i.bufferView)):r.push(null),i.sparse!==void 0&&(r.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(r).then(function(o){const a=o[0],l=J1[i.type],c=Wf[i.componentType],h=c.BYTES_PER_ELEMENT,f=h*l,p=i.byteOffset||0,y=i.bufferView!==void 0?n.bufferViews[i.bufferView].byteStride:void 0,v=i.normalized===!0;let _,S;if(y&&y!==f){const A=Math.floor(p/y),w="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+A+":"+i.count;let M=t.cache.get(w);M||(_=new c(a,A*y,i.count*y/h),M=new D0(_,y/h),t.cache.add(w,M)),S=new Zc(M,l,p%y/h,v)}else a===null?_=new c(i.count*l):_=new c(a,p,i.count*l),S=new Rn(_,l,v);if(i.sparse!==void 0){const A=J1.SCALAR,w=Wf[i.sparse.indices.componentType],M=i.sparse.indices.byteOffset||0,C=i.sparse.values.byteOffset||0,I=new w(o[1],M,i.sparse.count*A),O=new c(o[2],C,i.sparse.count*l);a!==null&&(S=new Rn(S.array.slice(),S.itemSize,S.normalized));for(let k=0,N=I.length;k<N;k++){const B=I[k];if(S.setX(B,O[k*l]),l>=2&&S.setY(B,O[k*l+1]),l>=3&&S.setZ(B,O[k*l+2]),l>=4&&S.setW(B,O[k*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return S})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,o=t.images[r];let a=this.textureLoader;if(o.uri){const l=n.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,r,a)}loadTextureImage(e,t,n){const i=this,r=this.json,o=r.textures[e],a=r.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,n).then(function(h){h.flipY=!1,h.name=o.name||a.name||"",h.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(h.name=a.uri);const p=(r.samplers||{})[o.sampler]||{};return h.magFilter=M2[p.magFilter]||pi,h.minFilter=M2[p.minFilter]||Ao,h.wrapS=b2[p.wrapS]||Qc,h.wrapT=b2[p.wrapT]||Qc,i.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const n=this,i=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const o=i.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=n.getDependency("bufferView",o.bufferView).then(function(f){c=!0;const p=new Blob([f],{type:o.mimeType});return l=a.createObjectURL(p),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(f){return new Promise(function(p,y){let v=p;t.isImageBitmapLoader===!0&&(v=function(_){const S=new ei(_);S.needsUpdate=!0,p(S)}),t.load(Xc.resolveURL(f,r.path),v,void 0,y)})}).then(function(f){return c===!0&&a.revokeObjectURL(l),Pl(f,o),f.userData.mimeType=o.mimeType||X9(o.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[e]=h,h}assignTexture(e,t,n,i){const r=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),r.extensions[vn.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[vn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=r.associations.get(o);o=r.extensions[vn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),r.associations.set(o,l)}}return i!==void 0&&(typeof i=="number"&&(i=i===T2?Ah:Wl),"colorSpace"in o?o.colorSpace=i:o.encoding=i===Ah?T2:g9),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new kx,Ui.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new Hr,Ui.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(i||r||o){let a="ClonedMaterial:"+n.uuid+":";i&&(a+="derivative-tangents:"),r&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),r&&(l.vertexColors=!0),o&&(l.flatShading=!0),i&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return U0}loadMaterial(e){const t=this,n=this.json,i=this.extensions,r=n.materials[e];let o;const a={},l=r.extensions||{},c=[];if(l[vn.KHR_MATERIALS_UNLIT]){const f=i[vn.KHR_MATERIALS_UNLIT];o=f.getMaterialType(),c.push(f.extendParams(a,r,t))}else{const f=r.pbrMetallicRoughness||{};if(a.color=new ut(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const p=f.baseColorFactor;a.color.setRGB(p[0],p[1],p[2],Wl),a.opacity=p[3]}f.baseColorTexture!==void 0&&c.push(t.assignTexture(a,"map",f.baseColorTexture,Ah)),a.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,a.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),o=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}r.doubleSided===!0&&(a.side=So);const h=r.alphaMode||q1.OPAQUE;if(h===q1.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===q1.MASK&&(a.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&o!==Ks&&(c.push(t.assignTexture(a,"normalMap",r.normalTexture)),a.normalScale=new Ue(1,1),r.normalTexture.scale!==void 0)){const f=r.normalTexture.scale;a.normalScale.set(f,f)}if(r.occlusionTexture!==void 0&&o!==Ks&&(c.push(t.assignTexture(a,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&o!==Ks){const f=r.emissiveFactor;a.emissive=new ut().setRGB(f[0],f[1],f[2],Wl)}return r.emissiveTexture!==void 0&&o!==Ks&&c.push(t.assignTexture(a,"emissiveMap",r.emissiveTexture,Ah)),Promise.all(c).then(function(){const f=new o(a);return r.name&&(f.name=r.name),Pl(f,r),t.associations.set(f,{materials:e}),r.extensions&&sh(i,f,r),f})}createUniqueName(e){const t=wn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function r(a){return n[vn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return C2(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],h=K9(c),f=i[h];if(f)o.push(f.promise);else{let p;c.extensions&&c.extensions[vn.KHR_DRACO_MESH_COMPRESSION]?p=r(c):p=C2(new rn,c,t),i[h]={primitive:c,promise:p},o.push(p)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,i=this.extensions,r=n.meshes[e],o=r.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const h=o[l].material===void 0?j9(this.cache):this.getDependency("material",o[l].material);a.push(h)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],f=[];for(let y=0,v=h.length;y<v;y++){const _=h[y],S=o[y];let A;const w=c[y];if(S.mode===vo.TRIANGLES||S.mode===vo.TRIANGLE_STRIP||S.mode===vo.TRIANGLE_FAN||S.mode===void 0)A=r.isSkinnedMesh===!0?new oE(_,w):new Ci(_,w),A.isSkinnedMesh===!0&&A.normalizeSkinWeights(),S.mode===vo.TRIANGLE_STRIP?A.geometry=S2(A.geometry,qA):S.mode===vo.TRIANGLE_FAN&&(A.geometry=S2(A.geometry,Yv));else if(S.mode===vo.LINES)A=new aa(_,w);else if(S.mode===vo.LINE_STRIP)A=new $l(_,w);else if(S.mode===vo.LINE_LOOP)A=new lE(_,w);else if(S.mode===vo.POINTS)A=new cE(_,w);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+S.mode);Object.keys(A.geometry.morphAttributes).length>0&&W9(A,r),A.name=t.createUniqueName(r.name||"mesh_"+e),Pl(A,r),S.extensions&&sh(i,A,S),t.assignFinalMaterial(A),f.push(A)}for(let y=0,v=f.length;y<v;y++)t.associations.set(f[y],{meshes:e,primitives:y});if(f.length===1)return r.extensions&&sh(i,f[0],r),f[0];const p=new Gl;r.extensions&&sh(i,p,r),t.associations.set(p,{meshes:e});for(let y=0,v=f.length;y<v;y++)p.add(f[y]);return p})}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new si(hR.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):n.type==="orthographic"&&(t=new ra(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Pl(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let i=0,r=t.joints.length;i<r;i++)n.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(i){const r=i.pop(),o=i,a=[],l=[];for(let c=0,h=o.length;c<h;c++){const f=o[c];if(f){a.push(f);const p=new Kt;r!==null&&p.fromArray(r.array,c*16),l.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new O0(a,l)})}loadAnimation(e){const t=this.json,n=this,i=t.animations[e],r=i.name?i.name:"animation_"+e,o=[],a=[],l=[],c=[],h=[];for(let f=0,p=i.channels.length;f<p;f++){const y=i.channels[f],v=i.samplers[y.sampler],_=y.target,S=_.node,A=i.parameters!==void 0?i.parameters[v.input]:v.input,w=i.parameters!==void 0?i.parameters[v.output]:v.output;_.node!==void 0&&(o.push(this.getDependency("node",S)),a.push(this.getDependency("accessor",A)),l.push(this.getDependency("accessor",w)),c.push(v),h.push(_))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(h)]).then(function(f){const p=f[0],y=f[1],v=f[2],_=f[3],S=f[4],A=[];for(let w=0,M=p.length;w<M;w++){const C=p[w],I=y[w],O=v[w],k=_[w],N=S[w];if(C===void 0)continue;C.updateMatrix&&C.updateMatrix();const B=n._createAnimationTracks(C,I,O,k,N);if(B)for(let P=0;P<B.length;P++)A.push(B[P])}return new np(r,void 0,A)})}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return i.mesh===void 0?null:n.getDependency("mesh",i.mesh).then(function(r){const o=n._getNodeRef(n.meshCache,i.mesh,r);return i.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=i.weights.length;l<c;l++)a.morphTargetInfluences[l]=i.weights[l]}),o})}loadNode(e){const t=this.json,n=this,i=t.nodes[e],r=n._loadNodeShallow(e),o=[],a=i.children||[];for(let c=0,h=a.length;c<h;c++)o.push(n.getDependency("node",a[c]));const l=i.skin===void 0?Promise.resolve(null):n.getDependency("skin",i.skin);return Promise.all([r,Promise.all(o),l]).then(function(c){const h=c[0],f=c[1],p=c[2];p!==null&&h.traverse(function(y){y.isSkinnedMesh&&y.bind(p,$9)});for(let y=0,v=f.length;y<v;y++)h.add(f[y]);return h})}_loadNodeShallow(e){const t=this.json,n=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=t.nodes[e],o=r.name?i.createUniqueName(r.name):"",a=[],l=i._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),r.camera!==void 0&&a.push(i.getDependency("camera",r.camera).then(function(c){return i._getNodeRef(i.cameraCache,r.camera,c)})),i._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let h;if(r.isBone===!0?h=new Fx:c.length>1?h=new Gl:c.length===1?h=c[0]:h=new An,h!==c[0])for(let f=0,p=c.length;f<p;f++)h.add(c[f]);if(r.name&&(h.userData.name=r.name,h.name=o),Pl(h,r),r.extensions&&sh(n,h,r),r.matrix!==void 0){const f=new Kt;f.fromArray(r.matrix),h.applyMatrix4(f)}else r.translation!==void 0&&h.position.fromArray(r.translation),r.rotation!==void 0&&h.quaternion.fromArray(r.rotation),r.scale!==void 0&&h.scale.fromArray(r.scale);return i.associations.has(h)||i.associations.set(h,{}),i.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],i=this,r=new Gl;n.name&&(r.name=i.createUniqueName(n.name)),Pl(r,n),n.extensions&&sh(t,r,n);const o=n.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(i.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let h=0,f=l.length;h<f;h++)r.add(l[h]);const c=h=>{const f=new Map;for(const[p,y]of i.associations)(p instanceof Ui||p instanceof ei)&&f.set(p,y);return h.traverse(p=>{const y=i.associations.get(p);y!=null&&f.set(p,y)}),f};return i.associations=c(r),r})}_createAnimationTracks(e,t,n,i,r){const o=[],a=e.name?e.name:e.uuid,l=[];Uc[r.path]===Uc.weights?e.traverse(function(p){p.morphTargetInfluences&&l.push(p.name?p.name:p.uuid)}):l.push(a);let c;switch(Uc[r.path]){case Uc.weights:c=zh;break;case Uc.rotation:c=jh;break;case Uc.position:case Uc.scale:c=Vh;break;default:switch(n.itemSize){case 1:c=zh;break;case 2:case 3:default:c=Vh;break}break}const h=i.interpolation!==void 0?z9[i.interpolation]:Zf,f=this._getArrayFromAccessor(n);for(let p=0,y=l.length;p<y;p++){const v=new c(l[p]+"."+Uc[r.path],t.array,f,h);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(v),o.push(v)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=tA(t.constructor),i=new Float32Array(t.length);for(let r=0,o=t.length;r<o;r++)i[r]=t[r]*n;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const i=this instanceof jh?H9:NI;return new i(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function J9(s,e,t){const n=e.attributes,i=new wr;if(n.POSITION!==void 0){const a=t.json.accessors[n.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(i.set(new J(l[0],l[1],l[2]),new J(c[0],c[1],c[2])),a.normalized){const h=tA(Wf[a.componentType]);i.min.multiplyScalar(h),i.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const a=new J,l=new J;for(let c=0,h=r.length;c<h;c++){const f=r[c];if(f.POSITION!==void 0){const p=t.json.accessors[f.POSITION],y=p.min,v=p.max;if(y!==void 0&&v!==void 0){if(l.setX(Math.max(Math.abs(y[0]),Math.abs(v[0]))),l.setY(Math.max(Math.abs(y[1]),Math.abs(v[1]))),l.setZ(Math.max(Math.abs(y[2]),Math.abs(v[2]))),p.normalized){const _=tA(Wf[p.componentType]);l.multiplyScalar(_)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(a)}s.boundingBox=i;const o=new dr;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,s.boundingSphere=o}function C2(s,e,t){const n=e.attributes,i=[];function r(o,a){return t.getDependency("accessor",o).then(function(l){s.setAttribute(a,l)})}for(const o in n){const a=eA[o]||o.toLowerCase();a in s.attributes||i.push(r(n[o],a))}if(e.indices!==void 0&&!s.index){const o=t.getDependency("accessor",e.indices).then(function(a){s.setIndex(a)});i.push(o)}return Pl(s,e),J9(s,e,t),Promise.all(i).then(function(){return e.targets!==void 0?V9(s,e.targets,t):s})}const Z1=new WeakMap;class q9 extends zr{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,i){const r=new qs(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(t).catch(i)},n,i)}decodeDracoFile(e,t,n,i){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){for(const l in t.attributeTypes){const c=t.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[l]=c.name)}const n=JSON.stringify(t);if(Z1.has(e)){const l=Z1.get(e);if(l.key===n)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const r=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(r,o).then(l=>(i=l,new Promise((c,h)=>{i._callbacks[r]={resolve:c,reject:h},i.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{i&&r&&this._releaseTask(i,r)}),Z1.set(e,{key:n,promise:a}),a}_createGeometry(e){const t=new rn;e.index&&t.setIndex(new Rn(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n],r=i.name,o=i.array,a=i.itemSize;t.setAttribute(r,new Rn(o,a))}return t}_loadLibrary(e,t){const n=new qs(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((i,r)=>{n.load(e,i,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const i=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const r=Q9.toString(),o=["/* draco decoder */",i,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(r){const o=r.data;switch(o.type){case"decode":i._callbacks[o.id].resolve(o);break;case"error":i._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,r){return i._taskLoad>r._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Q9(){let s,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":s=a.decoderConfig,e=new Promise(function(h){s.onModuleLoaded=function(f){h({draco:f})},DracoDecoderModule(s)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(h=>{const f=h.draco,p=new f.Decoder,y=new f.DecoderBuffer;y.Init(new Int8Array(l),l.byteLength);try{const v=t(f,p,y,c),_=v.attributes.map(S=>S.array.buffer);v.index&&_.push(v.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:v},_)}catch(v){console.error(v),self.postMessage({type:"error",id:a.id,error:v.message})}finally{f.destroy(y),f.destroy(p)}});break}};function t(o,a,l,c){const h=c.attributeIDs,f=c.attributeTypes;let p,y;const v=a.GetEncodedGeometryType(l);if(v===o.TRIANGULAR_MESH)p=new o.Mesh,y=a.DecodeBufferToMesh(l,p);else if(v===o.POINT_CLOUD)p=new o.PointCloud,y=a.DecodeBufferToPointCloud(l,p);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!y.ok()||p.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+y.error_msg());const _={index:null,attributes:[]};for(const S in h){const A=self[f[S]];let w,M;if(c.useUniqueIDs)M=h[S],w=a.GetAttributeByUniqueId(p,M);else{if(M=a.GetAttributeId(p,o[h[S]]),M===-1)continue;w=a.GetAttribute(p,M)}_.attributes.push(i(o,a,p,S,A,w))}return v===o.TRIANGULAR_MESH&&(_.index=n(o,a,p)),o.destroy(p),_}function n(o,a,l){const h=l.num_faces()*3,f=h*4,p=o._malloc(f);a.GetTrianglesUInt32Array(l,f,p);const y=new Uint32Array(o.HEAPF32.buffer,p,h).slice();return o._free(p),{array:y,itemSize:1}}function i(o,a,l,c,h,f){const p=f.num_components(),v=l.num_points()*p,_=v*h.BYTES_PER_ELEMENT,S=r(o,h),A=o._malloc(_);a.GetAttributeDataArrayForAllPoints(l,f,S,_,A);const w=new h(o.HEAPF32.buffer,A,v).slice();return o._free(A),{name:c,array:w,itemSize:p}}function r(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let By;const eS=()=>{if(By)return By;const s="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let i=s;WebAssembly.validate(t)&&(i=e);let r;const o=WebAssembly.instantiate(a(i),{}).then(f=>{r=f.instance,r.exports.__wasm_call_ctors()});function a(f){const p=new Uint8Array(f.length);for(let v=0;v<f.length;++v){const _=f.charCodeAt(v);p[v]=_>96?_-71:_>64?_-65:_>47?_+4:_>46?63:62}let y=0;for(let v=0;v<f.length;++v)p[y++]=p[v]<60?n[p[v]]:(p[v]-60)*64+p[++v];return p.buffer.slice(0,y)}function l(f,p,y,v,_,S){const A=r.exports.sbrk,w=y+3&-4,M=A(w*v),C=A(_.length),I=new Uint8Array(r.exports.memory.buffer);I.set(_,C);const O=f(M,y,v,C,_.length);if(O===0&&S&&S(M,w,v),p.set(I.subarray(M,M+y*v)),A(M-A(0)),O!==0)throw new Error(`Malformed buffer data: ${O}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return By={ready:o,supported:!0,decodeVertexBuffer(f,p,y,v,_){l(r.exports.meshopt_decodeVertexBuffer,f,p,y,v,r.exports[c[_]])},decodeIndexBuffer(f,p,y,v){l(r.exports.meshopt_decodeIndexBuffer,f,p,y,v)},decodeIndexSequence(f,p,y,v){l(r.exports.meshopt_decodeIndexSequence,f,p,y,v)},decodeGltfBuffer(f,p,y,v,_,S){l(r.exports[h[_]],f,p,y,v,r.exports[c[S]])}},By};let Fy=null,UI="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function GI(s=!0,e=!0,t){return n=>{t&&t(n),s&&(Fy||(Fy=new q9),Fy.setDecoderPath(typeof s=="string"?s:UI),n.setDRACOLoader(Fy)),e&&n.setMeshoptDecoder(typeof eS=="function"?eS():eS)}}const Sp=(s,e,t,n)=>H0(kE,s,GI(e,t,n));Sp.preload=(s,e,t,n)=>H0.preload(kE,s,GI(e,t,n));Sp.clear=s=>H0.clear(kE,s);Sp.setDecoderPath=s=>{UI=s};function Z9(s,e,t){const n=ki(p=>p.size),i=ki(p=>p.viewport),r=typeof s=="number"?s:n.width*i.dpr,o=n.height*i.dpr,a=(typeof s=="number"?t:s)||{},{samples:l=0,depth:c,...h}=a,f=te.useMemo(()=>{const p=new wo(r,o,{minFilter:pi,magFilter:pi,type:Yh,...h});return c&&(p.depthTexture=new Ux(r,o,rs)),p.samples=l,p},[]);return te.useLayoutEffect(()=>{f.setSize(r,o),l&&(f.samples=l)},[l,f,r,o]),te.useEffect(()=>()=>f.dispose(),[]),f}const eG=s=>typeof s=="function",HI=te.forwardRef(({envMap:s,resolution:e=256,frames:t=1/0,makeDefault:n,children:i,...r},o)=>{const a=ki(({set:S})=>S),l=ki(({camera:S})=>S),c=ki(({size:S})=>S),h=te.useRef(null);te.useImperativeHandle(o,()=>h.current,[]);const f=te.useRef(null),p=Z9(e);te.useLayoutEffect(()=>{r.manual||(h.current.aspect=c.width/c.height)},[c,r]),te.useLayoutEffect(()=>{h.current.updateProjectionMatrix()});let y=0,v=null;const _=eG(i);return OE(S=>{_&&(t===1/0||y<t)&&(f.current.visible=!1,S.gl.setRenderTarget(p),v=S.scene.background,s&&(S.scene.background=s),S.gl.render(S.scene,h.current),S.scene.background=v,S.gl.setRenderTarget(null),f.current.visible=!0,y++)}),te.useLayoutEffect(()=>{if(n){const S=l;return a(()=>({camera:h.current})),()=>a(()=>({camera:S}))}},[h,n,a]),te.createElement(te.Fragment,null,te.createElement("perspectiveCamera",rp({ref:h},r),!_&&i),te.createElement("group",{ref:f},_&&i(p.texture)))}),zI=te.forwardRef(({makeDefault:s,camera:e,regress:t,domElement:n,enableDamping:i=!0,keyEvents:r=!1,onChange:o,onStart:a,onEnd:l,...c},h)=>{const f=ki(O=>O.invalidate),p=ki(O=>O.camera),y=ki(O=>O.gl),v=ki(O=>O.events),_=ki(O=>O.setEvents),S=ki(O=>O.set),A=ki(O=>O.get),w=ki(O=>O.performance),M=e||p,C=n||v.connected||y.domElement,I=te.useMemo(()=>new m9(M),[M]);return OE(()=>{I.enabled&&I.update()},-1),te.useEffect(()=>(r&&I.connect(r===!0?C:r),I.connect(C),()=>void I.dispose()),[r,C,t,I,f]),te.useEffect(()=>{const O=B=>{f(),t&&w.regress(),o&&o(B)},k=B=>{a&&a(B)},N=B=>{l&&l(B)};return I.addEventListener("change",O),I.addEventListener("start",k),I.addEventListener("end",N),()=>{I.removeEventListener("start",k),I.removeEventListener("end",N),I.removeEventListener("change",O)}},[o,a,l,I,f,_]),te.useEffect(()=>{if(s){const O=A().controls;return S({controls:I}),()=>S({controls:O})}},[s,I]),te.createElement("primitive",rp({ref:h,object:I,enableDamping:i},c))}),tG="modulepreload",nG=function(s){return"/drren-portfolio/"+s},R2={},iG=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(l=>{if(l=nG(l),l in R2)return;R2[l]=!0;const c=l.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":tG,c||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),c)return new Promise((p,y)=>{f.addEventListener("load",p),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})};function rG(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var jI={exports:{}};(function(s,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,r=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,c,h){if(h=h||{},l=l.trim(),c=c.trim(),!c){if(!h.alwaysNormalize)return l;var f=a.parseURL(l);if(!f)throw new Error("Error trying to parse base URL.");return f.path=a.normalizePath(f.path),a.buildURLFromParts(f)}var p=a.parseURL(c);if(!p)throw new Error("Error trying to parse relative URL.");if(p.scheme)return h.alwaysNormalize?(p.path=a.normalizePath(p.path),a.buildURLFromParts(p)):c;var y=a.parseURL(l);if(!y)throw new Error("Error trying to parse base URL.");if(!y.netLoc&&y.path&&y.path[0]!=="/"){var v=i.exec(y.path);y.netLoc=v[1],y.path=v[2]}y.netLoc&&!y.path&&(y.path="/");var _={scheme:y.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};if(!p.netLoc&&(_.netLoc=y.netLoc,p.path[0]!=="/"))if(!p.path)_.path=y.path,p.params||(_.params=y.params,p.query||(_.query=y.query));else{var S=y.path,A=S.substring(0,S.lastIndexOf("/")+1)+p.path;_.path=a.normalizePath(A)}return _.path===null&&(_.path=h.alwaysNormalize?a.normalizePath(p.path):p.path),a.buildURLFromParts(_)},parseURL:function(l){var c=n.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(r,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};s.exports=a})()})(jI);var NE=jI.exports;function I2(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function fr(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?I2(Object(t),!0).forEach(function(n){aG(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):I2(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function sG(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function oG(s){var e=sG(s,"string");return typeof e=="symbol"?e:String(e)}function aG(s,e,t){return e=oG(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Gi(){return Gi=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},Gi.apply(this,arguments)}const bt=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},lG=Number.isSafeInteger||function(s){return typeof s=="number"&&Math.abs(s)<=cG},cG=Number.MAX_SAFE_INTEGER||9007199254740991;let z=function(s){return s.MEDIA_ATTACHING="hlsMediaAttaching",s.MEDIA_ATTACHED="hlsMediaAttached",s.MEDIA_DETACHING="hlsMediaDetaching",s.MEDIA_DETACHED="hlsMediaDetached",s.BUFFER_RESET="hlsBufferReset",s.BUFFER_CODECS="hlsBufferCodecs",s.BUFFER_CREATED="hlsBufferCreated",s.BUFFER_APPENDING="hlsBufferAppending",s.BUFFER_APPENDED="hlsBufferAppended",s.BUFFER_EOS="hlsBufferEos",s.BUFFER_FLUSHING="hlsBufferFlushing",s.BUFFER_FLUSHED="hlsBufferFlushed",s.MANIFEST_LOADING="hlsManifestLoading",s.MANIFEST_LOADED="hlsManifestLoaded",s.MANIFEST_PARSED="hlsManifestParsed",s.LEVEL_SWITCHING="hlsLevelSwitching",s.LEVEL_SWITCHED="hlsLevelSwitched",s.LEVEL_LOADING="hlsLevelLoading",s.LEVEL_LOADED="hlsLevelLoaded",s.LEVEL_UPDATED="hlsLevelUpdated",s.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",s.LEVELS_UPDATED="hlsLevelsUpdated",s.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",s.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",s.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",s.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",s.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",s.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",s.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",s.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",s.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",s.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",s.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",s.CUES_PARSED="hlsCuesParsed",s.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",s.INIT_PTS_FOUND="hlsInitPtsFound",s.FRAG_LOADING="hlsFragLoading",s.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",s.FRAG_LOADED="hlsFragLoaded",s.FRAG_DECRYPTED="hlsFragDecrypted",s.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",s.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",s.FRAG_PARSING_METADATA="hlsFragParsingMetadata",s.FRAG_PARSED="hlsFragParsed",s.FRAG_BUFFERED="hlsFragBuffered",s.FRAG_CHANGED="hlsFragChanged",s.FPS_DROP="hlsFpsDrop",s.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",s.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",s.ERROR="hlsError",s.DESTROYING="hlsDestroying",s.KEY_LOADING="hlsKeyLoading",s.KEY_LOADED="hlsKeyLoaded",s.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",s.BACK_BUFFER_REACHED="hlsBackBufferReached",s.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",s}({}),Yt=function(s){return s.NETWORK_ERROR="networkError",s.MEDIA_ERROR="mediaError",s.KEY_SYSTEM_ERROR="keySystemError",s.MUX_ERROR="muxError",s.OTHER_ERROR="otherError",s}({}),Le=function(s){return s.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",s.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",s.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",s.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_PARSING_ERROR="levelParsingError",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",s.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.FRAG_GAP="fragGap",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.INTERNAL_EXCEPTION="internalException",s.INTERNAL_ABORTED="aborted",s.UNKNOWN="unknown",s}({});const fh=function(){},nA={trace:fh,debug:fh,log:fh,warn:fh,info:fh,error:fh};let qm=nA;function uG(s){const e=self.console[s];return e?e.bind(self.console,`[${s}] >`):fh}function hG(s,...e){e.forEach(function(t){qm[t]=s[t]?s[t].bind(s):uG(t)})}function dG(s,e){if(typeof console=="object"&&s===!0||typeof s=="object"){hG(s,"debug","log","info","warn","error");try{qm.log(`Debug logs enabled for "${e}" in hls.js version 1.5.17`)}catch{qm=nA}}else qm=nA}const ve=qm,fG=/^(\d+)x(\d+)$/,L2=/(.+?)=(".*?"|.*?)(?:,|$)/g;class ri{constructor(e){typeof e=="string"&&(e=ri.parseAttrList(e)),Gi(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let i=0;i<t.length/2;i++)n[i]=parseInt(t.slice(i*2,i*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=fG.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},i='"';for(L2.lastIndex=0;(t=L2.exec(e))!==null;){let r=t[2];r.indexOf(i)===0&&r.lastIndexOf(i)===r.length-1&&(r=r.slice(1,-1));const o=t[1].trim();n[o]=r}return n}}function pG(s){return s!=="ID"&&s!=="CLASS"&&s!=="START-DATE"&&s!=="DURATION"&&s!=="END-DATE"&&s!=="END-ON-NEXT"}function mG(s){return s==="SCTE35-OUT"||s==="SCTE35-IN"}class UE{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const i in n)if(Object.prototype.hasOwnProperty.call(e,i)&&e[i]!==n[i]){ve.warn(`DATERANGE tag attribute: "${i}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=i;break}e=Gi(new ri({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);bt(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(bt(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&bt(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class j0{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var kn={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class GE{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[kn.AUDIO]:null,[kn.VIDEO]:null,[kn.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let i;n.length===1?i=(t==null?void 0:t.byteRangeEndOffset)||0:i=parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=NE.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class nv extends GE{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new j0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!bt(this.programDateTime))return null;const e=bt(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,i,r,o=!1){const{elementaryStreams:a}=this,l=a[e];if(!l){a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:o};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,i),l.endDTS=Math.max(l.endDTS,r)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[kn.AUDIO]=null,e[kn.VIDEO]=null,e[kn.AUDIOVIDEO]=null}}class VI extends GE{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new j0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const gG=10;class WI{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?bt(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||gG}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function HE(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0))}function yG(s){const e=iA(s).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function vG(s){const e=function(n,i,r){const o=n[i];n[i]=n[r],n[r]=o};e(s,0,3),e(s,1,2),e(s,4,5),e(s,6,7)}function xG(s){const e=s.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),i=n[n.length-1].split(",");if(i.length===2){const r=i[0]==="base64",o=i[1];r?(n.splice(-1,1),t=HE(o)):t=yG(o)}}return t}function iA(s){return Uint8Array.from(unescape(encodeURIComponent(s)),e=>e.charCodeAt(0))}const sp=typeof self<"u"?self:void 0;var Kn={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},ts={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function P2(s){switch(s){case ts.FAIRPLAY:return Kn.FAIRPLAY;case ts.PLAYREADY:return Kn.PLAYREADY;case ts.WIDEVINE:return Kn.WIDEVINE;case ts.CLEARKEY:return Kn.CLEARKEY}}var Um={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function D2(s){if(s===Um.WIDEVINE)return Kn.WIDEVINE;if(s===Um.PLAYREADY)return Kn.PLAYREADY;if(s===Um.CENC||s===Um.CLEARKEY)return Kn.CLEARKEY}function O2(s){switch(s){case Kn.FAIRPLAY:return ts.FAIRPLAY;case Kn.PLAYREADY:return ts.PLAYREADY;case Kn.WIDEVINE:return ts.WIDEVINE;case Kn.CLEARKEY:return ts.CLEARKEY}}function tS(s){const{drmSystems:e,widevineLicenseUrl:t}=s,n=e?[Kn.FAIRPLAY,Kn.WIDEVINE,Kn.PLAYREADY,Kn.CLEARKEY].filter(i=>!!e[i]):[];return!n[Kn.WIDEVINE]&&t&&n.push(Kn.WIDEVINE),n}const KI=function(s){return sp!=null&&(s=sp.navigator)!=null&&s.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function _G(s,e,t,n){let i;switch(s){case Kn.FAIRPLAY:i=["cenc","sinf"];break;case Kn.WIDEVINE:case Kn.PLAYREADY:i=["cenc"];break;case Kn.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${s}`)}return SG(i,e,t,n)}function SG(s,e,t,n){return[{initDataTypes:s,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(r=>({contentType:`audio/mp4; codecs="${r}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(r=>({contentType:`video/mp4; codecs="${r}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function Ih(s,e,t){return Uint8Array.prototype.slice?s.slice(e,t):new Uint8Array(Array.prototype.slice.call(s,e,t))}const zE=(s,e)=>e+10<=s.length&&s[e]===73&&s[e+1]===68&&s[e+2]===51&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128,XI=(s,e)=>e+10<=s.length&&s[e]===51&&s[e+1]===68&&s[e+2]===73&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128,m0=(s,e)=>{const t=e;let n=0;for(;zE(s,e);){n+=10;const i=n_(s,e+6);n+=i,XI(s,e+10)&&(n+=10),e+=n}if(n>0)return s.subarray(t,t+n)},n_=(s,e)=>{let t=0;return t=(s[e]&127)<<21,t|=(s[e+1]&127)<<14,t|=(s[e+2]&127)<<7,t|=s[e+3]&127,t},AG=(s,e)=>zE(s,e)&&n_(s,e+6)+10<=s.length-e,jE=s=>{const e=YI(s);for(let t=0;t<e.length;t++){const n=e[t];if($I(n))return CG(n)}},$I=s=>s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp",EG=s=>{const e=String.fromCharCode(s[0],s[1],s[2],s[3]),t=n_(s,4),n=10;return{type:e,size:t,data:s.subarray(n,n+t)}},YI=s=>{let e=0;const t=[];for(;zE(s,e);){const n=n_(s,e+6);e+=10;const i=e+n;for(;e+8<i;){const r=EG(s.subarray(e)),o=TG(r);o&&t.push(o),e+=r.size+10}XI(s,e)&&(e+=10)}return t},TG=s=>s.type==="PRIV"?wG(s):s.type[0]==="W"?bG(s):MG(s),wG=s=>{if(s.size<2)return;const e=ka(s.data,!0),t=new Uint8Array(s.data.subarray(e.length+1));return{key:s.type,info:e,data:t.buffer}},MG=s=>{if(s.size<2)return;if(s.type==="TXXX"){let t=1;const n=ka(s.data.subarray(t),!0);t+=n.length+1;const i=ka(s.data.subarray(t));return{key:s.type,info:n,data:i}}const e=ka(s.data.subarray(1));return{key:s.type,data:e}},bG=s=>{if(s.type==="WXXX"){if(s.size<2)return;let t=1;const n=ka(s.data.subarray(t),!0);t+=n.length+1;const i=ka(s.data.subarray(t));return{key:s.type,info:n,data:i}}const e=ka(s.data);return{key:s.type,data:e}},CG=s=>{if(s.data.byteLength===8){const e=new Uint8Array(s.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}},ka=(s,e=!1)=>{const t=RG();if(t){const c=t.decode(s);if(e){const h=c.indexOf("\0");return h!==-1?c.substring(0,h):c}return c.replace(/\0/g,"")}const n=s.length;let i,r,o,a="",l=0;for(;l<n;){if(i=s[l++],i===0&&e)return a;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=s[l++],a+=String.fromCharCode((i&31)<<6|r&63);break;case 14:r=s[l++],o=s[l++],a+=String.fromCharCode((i&15)<<12|(r&63)<<6|(o&63)<<0);break}}return a};let nS;function RG(){if(!navigator.userAgent.includes("PlayStation 4"))return!nS&&typeof self.TextDecoder<"u"&&(nS=new self.TextDecoder("utf-8")),nS}const Ma={hexDump:function(s){let e="";for(let t=0;t<s.length;t++){let n=s[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},nx=Math.pow(2,32)-1,IG=[].push,JI={video:1,audio:2,id3:3,text:4};function $i(s){return String.fromCharCode.apply(null,s)}function qI(s,e){const t=s[e]<<8|s[e+1];return t<0?65536+t:t}function Wt(s,e){const t=QI(s,e);return t<0?4294967296+t:t}function B2(s,e){let t=Wt(s,e);return t*=Math.pow(2,32),t+=Wt(s,e+4),t}function QI(s,e){return s[e]<<24|s[e+1]<<16|s[e+2]<<8|s[e+3]}function iS(s,e,t){s[e]=t>>24,s[e+1]=t>>16&255,s[e+2]=t>>8&255,s[e+3]=t&255}function LG(s){const e=s.byteLength;for(let t=0;t<e;){const n=Wt(s,t);if(n>8&&s[t+4]===109&&s[t+5]===111&&s[t+6]===111&&s[t+7]===102)return!0;t=n>1?t+n:e}return!1}function an(s,e){const t=[];if(!e.length)return t;const n=s.byteLength;for(let i=0;i<n;){const r=Wt(s,i),o=$i(s.subarray(i+4,i+8)),a=r>1?i+r:n;if(o===e[0])if(e.length===1)t.push(s.subarray(i+8,a));else{const l=an(s.subarray(i+8,a),e.slice(1));l.length&&IG.apply(t,l)}i=a}return t}function PG(s){const e=[],t=s[0];let n=8;const i=Wt(s,n);n+=4;let r=0,o=0;t===0?(r=Wt(s,n),o=Wt(s,n+4),n+=8):(r=B2(s,n),o=B2(s,n+8),n+=16),n+=2;let a=s.length+o;const l=qI(s,n);n+=2;for(let c=0;c<l;c++){let h=n;const f=Wt(s,h);h+=4;const p=f&2147483647;if((f&2147483648)>>>31===1)return ve.warn("SIDX has hierarchical references (not supported)"),null;const v=Wt(s,h);h+=4,e.push({referenceSize:p,subsegmentDuration:v,info:{duration:v/i,start:a,end:a+p-1}}),a+=p,h+=4,n=h}return{earliestPresentationTime:r,timescale:i,version:t,referencesCount:l,references:e}}function ZI(s){const e=[],t=an(s,["moov","trak"]);for(let i=0;i<t.length;i++){const r=t[i],o=an(r,["tkhd"])[0];if(o){let a=o[0];const l=Wt(o,a===0?12:20),c=an(r,["mdia","mdhd"])[0];if(c){a=c[0];const h=Wt(c,a===0?12:20),f=an(r,["mdia","hdlr"])[0];if(f){const p=$i(f.subarray(8,12)),y={soun:kn.AUDIO,vide:kn.VIDEO}[p];if(y){const v=an(r,["mdia","minf","stbl","stsd"])[0],_=DG(v);e[l]={timescale:h,type:y},e[y]=fr({timescale:h,id:l},_)}}}}}return an(s,["moov","mvex","trex"]).forEach(i=>{const r=Wt(i,4),o=e[r];o&&(o.default={duration:Wt(i,12),flags:Wt(i,20)})}),e}function DG(s){const e=s.subarray(8),t=e.subarray(86),n=$i(e.subarray(4,8));let i=n;const r=n==="enca"||n==="encv";if(r){const a=an(e,[n])[0].subarray(n==="enca"?28:78);an(a,["sinf"]).forEach(c=>{const h=an(c,["schm"])[0];if(h){const f=$i(h.subarray(4,8));if(f==="cbcs"||f==="cenc"){const p=an(c,["frma"])[0];p&&(i=$i(p))}}})}switch(i){case"avc1":case"avc2":case"avc3":case"avc4":{const o=an(t,["avcC"])[0];i+="."+ky(o[1])+ky(o[2])+ky(o[3]);break}case"mp4a":{const o=an(e,[n])[0],a=an(o.subarray(28),["esds"])[0];if(a&&a.length>12){let l=4;if(a[l++]!==3)break;l=rS(a,l),l+=2;const c=a[l++];if(c&128&&(l+=2),c&64&&(l+=a[l++]),a[l++]!==4)break;l=rS(a,l);const h=a[l++];if(h===64)i+="."+ky(h);else break;if(l+=12,a[l++]!==5)break;l=rS(a,l);const f=a[l++];let p=(f&248)>>3;p===31&&(p+=1+((f&7)<<3)+((a[l]&224)>>5)),i+="."+p}break}case"hvc1":case"hev1":{const o=an(t,["hvcC"])[0],a=o[1],l=["","A","B","C"][a>>6],c=a&31,h=Wt(o,2),f=(a&32)>>5?"H":"L",p=o[12],y=o.subarray(6,12);i+="."+l+c,i+="."+h.toString(16).toUpperCase(),i+="."+f+p;let v="";for(let _=y.length;_--;){const S=y[_];(S||v)&&(v="."+S.toString(16).toUpperCase()+v)}i+=v;break}case"dvh1":case"dvhe":{const o=an(t,["dvcC"])[0],a=o[2]>>1&127,l=o[2]<<5&32|o[3]>>3&31;i+="."+wa(a)+"."+wa(l);break}case"vp09":{const o=an(t,["vpcC"])[0],a=o[4],l=o[5],c=o[6]>>4&15;i+="."+wa(a)+"."+wa(l)+"."+wa(c);break}case"av01":{const o=an(t,["av1C"])[0],a=o[1]>>>5,l=o[1]&31,c=o[2]>>>7?"H":"M",h=(o[2]&64)>>6,f=(o[2]&32)>>5,p=a===2&&h?f?12:10:h?10:8,y=(o[2]&16)>>4,v=(o[2]&8)>>3,_=(o[2]&4)>>2,S=o[2]&3;i+="."+a+"."+wa(l)+c+"."+wa(p)+"."+y+"."+v+_+S+"."+wa(1)+"."+wa(1)+"."+wa(1)+"."+0;break}}return{codec:i,encrypted:r}}function rS(s,e){const t=e+5;for(;s[e++]&128&&e<t;);return e}function ky(s){return("0"+s.toString(16).toUpperCase()).slice(-2)}function wa(s){return(s<10?"0":"")+s}function OG(s,e){if(!s||!e)return s;const t=e.keyId;return t&&e.isCommonEncryption&&an(s,["moov","trak"]).forEach(i=>{const o=an(i,["mdia","minf","stbl","stsd"])[0].subarray(8);let a=an(o,["enca"]);const l=a.length>0;l||(a=an(o,["encv"])),a.forEach(c=>{const h=l?c.subarray(28):c.subarray(78);an(h,["sinf"]).forEach(p=>{const y=eL(p);if(y){const v=y.subarray(8,24);v.some(_=>_!==0)||(ve.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${Ma.hexDump(v)} -> ${Ma.hexDump(t)}`),y.set(t,8))}})})}),s}function eL(s){const e=an(s,["schm"])[0];if(e){const t=$i(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return an(s,["schi","tenc"])[0]}return null}function BG(s,e){return an(e,["moof","traf"]).reduce((t,n)=>{const i=an(n,["tfdt"])[0],r=i[0],o=an(n,["tfhd"]).reduce((a,l)=>{const c=Wt(l,4),h=s[c];if(h){let f=Wt(i,4);if(r===1){if(f===nx)return ve.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),a;f*=nx+1,f+=Wt(i,8)}const p=h.timescale||9e4,y=f/p;if(bt(y)&&(a===null||y<a))return y}return a},null);return o!==null&&bt(o)&&(t===null||o<t)?o:t},null)}function FG(s,e){let t=0,n=0,i=0;const r=an(s,["moof","traf"]);for(let o=0;o<r.length;o++){const a=r[o],l=an(a,["tfhd"])[0],c=Wt(l,4),h=e[c];if(!h)continue;const f=h.default,p=Wt(l,0)|(f==null?void 0:f.flags);let y=f==null?void 0:f.duration;p&8&&(p&2?y=Wt(l,12):y=Wt(l,8));const v=h.timescale||9e4,_=an(a,["trun"]);for(let S=0;S<_.length;S++){if(t=kG(_[S]),!t&&y){const A=Wt(_[S],4);t=y*A}h.type===kn.VIDEO?n+=t/v:h.type===kn.AUDIO&&(i+=t/v)}}if(n===0&&i===0){let o=1/0,a=0,l=0;const c=an(s,["sidx"]);for(let h=0;h<c.length;h++){const f=PG(c[h]);if(f!=null&&f.references){o=Math.min(o,f.earliestPresentationTime/f.timescale);const p=f.references.reduce((y,v)=>y+v.info.duration||0,0);a=Math.max(a,p+f.earliestPresentationTime/f.timescale),l=a-o}}if(l&&bt(l))return l}return n||i}function kG(s){const e=Wt(s,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const i=Wt(s,4);for(let r=0;r<i;r++){if(e&256){const o=Wt(s,t);n+=o,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function NG(s,e,t){an(e,["moof","traf"]).forEach(n=>{an(n,["tfhd"]).forEach(i=>{const r=Wt(i,4),o=s[r];if(!o)return;const a=o.timescale||9e4;an(n,["tfdt"]).forEach(l=>{const c=l[0],h=t*a;if(h){let f=Wt(l,4);if(c===0)f-=h,f=Math.max(f,0),iS(l,4,f);else{f*=Math.pow(2,32),f+=Wt(l,8),f-=h,f=Math.max(f,0);const p=Math.floor(f/(nx+1)),y=Math.floor(f%(nx+1));iS(l,4,p),iS(l,8,y)}}})})})}function UG(s){const e={valid:null,remainder:null},t=an(s,["moof"]);if(t.length<2)return e.remainder=s,e;const n=t[t.length-1];return e.valid=Ih(s,0,n.byteOffset-8),e.remainder=Ih(s,n.byteOffset-8),e}function Mo(s,e){const t=new Uint8Array(s.length+e.length);return t.set(s),t.set(e,s.length),t}function F2(s,e){const t=[],n=e.samples,i=e.timescale,r=e.id;let o=!1;return an(n,["moof"]).map(l=>{const c=l.byteOffset-8;an(l,["traf"]).map(f=>{const p=an(f,["tfdt"]).map(y=>{const v=y[0];let _=Wt(y,4);return v===1&&(_*=Math.pow(2,32),_+=Wt(y,8)),_/i})[0];return p!==void 0&&(s=p),an(f,["tfhd"]).map(y=>{const v=Wt(y,4),_=Wt(y,0)&16777215,S=(_&1)!==0,A=(_&2)!==0,w=(_&8)!==0;let M=0;const C=(_&16)!==0;let I=0;const O=(_&32)!==0;let k=8;v===r&&(S&&(k+=8),A&&(k+=4),w&&(M=Wt(y,k),k+=4),C&&(I=Wt(y,k),k+=4),O&&(k+=4),e.type==="video"&&(o=GG(e.codec)),an(f,["trun"]).map(N=>{const B=N[0],P=Wt(N,0)&16777215,G=(P&1)!==0;let Z=0;const Y=(P&4)!==0,se=(P&256)!==0;let oe=0;const re=(P&512)!==0;let ce=0;const H=(P&1024)!==0,$=(P&2048)!==0;let X=0;const W=Wt(N,4);let ne=8;G&&(Z=Wt(N,ne),ne+=4),Y&&(ne+=4);let Ee=Z+c;for(let le=0;le<W;le++){if(se?(oe=Wt(N,ne),ne+=4):oe=M,re?(ce=Wt(N,ne),ne+=4):ce=I,H&&(ne+=4),$&&(B===0?X=Wt(N,ne):X=QI(N,ne),ne+=4),e.type===kn.VIDEO){let ye=0;for(;ye<ce;){const we=Wt(n,Ee);if(Ee+=4,HG(o,n[Ee])){const Ie=n.subarray(Ee,Ee+we);tL(Ie,o?2:1,s+X/i,t)}Ee+=we,ye+=we+4}}s+=oe/i}}))})})}),t}function GG(s){if(!s)return!1;const e=s.indexOf("."),t=e<0?s:s.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function HG(s,e){if(s){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function tL(s,e,t,n){const i=nL(s);let r=0;r+=e;let o=0,a=0,l=0;for(;r<i.length;){o=0;do{if(r>=i.length)break;l=i[r++],o+=l}while(l===255);a=0;do{if(r>=i.length)break;l=i[r++],a+=l}while(l===255);const c=i.length-r;let h=r;if(a<c)r+=a;else if(a>c){ve.error(`Malformed SEI payload. ${a} is too small, only ${c} bytes left to parse.`);break}if(o===4){if(i[h++]===181){const p=qI(i,h);if(h+=2,p===49){const y=Wt(i,h);if(h+=4,y===1195456820){const v=i[h++];if(v===3){const _=i[h++],S=31&_,A=64&_,w=A?2+S*3:0,M=new Uint8Array(w);if(A){M[0]=_;for(let C=1;C<w;C++)M[C]=i[h++]}n.push({type:v,payloadType:o,pts:t,bytes:M})}}}}}else if(o===5&&a>16){const f=[];for(let v=0;v<16;v++){const _=i[h++].toString(16);f.push(_.length==1?"0"+_:_),(v===3||v===5||v===7||v===9)&&f.push("-")}const p=a-16,y=new Uint8Array(p);for(let v=0;v<p;v++)y[v]=i[h++];n.push({payloadType:o,pts:t,uuid:f.join(""),userData:ka(y),userDataBytes:y})}}}function nL(s){const e=s.byteLength,t=[];let n=1;for(;n<e-2;)s[n]===0&&s[n+1]===0&&s[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return s;const i=e-t.length,r=new Uint8Array(i);let o=0;for(n=0;n<i;o++,n++)o===t[0]&&(o++,t.shift()),r[n]=s[o];return r}function zG(s){const e=s[0];let t="",n="",i=0,r=0,o=0,a=0,l=0,c=0;if(e===0){for(;$i(s.subarray(c,c+1))!=="\0";)t+=$i(s.subarray(c,c+1)),c+=1;for(t+=$i(s.subarray(c,c+1)),c+=1;$i(s.subarray(c,c+1))!=="\0";)n+=$i(s.subarray(c,c+1)),c+=1;n+=$i(s.subarray(c,c+1)),c+=1,i=Wt(s,12),r=Wt(s,16),a=Wt(s,20),l=Wt(s,24),c=28}else if(e===1){c+=4,i=Wt(s,c),c+=4;const f=Wt(s,c);c+=4;const p=Wt(s,c);for(c+=4,o=2**32*f+p,lG(o)||(o=Number.MAX_SAFE_INTEGER,ve.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=Wt(s,c),c+=4,l=Wt(s,c),c+=4;$i(s.subarray(c,c+1))!=="\0";)t+=$i(s.subarray(c,c+1)),c+=1;for(t+=$i(s.subarray(c,c+1)),c+=1;$i(s.subarray(c,c+1))!=="\0";)n+=$i(s.subarray(c,c+1)),c+=1;n+=$i(s.subarray(c,c+1)),c+=1}const h=s.subarray(c,s.byteLength);return{schemeIdUri:t,value:n,timeScale:i,presentationTime:o,presentationTimeDelta:r,eventDuration:a,id:l,payload:h}}function jG(s,...e){const t=e.length;let n=8,i=t;for(;i--;)n+=e[i].byteLength;const r=new Uint8Array(n);for(r[0]=n>>24&255,r[1]=n>>16&255,r[2]=n>>8&255,r[3]=n&255,r.set(s,4),i=0,n=8;i<t;i++)r.set(e[i],n),n+=e[i].byteLength;return r}function VG(s,e,t){if(s.byteLength!==16)throw new RangeError("Invalid system id");let n,i;n=0,i=new Uint8Array;let r;n>0?(r=new Uint8Array(4),e.length>0&&new DataView(r.buffer).setUint32(0,e.length,!1)):r=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),jG([112,115,115,104],new Uint8Array([n,0,0,0]),s,r,i,o,t||new Uint8Array)}function WG(s){const e=[];if(s instanceof ArrayBuffer){const t=s.byteLength;let n=0;for(;n+32<t;){const i=new DataView(s,n),r=KG(i);e.push(r),n+=r.size}}return e}function KG(s){const e=s.getUint32(0),t=s.byteOffset,n=s.byteLength;if(n<e)return{offset:t,size:n};if(s.getUint32(4)!==1886614376)return{offset:t,size:e};const r=s.getUint32(8)>>>24;if(r!==0&&r!==1)return{offset:t,size:e};const o=s.buffer,a=Ma.hexDump(new Uint8Array(o,t+12,16)),l=s.getUint32(28);let c=null,h=null;if(r===0){if(e-32<l||l<22)return{offset:t,size:e};h=new Uint8Array(o,t+32,l)}else if(r===1){if(!l||n<t+32+l*16+16)return{offset:t,size:e};c=[];for(let f=0;f<l;f++)c.push(new Uint8Array(o,t+32+f*16,16))}return{version:r,systemId:a,kids:c,data:h,offset:t,size:e}}let Ny={};class op{static clearKeyUriToKeyIdMap(){Ny={}}constructor(e,t,n,i=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case ts.FAIRPLAY:case ts.WIDEVINE:case ts.PLAYREADY:case ts.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&ve.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=XG(e);return new op(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=xG(this.uri);if(t)switch(this.keyFormat){case ts.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case ts.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=VG(n,null,t);const i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),r=String.fromCharCode.apply(null,Array.from(i)),o=r.substring(r.indexOf("<"),r.length),c=new DOMParser().parseFromString(o,"text/xml").getElementsByTagName("KID")[0];if(c){const h=c.childNodes[0]?c.childNodes[0].nodeValue:c.getAttribute("VALUE");if(h){const f=HE(h).subarray(0,16);vG(f),this.keyId=f}}break}default:{let n=t.subarray(0,16);if(n.length!==16){const i=new Uint8Array(16);i.set(n,16-n.length),n=i}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=Ny[this.uri];if(!n){const i=Object.keys(Ny).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,i),Ny[this.uri]=n}this.keyId=n}return this}}function XG(s){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=s>>8*(15-t)&255;return e}const iL=/\{\$([a-zA-Z0-9-_]+)\}/g;function k2(s){return iL.test(s)}function Ss(s,e,t){if(s.variableList!==null||s.hasVariableRefs)for(let n=t.length;n--;){const i=t[n],r=e[i];r&&(e[i]=rA(s,r))}}function rA(s,e){if(s.variableList!==null||s.hasVariableRefs){const t=s.variableList;return e.replace(iL,n=>{const i=n.substring(2,n.length-1),r=t==null?void 0:t[i];return r===void 0?(s.playlistParsingError||(s.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),n):r})}return e}function N2(s,e,t){let n=s.variableList;n||(s.variableList=n={});let i,r;if("QUERYPARAM"in e){i=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(i))r=o.get(i);else throw new Error(`"${i}" does not match any query parameter in URI: "${t}"`)}catch(o){s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else i=e.NAME,r=e.VALUE;i in n?s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):n[i]=r||""}function $G(s,e,t){const n=e.IMPORT;if(t&&n in t){let i=s.variableList;i||(s.variableList=i={}),i[n]=t[n]}else s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function eu(s=!0){return typeof self>"u"?void 0:(s||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function YG(s){return typeof self<"u"&&s===self.ManagedMediaSource}const ix={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function JG(s,e){const t=ix[e];return!!t&&!!t[s.slice(0,4)]}function sS(s,e,t=!0){return!s.split(",").some(n=>!rL(n,e,t))}function rL(s,e,t=!0){var n;const i=eu(t);return(n=i==null?void 0:i.isTypeSupported(g0(s,e)))!=null?n:!1}function g0(s,e){return`${e}/mp4;codecs="${s}"`}function U2(s){if(s){const e=s.substring(0,4);return ix.video[e]}return 2}function rx(s){return s.split(",").reduce((e,t)=>{const n=ix.video[t];return n?(n*2+e)/(e?3:2):(ix.audio[t]+e)/(e?2:1)},0)}const oS={};function qG(s,e=!0){if(oS[s])return oS[s];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[s];for(let n=0;n<t.length;n++)if(rL(t[n],"audio",e))return oS[s]=t[n],t[n];return s}const QG=/flac|opus/i;function sx(s,e=!0){return s.replace(QG,t=>qG(t.toLowerCase(),e))}function G2(s,e){return s&&s!=="mp4a"?s:e&&e.split(",")[0]}function ZG(s){const e=s.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");if(n.length>2){let i=n.shift()+".";i+=parseInt(n.shift()).toString(16),i+=("000"+parseInt(n.shift()).toString(16)).slice(-4),e[t]=i}}return e.join(",")}const H2=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,z2=/#EXT-X-MEDIA:(.*)/g,eH=/^#EXT(?:INF|-X-TARGETDURATION):/m,j2=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),tH=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class La{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return NE.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return eH.test(e)}static parseMasterPlaylist(e,t){const n=k2(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},r=[];H2.lastIndex=0;let o;for(;(o=H2.exec(e))!=null;)if(o[1]){var a;const c=new ri(o[1]);Ss(i,c,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const h=rA(i,o[2]),f={attrs:c,bitrate:c.decimalInteger("BANDWIDTH")||c.decimalInteger("AVERAGE-BANDWIDTH"),name:c.NAME,url:La.resolve(h,t)},p=c.decimalResolution("RESOLUTION");p&&(f.width=p.width,f.height=p.height),nH(c.CODECS,f),(a=f.unknownCodecs)!=null&&a.length||r.push(f),i.levels.push(f)}else if(o[3]){const c=o[3],h=o[4];switch(c){case"SESSION-DATA":{const f=new ri(h);Ss(i,f,["DATA-ID","LANGUAGE","VALUE","URI"]);const p=f["DATA-ID"];p&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[p]=f);break}case"SESSION-KEY":{const f=V2(h,t,i);f.encrypted&&f.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(f)):ve.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${h}"`);break}case"DEFINE":{{const f=new ri(h);Ss(i,f,["NAME","VALUE","QUERYPARAM"]),N2(i,f,t)}break}case"CONTENT-STEERING":{const f=new ri(h);Ss(i,f,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:La.resolve(f["SERVER-URI"],t),pathwayId:f["PATHWAY-ID"]||"."};break}case"START":{i.startTimeOffset=W2(h);break}}}const l=r.length>0&&r.length<i.levels.length;return i.levels=l?r:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const r={},o=n.levels,a={AUDIO:o.map(c=>({id:c.attrs.AUDIO,audioCodec:c.audioCodec})),SUBTITLES:o.map(c=>({id:c.attrs.SUBTITLES,textCodec:c.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(z2.lastIndex=0;(i=z2.exec(e))!==null;){const c=new ri(i[1]),h=c.TYPE;if(h){const f=a[h],p=r[h]||[];r[h]=p,Ss(n,c,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const y=c.LANGUAGE,v=c["ASSOC-LANGUAGE"],_=c.CHANNELS,S=c.CHARACTERISTICS,A=c["INSTREAM-ID"],w={attrs:c,bitrate:0,id:l++,groupId:c["GROUP-ID"]||"",name:c.NAME||y||"",type:h,default:c.bool("DEFAULT"),autoselect:c.bool("AUTOSELECT"),forced:c.bool("FORCED"),lang:y,url:c.URI?La.resolve(c.URI,t):""};if(v&&(w.assocLang=v),_&&(w.channels=_),S&&(w.characteristics=S),A&&(w.instreamId=A),f!=null&&f.length){const M=La.findGroup(f,w.groupId)||f[0];K2(w,M,"audioCodec"),K2(w,M,"textCodec")}p.push(w)}}return r}static parseLevelPlaylist(e,t,n,i,r,o){const a=new WI(t),l=a.fragments;let c=null,h=0,f=0,p=0,y=0,v=null,_=new nv(i,t),S,A,w,M=-1,C=!1,I=null;for(j2.lastIndex=0,a.m3u8=e,a.hasVariableRefs=k2(e);(S=j2.exec(e))!==null;){C&&(C=!1,_=new nv(i,t),_.start=p,_.sn=h,_.cc=y,_.level=n,c&&(_.initSegment=c,_.rawProgramDateTime=c.rawProgramDateTime,c.rawProgramDateTime=null,I&&(_.setByteRange(I),I=null)));const B=S[1];if(B){_.duration=parseFloat(B);const P=(" "+S[2]).slice(1);_.title=P||null,_.tagList.push(P?["INF",B,P]:["INF",B])}else if(S[3]){if(bt(_.duration)){_.start=p,w&&Y2(_,w,a),_.sn=h,_.level=n,_.cc=y,l.push(_);const P=(" "+S[3]).slice(1);_.relurl=rA(a,P),X2(_,v),v=_,p+=_.duration,h++,f=0,C=!0}}else if(S[4]){const P=(" "+S[4]).slice(1);v?_.setByteRange(P,v):_.setByteRange(P)}else if(S[5])_.rawProgramDateTime=(" "+S[5]).slice(1),_.tagList.push(["PROGRAM-DATE-TIME",_.rawProgramDateTime]),M===-1&&(M=l.length);else{if(S=S[0].match(tH),!S){ve.warn("No matches on slow regex match for level playlist!");continue}for(A=1;A<S.length&&!(typeof S[A]<"u");A++);const P=(" "+S[A]).slice(1),G=(" "+S[A+1]).slice(1),Z=S[A+2]?(" "+S[A+2]).slice(1):"";switch(P){case"PLAYLIST-TYPE":a.type=G.toUpperCase();break;case"MEDIA-SEQUENCE":h=a.startSN=parseInt(G);break;case"SKIP":{const Y=new ri(G);Ss(a,Y,["RECENTLY-REMOVED-DATERANGES"]);const se=Y.decimalInteger("SKIPPED-SEGMENTS");if(bt(se)){a.skippedSegments=se;for(let re=se;re--;)l.unshift(null);h+=se}const oe=Y.enumeratedString("RECENTLY-REMOVED-DATERANGES");oe&&(a.recentlyRemovedDateranges=oe.split("	"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(G),1);break;case"VERSION":a.version=parseInt(G);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(G||Z)&&_.tagList.push(Z?[G,Z]:[G]);break;case"DISCONTINUITY":y++,_.tagList.push(["DIS"]);break;case"GAP":_.gap=!0,_.tagList.push([P]);break;case"BITRATE":_.tagList.push([P,G]);break;case"DATERANGE":{const Y=new ri(G);Ss(a,Y,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Ss(a,Y,Y.clientAttrs);const se=new UE(Y,a.dateRanges[Y.ID]);se.isValid||a.skippedSegments?a.dateRanges[se.id]=se:ve.warn(`Ignoring invalid DATERANGE tag: "${G}"`),_.tagList.push(["EXT-X-DATERANGE",G]);break}case"DEFINE":{{const Y=new ri(G);Ss(a,Y,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in Y?$G(a,Y,o):N2(a,Y,t)}break}case"DISCONTINUITY-SEQUENCE":y=parseInt(G);break;case"KEY":{const Y=V2(G,t,a);if(Y.isSupported()){if(Y.method==="NONE"){w=void 0;break}w||(w={}),w[Y.keyFormat]&&(w=Gi({},w)),w[Y.keyFormat]=Y}else ve.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${G}"`);break}case"START":a.startTimeOffset=W2(G);break;case"MAP":{const Y=new ri(G);if(Ss(a,Y,["BYTERANGE","URI"]),_.duration){const se=new nv(i,t);$2(se,Y,n,w),c=se,_.initSegment=c,c.rawProgramDateTime&&!_.rawProgramDateTime&&(_.rawProgramDateTime=c.rawProgramDateTime)}else{const se=_.byteRangeEndOffset;if(se){const oe=_.byteRangeStartOffset;I=`${se-oe}@${oe}`}else I=null;$2(_,Y,n,w),c=_,C=!0}break}case"SERVER-CONTROL":{const Y=new ri(G);a.canBlockReload=Y.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=Y.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&Y.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=Y.optionalFloat("PART-HOLD-BACK",0),a.holdBack=Y.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const Y=new ri(G);a.partTarget=Y.decimalFloatingPoint("PART-TARGET");break}case"PART":{let Y=a.partList;Y||(Y=a.partList=[]);const se=f>0?Y[Y.length-1]:void 0,oe=f++,re=new ri(G);Ss(a,re,["BYTERANGE","URI"]);const ce=new VI(re,_,t,oe,se);Y.push(ce),_.duration+=ce.duration;break}case"PRELOAD-HINT":{const Y=new ri(G);Ss(a,Y,["URI"]),a.preloadHint=Y;break}case"RENDITION-REPORT":{const Y=new ri(G);Ss(a,Y,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(Y);break}default:ve.warn(`line parsed but not handled: ${S}`);break}}}v&&!v.relurl?(l.pop(),p-=v.duration,a.partList&&(a.fragmentHint=v)):a.partList&&(X2(_,v),_.cc=y,a.fragmentHint=_,w&&Y2(_,w,a));const O=l.length,k=l[0],N=l[O-1];if(p+=a.skippedSegments*a.targetduration,p>0&&O&&N){a.averagetargetduration=p/O;const B=N.sn;a.endSN=B!=="initSegment"?B:0,a.live||(N.endList=!0),k&&(a.startCC=k.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(p+=a.fragmentHint.duration),a.totalduration=p,a.endCC=y,M>0&&iH(l,M),a}}function V2(s,e,t){var n,i;const r=new ri(s);Ss(t,r,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=(n=r.METHOD)!=null?n:"",a=r.URI,l=r.hexadecimalInteger("IV"),c=r.KEYFORMATVERSIONS,h=(i=r.KEYFORMAT)!=null?i:"identity";a&&r.IV&&!l&&ve.error(`Invalid IV: ${r.IV}`);const f=a?La.resolve(a,e):"",p=(c||"1").split("/").map(Number).filter(Number.isFinite);return new op(o,f,h,p,l)}function W2(s){const t=new ri(s).decimalFloatingPoint("TIME-OFFSET");return bt(t)?t:null}function nH(s,e){let t=(s||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const i=t.filter(r=>JG(r,n));i.length&&(e[`${n}Codec`]=i.join(","),t=t.filter(r=>i.indexOf(r)===-1))}),e.unknownCodecs=t}function K2(s,e,t){const n=e[t];n&&(s[t]=n)}function iH(s,e){let t=s[e];for(let n=e;n--;){const i=s[n];if(!i)return;i.programDateTime=t.programDateTime-i.duration*1e3,t=i}}function X2(s,e){s.rawProgramDateTime?s.programDateTime=Date.parse(s.rawProgramDateTime):e!=null&&e.programDateTime&&(s.programDateTime=e.endProgramDateTime),bt(s.programDateTime)||(s.programDateTime=null,s.rawProgramDateTime=null)}function $2(s,e,t,n){s.relurl=e.URI,e.BYTERANGE&&s.setByteRange(e.BYTERANGE),s.level=t,s.sn="initSegment",n&&(s.levelkeys=n),s.initSegment=null}function Y2(s,e,t){s.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&n.push(s)}var Tn={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Ht={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function J2(s){const{type:e}=s;switch(e){case Tn.AUDIO_TRACK:return Ht.AUDIO;case Tn.SUBTITLE_TRACK:return Ht.SUBTITLE;default:return Ht.MAIN}}function aS(s,e){let t=s.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class rH{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.LEVEL_LOADING,this.onLevelLoading,this),e.on(z.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(z.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.LEVEL_LOADING,this.onLevelLoading,this),e.off(z.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(z.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=n||i,o=new r(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Tn.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:r,url:o,deliveryDirectives:a}=t;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:Tn.LEVEL,url:o,deliveryDirectives:a})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:o}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Tn.AUDIO_TRACK,url:r,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:o}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Tn.SUBTITLE_TRACK,url:r,deliveryDirectives:o})}load(e){var t;const n=this.hls.config;let i=this.getInternalLoader(e);if(i){const c=i.context;if(c&&c.url===e.url&&c.level===e.level){ve.trace("[playlist-loader]: playlist request ongoing");return}ve.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}let r;if(e.type===Tn.MANIFEST?r=n.manifestLoadPolicy.default:r=Gi({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),bt((t=e.deliveryDirectives)==null?void 0:t.part)){let c;if(e.type===Tn.LEVEL&&e.level!==null?c=this.hls.levels[e.level].details:e.type===Tn.AUDIO_TRACK&&e.id!==null?c=this.hls.audioTracks[e.id].details:e.type===Tn.SUBTITLE_TRACK&&e.id!==null&&(c=this.hls.subtitleTracks[e.id].details),c){const h=c.partTarget,f=c.targetduration;if(h&&f){const p=Math.max(h*3,f*.8)*1e3;r=Gi({},r,{maxTimeToFirstByteMs:Math.min(p,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(p,r.maxTimeToFirstByteMs)})}}}const o=r.errorRetry||r.timeoutRetry||{},a={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(c,h,f,p)=>{const y=this.getInternalLoader(f);this.resetInternalLoader(f.type);const v=c.data;if(v.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(c,f,new Error("no EXTM3U delimiter"),p||null,h);return}h.parsing.start=performance.now(),La.isMediaPlaylist(v)?this.handleTrackOrLevelPlaylist(c,h,f,p||null,y):this.handleMasterPlaylist(c,h,f,p)},onError:(c,h,f,p)=>{this.handleNetworkError(h,f,!1,c,p)},onTimeout:(c,h,f)=>{this.handleNetworkError(h,f,!0,void 0,c)}};i.load(e,a,l)}handleMasterPlaylist(e,t,n,i){const r=this.hls,o=e.data,a=aS(e,n),l=La.parseMasterPlaylist(o,a);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,i,t);return}const{contentSteering:c,levels:h,sessionData:f,sessionKeys:p,startTimeOffset:y,variableList:v}=l;this.variableList=v;const{AUDIO:_=[],SUBTITLES:S,"CLOSED-CAPTIONS":A}=La.parseMasterPlaylistMedia(o,a,l);_.length&&!_.some(M=>!M.url)&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(ve.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),_.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ri({}),bitrate:0,url:""})),r.trigger(z.MANIFEST_LOADED,{levels:h,audioTracks:_,subtitles:S,captions:A,contentSteering:c,url:a,stats:t,networkDetails:i,sessionData:f,sessionKeys:p,startTimeOffset:y,variableList:v})}handleTrackOrLevelPlaylist(e,t,n,i,r){const o=this.hls,{id:a,level:l,type:c}=n,h=aS(e,n),f=0,p=bt(l)?l:bt(a)?a:0,y=J2(n),v=La.parseLevelPlaylist(e.data,h,p,y,f,this.variableList);if(c===Tn.MANIFEST){const _={attrs:new ri({}),bitrate:0,details:v,name:"",url:h};o.trigger(z.MANIFEST_LOADED,{levels:[_],audioTracks:[],url:h,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=v,this.handlePlaylistLoaded(v,e,t,n,i,r)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger(z.ERROR,{type:Yt.NETWORK_ERROR,details:Le.MANIFEST_PARSING_ERROR,fatal:t.type===Tn.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t,n=!1,i,r){let o=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===Tn.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===Tn.AUDIO_TRACK||e.type===Tn.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);ve.warn(`[playlist-loader]: ${o}`);let l=Le.UNKNOWN,c=!1;const h=this.getInternalLoader(e);switch(e.type){case Tn.MANIFEST:l=n?Le.MANIFEST_LOAD_TIMEOUT:Le.MANIFEST_LOAD_ERROR,c=!0;break;case Tn.LEVEL:l=n?Le.LEVEL_LOAD_TIMEOUT:Le.LEVEL_LOAD_ERROR,c=!1;break;case Tn.AUDIO_TRACK:l=n?Le.AUDIO_TRACK_LOAD_TIMEOUT:Le.AUDIO_TRACK_LOAD_ERROR,c=!1;break;case Tn.SUBTITLE_TRACK:l=n?Le.SUBTITLE_TRACK_LOAD_TIMEOUT:Le.SUBTITLE_LOAD_ERROR,c=!1;break}h&&this.resetInternalLoader(e.type);const f={type:Yt.NETWORK_ERROR,details:l,fatal:c,url:e.url,loader:h,context:e,error:a,networkDetails:t,stats:r};if(i){const p=(t==null?void 0:t.url)||e.url;f.response=fr({url:p,data:void 0},i)}this.hls.trigger(z.ERROR,f)}handlePlaylistLoaded(e,t,n,i,r,o){const a=this.hls,{type:l,level:c,id:h,groupId:f,deliveryDirectives:p}=i,y=aS(t,i),v=J2(i),_=typeof i.level=="number"&&v===Ht.MAIN?c:void 0;if(!e.fragments.length){const A=new Error("No Segments found in Playlist");a.trigger(z.ERROR,{type:Yt.NETWORK_ERROR,details:Le.LEVEL_EMPTY_ERROR,fatal:!1,url:y,error:A,reason:A.message,response:t,context:i,level:_,parent:v,networkDetails:r,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const S=e.playlistParsingError;if(S){a.trigger(z.ERROR,{type:Yt.NETWORK_ERROR,details:Le.LEVEL_PARSING_ERROR,fatal:!1,url:y,error:S,reason:S.message,response:t,context:i,level:_,parent:v,networkDetails:r,stats:n});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case Tn.MANIFEST:case Tn.LEVEL:a.trigger(z.LEVEL_LOADED,{details:e,level:_||0,id:h||0,stats:n,networkDetails:r,deliveryDirectives:p});break;case Tn.AUDIO_TRACK:a.trigger(z.AUDIO_TRACK_LOADED,{details:e,id:h||0,groupId:f||"",stats:n,networkDetails:r,deliveryDirectives:p});break;case Tn.SUBTITLE_TRACK:a.trigger(z.SUBTITLE_TRACK_LOADED,{details:e,id:h||0,groupId:f||"",stats:n,networkDetails:r,deliveryDirectives:p});break}}}function sL(s,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=s,e.dispatchEvent(t)}function oL(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues&&!s.cues.getCueById(e.id))try{if(s.addCue(e),!s.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){ve.debug(`[texttrack-utils]: ${n}`);try{const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,s.addCue(i)}catch(i){ve.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}t==="disabled"&&(s.mode=t)}function Gf(s){const e=s.mode;if(e==="disabled"&&(s.mode="hidden"),s.cues)for(let t=s.cues.length;t--;)s.removeCue(s.cues[t]);e==="disabled"&&(s.mode=e)}function sA(s,e,t,n){const i=s.mode;if(i==="disabled"&&(s.mode="hidden"),s.cues&&s.cues.length>0){const r=oH(s.cues,e,t);for(let o=0;o<r.length;o++)(!n||n(r[o]))&&s.removeCue(r[o])}i==="disabled"&&(s.mode=i)}function sH(s,e){if(e<s[0].startTime)return 0;const t=s.length-1;if(e>s[t].endTime)return-1;let n=0,i=t;for(;n<=i;){const r=Math.floor((i+n)/2);if(e<s[r].startTime)i=r-1;else if(e>s[r].startTime&&n<t)n=r+1;else return r}return s[n].startTime-e<e-s[i].startTime?n:i}function oH(s,e,t){const n=[],i=sH(s,e);if(i>-1)for(let r=i,o=s.length;r<o;r++){const a=s[r];if(a.startTime>=e&&a.endTime<=t)n.push(a);else if(a.startTime>t)return n}return n}function iv(s){const e=[];for(let t=0;t<s.length;t++){const n=s[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(s[t])}return e}var _o={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const aH=.25;function oA(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function q2(s,e,t,n,i){let r=new s(e,t,"");try{r.value=n,i&&(r.type=i)}catch{r=new s(e,t,JSON.stringify(i?fr({type:i},n):n))}return r}const Uy=(()=>{const s=oA();try{s&&new s(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function lS(s,e){return s.getTime()/1e3-e}function lH(s){return Uint8Array.from(s.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class cH{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(z.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(z.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Gf(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return sL(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=oA();if(o)for(let a=0;a<r.length;a++){const l=r[a].type;if(l===_o.emsg&&!n||!i)continue;const c=YI(r[a].data);if(c){const h=r[a].pts;let f=h+r[a].duration;f>Uy&&(f=Uy),f-h<=0&&(f=h+aH);for(let y=0;y<c.length;y++){const v=c[y];if(!$I(v)){this.updateId3CueEnds(h,l);const _=q2(o,h,f,v,l);_&&this.id3Track.addCue(_)}}}}}updateId3CueEnds(e,t){var n;const i=(n=this.id3Track)==null?void 0:n.cues;if(i)for(let r=i.length;r--;){const o=i[r];o.type===t&&o.startTime<e&&o.endTime===Uy&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:r,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}=o;if(r&&(a||l)){let c;i==="audio"?c=h=>h.type===_o.audioId3&&l:i==="video"?c=h=>h.type===_o.emsg&&a:c=h=>h.type===_o.audioId3&&l||h.type===_o.emsg&&a,sA(r,t,n,c)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:i}=this,{dateRanges:r}=t,o=Object.keys(r);if(i){const h=Object.keys(n).filter(f=>!o.includes(f));for(let f=h.length;f--;){const p=h[f];Object.keys(n[p].cues).forEach(y=>{i.removeCue(n[p].cues[y])}),delete n[p]}}const a=t.fragments[t.fragments.length-1];if(o.length===0||!bt(a==null?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=a.programDateTime/1e3-a.start,c=oA();for(let h=0;h<o.length;h++){const f=o[h],p=r[f],y=lS(p.startDate,l),v=n[f],_=(v==null?void 0:v.cues)||{};let S=(v==null?void 0:v.durationKnown)||!1,A=Uy;const w=p.endDate;if(w)A=lS(w,l),S=!0;else if(p.endOnNext&&!S){const C=o.reduce((I,O)=>{if(O!==p.id){const k=r[O];if(k.class===p.class&&k.startDate>p.startDate&&(!I||p.startDate<I.startDate))return k}return I},null);C&&(A=lS(C.startDate,l),S=!0)}const M=Object.keys(p.attr);for(let C=0;C<M.length;C++){const I=M[C];if(!pG(I))continue;const O=_[I];if(O)S&&!v.durationKnown&&(O.endTime=A);else if(c){let k=p.attr[I];mG(I)&&(k=lH(k));const N=q2(c,y,A,{key:I,data:k},_o.dateRange);N&&(N.id=f,this.id3Track.addCue(N),_[I]=N)}}n[f]={cues:_,dateRange:p,durationKnown:S}}}}class uH{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,l=this.hls.userConfig;let c=a&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||c===0)&&(c=r!==void 0?r:o*i);const h=i;return c+Math.min(this.stallCount*1,h)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;const i=n.edge,r=e-t-this.edgeStalled,o=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,r),a)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(z.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(z.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(z.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(z.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(z.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(z.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===Le.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&ve.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||r===1||!t.live)return;const o=this.targetLatency;if(o===null)return;const a=n-o,l=Math.min(this.maxLatency,o+t.targetduration);if(a<l&&a>.05&&this.forwardBufferLength>1){const h=Math.min(2,Math.max(1,r)),f=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(h,Math.max(1,f))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const aA=["NONE","TYPE-0","TYPE-1",null];function hH(s){return aA.indexOf(s)>-1}const ox=["SDR","PQ","HLG"];function dH(s){return!!s&&ox.indexOf(s)>-1}var Qm={No:"",Yes:"YES",v2:"v2"};function Q2(s){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=s,i=n<e/2;return e&&i?t?Qm.v2:Qm.Yes:Qm.No}class lA{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Wh{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return Z2(this._audioGroups,e)}hasSubtitleGroup(e){return Z2(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function Z2(s,e){return!e||!s?!1:s.indexOf(e)!==-1}function cS(s,e){const t=e.startPTS;if(bt(t)){let n=0,i;e.sn>s.sn?(n=t-s.start,i=s):(n=s.start-t,i=e),i.duration!==n&&(i.duration=n)}else e.sn>s.sn?s.cc===e.cc&&s.minEndPTS?e.start=s.start+(s.minEndPTS-s.start):e.start=s.start+s.duration:e.start=Math.max(s.start-e.duration,0)}function aL(s,e,t,n,i,r){n-t<=0&&(ve.warn("Fragment should have a positive duration",e),n=t+e.duration,r=i+e.duration);let a=t,l=n;const c=e.startPTS,h=e.endPTS;if(bt(c)){const S=Math.abs(c-t);bt(e.deltaPTS)?e.deltaPTS=Math.max(S,e.deltaPTS):e.deltaPTS=S,a=Math.max(t,c),t=Math.min(t,c),i=Math.min(i,e.startDTS),l=Math.min(n,h),n=Math.max(n,h),r=Math.max(r,e.endDTS)}const f=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=a,e.startDTS=i,e.endPTS=n,e.minEndPTS=l,e.endDTS=r;const p=e.sn;if(!s||p<s.startSN||p>s.endSN)return 0;let y;const v=p-s.startSN,_=s.fragments;for(_[v]=e,y=v;y>0;y--)cS(_[y],_[y-1]);for(y=v;y<_.length-1;y++)cS(_[y],_[y+1]);return s.fragmentHint&&cS(_[_.length-1],s.fragmentHint),s.PTSKnown=s.alignedSliding=!0,f}function fH(s,e){let t=null;const n=s.fragments;for(let l=n.length-1;l>=0;l--){const c=n[l].initSegment;if(c){t=c;break}}s.fragmentHint&&delete s.fragmentHint.endPTS;let i=0,r;if(gH(s,e,(l,c)=>{l.relurl&&(i=l.cc-c.cc),bt(l.startPTS)&&bt(l.endPTS)&&(c.start=c.startPTS=l.startPTS,c.startDTS=l.startDTS,c.maxStartPTS=l.maxStartPTS,c.endPTS=l.endPTS,c.endDTS=l.endDTS,c.minEndPTS=l.minEndPTS,c.duration=l.endPTS-l.startPTS,c.duration&&(r=c),e.PTSKnown=e.alignedSliding=!0),c.elementaryStreams=l.elementaryStreams,c.loader=l.loader,c.stats=l.stats,l.initSegment&&(c.initSegment=l.initSegment,t=l.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(c=>{var h;c&&(!c.initSegment||c.initSegment.relurl===((h=t)==null?void 0:h.relurl))&&(c.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(l=>!l),e.deltaUpdateFailed){ve.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=pH(s.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const o=e.fragments;if(i){ve.warn("discontinuity sliding from playlist, take drift into account");for(let l=0;l<o.length;l++)o[l].cc+=i}e.skippedSegments&&(e.startCC=e.fragments[0].cc),mH(s.partList,e.partList,(l,c)=>{c.elementaryStreams=l.elementaryStreams,c.stats=l.stats}),r?aL(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):lL(s,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=s.driftStartTime,e.driftStart=s.driftStart;const a=e.advancedDateTime;if(e.advanced&&a){const l=e.edge;e.driftStart||(e.driftStartTime=a,e.driftStart=l),e.driftEndTime=a,e.driftEnd=l}else e.driftEndTime=s.driftEndTime,e.driftEnd=s.driftEnd,e.advancedDateTime=s.advancedDateTime}function pH(s,e,t){const n=Gi({},s);return t&&t.forEach(i=>{delete n[i]}),Object.keys(e).forEach(i=>{const r=new UE(e[i].attr,n[i]);r.isValid?n[i]=r:ve.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[i].attr)}"`)}),n}function mH(s,e,t){if(s&&e){let n=0;for(let i=0,r=s.length;i<=r;i++){const o=s[i],a=e[i+n];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?t(o,a):n--}}}function gH(s,e,t){const n=e.skippedSegments,i=Math.max(s.startSN,e.startSN)-e.startSN,r=(s.fragmentHint?1:0)+(n?e.endSN:Math.min(s.endSN,e.endSN))-e.startSN,o=e.startSN-s.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments;for(let c=i;c<=r;c++){const h=l[o+c];let f=a[c];n&&!f&&c<n&&(f=e.fragments[c]=h),h&&f&&t(h,f)}}function lL(s,e){const t=e.startSN+e.skippedSegments-s.startSN,n=s.fragments;t<0||t>=n.length||cA(e,n[t].start)}function cA(s,e){if(e){const t=s.fragments;for(let n=s.skippedSegments;n<t.length;n++)t[n].start+=e;s.fragmentHint&&(s.fragmentHint.start+=e)}}function yH(s,e=1/0){let t=1e3*s.targetduration;if(s.updated){const n=s.fragments;if(n.length&&t*4>e){const r=n[n.length-1].duration*1e3;r<t&&(t=r)}}else t/=2;return Math.round(t)}function vH(s,e,t){if(!(s!=null&&s.details))return null;const n=s.details;let i=n.fragments[e-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===e)?i:e<n.startSN&&t&&t.sn===e?t:null}function eb(s,e,t){var n;return s!=null&&s.details?cL((n=s.details)==null?void 0:n.partList,e,t):null}function cL(s,e,t){if(s)for(let n=s.length;n--;){const i=s[n];if(i.index===t&&i.fragment.sn===e)return i}return null}function uL(s){s.forEach((e,t)=>{const{details:n}=e;n!=null&&n.fragments&&n.fragments.forEach(i=>{i.level=t})})}function ax(s){switch(s.details){case Le.FRAG_LOAD_TIMEOUT:case Le.KEY_LOAD_TIMEOUT:case Le.LEVEL_LOAD_TIMEOUT:case Le.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function tb(s,e){const t=ax(e);return s.default[`${t?"timeout":"error"}Retry`]}function VE(s,e){const t=s.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*s.retryDelayMs,s.maxRetryDelayMs)}function nb(s){return fr(fr({},s),{errorRetry:null,timeoutRetry:null})}function lx(s,e,t,n){if(!s)return!1;const i=n==null?void 0:n.code,r=e<s.maxNumRetry&&(xH(i)||!!t);return s.shouldRetry?s.shouldRetry(s,e,t,n,r):r}function xH(s){return s===0&&navigator.onLine===!1||!!s&&(s<400||s>499)}const hL={search:function(s,e){let t=0,n=s.length-1,i=null,r=null;for(;t<=n;){i=(t+n)/2|0,r=s[i];const o=e(r);if(o>0)t=i+1;else if(o<0)n=i-1;else return r}return null}};function _H(s,e,t){if(e===null||!Array.isArray(s)||!s.length||!bt(e))return null;const n=s[0].programDateTime;if(e<(n||0))return null;const i=s[s.length-1].endProgramDateTime;if(e>=(i||0))return null;t=t||0;for(let r=0;r<s.length;++r){const o=s[r];if(AH(e,t,o))return o}return null}function cx(s,e,t=0,n=0,i=.005){let r=null;if(s){r=e[s.sn-e[0].sn+1]||null;const a=s.endDTS-t;a>0&&a<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(r=e[0]);if(r&&((!s||s.level===r.level)&&uA(t,n,r)===0||SH(r,s,Math.min(i,n))))return r;const o=hL.search(e,uA.bind(null,t,n));return o&&(o!==s||!r)?o:r}function SH(s,e,t){if(e&&e.start===0&&e.level<s.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((i,r)=>(r[0]==="INF"&&(i+=parseFloat(r[1])),i),t);return s.start<=n}return!1}function uA(s=0,e=0,t){if(t.start<=s&&t.start+t.duration>s)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=s?1:t.start-n>s&&t.start?-1:0}function AH(s,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>s}function EH(s,e){return hL.search(s,t=>t.cc<e?1:t.cc>e?-1:0)}var Yi={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},go={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class dL{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=ve.log.bind(ve,"[info]:"),this.warn=ve.warn.bind(ve,"[warning]:"),this.error=ve.error.bind(ve,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(z.ERROR,this.onError,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(z.ERROR,this.onError,this),e.off(z.ERROR,this.onErrorOut,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Ht.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,i;if(t.fatal)return;const r=this.hls,o=t.context;switch(t.details){case Le.FRAG_LOAD_ERROR:case Le.FRAG_LOAD_TIMEOUT:case Le.KEY_LOAD_ERROR:case Le.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case Le.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction={action:Yi.DoNothing,flags:go.None};return}case Le.FRAG_GAP:case Le.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Yi.SendAlternateToPenaltyBox;return}case Le.LEVEL_EMPTY_ERROR:case Le.LEVEL_PARSING_ERROR:{var a,l;const c=t.parent===Ht.MAIN?t.level:r.loadLevel;t.details===Le.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(l=a.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,c):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,c))}return;case Le.LEVEL_LOAD_ERROR:case Le.LEVEL_LOAD_TIMEOUT:typeof(o==null?void 0:o.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case Le.AUDIO_TRACK_LOAD_ERROR:case Le.AUDIO_TRACK_LOAD_TIMEOUT:case Le.SUBTITLE_LOAD_ERROR:case Le.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const c=r.levels[r.loadLevel];if(c&&(o.type===Tn.AUDIO_TRACK&&c.hasAudioGroup(o.groupId)||o.type===Tn.SUBTITLE_TRACK&&c.hasSubtitleGroup(o.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=Yi.SendAlternateToPenaltyBox,t.errorAction.flags=go.MoveAllAlternatesMatchingHost;return}}return;case Le.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const c=r.levels[r.loadLevel],h=c==null?void 0:c.attrs["HDCP-LEVEL"];h?t.errorAction={action:Yi.SendAlternateToPenaltyBox,flags:go.MoveAllAlternatesMatchingHDCP,hdcpLevel:h}:this.keySystemError(t)}return;case Le.BUFFER_ADD_CODEC_ERROR:case Le.REMUX_ALLOC_ERROR:case Le.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(i=t.level)!=null?i:r.loadLevel);return;case Le.INTERNAL_EXCEPTION:case Le.BUFFER_APPENDING_ERROR:case Le.BUFFER_FULL_ERROR:case Le.LEVEL_SWITCH_ERROR:case Le.BUFFER_STALLED_ERROR:case Le.BUFFER_SEEK_OVER_HOLE:case Le.BUFFER_NUDGE_ON_STALL:t.errorAction={action:Yi.DoNothing,flags:go.None};return}t.type===Yt.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,i=tb(n.config.playlistLoadPolicy,e),r=this.playlistError++;if(lx(i,r,ax(e),e.response))return{action:Yi.RetryRequest,flags:go.None,retryConfig:i,retryCount:r};const a=this.getLevelSwitchAction(e,t);return i&&(a.retryConfig=i,a.retryCount=r),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:o}=t.config,a=tb(e.details.startsWith("key")?o:r,e),l=t.levels.reduce((h,f)=>h+f.fragmentError,0);if(i&&(e.details!==Le.FRAG_GAP&&i.fragmentError++,lx(a,l,ax(e),e.response)))return{action:Yi.RetryRequest,flags:go.None,retryConfig:a,retryCount:l};const c=this.getLevelSwitchAction(e,n);return a&&(c.retryConfig=a,c.retryCount=l),c}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const i=this.hls.levels[t];if(i){var r,o;const c=e.details;i.loadError++,c===Le.BUFFER_APPEND_ERROR&&i.fragmentError++;let h=-1;const{levels:f,loadLevel:p,minAutoLevel:y,maxAutoLevel:v}=n;n.autoLevelEnabled||(n.loadLevel=-1);const _=(r=e.frag)==null?void 0:r.type,A=(_===Ht.AUDIO&&c===Le.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(c===Le.BUFFER_ADD_CODEC_ERROR||c===Le.BUFFER_APPEND_ERROR))&&f.some(({audioCodec:O})=>i.audioCodec!==O),M=e.sourceBufferName==="video"&&(c===Le.BUFFER_ADD_CODEC_ERROR||c===Le.BUFFER_APPEND_ERROR)&&f.some(({codecSet:O,audioCodec:k})=>i.codecSet!==O&&i.audioCodec===k),{type:C,groupId:I}=(o=e.context)!=null?o:{};for(let O=f.length;O--;){const k=(O+p)%f.length;if(k!==p&&k>=y&&k<=v&&f[k].loadError===0){var a,l;const N=f[k];if(c===Le.FRAG_GAP&&_===Ht.MAIN&&e.frag){const B=f[k].details;if(B){const P=cx(e.frag,B.fragments,e.frag.start);if(P!=null&&P.gap)continue}}else{if(C===Tn.AUDIO_TRACK&&N.hasAudioGroup(I)||C===Tn.SUBTITLE_TRACK&&N.hasSubtitleGroup(I))continue;if(_===Ht.AUDIO&&(a=i.audioGroups)!=null&&a.some(B=>N.hasAudioGroup(B))||_===Ht.SUBTITLE&&(l=i.subtitleGroups)!=null&&l.some(B=>N.hasSubtitleGroup(B))||A&&i.audioCodec===N.audioCodec||!A&&i.audioCodec!==N.audioCodec||M&&i.codecSet===N.codecSet)continue}h=k;break}}if(h>-1&&n.loadLevel!==h)return e.levelRetry=!0,this.playlistError=0,{action:Yi.SendAlternateToPenaltyBox,flags:go.None,nextAutoLevel:h}}return{action:Yi.SendAlternateToPenaltyBox,flags:go.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case Yi.DoNothing:break;case Yi.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Le.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break;case Yi.RetryRequest:break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:r,nextAutoLevel:o}=n;switch(i){case go.None:this.switchLevel(e,o);break;case go.MoveAllAlternatesMatchingHDCP:r&&(t.maxHdcpLevel=aA[aA.indexOf(r)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class i_{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=ve.log.bind(ve,`${t}:`),this.warn=ve.warn.bind(ve,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=t==null?void 0:t.renditionReports;if(i){let r=-1;for(let o=0;o<i.length;o++){const a=i[o];let l;try{l=new self.URL(a.URI,t.url).href}catch(c){ve.warn(`Could not construct new URL for Rendition Report: ${c}`),l=a.URI||""}if(l===e){r=o;break}else l===e.substring(0,l.length)&&(r=o)}if(r!==-1){const o=i[r],a=parseInt(o["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let l=parseInt(o["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const h=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&h>t.partTarget&&(l+=1)}const c=n&&Q2(n);return new lA(a,l>=0?l:void 0,c)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:i,stats:r}=t,o=self.performance.now(),a=r.loading.first?Math.max(0,o-r.loading.first):0;if(i.advancedDateTime=Date.now()-a,i.live||n!=null&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),n&&i.fragments.length>0&&fH(n,i),!this.canLoad||!i.live)return;let l,c,h;if(i.canBlockReload&&i.endSN&&i.advanced){const S=this.hls.config.lowLatencyMode,A=i.lastPartSn,w=i.endSN,M=i.lastPartIndex,C=M!==-1,I=A===w,O=S?0:M;C?(c=I?w+1:A,h=I?O:M+1):c=w+1;const k=i.age,N=k+i.ageHeader;let B=Math.min(N-i.partTarget,i.targetduration*1.5);if(B>0){if(n&&B>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${B} with playlist age: ${i.age}`),B=0;else{const P=Math.floor(B/i.targetduration);if(c+=P,h!==void 0){const G=Math.round(B%i.targetduration/i.partTarget);h+=G}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${k.toFixed(2)}s goal: ${B} skip sn ${P} to part ${h}`)}i.tuneInGoal=B}if(l=this.getDeliveryDirectives(i,t.deliveryDirectives,c,h),S||!I){this.loadPlaylist(l);return}}else(i.canBlockReload||i.canSkipUntil)&&(l=this.getDeliveryDirectives(i,t.deliveryDirectives,c,h));const f=this.hls.mainForwardBufferInfo,p=f?f.end-f.len:0,y=(i.edge-p)*1e3,v=yH(i,y);i.updated&&o>this.requestScheduled+v&&(this.requestScheduled=r.loading.start),c!==void 0&&i.canBlockReload?this.requestScheduled=r.loading.first+v-(i.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+v<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=v);let _=this.requestScheduled-o;_=Math.max(0,_),this.log(`reload live playlist ${e} in ${Math.round(_)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),_)}else this.clearTimer()}getDeliveryDirectives(e,t,n,i){let r=Q2(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=Qm.No),new lA(n,i,r)}checkRetry(e){const t=e.details,n=ax(e),i=e.errorAction,{action:r,retryCount:o=0,retryConfig:a}=i||{},l=!!i&&!!a&&(r===Yi.RetryRequest||!i.resolved&&r===Yi.SendAlternateToPenaltyBox);if(l){var c;if(this.requestScheduled=-1,o>=a.maxNumRetry)return!1;if(n&&(c=e.context)!=null&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const h=VE(a,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),h),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${h}ms`)}e.levelRetry=!0,i.resolved=!0}return l}}class Mf{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class TH{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Mf(e),this.fast_=new Mf(t),this.defaultTTFB_=i,this.ttfb_=new Mf(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new Mf(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new Mf(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new Mf(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,r=n/i;this.fast_.sample(i,r),this.slow_.sample(i,r)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const fL={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},ib={};function wH(s,e,t,n,i,r){const o=s.audioCodec?s.audioGroups:null,a=r==null?void 0:r.audioCodec,l=r==null?void 0:r.channels,c=l?parseInt(l):a?1/0:2;let h=null;if(o!=null&&o.length)try{o.length===1&&o[0]?h=e.groups[o[0]].channels:h=o.reduce((f,p)=>{if(p){const y=e.groups[p];if(!y)throw new Error(`Audio track group ${p} not found`);Object.keys(y.channels).forEach(v=>{f[v]=(f[v]||0)+y.channels[v]})}return f},{2:0})}catch{return!0}return s.videoCodec!==void 0&&(s.width>1920&&s.height>1088||s.height>1920&&s.width>1088||s.frameRate>Math.max(n,30)||s.videoRange!=="SDR"&&s.videoRange!==t||s.bitrate>Math.max(i,8e6))||!!h&&bt(c)&&Object.keys(h).some(f=>parseInt(f)>c)}function MH(s,e,t){const n=s.videoCodec,i=s.audioCodec;if(!n||!i||!t)return Promise.resolve(fL);const r={width:s.width,height:s.height,bitrate:Math.ceil(Math.max(s.bitrate*.9,s.averageBitrate)),framerate:s.frameRate||30},o=s.videoRange;o!=="SDR"&&(r.transferFunction=o.toLowerCase());const a=n.split(",").map(l=>({type:"media-source",video:fr(fr({},r),{},{contentType:g0(l,"video")})}));return i&&s.audioGroups&&s.audioGroups.forEach(l=>{var c;l&&((c=e.groups[l])==null||c.tracks.forEach(h=>{if(h.groupId===l){const f=h.channels||"",p=parseFloat(f);bt(p)&&p>2&&a.push.apply(a,i.split(",").map(y=>({type:"media-source",audio:{contentType:g0(y,"audio"),channels:""+p}})))}}))}),Promise.all(a.map(l=>{const c=bH(l);return ib[c]||(ib[c]=t.decodingInfo(l))})).then(l=>({supported:!l.some(c=>!c.supported),configurations:a,decodingInfoResults:l})).catch(l=>({supported:!1,configurations:a,decodingInfoResults:[],error:l}))}function bH(s){const{audio:e,video:t}=s,n=t||e;if(n){const i=n.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${i}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${i}`}return""}function CH(){if(typeof matchMedia=="function"){const s=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(s.media!==e.media)return s.matches===!0}return!1}function RH(s,e){let t=!1,n=[];return s&&(t=s!=="SDR",n=[s]),e&&(n=e.allowedVideoRanges||ox.slice(0),t=e.preferHDR!==void 0?e.preferHDR:CH(),t?n=n.filter(i=>i!=="SDR"):n=["SDR"]),{preferHDR:t,allowedVideoRanges:n}}function IH(s,e,t,n,i){const r=Object.keys(s),o=n==null?void 0:n.channels,a=n==null?void 0:n.audioCodec,l=o&&parseInt(o)===2;let c=!0,h=!1,f=1/0,p=1/0,y=1/0,v=0,_=[];const{preferHDR:S,allowedVideoRanges:A}=RH(e,i);for(let I=r.length;I--;){const O=s[r[I]];c=O.channels[2]>0,f=Math.min(f,O.minHeight),p=Math.min(p,O.minFramerate),y=Math.min(y,O.minBitrate);const k=A.filter(N=>O.videoRanges[N]>0);k.length>0&&(h=!0,_=k)}f=bt(f)?f:0,p=bt(p)?p:0;const w=Math.max(1080,f),M=Math.max(30,p);return y=bt(y)?y:t,t=Math.max(y,t),h||(e=void 0,_=[]),{codecSet:r.reduce((I,O)=>{const k=s[O];if(O===I)return I;if(k.minBitrate>t)return Il(O,`min bitrate of ${k.minBitrate} > current estimate of ${t}`),I;if(!k.hasDefaultAudio)return Il(O,"no renditions with default or auto-select sound found"),I;if(a&&O.indexOf(a.substring(0,4))%5!==0)return Il(O,`audio codec preference "${a}" not found`),I;if(o&&!l){if(!k.channels[o])return Il(O,`no renditions with ${o} channel sound found (channels options: ${Object.keys(k.channels)})`),I}else if((!a||l)&&c&&k.channels[2]===0)return Il(O,"no renditions with stereo sound found"),I;return k.minHeight>w?(Il(O,`min resolution of ${k.minHeight} > maximum of ${w}`),I):k.minFramerate>M?(Il(O,`min framerate of ${k.minFramerate} > maximum of ${M}`),I):_.some(N=>k.videoRanges[N]>0)?k.maxScore<v?(Il(O,`max score of ${k.maxScore} < selected max of ${v}`),I):I&&(rx(O)>=rx(I)||k.fragmentError>s[I].fragmentError)?I:(v=k.maxScore,O):(Il(O,`no variants with VIDEO-RANGE of ${JSON.stringify(_)} found`),I)},void 0),videoRanges:_,preferHDR:S,minFramerate:p,minBitrate:y}}function Il(s,e){ve.log(`[abr] start candidates with "${s}" ignored because ${e}`)}function LH(s){return s.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function PH(s,e,t,n){return s.slice(t,n+1).reduce((i,r)=>{if(!r.codecSet)return i;const o=r.audioGroups;let a=i[r.codecSet];a||(i[r.codecSet]=a={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),a.minBitrate=Math.min(a.minBitrate,r.bitrate);const l=Math.min(r.height,r.width);return a.minHeight=Math.min(a.minHeight,l),a.minFramerate=Math.min(a.minFramerate,r.frameRate),a.maxScore=Math.max(a.maxScore,r.score),a.fragmentError+=r.fragmentError,a.videoRanges[r.videoRange]=(a.videoRanges[r.videoRange]||0)+1,o&&o.forEach(c=>{if(!c)return;const h=e.groups[c];h&&(a.hasDefaultAudio=a.hasDefaultAudio||e.hasDefaultAudio?h.hasDefault:h.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(h.channels).forEach(f=>{a.channels[f]=(a.channels[f]||0)+h.channels[f]}))}),i},{})}function Pa(s,e,t){if("attrs"in s){const n=e.indexOf(s);if(n!==-1)return n}for(let n=0;n<e.length;n++){const i=e[n];if(Kf(s,i,t))return n}return-1}function Kf(s,e,t){const{groupId:n,name:i,lang:r,assocLang:o,characteristics:a,default:l}=s,c=s.forced;return(n===void 0||e.groupId===n)&&(i===void 0||e.name===i)&&(r===void 0||e.lang===r)&&(r===void 0||e.assocLang===o)&&(l===void 0||e.default===l)&&(c===void 0||e.forced===c)&&(a===void 0||DH(a,e.characteristics))&&(t===void 0||t(s,e))}function DH(s,e=""){const t=s.split(","),n=e.split(",");return t.length===n.length&&!t.some(i=>n.indexOf(i)===-1)}function bf(s,e){const{audioCodec:t,channels:n}=s;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function OH(s,e,t,n,i){const r=e[n],a=e.reduce((p,y,v)=>{const _=y.uri;return(p[_]||(p[_]=[])).push(v),p},{})[r.uri];a.length>1&&(n=Math.max.apply(Math,a));const l=r.videoRange,c=r.frameRate,h=r.codecSet.substring(0,4),f=rb(e,n,p=>{if(p.videoRange!==l||p.frameRate!==c||p.codecSet.substring(0,4)!==h)return!1;const y=p.audioGroups,v=t.filter(_=>!y||y.indexOf(_.groupId)!==-1);return Pa(s,v,i)>-1});return f>-1?f:rb(e,n,p=>{const y=p.audioGroups,v=t.filter(_=>!y||y.indexOf(_.groupId)!==-1);return Pa(s,v,i)>-1})}function rb(s,e,t){for(let n=e;n>-1;n--)if(t(s[n]))return n;for(let n=e+1;n<s.length;n++)if(t(s[n]))return n;return-1}class pL{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:n,hls:i}=this,{autoLevelEnabled:r,media:o}=i;if(!t||!o)return;const a=performance.now(),l=n?n.stats:t.stats,c=n?n.duration:t.duration,h=a-l.loading.start,f=i.minAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||t.level<=f){this.clearTimer(),this._nextAutoLevel=-1;return}if(!r||o.paused||!o.playbackRate||!o.readyState)return;const p=i.mainForwardBufferInfo;if(p===null)return;const y=this.bwEstimator.getEstimateTTFB(),v=Math.abs(o.playbackRate);if(h<=Math.max(y,1e3*(c/(v*2))))return;const _=p.len/v,S=l.loading.first?l.loading.first-l.loading.start:-1,A=l.loaded&&S>-1,w=this.getBwEstimate(),M=i.levels,C=M[t.level],I=l.total||Math.max(l.loaded,Math.round(c*C.averageBitrate/8));let O=A?h-S:h;O<1&&A&&(O=Math.min(h,l.loaded*8/w));const k=A?l.loaded*1e3/O:0,N=k?(I-l.loaded)/k:I*8/w+y/1e3;if(N<=_)return;const B=k?k*8:w;let P=Number.POSITIVE_INFINITY,G;for(G=t.level-1;G>f;G--){const Y=M[G].maxBitrate;if(P=this.getTimeToLoadFrag(y/1e3,B,c*Y,!M[G].details),P<_)break}if(P>=N||P>c*10)return;i.nextLoadLevel=i.nextAutoLevel=G,A?this.bwEstimator.sample(h-Math.min(y,S),l.loaded):this.bwEstimator.sampleTTFB(h);const Z=M[G].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>Z&&this.resetEstimator(Z),this.clearTimer(),ve.warn(`[abr] Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${_.toFixed(3)} s
      Estimated load time for current fragment: ${N.toFixed(3)} s
      Estimated load time for down switch fragment: ${P.toFixed(3)} s
      TTFB estimate: ${S|0} ms
      Current BW estimate: ${bt(w)?w|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${G} @ ${Z|0} bps`),i.trigger(z.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:n,stats:l})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(ve.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new TH(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.FRAG_LOADING,this.onFragLoading,this),e.on(z.FRAG_LOADED,this.onFragLoaded,this),e.on(z.FRAG_BUFFERED,this.onFragBuffered,this),e.on(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(z.LEVEL_LOADED,this.onLevelLoaded,this),e.on(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(z.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(z.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.FRAG_LOADING,this.onFragLoading,this),e.off(z.FRAG_LOADED,this.onFragLoaded,this),e.off(z.FRAG_BUFFERED,this.onFragBuffered,this),e.off(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(z.LEVEL_LOADED,this.onLevelLoaded,this),e.off(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(z.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(z.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var i;this.fragCurrent=n,this.partCurrent=(i=t.part)!=null?i:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Le.BUFFER_ADD_CODEC_ERROR:case Le.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Le.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:i,partCurrent:r}=this;if(n&&i&&n.sn===i.sn&&n.level===i.level){const o=performance.now(),a=r?r.stats:n.stats,l=o-a.loading.start,c=a.loading.first?a.loading.first-a.loading.start:-1;if(a.loaded&&c>-1){const f=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(f,c),a.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,n,i){const r=e+n/t,o=i?this.lastLevelLoadSec:0;return r+o}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,r=i.end-i.start;bt(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===Ht.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const r=n?n.duration:t.duration,o=this.hls.levels[t.level],a=(o.loaded?o.loaded.bytes:0)+i.loaded,l=(o.loaded?o.loaded.duration:0)+r;o.loaded={bytes:a,duration:l},o.realBitrate=Math.round(8*a/l)}if(t.bitrateTest){const r={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(z.FRAG_BUFFERED,r),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=i!=null&&i.stats.loaded?i.stats:n.stats;if(r.aborted||this.ignoreFragment(n))return;const o=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Ht.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,i,1,1);if(r>-1)return r;const o=this.hls.firstLevel,a=Math.min(Math.max(o,t),e);return ve.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const r=n&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,r)&&o[e].loadError<=o[r].loadError)return e}return this._nextAutoLevel=r,this.nextAutoLevelKey=this.getAutoLevelKey(),r}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:i,config:r,minAutoLevel:o}=n,a=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),c=this.getStarvationDelay();let h=r.abrBandWidthFactor,f=r.abrBandWidthUpFactor;if(c){const S=this.findBestLevel(l,o,i,c,0,h,f);if(S>=0)return S}let p=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay;if(!c){const S=this.bitrateTestDelay;S&&(p=(a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay)-S,ve.info(`[abr] bitrate test took ${Math.round(1e3*S)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),h=f=1)}const y=this.findBestLevel(l,o,i,c,p,h,f);if(ve.info(`[abr] ${c?"rebuffering expected":"buffer is empty"}, optimal quality level ${y}`),y>-1)return y;const v=n.levels[o],_=n.levels[n.loadLevel];return(v==null?void 0:v.bitrate)<(_==null?void 0:_.bitrate)?o:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,r,o,a){var l;const c=i+r,h=this.lastLoadedFragLevel,f=h===-1?this.hls.firstLevel:h,{fragCurrent:p,partCurrent:y}=this,{levels:v,allAudioTracks:_,loadLevel:S,config:A}=this.hls;if(v.length===1)return 0;const w=v[f],M=!!(w!=null&&(l=w.details)!=null&&l.live),C=S===-1||h===-1;let I,O="SDR",k=(w==null?void 0:w.frameRate)||0;const{audioPreference:N,videoPreference:B}=A,P=this.audioTracksByGroup||(this.audioTracksByGroup=LH(_));if(C){if(this.firstSelection!==-1)return this.firstSelection;const oe=this.codecTiers||(this.codecTiers=PH(v,P,t,n)),re=IH(oe,O,e,N,B),{codecSet:ce,videoRanges:H,minFramerate:$,minBitrate:X,preferHDR:W}=re;I=ce,O=W?H[H.length-1]:H[0],k=$,e=Math.max(e,X),ve.log(`[abr] picked start tier ${JSON.stringify(re)}`)}else I=w==null?void 0:w.codecSet,O=w==null?void 0:w.videoRange;const G=y?y.duration:p?p.duration:0,Z=this.bwEstimator.getEstimateTTFB()/1e3,Y=[];for(let oe=n;oe>=t;oe--){var se;const re=v[oe],ce=oe>f;if(!re)continue;if(A.useMediaCapabilities&&!re.supportedResult&&!re.supportedPromise){const le=navigator.mediaCapabilities;typeof(le==null?void 0:le.decodingInfo)=="function"&&wH(re,P,O,k,e,N)?(re.supportedPromise=MH(re,P,le),re.supportedPromise.then(ye=>{if(!this.hls)return;re.supportedResult=ye;const we=this.hls.levels,Ie=we.indexOf(re);ye.error?ve.warn(`[abr] MediaCapabilities decodingInfo error: "${ye.error}" for level ${Ie} ${JSON.stringify(ye)}`):ye.supported||(ve.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${Ie} ${JSON.stringify(ye)}`),Ie>-1&&we.length>1&&(ve.log(`[abr] Removing unsupported level ${Ie}`),this.hls.removeLevel(Ie)))})):re.supportedResult=fL}if(I&&re.codecSet!==I||O&&re.videoRange!==O||ce&&k>re.frameRate||!ce&&k>0&&k<re.frameRate||re.supportedResult&&!((se=re.supportedResult.decodingInfoResults)!=null&&se[0].smooth)){Y.push(oe);continue}const H=re.details,$=(y?H==null?void 0:H.partTarget:H==null?void 0:H.averagetargetduration)||G;let X;ce?X=a*e:X=o*e;const W=G&&i>=G*2&&r===0?v[oe].averageBitrate:v[oe].maxBitrate,ne=this.getTimeToLoadFrag(Z,X,W*$,H===void 0);if(X>=W&&(oe===h||re.loadError===0&&re.fragmentError===0)&&(ne<=Z||!bt(ne)||M&&!this.bitrateTestDelay||ne<c)){const le=this.forcedAutoLevel;return oe!==S&&(le===-1||le!==S)&&(Y.length&&ve.trace(`[abr] Skipped level(s) ${Y.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${v[Y[0]].codecs}" ${v[Y[0]].videoRange}; not compatible with "${w.codecs}" ${O}`),ve.info(`[abr] switch candidate:${f}->${oe} adjustedbw(${Math.round(X)})-bitrate=${Math.round(X-W)} ttfb:${Z.toFixed(1)} avgDuration:${$.toFixed(1)} maxFetchDuration:${c.toFixed(1)} fetchDuration:${ne.toFixed(1)} firstSelection:${C} codecSet:${I} videoRange:${O} hls.loadLevel:${S}`)),C&&(this.firstSelection=oe),oe}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,i=Math.min(Math.max(e,n),t);this._nextAutoLevel!==i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}}class BH{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var lr={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class FH{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(z.BUFFER_APPENDED,this.onBufferAppended,this),e.on(z.FRAG_BUFFERED,this.onFragBuffered,this),e.on(z.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(z.BUFFER_APPENDED,this.onBufferAppended,this),e.off(z.FRAG_BUFFERED,this.onFragBuffered,this),e.off(z.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const r=n[i];if(!r)break;const o=r.end;if(r.start<=e&&o!==null&&e<=o)return r}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,i=Object.keys(n);for(let r=i.length;r--;){const o=n[i[r]];if((o==null?void 0:o.body.type)===t&&o.buffered){const a=o.body;if(a.start<=e&&e<=a.end)return a}}return null}detectEvictedFragments(e,t,n,i){this.timeRanges&&(this.timeRanges[e]=t);const r=(i==null?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a||r>=a.body.sn)return;if(!a.buffered&&!a.loaded){a.body.type===n&&this.removeFragment(a.body);return}const l=a.range[e];l&&l.time.some(c=>{const h=!this.isTimeBuffered(c.startPTS,c.endPTS,t);return h&&this.removeFragment(a.body),h})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:i}=e;if(!t||n.sn==="initSegment")return;const r=Cf(n),o=this.fragments[r];if(!o||o.buffered&&n.gap)return;const a=!n.relurl;Object.keys(t).forEach(l=>{const c=n.elementaryStreams[l];if(!c)return;const h=t[l],f=a||c.partial===!0;o.range[l]=this.getBufferedTimes(n,i,f,h)}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=n.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),Gy(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(i=>i.fragment.sn>=e))}fragBuffered(e,t){const n=Cf(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},o=e.start,a=e.end,l=e.minEndPTS||a,c=e.maxStartPTS||o;for(let h=0;h<i.length;h++){const f=i.start(h)-this.bufferPadding,p=i.end(h)+this.bufferPadding;if(c>=f&&l<=p){r.time.push({startPTS:Math.max(o,i.start(h)),endPTS:Math.min(a,i.end(h))});break}else if(o<p&&a>f){const y=Math.max(o,i.start(h)),v=Math.min(a,i.end(h));v>y&&(r.partial=!0,r.time.push({startPTS:y,endPTS:v}))}else if(a<=f)break}return r}getPartialFragment(e){let t=null,n,i,r,o=0;const{bufferPadding:a,fragments:l}=this;return Object.keys(l).forEach(c=>{const h=l[c];h&&Gy(h)&&(i=h.body.start-a,r=h.body.end+a,e>=i&&e<=r&&(n=Math.min(e-i,r-e),o<=n&&(t=h.body,o=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Gy(t))}getState(e){const t=Cf(e),n=this.fragments[t];return n?n.buffered?Gy(n)?lr.PARTIAL:lr.OK:lr.APPENDING:lr.NOT_LOADED}isTimeBuffered(e,t,n){let i,r;for(let o=0;o<n.length;o++){if(i=n.start(o)-this.bufferPadding,r=n.end(o)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:i}=t;if(n.sn==="initSegment"||n.bitrateTest)return;const r=i?null:t,o=Cf(n);this.fragments[o]={body:n,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r}=t;if(n.sn==="initSegment")return;const o=n.type;if(i){let a=this.activePartLists[o];a||(this.activePartLists[o]=a=[]),a.push(i)}this.timeRanges=r,Object.keys(r).forEach(a=>{const l=r[a];this.detectEvictedFragments(a,l,o,i)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Cf(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const l=a.body;l.type!==n||i&&!l.gap||l.start<t&&l.end>e&&(a.buffered||r)&&this.removeFragment(l)})}removeFragment(e){const t=Cf(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const i=e.sn;this.activePartLists[e.type]=n.filter(r=>r.fragment.sn!==i)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function Gy(s){var e,t,n;return s.buffered&&(s.body.gap||((e=s.range.video)==null?void 0:e.partial)||((t=s.range.audio)==null?void 0:t.partial)||((n=s.range.audiovideo)==null?void 0:n.partial))}function Cf(s){return`${s.type}_${s.level}_${s.sn}`}const kH={length:0,start:()=>0,end:()=>0};class Jn{static isBuffered(e,t){try{if(e){const n=Jn.getBuffered(e);for(let i=0;i<n.length;i++)if(t>=n.start(i)&&t<=n.end(i))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){const i=Jn.getBuffered(e),r=[];let o;for(o=0;o<i.length;o++)r.push({start:i.start(o),end:i.end(o)});return this.bufferedInfo(r,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(c,h){const f=c.start-h.start;return f||h.end-c.end});let i=[];if(n)for(let c=0;c<e.length;c++){const h=i.length;if(h){const f=i[h-1].end;e[c].start-f<n?e[c].end>f&&(i[h-1].end=e[c].end):i.push(e[c])}else i.push(e[c])}else i=e;let r=0,o,a=t,l=t;for(let c=0;c<i.length;c++){const h=i[c].start,f=i[c].end;if(t+n>=h&&t<f)a=h,l=f,r=l-t;else if(t+n<h){o=h;break}}return{len:r,start:a||0,end:l||0,nextStart:o}}static getBuffered(e){try{return e.buffered}catch(t){return ve.log("failed to get media.buffered",t),kH}}}class r_{constructor(e,t,n,i=0,r=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Hy(),this.buffering={audio:Hy(),video:Hy(),audiovideo:Hy()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=o}}function Hy(){return{start:0,executeStart:0,executeEnd:0,end:0}}function rv(s,e){for(let n=0,i=s.length;n<i;n++){var t;if(((t=s[n])==null?void 0:t.cc)===e)return s[n]}return null}function NH(s,e,t){return!!(e&&(t.endCC>t.startCC||s&&s.cc<t.startCC))}function UH(s,e){const t=s.fragments,n=e.fragments;if(!n.length||!t.length){ve.log("No fragments to align");return}const i=rv(t,n[0].cc);if(!i||i&&!i.startPTS){ve.log("No frag in previous level to align on");return}return i}function sb(s,e){if(s){const t=s.start+e;s.start=s.startPTS=t,s.endPTS=t+s.duration}}function mL(s,e){const t=e.fragments;for(let n=0,i=t.length;n<i;n++)sb(t[n],s);e.fragmentHint&&sb(e.fragmentHint,s),e.alignedSliding=!0}function GH(s,e,t){e&&(HH(s,t,e),!t.alignedSliding&&e&&ux(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&lL(e,t))}function HH(s,e,t){if(NH(s,t,e)){const n=UH(t,e);n&&bt(n.start)&&(ve.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),mL(n.start,e))}}function ux(s,e){if(!s.hasProgramDateTime||!e.hasProgramDateTime)return;const t=s.fragments,n=e.fragments;if(!t.length||!n.length)return;let i,r;const o=Math.min(e.endCC,s.endCC);e.startCC<o&&s.startCC<o&&(i=rv(n,o),r=rv(t,o)),(!i||!r)&&(i=n[Math.floor(n.length/2)],r=rv(t,i.cc)||t[Math.floor(t.length/2)]);const a=i.programDateTime,l=r.programDateTime;if(!a||!l)return;const c=(l-a)/1e3-(r.start-i.start);mL(c,s)}const ob=Math.pow(2,17);class zH{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new Dl({type:Yt.NETWORK_ERROR,details:Le.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,o=i.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(y=>y[0]==="GAP")){l(lb(e));return}else e.gap=!1;const c=this.loader=e.loader=r?new r(i):new o(i),h=ab(e),f=nb(i.fragLoadPolicy.default),p={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:ob};e.stats=c.stats,c.load(h,p,{onSuccess:(y,v,_,S)=>{this.resetLoader(e,c);let A=y.data;_.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(A.slice(0,16)),A=A.slice(16)),a({frag:e,part:null,payload:A,networkDetails:S})},onError:(y,v,_,S)=>{this.resetLoader(e,c),l(new Dl({type:Yt.NETWORK_ERROR,details:Le.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:fr({url:n,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:_,stats:S}))},onAbort:(y,v,_)=>{this.resetLoader(e,c),l(new Dl({type:Yt.NETWORK_ERROR,details:Le.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:_,stats:y}))},onTimeout:(y,v,_)=>{this.resetLoader(e,c),l(new Dl({type:Yt.NETWORK_ERROR,details:Le.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:_,stats:y}))},onProgress:(y,v,_,S)=>{t&&t({frag:e,part:null,payload:_,networkDetails:S})}})})}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,o=i.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(lb(e,t));return}const c=this.loader=e.loader=r?new r(i):new o(i),h=ab(e,t),f=nb(i.fragLoadPolicy.default),p={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:ob};t.stats=c.stats,c.load(h,p,{onSuccess:(y,v,_,S)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);const A={frag:e,part:t,payload:y.data,networkDetails:S};n(A),a(A)},onError:(y,v,_,S)=>{this.resetLoader(e,c),l(new Dl({type:Yt.NETWORK_ERROR,details:Le.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:fr({url:h.url,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:_,stats:S}))},onAbort:(y,v,_)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new Dl({type:Yt.NETWORK_ERROR,details:Le.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:_,stats:y}))},onTimeout:(y,v,_)=>{this.resetLoader(e,c),l(new Dl({type:Yt.NETWORK_ERROR,details:Le.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:_,stats:y}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const l=Math.round(e.duration/t.duration),c=Math.min(Math.round(n.loaded/r),l),f=(l-c)*Math.round(n.loaded/c);n.total=n.loaded+f}else n.total=Math.max(n.loaded,n.total);const o=n.loading,a=i.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function ab(s,e=null){const t=e||s,n={frag:s,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,r=t.byteRangeEndOffset;if(bt(i)&&bt(r)){var o;let a=i,l=r;if(s.sn==="initSegment"&&((o=s.decryptdata)==null?void 0:o.method)==="AES-128"){const c=r-i;c%16&&(l=r+(16-c%16)),i!==0&&(n.resetIV=!0,a=i-16)}n.rangeStart=a,n.rangeEnd=l}return n}function lb(s,e){const t=new Error(`GAP ${s.gap?"tag":"attribute"} found`),n={type:Yt.MEDIA_ERROR,details:Le.FRAG_GAP,fatal:!1,frag:s,error:t,networkDetails:null};return e&&(n.part=e),(e||s).stats.aborted=!0,new Dl(n)}class Dl extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class jH{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class VH{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function WH(s){const e=s.byteLength,t=e&&new DataView(s.buffer).getUint8(e-1);return t?Ih(s,0,e-t):s}class KH{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(i*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],o=n[2],a=n[3],l=this.invSubMix,c=l[0],h=l[1],f=l[2],p=l[3],y=new Uint32Array(256);let v=0,_=0,S=0;for(S=0;S<256;S++)S<128?y[S]=S<<1:y[S]=S<<1^283;for(S=0;S<256;S++){let A=_^_<<1^_<<2^_<<3^_<<4;A=A>>>8^A&255^99,e[v]=A,t[A]=v;const w=y[v],M=y[w],C=y[M];let I=y[A]*257^A*16843008;i[v]=I<<24|I>>>8,r[v]=I<<16|I>>>16,o[v]=I<<8|I>>>24,a[v]=I,I=C*16843009^M*65537^w*257^v*16843008,c[A]=I<<24|I>>>8,h[A]=I<<16|I>>>16,f[A]=I<<8|I>>>24,p[A]=I,v?(v=w^y[y[y[C^w]]],_^=y[y[_]]):v=_=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(r!==4&&r!==6&&r!==8)throw new Error("Invalid aes key size="+r);const o=this.ksRows=(r+6+1)*4;let a,l;const c=this.keySchedule=new Uint32Array(o),h=this.invKeySchedule=new Uint32Array(o),f=this.sBox,p=this.rcon,y=this.invSubMix,v=y[0],_=y[1],S=y[2],A=y[3];let w,M;for(a=0;a<o;a++){if(a<r){w=c[a]=t[a];continue}M=w,a%r===0?(M=M<<8|M>>>24,M=f[M>>>24]<<24|f[M>>>16&255]<<16|f[M>>>8&255]<<8|f[M&255],M^=p[a/r|0]<<24):r>6&&a%r===4&&(M=f[M>>>24]<<24|f[M>>>16&255]<<16|f[M>>>8&255]<<8|f[M&255]),c[a]=w=(c[a-r]^M)>>>0}for(l=0;l<o;l++)a=o-l,l&3?M=c[a]:M=c[a-4],l<4||a<=4?h[l]=M:h[l]=v[f[M>>>24]]^_[f[M>>>16&255]]^S[f[M>>>8&255]]^A[f[M&255]],h[l]=h[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,l=a[0],c=a[1],h=a[2],f=a[3],p=this.uint8ArrayToUint32Array_(n);let y=p[0],v=p[1],_=p[2],S=p[3];const A=new Int32Array(e),w=new Int32Array(A.length);let M,C,I,O,k,N,B,P,G,Z,Y,se,oe,re;const ce=this.networkToHostOrderSwap;for(;t<A.length;){for(G=ce(A[t]),Z=ce(A[t+1]),Y=ce(A[t+2]),se=ce(A[t+3]),k=G^r[0],N=se^r[1],B=Y^r[2],P=Z^r[3],oe=4,re=1;re<i;re++)M=l[k>>>24]^c[N>>16&255]^h[B>>8&255]^f[P&255]^r[oe],C=l[N>>>24]^c[B>>16&255]^h[P>>8&255]^f[k&255]^r[oe+1],I=l[B>>>24]^c[P>>16&255]^h[k>>8&255]^f[N&255]^r[oe+2],O=l[P>>>24]^c[k>>16&255]^h[N>>8&255]^f[B&255]^r[oe+3],k=M,N=C,B=I,P=O,oe=oe+4;M=o[k>>>24]<<24^o[N>>16&255]<<16^o[B>>8&255]<<8^o[P&255]^r[oe],C=o[N>>>24]<<24^o[B>>16&255]<<16^o[P>>8&255]<<8^o[k&255]^r[oe+1],I=o[B>>>24]<<24^o[P>>16&255]<<16^o[k>>8&255]<<8^o[N&255]^r[oe+2],O=o[P>>>24]<<24^o[k>>16&255]<<16^o[N>>8&255]<<8^o[B&255]^r[oe+3],w[t]=ce(M^y),w[t+1]=ce(O^v),w[t+2]=ce(I^_),w[t+3]=ce(C^S),y=G,v=Z,_=Y,S=se,t=t+4}return w.buffer}}const XH=16;class WE{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?WH(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((i,r)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const o=this.flush();o?i(o.buffer):r(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:i,currentResult:r,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=Mo(o,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;i&&(n=i);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new KH),l.expandKey(t);const c=r;return this.currentResult=l.decrypt(a.buffer,0,n),this.currentIV=Ih(a,-16).buffer,c||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new VH(this.subtle,t)}return this.fastAesKey.expandKey().then(i=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new jH(this.subtle,new Uint8Array(n)).decrypt(e.buffer,i)):Promise.reject(new Error("web crypto not initialized"))).catch(i=>(ve.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%XH;return n!==e.length&&(t=Ih(e,0,n),this.remainderData=Ih(e,n)),t}logOnce(e){this.logEnabled&&(ve.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const $H={toString:function(s){let e="";const t=s.length;for(let n=0;n<t;n++)e+=`[${s.start(n).toFixed(3)}-${s.end(n).toFixed(3)}]`;return e}},je={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class s_ extends BH{constructor(e,t,n,i,r){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=je.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=r,this.logPrefix=i,this.log=ve.log.bind(ve,`${i}:`),this.warn=ve.warn.bind(ve,`${i}:`),this.hls=e,this.fragmentLoader=new zH(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new WE(e.config),e.on(z.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=je.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(n!=null&&n.length){const r=n[n.length-1];return Jn.isBuffered(this.media,r.start+r.duration/2)}const i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===je.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:r}=this,o=n?n.currentTime:0,a=Jn.bufferInfo(i||n,o,e.maxBufferHole);if(this.log(`media seeking to ${bt(o)?o.toFixed(3):o}, state: ${r}`),this.state===je.ENDED)this.resetLoadingState();else if(t){const l=e.maxFragLookUpTolerance,c=t.start-l,h=t.start+t.duration+l;if(!a.len||h<a.start||c>a.end){const f=o>h;(o<c||f)&&(f&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),!this.loadedmetadata&&!a.len&&(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(z.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=je.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=r=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${r.part?" p: "+r.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(r)};this._doFragLoad(e,t,n,i).then(r=>{if(!r)return;const o=this.state;if(this.fragContextChanged(e)){(o===je.FRAG_LOADING||!this.fragCurrent&&o===je.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=je.IDLE);return}"payload"in r&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(z.FRAG_LOADED,r)),this._handleFragmentLoadComplete(r)}).catch(r=>{this.state===je.STOPPED||this.state===je.ERROR||(this.warn(`Frag error: ${(r==null?void 0:r.message)||r}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===lr.APPENDING){const r=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,r),a=Math.max(e.duration,o?o.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(a,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===lr.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(z.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:i}=this,{payload:r}=n,o=e.decryptdata;if(r&&r.byteLength>0&&o!=null&&o.key&&o.iv&&o.method==="AES-128"){const a=self.performance.now();return this.decrypter.decrypt(new Uint8Array(r),o.key.buffer,o.iv.buffer).catch(l=>{throw i.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{const c=self.performance.now();return i.trigger(z.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:a,tdecrypt:c}}),n.payload=l,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===je.STOPPED||this.state===je.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=je.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,i,r,o;const a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Ht.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((i=e.endPTS)!=null?i:NaN).toFixed(3)}] > buffer:${a?$H.toString(Jn.getBuffered(a)):"(detached)"})`),e.sn!=="initSegment"){var l;if(e.type!==Ht.SUBTITLE){const h=e.elementaryStreams;if(!Object.keys(h).some(f=>!!h[f])){this.state=je.IDLE;return}}const c=(l=this.levels)==null?void 0:l[e.level];c!=null&&c.fragmentError&&(this.log(`Resetting level fragment error count of ${c.fragmentError} on frag buffered`),c.fragmentError=0)}this.state=je.IDLE,a&&(!this.loadedmetadata&&e.type==Ht.MAIN&&a.buffered.length&&((r=this.fragCurrent)==null?void 0:r.sn)===((o=this.fragPrevious)==null?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,o=!r||r.length===0||r.some(l=>!l),a=new r_(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var r;const o=t==null?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(e.encrypted&&!((r=e.decryptdata)!=null&&r.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=je.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(h=>{if(!this.fragContextChanged(h.frag))return this.hls.trigger(z.KEY_LOADED,h),this.state===je.KEY_LOADING&&(this.state=je.IDLE),h}),this.hls.trigger(z.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const h=o.partList;if(h&&i){n>e.end&&o.fragmentHint&&(e=o.fragmentHint);const f=this.getNextPart(h,e,n);if(f>-1){const p=h[f];this.log(`Loading part sn: ${e.sn} p: ${p.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${f}-${h.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=p.start+p.duration,this.state=je.FRAG_LOADING;let y;return a?y=a.then(v=>!v||this.fragContextChanged(v.frag)?null:this.doFragPartsLoad(e,p,t,i)).catch(v=>this.handleFragLoadError(v)):y=this.doFragPartsLoad(e,p,t,i).catch(v=>this.handleFragLoadError(v)),this.hls.trigger(z.FRAG_LOADING,{frag:e,part:p,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):y}else if(!e.url||this.loadedEndOfParts(h,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),bt(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=je.FRAG_LOADING;const l=this.config.progressive;let c;return l&&a?c=a.then(h=>!h||this.fragContextChanged(h==null?void 0:h.frag)?null:this.fragmentLoader.load(e,i)).catch(h=>this.handleFragLoadError(h)):c=Promise.all([this.fragmentLoader.load(e,l?i:void 0),a]).then(([h])=>(!l&&h&&i&&i(h),h)).catch(h=>this.handleFragLoadError(h)),this.hls.trigger(z.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):c}doFragPartsLoad(e,t,n,i){return new Promise((r,o)=>{var a;const l=[],c=(a=n.details)==null?void 0:a.partList,h=f=>{this.fragmentLoader.loadPart(e,f,i).then(p=>{l[f.index]=p;const y=p.part;this.hls.trigger(z.FRAG_LOADED,p);const v=eb(n,e.sn,f.index+1)||cL(c,e.sn,f.index+1);if(v)h(v);else return r({frag:e,part:y,partsLoaded:l})}).catch(o)};h(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Le.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(z.ERROR,t)}else this.hls.trigger(z.ERROR,{type:Yt.OTHER_ERROR,details:Le.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==je.PARSING){!this.fragCurrent&&this.state!==je.STOPPED&&this.state!==je.ERROR&&(this.state=je.IDLE);return}const{frag:n,part:i,level:r}=t,o=self.performance.now();n.stats.parsing.end=o,i&&(i.stats.parsing.end=o),this.updateLevelTiming(n,i,r,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:o}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${r} of level ${i}. The current chunk will not be buffered.`),null;const a=t[i],l=o>-1?eb(a,r,o):null,c=l?l.fragment:vH(a,r,n);return c?(n&&n!==c&&(c.stats=n.stats),{frag:c,part:l,level:a}):null}bufferFragmentData(e,t,n,i,r){var o;if(!e||this.state!==je.PARSING)return;const{data1:a,data2:l}=e;let c=a;if(a&&l&&(c=Mo(a,l)),!((o=c)!=null&&o.length))return;const h={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:c};if(this.hls.trigger(z.BUFFER_APPENDING,h),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Jn.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,i=Jn.bufferInfo(t,n,0),r=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,r*.25),a=Math.max(Math.min(e.start-o,i.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return bt(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:i}}=this,r=Jn.bufferInfo(e,t,i);if(r.len===0&&r.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&r.nextStart<o.end)return Jn.bufferInfo(e,t,Math.max(r.nextStart,i))}return r}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),r=Math.max(e-t*3,n.maxMaxBufferLength/2,i);return r>=i?(n.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0):!1}getAppendedFrag(e,t=Ht.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,Ht.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,o=n[0].start;let a;if(t.live){const l=r.initialLiveManifestSize;if(i<l)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${l})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o)&&(a=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=n[0]);if(!a){const l=r.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===lr.OK||n===lr.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){const o=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(a===null)return a;if(e=a,o&&e&&!e.gap&&n.nextStart){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(l!==null&&n.len+l.len>=r)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let i=-1,r=!1,o=!0;for(let a=0,l=e.length;a<l;a++){const c=e[a];if(o=o&&!c.independent,i>-1&&n<c.start)break;const h=c.loaded;h?i=-1:(r||c.independent||o)&&c.fragment===t&&(i=a),r=h}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=_H(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const o=t[r-e.startSN];n.cc===o.cc&&(i=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=EH(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const r=this.hls.liveSyncPosition;r!==null&&(i=this.getFragmentAtPosition(r,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:o,endSN:a}=n;const{fragmentHint:l}=n,{maxFragLookUpTolerance:c}=i,h=n.partList,f=!!(i.lowLatencyMode&&h!=null&&h.length&&l);f&&l&&!this.bitrateTest&&(o=o.concat(l),a=l.sn);let p;if(e<t){const y=e>t-c?0:c;p=cx(r,o,e,y)}else p=o[o.length-1];if(p){const y=p.sn-n.startSN,v=this.fragmentTracker.getState(p);if((v===lr.OK||v===lr.PARTIAL&&p.gap)&&(r=p),r&&p.sn===r.sn&&(!f||h[0].fragment.sn>p.sn)&&r&&p.level===r.level){const S=o[y+1];p.sn<a&&this.fragmentTracker.getState(S)!==lr.OK?p=S:p=null}}return p}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=n.currentTime,o=e.fragments[0].start,a=e.edge,l=r>=o-t.maxFragLookUpTolerance&&r<=a;if(i!==null&&n.duration>i&&(r<i||!l)){const c=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||r<a-c)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const r=e.fragments[0].start,o=!t,a=e.alignedSliding&&bt(r);if(o||!a&&!r){const{fragPrevious:l}=this;GH(l,n,e);const c=e.fragments[0].start;return this.log(`Live playlist sliding: ${c.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${l?l.sn:"na"} fragments: ${i}`),c}return r}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){const i=this.startTimeOffset!==null,r=i?this.startTimeOffset:e.startTimeOffset;r!==null&&bt(r)?(n=t+r,r<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${r} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==je.FRAG_LOADING_WAITING_RETRY)&&(this.state=je.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const h=this.getCurrentContext(t.chunkMeta);h&&(t.frag=h.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var i;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const r=t.details===Le.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(n,!0);const o=t.errorAction,{action:a,retryCount:l=0,retryConfig:c}=o||{};if(o&&a===Yi.RetryRequest&&c){this.resetStartWhenNotLoaded(this.levelLastLoaded);const h=VE(c,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${c.maxNumRetry} in ${h}ms`),o.resolved=!0,this.retryDate=self.performance.now()+h,this.state=je.FRAG_LOADING_WAITING_RETRY}else if(c&&o)if(this.resetFragmentErrors(e),l<c.maxNumRetry)!r&&a!==Yi.RemoveAlternatePermanently&&(o.resolved=!0);else{ve.warn(`${t.details} reached or exceeded max retry (${l})`);return}else(o==null?void 0:o.action)===Yi.SendAlternateToPenaltyBox?this.state=je.WAITING_LEVEL:this.state=je.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===je.PARSING||this.state===je.PARSED){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len,(t==null?void 0:t.duration)||10);const o=!r;return o&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===Ht.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==je.STOPPED&&(this.state=je.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=Jn.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===je.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=je.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){var r;const o=n.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,c)=>{const h=e.elementaryStreams[c];if(h){const f=h.endPTS-h.startPTS;if(f<=0)return this.warn(`Could not parse fragment ${e.sn} ${c} duration reliably (${f})`),l||!1;const p=i?0:aL(o,e,h.startPTS,h.endPTS,h.startDTS,h.endDTS);return this.hls.trigger(z.LEVEL_PTS_UPDATED,{details:o,level:n,drift:p,type:c,frag:e,start:h.startPTS,end:h.endPTS}),!0}return l},!1)&&((r=this.transmuxer)==null?void 0:r.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(n.fragmentError===0&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(l.message),this.hls.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=je.PARSED,this.hls.trigger(z.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class gL{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=YH(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function YH(s,e){const t=new Uint8Array(e);let n=0;for(let i=0;i<s.length;i++){const r=s[i];t.set(r,n),n+=r.length}return t}function JH(){return typeof __HLS_WORKER_BUNDLE__=="function"}function qH(){const s=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(s);return{worker:new self.Worker(e),objectURL:e}}function QH(s){const e=new self.URL(s,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function Ca(s="",e=9e4){return{type:s,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class KE{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Mo(this.cachedData,e),this.cachedData=null);let n=m0(e,0),i=n?n.length:0,r;const o=this._audioTrack,a=this._id3Track,l=n?jE(n):void 0,c=e.length;for((this.basePTS===null||this.frameIndex===0&&bt(l))&&(this.basePTS=ZH(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:_o.audioId3,duration:Number.POSITIVE_INFINITY});i<c;){if(this.canParse(e,i)){const h=this.appendFrame(o,e,i);h?(this.frameIndex++,this.lastPTS=h.sample.pts,i+=h.length,r=i):i=c}else AG(e,i)?(n=m0(e,i),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:_o.audioId3,duration:Number.POSITIVE_INFINITY}),i+=n.length,r=i):i++;if(i===c&&r!==c){const h=Ih(e,r);this.cachedData?this.cachedData=Mo(this.cachedData,h):this.cachedData=h}}return{audioTrack:o,videoTrack:Ca(),id3Track:a,textTrack:Ca()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Ca(),id3Track:this._id3Track,textTrack:Ca()}}destroy(){}}const ZH=(s,e,t)=>{if(bt(s))return s*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function ez(s,e,t,n){let i,r,o,a;const l=navigator.userAgent.toLowerCase(),c=n,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=((e[t+2]&192)>>>6)+1;const f=(e[t+2]&60)>>>2;if(f>h.length-1){const p=new Error(`invalid ADTS sampling index:${f}`);s.emit(z.ERROR,z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.FRAG_PARSING_ERROR,fatal:!0,error:p,reason:p.message});return}return o=(e[t+2]&1)<<2,o|=(e[t+3]&192)>>>6,ve.log(`manifest codec:${n}, ADTS type:${i}, samplingIndex:${f}`),/firefox/i.test(l)?f>=6?(i=5,a=new Array(4),r=f-3):(i=2,a=new Array(2),r=f):l.indexOf("android")!==-1?(i=2,a=new Array(2),r=f):(i=5,a=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&f>=6?r=f-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(f>=6&&o===1||/vivaldi/i.test(l))||!n&&o===1)&&(i=2,a=new Array(2)),r=f)),a[0]=i<<3,a[0]|=(f&14)>>1,a[1]|=(f&1)<<7,a[1]|=o<<3,i===5&&(a[1]|=(r&14)>>1,a[2]=(r&1)<<7,a[2]|=8,a[3]=0),{config:a,samplerate:h[f],channelCount:o,codec:"mp4a.40."+i,manifestCodec:c}}function yL(s,e){return s[e]===255&&(s[e+1]&246)===240}function vL(s,e){return s[e+1]&1?7:9}function XE(s,e){return(s[e+3]&3)<<11|s[e+4]<<3|(s[e+5]&224)>>>5}function tz(s,e){return e+5<s.length}function hx(s,e){return e+1<s.length&&yL(s,e)}function nz(s,e){return tz(s,e)&&yL(s,e)&&XE(s,e)<=s.length-e}function iz(s,e){if(hx(s,e)){const t=vL(s,e);if(e+t>=s.length)return!1;const n=XE(s,e);if(n<=t)return!1;const i=e+n;return i===s.length||hx(s,i)}return!1}function xL(s,e,t,n,i){if(!s.samplerate){const r=ez(e,t,n,i);if(!r)return;s.config=r.config,s.samplerate=r.samplerate,s.channelCount=r.channelCount,s.codec=r.codec,s.manifestCodec=r.manifestCodec,ve.log(`parsed codec:${s.codec}, rate:${r.samplerate}, channels:${r.channelCount}`)}}function _L(s){return 1024*9e4/s}function rz(s,e){const t=vL(s,e);if(e+t<=s.length){const n=XE(s,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function SL(s,e,t,n,i){const r=_L(s.samplerate),o=n+i*r,a=rz(e,t);let l;if(a){const{frameLength:f,headerLength:p}=a,y=p+f,v=Math.max(0,t+y-e.length);v?(l=new Uint8Array(y-p),l.set(e.subarray(t+p,e.length),0)):l=e.subarray(t+p,t+y);const _={unit:l,pts:o};return v||s.samples.push(_),{sample:_,length:y,missing:v}}const c=e.length-t;return l=new Uint8Array(c),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:o},length:c,missing:-1}}let zy=null;const sz=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],oz=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],az=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],lz=[0,1,1,4];function AL(s,e,t,n,i){if(t+24>e.length)return;const r=EL(e,t);if(r&&t+r.frameLength<=e.length){const o=r.samplesPerFrame*9e4/r.sampleRate,a=n+i*o,l={unit:e.subarray(t,t+r.frameLength),pts:a,dts:a};return s.config=[],s.channelCount=r.channelCount,s.samplerate=r.sampleRate,s.samples.push(l),{sample:l,length:r.frameLength,missing:0}}}function EL(s,e){const t=s[e+1]>>3&3,n=s[e+1]>>1&3,i=s[e+2]>>4&15,r=s[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&r!==3){const o=s[e+2]>>1&1,a=s[e+3]>>6,l=t===3?3-n:n===3?3:4,c=sz[l*14+i-1]*1e3,f=oz[(t===3?0:t===2?1:2)*3+r],p=a===3?1:2,y=az[t][n],v=lz[n],_=y*8*v,S=Math.floor(y*c/f+o)*v;if(zy===null){const M=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);zy=M?parseInt(M[1]):0}return!!zy&&zy<=87&&n===2&&c>=224e3&&a===0&&(s[e+3]=s[e+3]|128),{sampleRate:f,channelCount:p,frameLength:S,samplesPerFrame:_}}}function $E(s,e){return s[e]===255&&(s[e+1]&224)===224&&(s[e+1]&6)!==0}function TL(s,e){return e+1<s.length&&$E(s,e)}function cz(s,e){return $E(s,e)&&4<=s.length-e}function wL(s,e){if(e+1<s.length&&$E(s,e)){const n=EL(s,e);let i=4;n!=null&&n.frameLength&&(i=n.frameLength);const r=e+i;return r===s.length||TL(s,r)}return!1}class uz extends KE{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=m0(e,0);let n=(t==null?void 0:t.length)||0;if(wL(e,n))return!1;for(let i=e.length;n<i;n++)if(iz(e,n))return ve.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return nz(e,t)}appendFrame(e,t,n){xL(e,this.observer,t,n,e.manifestCodec);const i=SL(e,t,n,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}const hz=/\/emsg[-/]ID3/i;class dz{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=Ca("video",1),o=this.audioTrack=Ca("audio",1),a=this.txtTrack=Ca("text",1);if(this.id3Track=Ca("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=ZI(e);if(l.video){const{id:c,timescale:h,codec:f}=l.video;r.id=c,r.timescale=a.timescale=h,r.codec=f}if(l.audio){const{id:c,timescale:h,codec:f}=l.audio;o.id=c,o.timescale=h,o.codec=f}a.id=JI.text,r.sampleDuration=0,r.duration=o.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return LG(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Mo(this.remainderData,e));const a=UG(n);this.remainderData=a.remainder,i.samples=a.valid||new Uint8Array}else i.samples=n;const o=this.extractID3Track(i,t);return r.samples=F2(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=F2(e,t),{videoTrack:t,audioTrack:Ca(),id3Track:i,textTrack:Ca()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=an(e.samples,["emsg"]);i&&i.forEach(r=>{const o=zG(r);if(hz.test(o.schemeIdUri)){const a=bt(o.presentationTime)?o.presentationTime/o.timeScale:t+o.presentationTimeDelta/o.timeScale;let l=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const c=o.payload;n.samples.push({data:c,len:c.byteLength,dts:a,pts:a,type:_o.emsg,duration:l})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const ML=(s,e)=>{let t=0,n=5;e+=n;const i=new Uint32Array(1),r=new Uint32Array(1),o=new Uint8Array(1);for(;n>0;){o[0]=s[e];const a=Math.min(n,8),l=8-a;r[0]=4278190080>>>24+l<<l,i[0]=(o[0]&r[0])>>l,t=t?t<<a|i[0]:i[0],e+=1,n-=a}return t};class fz extends KE{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=bL(e,t,n,this.basePTS,this.frameIndex);if(i!==-1)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;const t=m0(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&jE(t)!==void 0&&ML(e,n)<16}}function bL(s,e,t,n,i){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const r=e[t+4]>>6;if(r>=3)return-1;const a=[48e3,44100,32e3][r],l=e[t+4]&63,h=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+r]*2;if(t+h>e.length)return-1;const f=e[t+6]>>5;let p=0;f===2?p+=2:(f&1&&f!==1&&(p+=2),f&4&&(p+=2));const y=(e[t+6]<<8|e[t+7])>>12-p&1,_=[2,1,2,3,3,4,4,5][f]+y,S=e[t+5]>>3,A=e[t+5]&7,w=new Uint8Array([r<<6|S<<1|A>>2,(A&3)<<6|f<<3|y<<2|l>>4,l<<4&224]),M=1536/a*9e4,C=n+i*M,I=e.subarray(t,t+h);return s.config=w,s.channelCount=_,s.samplerate=a,s.samples.push({unit:I,pts:C}),h}class pz{constructor(){this.VideoSample=null}createVideoSample(e,t,n,i){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:i,length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,i;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const r=n.units;i=r[r.length-1]}return i}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,i=n.length;if(i){const r=n[i-1];e.pts=r.pts,e.dts=r.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&ve.log(e.pts+"/"+e.dts+":"+e.debug)}}class cb{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(r===0)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=r*8,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&ve.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,i;for(let r=0;r<e;r++)n!==0&&(i=this.readEG(),n=(t+i+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,i=0,r,o,a;const l=this.readUByte.bind(this),c=this.readBits.bind(this),h=this.readUEG.bind(this),f=this.readBoolean.bind(this),p=this.skipBits.bind(this),y=this.skipEG.bind(this),v=this.skipUEG.bind(this),_=this.skipScalingList.bind(this);l();const S=l();if(c(5),p(3),l(),v(),S===100||S===110||S===122||S===244||S===44||S===83||S===86||S===118||S===128){const O=h();if(O===3&&p(1),v(),v(),p(1),f())for(o=O!==3?8:12,a=0;a<o;a++)f()&&(a<6?_(16):_(64))}v();const A=h();if(A===0)h();else if(A===1)for(p(1),y(),y(),r=h(),a=0;a<r;a++)y();v(),p(1);const w=h(),M=h(),C=c(1);C===0&&p(1),p(1),f()&&(e=h(),t=h(),n=h(),i=h());let I=[1,1];if(f()&&f())switch(l()){case 1:I=[1,1];break;case 2:I=[12,11];break;case 3:I=[10,11];break;case 4:I=[16,11];break;case 5:I=[40,33];break;case 6:I=[24,11];break;case 7:I=[20,11];break;case 8:I=[32,11];break;case 9:I=[80,33];break;case 10:I=[18,11];break;case 11:I=[15,11];break;case 12:I=[64,33];break;case 13:I=[160,99];break;case 14:I=[4,3];break;case 15:I=[3,2];break;case 16:I=[2,1];break;case 255:{I=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((w+1)*16-e*2-t*2),height:(2-C)*(M+1)*16-(C?2:4)*(n+i),pixelRatio:I}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class mz extends pz{parseAVCPES(e,t,n,i,r){const o=this.parseAVCNALu(e,n.data);let a=this.VideoSample,l,c=!1;n.data=null,a&&o.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),o.forEach(h=>{var f;switch(h.type){case 1:{let _=!1;l=!0;const S=h.data;if(c&&S.length>4){const A=new cb(S).readSliceType();(A===2||A===4||A===7||A===9)&&(_=!0)}if(_){var p;(p=a)!=null&&p.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),a.frame=!0,a.key=_;break}case 5:l=!0,(f=a)!=null&&f.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),a.key=!0,a.frame=!0;break;case 6:{l=!0,tL(h.data,1,n.pts,t.samples);break}case 7:{var y,v;l=!0,c=!0;const _=h.data,A=new cb(_).readSPS();if(!e.sps||e.width!==A.width||e.height!==A.height||((y=e.pixelRatio)==null?void 0:y[0])!==A.pixelRatio[0]||((v=e.pixelRatio)==null?void 0:v[1])!==A.pixelRatio[1]){e.width=A.width,e.height=A.height,e.pixelRatio=A.pixelRatio,e.sps=[_],e.duration=r;const w=_.subarray(1,4);let M="avc1.";for(let C=0;C<3;C++){let I=w[C].toString(16);I.length<2&&(I="0"+I),M+=I}e.codec=M}break}case 8:l=!0,e.pps=[h.data];break;case 9:l=!0,e.audFound=!0,a&&this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:l=!0;break;default:l=!1,a&&(a.debug+="unknown NAL "+h.type+" ");break}a&&l&&a.units.push(h)}),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let i=e.naluState||0;const r=i,o=[];let a=0,l,c,h,f=-1,p=0;for(i===-1&&(f=0,p=t[0]&31,i=0,a=1);a<n;){if(l=t[a++],!i){i=l?0:1;continue}if(i===1){i=l?0:2;continue}if(!l)i=3;else if(l===1){if(c=a-i-1,f>=0){const y={data:t.subarray(f,c),type:p};o.push(y)}else{const y=this.getLastNalUnit(e.samples);y&&(r&&a<=4-r&&y.state&&(y.data=y.data.subarray(0,y.data.byteLength-r)),c>0&&(y.data=Mo(y.data,t.subarray(0,c)),y.state=0))}a<n?(h=t[a]&31,f=a,p=h,i=0):i=-1}else i=0}if(f>=0&&i>=0){const y={data:t.subarray(f,n),type:p,state:i};o.push(y)}if(o.length===0){const y=this.getLastNalUnit(e.samples);y&&(y.data=Mo(y.data,t))}return e.naluState=i,o}}class gz{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new WE(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),o=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(o).then(a=>{const l=new Uint8Array(a);i.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)n.set(e.subarray(r,r+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)e.set(n.subarray(i,i+16),r);return e}decryptAvcSample(e,t,n,i,r){const o=nL(r.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(l=>{r.data=this.getAvcDecryptedUnit(o,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)})}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){i();return}const r=e[t].units;for(;!(n>=r.length);n++){const o=r[n];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,n,i,o),!this.decrypter.isSync()))return}}}}const ar=188;class Hc{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new mz}static probe(e){const t=Hc.syncOffset(e);return t>0&&ve.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let n=Math.min(ar*5,t-ar)+1,i=0;for(;i<n;){let r=!1,o=-1,a=0;for(let l=i;l<t;l+=ar)if(e[l]===71&&(t-l===ar||e[l+ar]===71)){if(a++,o===-1&&(o=l,o!==0&&(n=Math.min(o+ar*99,e.length-ar)+1)),r||(r=hA(e,l)===0),r&&a>1&&(o===0&&a>2||l+ar>n))return o}else{if(a)return-1;break}i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:JI[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Hc.createTrack("video"),this._audioTrack=Hc.createTrack("audio",i),this._id3Track=Hc.createTrack("id3"),this._txtTrack=Hc.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){n||(this.sampleAes=null);let r;const o=this._videoTrack,a=this._audioTrack,l=this._id3Track,c=this._txtTrack;let h=o.pid,f=o.pesData,p=a.pid,y=l.pid,v=a.pesData,_=l.pesData,S=null,A=this.pmtParsed,w=this._pmtId,M=e.length;if(this.remainderData&&(e=Mo(this.remainderData,e),M=e.length,this.remainderData=null),M<ar&&!i)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};const C=Math.max(0,Hc.syncOffset(e));M-=(M-C)%ar,M<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,M,e.buffer.byteLength-M));let I=0;for(let k=C;k<M;k+=ar)if(e[k]===71){const N=!!(e[k+1]&64),B=hA(e,k),P=(e[k+3]&48)>>4;let G;if(P>1){if(G=k+5+e[k+4],G===k+ar)continue}else G=k+4;switch(B){case h:N&&(f&&(r=Rf(f))&&this.videoParser.parseAVCPES(o,c,r,!1,this._duration),f={data:[],size:0}),f&&(f.data.push(e.subarray(G,k+ar)),f.size+=k+ar-G);break;case p:if(N){if(v&&(r=Rf(v)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,r);break;case"mp3":this.parseMPEGPES(a,r);break;case"ac3":this.parseAC3PES(a,r);break}v={data:[],size:0}}v&&(v.data.push(e.subarray(G,k+ar)),v.size+=k+ar-G);break;case y:N&&(_&&(r=Rf(_))&&this.parseID3PES(l,r),_={data:[],size:0}),_&&(_.data.push(e.subarray(G,k+ar)),_.size+=k+ar-G);break;case 0:N&&(G+=e[G]+1),w=this._pmtId=yz(e,G);break;case w:{N&&(G+=e[G]+1);const Z=vz(e,G,this.typeSupported,n,this.observer);h=Z.videoPid,h>0&&(o.pid=h,o.segmentCodec=Z.segmentVideoCodec),p=Z.audioPid,p>0&&(a.pid=p,a.segmentCodec=Z.segmentAudioCodec),y=Z.id3Pid,y>0&&(l.pid=y),S!==null&&!A&&(ve.warn(`MPEG-TS PMT found at ${k} after unknown PID '${S}'. Backtracking to sync byte @${C} to parse all TS packets.`),S=null,k=C-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:S=B;break}}else I++;I>0&&dx(this.observer,new Error(`Found ${I} TS packet/s that do not start with 0x47`)),o.pesData=f,a.pesData=v,l.pesData=_;const O={audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};return i&&this.extractRemainingSamples(O),O}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,o=n.pesData,a=t.pesData,l=i.pesData;let c;if(o&&(c=Rf(o))?(this.videoParser.parseAVCPES(n,r,c,!0,this._duration),n.pesData=null):n.pesData=o,a&&(c=Rf(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,c);break;case"mp3":this.parseMPEGPES(t,c);break;case"ac3":this.parseAC3PES(t,c);break}t.pesData=null}else a!=null&&a.size&&ve.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;l&&(c=Rf(l))?(this.parseID3PES(i,c),i.pesData=null):i.pesData=l}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new gz(this.observer,this.config,t);return this.decrypt(i,r)}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,()=>{n(e)}):n(e)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r=t.data;if(i){this.aacOverFlow=null;const f=i.missing,p=i.sample.unit.byteLength;if(f===-1)r=Mo(i.sample.unit,r);else{const y=p-f;i.sample.unit.set(r.subarray(0,f),y),e.samples.push(i.sample),n=i.missing}}let o,a;for(o=n,a=r.length;o<a-1&&!hx(r,o);o++);if(o!==n){let f;const p=o<a-1;if(p?f=`AAC PES did not start with ADTS header,offset:${o}`:f="No ADTS header found in AAC PES",dx(this.observer,new Error(f),p),!p)return}xL(e,this.observer,r,o,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(i){const f=_L(e.samplerate);l=i.sample.pts+f}else{ve.warn("[tsdemuxer]: AAC PES unknown PTS");return}let c=0,h;for(;o<a;)if(h=SL(e,r,o,l,c),o+=h.length,h.missing){this.aacOverFlow=h;break}else for(c++;o<a-1&&!hx(r,o);o++);}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,o=0;const a=t.pts;if(a===void 0){ve.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<i;)if(TL(n,o)){const l=AL(e,n,o,a,r);if(l)o+=l.length,r++;else break}else o++}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(i===void 0){ve.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const r=n.length;let o=0,a=0,l;for(;a<r&&(l=bL(e,n,a,i,o++))>0;)a+=l}}parseID3PES(e,t){if(t.pts===void 0){ve.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=Gi({},t,{type:this._videoTrack?_o.emsg:_o.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function hA(s,e){return((s[e+1]&31)<<8)+s[e+2]}function yz(s,e){return(s[e+10]&31)<<8|s[e+11]}function vz(s,e,t,n,i){const r={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(s[e+1]&15)<<8|s[e+2],a=e+3+o-4,l=(s[e+10]&15)<<8|s[e+11];for(e+=12+l;e<a;){const c=hA(s,e),h=(s[e+3]&15)<<8|s[e+4];switch(s[e]){case 207:if(!n){uS("ADTS AAC");break}case 15:r.audioPid===-1&&(r.audioPid=c);break;case 21:r.id3Pid===-1&&(r.id3Pid=c);break;case 219:if(!n){uS("H.264");break}case 27:r.videoPid===-1&&(r.videoPid=c,r.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?ve.log("MPEG audio found, not supported in this browser"):r.audioPid===-1&&(r.audioPid=c,r.segmentAudioCodec="mp3");break;case 193:if(!n){uS("AC-3");break}case 129:t.ac3?r.audioPid===-1&&(r.audioPid=c,r.segmentAudioCodec="ac3"):ve.log("AC-3 audio found, not supported in this browser");break;case 6:if(r.audioPid===-1&&h>0){let f=e+5,p=h;for(;p>2;){switch(s[f]){case 106:t.ac3!==!0?ve.log("AC-3 audio found, not supported in this browser for now"):(r.audioPid=c,r.segmentAudioCodec="ac3");break}const v=s[f+1]+2;f+=v,p-=v}}break;case 194:case 135:return dx(i,new Error("Unsupported EC-3 in M2TS found")),r;case 36:return dx(i,new Error("Unsupported HEVC in M2TS found")),r}e+=h+5}return r}function dx(s,e,t){ve.warn(`parsing error: ${e.message}`),s.emit(z.ERROR,z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function uS(s){ve.log(`${s} with AES-128-CBC encryption found in unencrypted stream`)}function Rf(s){let e=0,t,n,i,r,o;const a=s.data;if(!s||s.size===0)return null;for(;a[0].length<19&&a.length>1;)a[0]=Mo(a[0],a[1]),a.splice(1,1);if(t=a[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>s.size-6)return null;const c=t[7];c&192&&(r=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,c&64?(o=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,r-o>60*9e4&&(ve.warn(`${Math.round((r-o)/9e4)}s delta between PTS and DTS, align them`),r=o)):o=r),i=t[8];let h=i+9;if(s.size<=h)return null;s.size-=h;const f=new Uint8Array(s.size);for(let p=0,y=a.length;p<y;p++){t=a[p];let v=t.byteLength;if(h)if(h>v){h-=v;continue}else t=t.subarray(h),v-=h,h=0;f.set(t,e),e+=v}return n&&(n-=i+3),{data:f,pts:r,dts:o,len:n}}return null}class xz extends KE{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=m0(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&jE(t)!==void 0&&ML(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(wL(e,n))return ve.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return cz(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return AL(e,t,n,this.basePTS,this.frameIndex)}}class ub{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Gc=Math.pow(2,32)-1;class Se{static init(){Se.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Se.types)Se.types.hasOwnProperty(e)&&(Se.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Se.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);Se.STTS=Se.STSC=Se.STCO=r,Se.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Se.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Se.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Se.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);Se.FTYP=Se.box(Se.types.ftyp,o,l,o,a),Se.DINF=Se.box(Se.types.dinf,Se.box(Se.types.dref,i))}static box(e,...t){let n=8,i=t.length;const r=i;for(;i--;)n+=t[i].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(e,4),i=0,n=8;i<r;i++)o.set(t[i],n),n+=t[i].byteLength;return o}static hdlr(e){return Se.box(Se.types.hdlr,Se.HDLR_TYPES[e])}static mdat(e){return Se.box(Se.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Gc+1)),i=Math.floor(t%(Gc+1));return Se.box(Se.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return Se.box(Se.types.mdia,Se.mdhd(e.timescale,e.duration),Se.hdlr(e.type),Se.minf(e))}static mfhd(e){return Se.box(Se.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Se.box(Se.types.minf,Se.box(Se.types.smhd,Se.SMHD),Se.DINF,Se.stbl(e)):Se.box(Se.types.minf,Se.box(Se.types.vmhd,Se.VMHD),Se.DINF,Se.stbl(e))}static moof(e,t,n){return Se.box(Se.types.moof,Se.mfhd(e),Se.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=Se.trak(e[t]);return Se.box.apply(null,[Se.types.moov,Se.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(Se.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=Se.trex(e[t]);return Se.box.apply(null,[Se.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Gc+1)),i=Math.floor(t%(Gc+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Se.box(Se.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return Se.box(Se.types.sdtp,n)}static stbl(e){return Se.box(Se.types.stbl,Se.stsd(e),Se.box(Se.types.stts,Se.STTS),Se.box(Se.types.stsc,Se.STSC),Se.box(Se.types.stsz,Se.STSZ),Se.box(Se.types.stco,Se.STCO))}static avc1(e){let t=[],n=[],i,r,o;for(i=0;i<e.sps.length;i++)r=e.sps[i],o=r.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(r));for(i=0;i<e.pps.length;i++)r=e.pps[i],o=r.byteLength,n.push(o>>>8&255),n.push(o&255),n=n.concat(Array.prototype.slice.call(r));const a=Se.box(Se.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),l=e.width,c=e.height,h=e.pixelRatio[0],f=e.pixelRatio[1];return Se.box(Se.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,c>>8&255,c&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,Se.box(Se.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Se.box(Se.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,f>>24,f>>16&255,f>>8&255,f&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return Se.box(Se.types.mp4a,Se.audioStsd(e),Se.box(Se.types.esds,Se.esds(e)))}static mp3(e){return Se.box(Se.types[".mp3"],Se.audioStsd(e))}static ac3(e){return Se.box(Se.types["ac-3"],Se.audioStsd(e),Se.box(Se.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?Se.box(Se.types.stsd,Se.STSD,Se.mp3(e)):e.segmentCodec==="ac3"?Se.box(Se.types.stsd,Se.STSD,Se.ac3(e)):Se.box(Se.types.stsd,Se.STSD,Se.mp4a(e)):Se.box(Se.types.stsd,Se.STSD,Se.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,i=e.width,r=e.height,o=Math.floor(n/(Gc+1)),a=Math.floor(n%(Gc+1));return Se.box(Se.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,r>>8&255,r&255,0,0]))}static traf(e,t){const n=Se.sdtp(e),i=e.id,r=Math.floor(t/(Gc+1)),o=Math.floor(t%(Gc+1));return Se.box(Se.types.traf,Se.box(Se.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),Se.box(Se.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,o>>24,o>>16&255,o>>8&255,o&255])),Se.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,Se.box(Se.types.trak,Se.tkhd(e),Se.mdia(e))}static trex(e){const t=e.id;return Se.box(Se.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,o=new Uint8Array(r);let a,l,c,h,f,p;for(t+=8+r,o.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),a=0;a<i;a++)l=n[a],c=l.duration,h=l.size,f=l.flags,p=l.cts,o.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.paddingValue<<1|f.isNonSync,f.degradPrio&61440,f.degradPrio&15,p>>>24&255,p>>>16&255,p>>>8&255,p&255],12+16*a);return Se.box(Se.types.trun,o)}static initSegment(e){Se.types||Se.init();const t=Se.moov(e);return Mo(Se.FTYP,t)}}Se.types=void 0;Se.HDLR_TYPES=void 0;Se.STTS=void 0;Se.STSC=void 0;Se.STCO=void 0;Se.STSZ=void 0;Se.VMHD=void 0;Se.SMHD=void 0;Se.STSD=void 0;Se.FTYP=void 0;Se.DINF=void 0;const CL=9e4;function YE(s,e,t=1,n=!1){const i=s*e*t;return n?Math.round(i):i}function _z(s,e,t=1,n=!1){return YE(s,e,1/t,n)}function Bm(s,e=!1){return YE(s,1e3,1/CL,e)}function Sz(s,e=1){return YE(s,CL,1/e)}const Az=10*1e3,hb=1024,Ez=1152,Tz=1536;let If=null,hS=null;class sv{constructor(e,t,n,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,If===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);If=o?parseInt(o[1]):0}if(hS===null){const r=navigator.userAgent.match(/Safari\/(\d+)/i);hS=r?parseInt(r[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){ve.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){ve.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){ve.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e.reduce((i,r)=>{const o=r.pts-i;return o<-4294967296?(t=!0,xo(i,r.pts)):o>0?i:r.pts},e[0].pts);return t&&ve.debug("PTS rollover detected"),n}remux(e,t,n,i,r,o,a,l){let c,h,f,p,y,v,_=r,S=r;const A=e.pid>-1,w=t.pid>-1,M=t.samples.length,C=e.samples.length>0,I=a&&M>0||M>1;if((!A||C)&&(!w||I)||this.ISGenerated||a){if(this.ISGenerated){var k,N,B,P;const se=this.videoTrackConfig;se&&(t.width!==se.width||t.height!==se.height||((k=t.pixelRatio)==null?void 0:k[0])!==((N=se.pixelRatio)==null?void 0:N[0])||((B=t.pixelRatio)==null?void 0:B[1])!==((P=se.pixelRatio)==null?void 0:P[1]))&&this.resetInitSegment()}else f=this.generateIS(e,t,r,o);const G=this.isVideoContiguous;let Z=-1,Y;if(I&&(Z=wz(t.samples),!G&&this.config.forceKeyFrameOnDiscontinuity))if(v=!0,Z>0){ve.warn(`[mp4-remuxer]: Dropped ${Z} out of ${M} video samples due to a missing keyframe`);const se=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(Z),t.dropped+=Z,S+=(t.samples[0].pts-se)/t.inputTimeScale,Y=S}else Z===-1&&(ve.warn(`[mp4-remuxer]: No keyframe found out of ${M} video samples`),v=!1);if(this.ISGenerated){if(C&&I){const se=this.getVideoStartPts(t.samples),re=(xo(e.samples[0].pts,se)-se)/t.inputTimeScale;_+=Math.max(0,re),S+=Math.max(0,-re)}if(C){if(e.samplerate||(ve.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),f=this.generateIS(e,t,r,o)),h=this.remuxAudio(e,_,this.isAudioContiguous,o,w||I||l===Ht.AUDIO?S:void 0),I){const se=h?h.endPTS-h.startPTS:0;t.inputTimeScale||(ve.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),f=this.generateIS(e,t,r,o)),c=this.remuxVideo(t,S,G,se)}}else I&&(c=this.remuxVideo(t,S,G,0));c&&(c.firstKeyFrame=Z,c.independent=Z!==-1,c.firstKeyFramePTS=Y)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(y=RL(n,r,this._initPTS,this._initDTS)),i.samples.length&&(p=IL(i,r,this._initPTS))),{audio:h,video:c,initSegment:f,independent:v,text:p,id3:y}}generateIS(e,t,n,i){const r=e.samples,o=t.samples,a=this.typeSupported,l={},c=this._initPTS;let h=!c||i,f="audio/mp4",p,y,v;if(h&&(p=y=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(f="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:f,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&a.mpeg?new Uint8Array(0):Se.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(v=e.inputTimeScale,!c||v!==c.timescale?p=y=r[0].pts-Math.round(v*n):h=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Se.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(v=t.inputTimeScale,!c||v!==c.timescale){const _=this.getVideoStartPts(o),S=Math.round(v*n);y=Math.min(y,xo(o[0].dts,_)-S),p=Math.min(p,_-S)}else h=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:p,timescale:v},this._initDTS={baseTime:y,timescale:v}):p=v=void 0,{tracks:l,initPTS:p,timescale:v}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,o=e.samples,a=[],l=o.length,c=this._initPTS;let h=this.nextAvcDts,f=8,p=this.videoSampleDuration,y,v,_=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,A=!1;if(!n||h===null){const $=t*r,X=o[0].pts-xo(o[0].dts,o[0].pts);If&&h!==null&&Math.abs($-X-h)<15e3?n=!0:h=$-X}const w=c.baseTime*r/c.timescale;for(let $=0;$<l;$++){const X=o[$];X.pts=xo(X.pts-w,h),X.dts=xo(X.dts-w,h),X.dts<o[$>0?$-1:$].dts&&(A=!0)}A&&o.sort(function($,X){const W=$.dts-X.dts,ne=$.pts-X.pts;return W||ne}),y=o[0].dts,v=o[o.length-1].dts;const M=v-y,C=M?Math.round(M/(l-1)):p||e.inputTimeScale/30;if(n){const $=y-h,X=$>C,W=$<-1;if((X||W)&&(X?ve.warn(`AVC: ${Bm($,!0)} ms (${$}dts) hole between fragments detected at ${t.toFixed(3)}`):ve.warn(`AVC: ${Bm(-$,!0)} ms (${$}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!W||h>=o[0].pts||If)){y=h;const ne=o[0].pts-$;if(X)o[0].dts=y,o[0].pts=ne;else for(let Ee=0;Ee<o.length&&!(o[Ee].dts>ne);Ee++)o[Ee].dts-=$,o[Ee].pts-=$;ve.log(`Video: Initial PTS/DTS adjusted: ${Bm(ne,!0)}/${Bm(y,!0)}, delta: ${Bm($,!0)} ms`)}}y=Math.max(0,y);let I=0,O=0,k=y;for(let $=0;$<l;$++){const X=o[$],W=X.units,ne=W.length;let Ee=0;for(let le=0;le<ne;le++)Ee+=W[le].data.length;O+=Ee,I+=ne,X.length=Ee,X.dts<k?(X.dts=k,k+=C/4|0||1):k=X.dts,_=Math.min(X.pts,_),S=Math.max(X.pts,S)}v=o[l-1].dts;const N=O+4*I+8;let B;try{B=new Uint8Array(N)}catch($){this.observer.emit(z.ERROR,z.ERROR,{type:Yt.MUX_ERROR,details:Le.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:N,reason:`fail allocating video mdat ${N}`});return}const P=new DataView(B.buffer);P.setUint32(0,N),B.set(Se.types.mdat,4);let G=!1,Z=Number.POSITIVE_INFINITY,Y=Number.POSITIVE_INFINITY,se=Number.NEGATIVE_INFINITY,oe=Number.NEGATIVE_INFINITY;for(let $=0;$<l;$++){const X=o[$],W=X.units;let ne=0;for(let ye=0,we=W.length;ye<we;ye++){const Ie=W[ye],ze=Ie.data,Ze=Ie.data.byteLength;P.setUint32(f,Ze),f+=4,B.set(ze,f),f+=Ze,ne+=4+Ze}let Ee;if($<l-1)p=o[$+1].dts-X.dts,Ee=o[$+1].pts-X.pts;else{const ye=this.config,we=$>0?X.dts-o[$-1].dts:C;if(Ee=$>0?X.pts-o[$-1].pts:C,ye.stretchShortVideoTrack&&this.nextAudioPts!==null){const Ie=Math.floor(ye.maxBufferHole*r),ze=(i?_+i*r:this.nextAudioPts)-X.pts;ze>Ie?(p=ze-we,p<0?p=we:G=!0,ve.log(`[mp4-remuxer]: It is approximately ${ze/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=we}else p=we}const le=Math.round(X.pts-X.dts);Z=Math.min(Z,p),se=Math.max(se,p),Y=Math.min(Y,Ee),oe=Math.max(oe,Ee),a.push(new db(X.key,p,ne,le))}if(a.length){if(If){if(If<70){const $=a[0].flags;$.dependsOn=2,$.isNonSync=0}}else if(hS&&oe-Y<se-Z&&C/se<.025&&a[0].cts===0){ve.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let $=y;for(let X=0,W=a.length;X<W;X++){const ne=$+a[X].duration,Ee=$+a[X].cts;if(X<W-1){const le=ne+a[X+1].cts;a[X].duration=le-Ee}else a[X].duration=X?a[X-1].duration:C;a[X].cts=0,$=ne}}}p=G||!p?C:p,this.nextAvcDts=h=v+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;const H={data1:Se.moof(e.sequenceNumber++,y,Gi({},e,{samples:a})),data2:B,startPTS:_/r,endPTS:(S+p)/r,startDTS:y/r,endDTS:h/r,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,H}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return Ez;case"ac3":return Tz;default:return hb}}remuxAudio(e,t,n,i,r){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,l=o/a,c=this.getSamplesPerFrame(e),h=c*l,f=this._initPTS,p=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,y=[],v=r!==void 0;let _=e.samples,S=p?0:8,A=this.nextAudioPts||-1;const w=t*o,M=f.baseTime*o/f.timescale;if(this.isAudioContiguous=n=n||_.length&&A>0&&(i&&Math.abs(w-A)<9e3||Math.abs(xo(_[0].pts-M,w)-A)<20*h),_.forEach(function(re){re.pts=xo(re.pts-M,w)}),!n||A<0){if(_=_.filter(re=>re.pts>=0),!_.length)return;r===0?A=0:i&&!v?A=Math.max(0,w):A=_[0].pts}if(e.segmentCodec==="aac"){const re=this.config.maxAudioFramesDrift;for(let ce=0,H=A;ce<_.length;ce++){const $=_[ce],X=$.pts,W=X-H,ne=Math.abs(1e3*W/o);if(W<=-re*h&&v)ce===0&&(ve.warn(`Audio frame @ ${(X/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*W/o)} ms.`),this.nextAudioPts=A=H=X);else if(W>=re*h&&ne<Az&&v){let Ee=Math.round(W/h);H=X-Ee*h,H<0&&(Ee--,H+=h),ce===0&&(this.nextAudioPts=A=H),ve.warn(`[mp4-remuxer]: Injecting ${Ee} audio frame @ ${(H/o).toFixed(3)}s due to ${Math.round(1e3*W/o)} ms gap.`);for(let le=0;le<Ee;le++){const ye=Math.max(H,0);let we=ub.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);we||(ve.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),we=$.unit.subarray()),_.splice(ce,0,{unit:we,pts:ye}),H+=h,ce++}}$.pts=H,H+=h}}let C=null,I=null,O,k=0,N=_.length;for(;N--;)k+=_[N].unit.byteLength;for(let re=0,ce=_.length;re<ce;re++){const H=_[re],$=H.unit;let X=H.pts;if(I!==null){const ne=y[re-1];ne.duration=Math.round((X-I)/l)}else if(n&&e.segmentCodec==="aac"&&(X=A),C=X,k>0){k+=S;try{O=new Uint8Array(k)}catch(ne){this.observer.emit(z.ERROR,z.ERROR,{type:Yt.MUX_ERROR,details:Le.REMUX_ALLOC_ERROR,fatal:!1,error:ne,bytes:k,reason:`fail allocating audio mdat ${k}`});return}p||(new DataView(O.buffer).setUint32(0,k),O.set(Se.types.mdat,4))}else return;O.set($,S);const W=$.byteLength;S+=W,y.push(new db(!0,c,W,0)),I=X}const B=y.length;if(!B)return;const P=y[y.length-1];this.nextAudioPts=A=I+l*P.duration;const G=p?new Uint8Array(0):Se.moof(e.sequenceNumber++,C/l,Gi({},e,{samples:y}));e.samples=[];const Z=C/o,Y=A/o,oe={data1:G,data2:O,startPTS:Z,endPTS:Y,startDTS:Z,endDTS:Y,type:"audio",hasAudio:!0,hasVideo:!1,nb:B};return this.isAudioContiguous=!0,oe}remuxEmptyAudio(e,t,n,i){const r=e.inputTimeScale,o=e.samplerate?e.samplerate:r,a=r/o,l=this.nextAudioPts,c=this._initDTS,h=c.baseTime*9e4/c.timescale,f=(l!==null?l:i.startDTS*r)+h,p=i.endDTS*r+h,y=a*hb,v=Math.ceil((p-f)/y),_=ub.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(ve.warn("[mp4-remuxer]: remux empty Audio"),!_){ve.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const S=[];for(let A=0;A<v;A++){const w=f+A*y;S.push({unit:_,pts:w,dts:w})}return e.samples=S,this.remuxAudio(e,t,n,!1)}}function xo(s,e){let t;if(e===null)return s;for(e<s?t=-8589934592:t=8589934592;Math.abs(s-e)>4294967296;)s+=t;return s}function wz(s){for(let e=0;e<s.length;e++)if(s[e].key)return e;return-1}function RL(s,e,t,n){const i=s.samples.length;if(!i)return;const r=s.inputTimeScale;for(let a=0;a<i;a++){const l=s.samples[a];l.pts=xo(l.pts-t.baseTime*r/t.timescale,e*r)/r,l.dts=xo(l.dts-n.baseTime*r/n.timescale,e*r)/r}const o=s.samples;return s.samples=[],{samples:o}}function IL(s,e,t){const n=s.samples.length;if(!n)return;const i=s.inputTimeScale;for(let o=0;o<n;o++){const a=s.samples[o];a.pts=xo(a.pts-t.baseTime*i/t.timescale,e*i)/i}s.samples.sort((o,a)=>o.pts-a.pts);const r=s.samples;return s.samples=[],{samples:r}}class db{constructor(e,t,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=i,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class Mz{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(OG(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const i=this.initData=ZI(e);i.audio&&(t=fb(i.audio,kn.AUDIO)),i.video&&(n=fb(i.video,kn.VIDEO));const r={};i.audio&&i.video?r.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?r.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:ve.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,n,i,r,o){var a,l;let{initPTS:c,lastEndTime:h}=this;const f={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};bt(h)||(h=this.lastEndTime=r||0);const p=t.samples;if(!(p!=null&&p.length))return f;const y={initPTS:void 0,timescale:1};let v=this.initData;if((a=v)!=null&&a.length||(this.generateInitSegment(p),v=this.initData),!((l=v)!=null&&l.length))return ve.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),f;this.emitInitSegment&&(y.tracks=this.initTracks,this.emitInitSegment=!1);const _=FG(p,v),S=BG(v,p),A=S===null?r:S;(bz(c,A,r,_)||y.timescale!==c.timescale&&o)&&(y.initPTS=A-r,c&&c.timescale===1&&ve.warn(`Adjusting initPTS by ${y.initPTS-c.baseTime}`),this.initPTS=c={baseTime:y.initPTS,timescale:1});const w=e?A-c.baseTime/c.timescale:h,M=w+_;NG(v,p,c.baseTime/c.timescale),_>0?this.lastEndTime=M:(ve.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const C=!!v.audio,I=!!v.video;let O="";C&&(O+="audio"),I&&(O+="video");const k={data1:p,startPTS:w,startDTS:w,endPTS:M,endDTS:M,type:O,hasAudio:C,hasVideo:I,nb:1,dropped:0};return f.audio=k.type==="audio"?k:void 0,f.video=k.type!=="audio"?k:void 0,f.initSegment=y,f.id3=RL(n,r,c,c),i.samples.length&&(f.text=IL(i,r,c)),f}}function bz(s,e,t,n){if(s===null)return!0;const i=Math.max(n,1),r=e-s.baseTime/s.timescale;return Math.abs(r-t)>i}function fb(s,e){const t=s==null?void 0:s.codec;if(t&&t.length>4)return t;if(e===kn.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return sx(t,!1);const n="mp4a.40.5";return ve.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${n}"`),n}return ve.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let Ol;try{Ol=self.performance.now.bind(self.performance)}catch{ve.debug("Unable to use Performance API on this environment"),Ol=sp==null?void 0:sp.Date.now}const ov=[{demux:dz,remux:Mz},{demux:Hc,remux:sv},{demux:uz,remux:sv},{demux:xz,remux:sv}];ov.splice(2,0,{demux:fz,remux:sv});class pb{constructor(e,t,n,i,r){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=i,this.id=r}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=Ol();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:l}=this;i&&(this.currentTransmuxState=i);const{contiguous:c,discontinuity:h,trackSwitch:f,accurateTimeOffset:p,timeOffset:y,initSegmentChange:v}=i||a,{audioCodec:_,videoCodec:S,defaultInitPts:A,duration:w,initSegmentData:M}=l,C=Cz(o,t);if(C&&C.method==="AES-128"){const N=this.getDecrypter();if(N.isSync()){let B=N.softwareDecrypt(o,C.key.buffer,C.iv.buffer);if(n.part>-1&&(B=N.flush()),!B)return r.executeEnd=Ol(),dS(n);o=new Uint8Array(B)}else return this.decryptionPromise=N.webCryptoDecrypt(o,C.key.buffer,C.iv.buffer).then(B=>{const P=this.push(B,null,n);return this.decryptionPromise=null,P}),this.decryptionPromise}const I=this.needsProbing(h,f);if(I){const N=this.configureTransmuxer(o);if(N)return ve.warn(`[transmuxer] ${N.message}`),this.observer.emit(z.ERROR,z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.FRAG_PARSING_ERROR,fatal:!1,error:N,reason:N.message}),r.executeEnd=Ol(),dS(n)}(h||f||v||I)&&this.resetInitSegment(M,_,S,w,t),(h||v||I)&&this.resetInitialTimestamp(A),c||this.resetContiguity();const O=this.transmux(o,C,y,p,n),k=this.currentTransmuxState;return k.contiguous=!0,k.discontinuity=!1,k.trackSwitch=!1,r.executeEnd=Ol(),O}flush(e){const t=e.transmuxing;t.executeStart=Ol();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return r.then(()=>this.flush(e));const o=[],{timeOffset:a}=i;if(n){const f=n.flush();f&&o.push(this.push(f,null,e))}const{demuxer:l,remuxer:c}=this;if(!l||!c)return t.executeEnd=Ol(),[dS(e)];const h=l.flush(a);return av(h)?h.then(f=>(this.flushRemux(o,f,e),o)):(this.flushRemux(o,h,e),o)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:o,textTrack:a}=t,{accurateTimeOffset:l,timeOffset:c}=this.currentTransmuxState;ve.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const h=this.remuxer.remux(i,r,o,a,c,l,!0,this.id);e.push({remuxResult:h,chunkMeta:n}),n.transmuxing.executeEnd=Ol()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,n,i,r):o=this.transmuxUnencrypted(e,n,i,r),o}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:o,id3Track:a,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,o,a,l,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,n,i,!1,this.id),chunkMeta:r}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i,vendor:r}=this;let o;for(let p=0,y=ov.length;p<y;p++){var a;if((a=ov[p].demux)!=null&&a.probe(e)){o=ov[p];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,c=this.remuxer,h=o.remux,f=o.demux;(!c||!(c instanceof h))&&(this.remuxer=new h(n,t,i,r)),(!l||!(l instanceof f))&&(this.demuxer=new f(n,t,i),this.probe=f.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new WE(this.config)),e}}function Cz(s,e){let t=null;return s.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const dS=s=>({remuxResult:{},chunkMeta:s});function av(s){return"then"in s&&s.then instanceof Function}class Rz{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class Iz{constructor(e,t,n,i,r,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=o}}var LL={exports:{}};(function(s){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,c,h){this.fn=l,this.context=c,this.once=h||!1}function r(l,c,h,f,p){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new i(h,f||l,p),v=t?t+c:c;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],y]:l._events[v].push(y):(l._events[v]=y,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],h,f;if(this._eventsCount===0)return c;for(f in h=this._events)e.call(h,f)&&c.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(h)):c},a.prototype.listeners=function(c){var h=t?t+c:c,f=this._events[h];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,y=f.length,v=new Array(y);p<y;p++)v[p]=f[p].fn;return v},a.prototype.listenerCount=function(c){var h=t?t+c:c,f=this._events[h];return f?f.fn?1:f.length:0},a.prototype.emit=function(c,h,f,p,y,v){var _=t?t+c:c;if(!this._events[_])return!1;var S=this._events[_],A=arguments.length,w,M;if(S.fn){switch(S.once&&this.removeListener(c,S.fn,void 0,!0),A){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,h),!0;case 3:return S.fn.call(S.context,h,f),!0;case 4:return S.fn.call(S.context,h,f,p),!0;case 5:return S.fn.call(S.context,h,f,p,y),!0;case 6:return S.fn.call(S.context,h,f,p,y,v),!0}for(M=1,w=new Array(A-1);M<A;M++)w[M-1]=arguments[M];S.fn.apply(S.context,w)}else{var C=S.length,I;for(M=0;M<C;M++)switch(S[M].once&&this.removeListener(c,S[M].fn,void 0,!0),A){case 1:S[M].fn.call(S[M].context);break;case 2:S[M].fn.call(S[M].context,h);break;case 3:S[M].fn.call(S[M].context,h,f);break;case 4:S[M].fn.call(S[M].context,h,f,p);break;default:if(!w)for(I=1,w=new Array(A-1);I<A;I++)w[I-1]=arguments[I];S[M].fn.apply(S[M].context,w)}}return!0},a.prototype.on=function(c,h,f){return r(this,c,h,f,!1)},a.prototype.once=function(c,h,f){return r(this,c,h,f,!0)},a.prototype.removeListener=function(c,h,f,p){var y=t?t+c:c;if(!this._events[y])return this;if(!h)return o(this,y),this;var v=this._events[y];if(v.fn)v.fn===h&&(!p||v.once)&&(!f||v.context===f)&&o(this,y);else{for(var _=0,S=[],A=v.length;_<A;_++)(v[_].fn!==h||p&&!v[_].once||f&&v[_].context!==f)&&S.push(v[_]);S.length?this._events[y]=S.length===1?S[0]:S:o(this,y)}return this},a.prototype.removeAllListeners=function(c){var h;return c?(h=t?t+c:c,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,s.exports=a})(LL);var Lz=LL.exports,JE=rG(Lz);class PL{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const o=(c,h)=>{h=h||{},h.frag=this.frag,h.id=this.id,c===z.ERROR&&(this.error=h.error),this.hls.trigger(c,h)};this.observer=new JE,this.observer.on(z.FRAG_DECRYPTED,o),this.observer.on(z.ERROR,o);const a=eu(r.preferManagedMediaSource)||{isTypeSupported:()=>!1},l={mpeg:a.isTypeSupported("audio/mpeg"),mp3:a.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:a.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(r.workerPath||JH())){try{r.workerPath?(ve.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=QH(r.workerPath)):(ve.log(`injecting Web Worker for "${t}"`),this.workerContext=qH()),this.onwmsg=f=>this.onWorkerMessage(f);const{worker:h}=this.workerContext;h.addEventListener("message",this.onwmsg),h.onerror=f=>{const p=new Error(`${f.message}  (${f.filename}:${f.lineno})`);r.enableWorker=!1,ve.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(z.ERROR,{type:Yt.OTHER_ERROR,details:Le.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:p})},h.postMessage({cmd:"init",typeSupported:l,vendor:"",id:t,config:JSON.stringify(r)})}catch(h){ve.warn(`Error setting up "${t}" Web Worker, fallback to inline`,h),this.resetWorker(),this.error=null,this.transmuxer=new pb(this.observer,l,r,"",t)}return}this.transmuxer=new pb(this.observer,l,r,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,i,r,o,a,l,c,h){var f,p;c.transmuxing.start=self.performance.now();const{transmuxer:y}=this,v=o?o.start:r.start,_=r.decryptdata,S=this.frag,A=!(S&&r.cc===S.cc),w=!(S&&c.level===S.level),M=S?c.sn-S.sn:-1,C=this.part?c.part-this.part.index:-1,I=M===0&&c.id>1&&c.id===(S==null?void 0:S.stats.chunkCount),O=!w&&(M===1||M===0&&(C===1||I&&C<=0)),k=self.performance.now();(w||M||r.stats.parsing.start===0)&&(r.stats.parsing.start=k),o&&(C||!O)&&(o.stats.parsing.start=k);const N=!(S&&((f=r.initSegment)==null?void 0:f.url)===((p=S.initSegment)==null?void 0:p.url)),B=new Iz(A,O,l,w,v,N);if(!O||A||N){ve.log(`[transmuxer-interface, ${r.type}]: Starting new transmux session for sn: ${c.sn} p: ${c.part} level: ${c.level} id: ${c.id}
        discontinuity: ${A}
        trackSwitch: ${w}
        contiguous: ${O}
        accurateTimeOffset: ${l}
        timeOffset: ${v}
        initSegmentChange: ${N}`);const P=new Rz(n,i,t,a,h);this.configureTransmuxer(P)}if(this.frag=r,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:_,chunkMeta:c,state:B},e instanceof ArrayBuffer?[e]:[]);else if(y){const P=y.push(e,_,c,B);av(P)?(y.async=!0,P.then(G=>{this.handleTransmuxComplete(G)}).catch(G=>{this.transmuxerError(G,c,"transmuxer-interface push error")})):(y.async=!1,this.handleTransmuxComplete(P))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);av(n)||t.async?(av(n)||(n=Promise.resolve(n)),n.then(r=>{this.handleFlushResult(r,e)}).catch(r=>{this.transmuxerError(r,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(!(t!=null&&t.event)){ve.warn(`worker message received with no ${t?"event name":"data"}`);return}const n=this.hls;if(this.hls)switch(t.event){case"init":{var i;const r=(i=this.workerContext)==null?void 0:i.objectURL;r&&self.URL.revokeObjectURL(r);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":ve[t.data.logType]&&ve[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}function DL(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!ap(s[t].attrs,e[t].attrs))return!1;return!0}function ap(s,e,t){const n=s["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(i=>s[i]!==e[i])}function dA(s,e){return e.label.toLowerCase()===s.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(s.lang||"").toLowerCase())}const mb=100;class OL extends s_{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",Ht.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.LEVEL_LOADED,this.onLevelLoaded,this),e.on(z.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(z.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(z.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(z.ERROR,this.onError,this),e.on(z.BUFFER_RESET,this.onBufferReset,this),e.on(z.BUFFER_CREATED,this.onBufferCreated,this),e.on(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(z.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(z.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(z.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.LEVEL_LOADED,this.onLevelLoaded,this),e.off(z.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(z.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(z.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(z.ERROR,this.onError,this),e.off(z.BUFFER_RESET,this.onBufferReset,this),e.off(z.BUFFER_CREATED,this.onBufferCreated,this),e.off(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(z.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(z.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(z.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){if(n==="main"){const o=t.cc;this.initPTS[t.cc]={baseTime:i,timescale:r},this.log(`InitPTS for cc: ${o} found from main: ${i}`),this.videoTrackCC=o,this.state===je.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=je.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(mb),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=je.IDLE):(this.loadedmetadata=!1,this.state=je.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case je.IDLE:this.doTickIdle();break;case je.WAITING_TRACK:{var e;const{levels:n,trackId:i}=this,r=n==null||(e=n[i])==null?void 0:e.details;if(r){if(this.waitForCdnTuneIn(r))break;this.state=je.WAITING_INIT_PTS}break}case je.FRAG_LOADING_WAITING_RETRY:{var t;const n=performance.now(),i=this.retryDate;if(!i||n>=i||(t=this.media)!=null&&t.seeking){const{levels:r,trackId:o}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((r==null?void 0:r[o])||null),this.state=je.IDLE}break}case je.WAITING_INIT_PTS:{const n=this.waitingData;if(n){const{frag:i,part:r,cache:o,complete:a}=n;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=je.FRAG_LOADING;const l=o.flush(),c={frag:i,part:r,payload:l,networkDetails:null};this._handleFragmentLoadProgress(c),a&&super._handleFragmentLoadComplete(c)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${i.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const l=this.getLoadPosition(),c=Jn.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);uA(c.end,this.config.maxFragLookUpTolerance,i)<0&&(this.log(`Waiting fragment cc (${i.cc}) @ ${i.start} cancelled because another fragment at ${c.end} is needed`),this.clearWaitingFragment())}}else this.state=je.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=je.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:i}=this,r=e.config;if(!n&&(this.startFragRequested||!r.startFragPrefetch)||!(t!=null&&t[i]))return;const o=t[i],a=o.details;if(!a||a.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(a)){this.state=je.WAITING_TRACK;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,kn.AUDIO,Ht.AUDIO));const c=this.getFwdBufferInfo(l,Ht.AUDIO);if(c===null)return;const{bufferedTrack:h,switchingTrack:f}=this;if(!f&&this._streamEnded(c,a)){e.trigger(z.BUFFER_EOS,{type:"audio"}),this.state=je.ENDED;return}const p=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Ht.MAIN),y=c.len,v=this.getMaxBufferLength(p==null?void 0:p.len),_=a.fragments,S=_[0].start;let A=this.flushing?this.getLoadPosition():c.end;if(f&&n){const I=this.getLoadPosition();h&&!ap(f.attrs,h.attrs)&&(A=I),a.PTSKnown&&I<S&&(c.end>S||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=S+.05)}if(y>=v&&!f&&A<_[_.length-1].start)return;let w=this.getNextFragment(A,a),M=!1;if(w&&this.isLoopLoading(w,A)&&(M=!!w.gap,w=this.getNextFragmentLoopLoading(w,a,c,Ht.MAIN,v)),!w){this.bufferFlushed=!0;return}const C=p&&w.start>p.end+a.targetduration;if(C||!(p!=null&&p.len)&&c.len){const I=this.getAppendedFrag(w.start,Ht.MAIN);if(I===null||(M||(M=!!I.gap||!!C&&p.len===0),C&&!M||M&&c.nextStart&&c.nextStart<I.end))return}this.loadFragment(w,o,A)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new Wh(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(mb):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=je.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=je.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(z.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:i}=this,{details:r,id:o}=t;if(!i){this.warn(`Audio tracks were reset while loading level ${o}`);return}this.log(`Audio track ${o} loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const a=i[o];let l=0;if(r.live||(n=a.details)!=null&&n.live){this.checkLiveUpdate(r);const h=this.mainDetails;if(r.deltaUpdateFailed||!h)return;if(!a.details&&r.hasProgramDateTime&&h.hasProgramDateTime)ux(r,h),l=r.fragments[0].start;else{var c;l=this.alignPlaylists(r,a.details,(c=this.levelLastLoaded)==null?void 0:c.details)}}a.details=r,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!r.live)&&this.setStartPosition(this.mainDetails||r,l),this.state===je.WAITING_TRACK&&!this.waitForCdnTuneIn(r)&&(this.state=je.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{config:o,trackId:a,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const c=l[a];if(!c){this.warn("Audio track is undefined on fragment load progress");return}const h=c.details;if(!h){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const f=o.defaultAudioCodec||c.audioCodec||"mp4a.40.2";let p=this.transmuxer;p||(p=this.transmuxer=new PL(this.hls,Ht.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const y=this.initPTS[n.cc],v=(t=n.initSegment)==null?void 0:t.data;if(y!==void 0){const S=i?i.index:-1,A=S!==-1,w=new r_(n.level,n.sn,n.stats.chunkCount,r.byteLength,S,A);p.push(r,v,f,"",n,i,h.totalduration,!1,w,y)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${h.startSN} ,${h.endSN}],track ${a}`);const{cache:_}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new gL,complete:!1};_.push(new Uint8Array(r)),this.waitingVideoCC=this.videoTrackCC,this.state=je.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type!==Ht.AUDIO){if(!this.loadedmetadata&&n.type===Ht.MAIN){const r=this.videoBuffer||this.media;r&&Jn.getBuffered(r).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;const r=this.switchingTrack;r&&(this.bufferedTrack=r,this.switchingTrack=null,this.hls.trigger(z.AUDIO_TRACK_SWITCHED,fr({},r)))}this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=je.ERROR;return}switch(t.details){case Le.FRAG_GAP:case Le.FRAG_PARSING_ERROR:case Le.FRAG_DECRYPT_ERROR:case Le.FRAG_LOAD_ERROR:case Le.FRAG_LOAD_TIMEOUT:case Le.KEY_LOAD_ERROR:case Le.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Ht.AUDIO,t);break;case Le.AUDIO_TRACK_LOAD_ERROR:case Le.AUDIO_TRACK_LOAD_TIMEOUT:case Le.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===je.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===Tn.AUDIO_TRACK&&(this.state=je.IDLE);break;case Le.BUFFER_APPEND_ERROR:case Le.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===Le.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Le.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==kn.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==kn.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===je.ENDED&&(this.state=je.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,Ht.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:c,level:h}=a,{details:f}=h,{audio:p,text:y,id3:v,initSegment:_}=r;if(this.fragContextChanged(l)||!f){this.fragmentTracker.removeFragment(l);return}if(this.state=je.PARSING,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),_!=null&&_.tracks){const S=l.initSegment||l;this._bufferInitSegment(h,_.tracks,S,o),i.trigger(z.FRAG_PARSING_INIT_SEGMENT,{frag:S,id:n,tracks:_.tracks})}if(p){const{startPTS:S,endPTS:A,startDTS:w,endDTS:M}=p;c&&(c.elementaryStreams[kn.AUDIO]={startPTS:S,endPTS:A,startDTS:w,endDTS:M}),l.setElementaryStreamInfo(kn.AUDIO,S,A,w,M),this.bufferFragmentData(p,l,c,o)}if(v!=null&&(t=v.samples)!=null&&t.length){const S=Gi({id:n,frag:l,details:f},v);i.trigger(z.FRAG_PARSING_METADATA,S)}if(y){const S=Gi({id:n,frag:l,details:f},y);i.trigger(z.FRAG_PARSING_USERDATA,S)}}_bufferInitSegment(e,t,n,i){if(this.state!==je.PARSING)return;t.video&&delete t.video;const r=t.audio;if(!r)return;r.id="audio";const o=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${o}/${r.codec}]`),o&&o.split(",").length===1&&(r.levelCodec=o),this.hls.trigger(z.BUFFER_CODECS,t);const a=r.initSegment;if(a!=null&&a.byteLength){const l={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:a};this.hls.trigger(z.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||i===lr.NOT_LOADED||i===lr.PARTIAL){var r;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((r=t.details)!=null&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=je.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragments[0].start!==t.details.fragments[0].start&&ux(t.details,o)}else this.startFragRequested=!0,super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){const{media:t,bufferedTrack:n}=this,i=n==null?void 0:n.attrs,r=e.attrs;t&&i&&(i.CHANNELS!==r.CHANNELS||n.name!==e.name||n.lang!==e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(z.AUDIO_TRACK_SWITCHED,fr({},e))}}class BL extends i_{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.LEVEL_LOADING,this.onLevelLoading,this),e.on(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(z.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(z.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.LEVEL_LOADING,this.onLevelLoading,this),e.off(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(z.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(z.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==i){this.warn(`Audio track with id:${n} and group:${i} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Audio track ${n} "${o.name}" lang:${o.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(a=>(i==null?void 0:i.indexOf(a))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(p=>!n||n.indexOf(p.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(p=>p.default)&&(this.selectDefaultTrack=!1),a.forEach((p,y)=>{p.id=y});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.audioPreference;if(!r&&l){const p=Pa(l,a,bf);if(p>-1)r=a[p];else{const y=Pa(l,this.tracks);r=this.tracks[y]}}let c=this.findTrackId(r);c===-1&&r&&(c=this.findTrackId(null));const h={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(z.AUDIO_TRACKS_UPDATED,h);const f=this.trackId;if(c!==-1&&f===-1)this.setAudioTrack(c);else if(a.length&&f===-1){var o;const p=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${a.length}`);this.warn(p.message),this.hls.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:p})}}else this.shouldReloadPlaylist(r)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===Tn.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&Kf(e,i,bf))return i;const r=Pa(e,this.tracksInGroup,bf);if(r>-1){const o=this.tracksInGroup[r];return this.setAudioTrack(r),o}else if(i){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const a=OH(e,t.levels,n,o,bf);if(a===-1)return null;t.nextLoadLevel=a}if(e.channels||e.audioCodec){const o=Pa(e,n);if(o>-1)return n[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],r=i.details&&!i.details.live;if(e===this.trackId&&i===n&&r||(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(z.AUDIO_TRACK_SWITCHING,fr({},i)),r))return;const o=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(!(this.selectDefaultTrack&&!i.default)&&(!e||Kf(e,i,bf)))return n}if(e){const{name:n,lang:i,assocLang:r,characteristics:o,audioCodec:a,channels:l}=e;for(let c=0;c<t.length;c++){const h=t[c];if(Kf({name:n,lang:i,assocLang:r,characteristics:o,audioCodec:a,channels:l},h,bf))return c}for(let c=0;c<t.length;c++){const h=t[c];if(ap(e.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return c}for(let c=0;c<t.length;c++){const h=t[c];if(ap(e.attrs,h.attrs,["LANGUAGE"]))return c}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const n=t.id,i=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(z.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null})}}}const gb=500;class FL extends s_{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",Ht.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.LEVEL_LOADED,this.onLevelLoaded,this),e.on(z.ERROR,this.onError,this),e.on(z.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(z.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(z.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(z.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(z.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.LEVEL_LOADED,this.onLevelLoaded,this),e.off(z.ERROR,this.onError,this),e.off(z.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(z.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(z.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(z.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(z.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=je.IDLE,this.setInterval(gb),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragPrevious=n,this.state=je.IDLE,!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let o;const a=n.start;for(let c=0;c<r.length;c++)if(a>=r[c].start&&a<=r[c].end){o=r[c];break}const l=n.start+n.duration;o?o.end=l:(o={start:a,end:l},r.push(o)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(n===0&&i!==Number.POSITIVE_INFINITY){const r=i-1;if(r<=0)return;t.endOffsetSubtitles=Math.max(0,r),this.tracksBuffered.forEach(o=>{for(let a=0;a<o.length;){if(o[a].end<=r){o.shift();continue}else if(o[a].start<r)o[a].start=r;else break;a++}}),this.fragmentTracker.removeFragmentsInRange(n,r,Ht.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===Ht.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===Ht.SUBTITLE&&(t.details===Le.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==je.STOPPED&&(this.state=je.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&DL(this.levels,t)){this.levels=t.map(n=>new Wh(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const i=new Wh(n);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Ht.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const i=this.levels[this.currentTrackId];i!=null&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(gb)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:r}=this,{details:o,id:a}=t;if(!r){this.warn(`Subtitle tracks were reset while loading level ${a}`);return}const l=r[a];if(a>=r.length||!l)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(o.live||(n=l.details)!=null&&n.live){const f=this.mainDetails;if(o.deltaUpdateFailed||!f)return;const p=f.fragments[0];if(!l.details)o.hasProgramDateTime&&f.hasProgramDateTime?(ux(o,f),c=o.fragments[0].start):p&&(c=p.start,cA(o,c));else{var h;c=this.alignPlaylists(o,l.details,(h=this.levelLastLoaded)==null?void 0:h.details),c===0&&p&&(c=p.start,cA(o,c))}}l.details=o,this.levelLastLoaded=l,a===i&&(!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(this.mainDetails||o,c),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===je.IDLE&&(cx(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i!=null&&i.key&&i.iv&&i.method==="AES-128"){const o=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch(a=>{throw r.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:t}),a}).then(a=>{const l=performance.now();r.trigger(z.FRAG_DECRYPTED,{frag:t,payload:a,stats:{tstart:o,tdecrypt:l}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state=je.IDLE})}}doTick(){if(!this.media){this.state=je.IDLE;return}if(this.state===je.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:i}=this,r=this.getLoadPosition(),o=Jn.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:a,len:l}=o,c=this.getFwdBufferInfo(this.media,Ht.MAIN),h=n.details,f=this.getMaxBufferLength(c==null?void 0:c.len)+h.levelTargetDuration;if(l>f)return;const p=h.fragments,y=p.length,v=h.edge;let _=null;const S=this.fragPrevious;if(a<v){const A=i.maxFragLookUpTolerance,w=a>v-A?0:A;_=cx(S,p,Math.max(p[0].start,a),w),!_&&S&&S.start<p[0].start&&(_=p[0])}else _=p[y-1];if(!_)return;if(_=this.mapToInitFragWhenRequired(_),_.sn!=="initSegment"){const A=_.sn-h.startSN,w=p[A-1];w&&w.cc===_.cc&&this.fragmentTracker.getState(w)===lr.NOT_LOADED&&(_=w)}this.fragmentTracker.getState(_)===lr.NOT_LOADED&&this.loadFragment(_,n,a)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new Pz(this.tracksBuffered[this.currentTrackId]||[])}}class Pz{constructor(e){this.buffered=void 0;const t=(n,i,r)=>{if(i=i>>>0,i>r-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${r})`);return e[i][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class kL extends i_{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=iv(this.media.textTracks);for(let r=0;r<n.length;r++)if(n[r].mode==="hidden")t=n[r];else if(n[r].mode==="showing"){t=n[r];break}const i=this.findTrackForTextTrack(t);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.LEVEL_LOADING,this.onLevelLoading,this),e.on(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(z.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(z.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.LEVEL_LOADING,this.onLevelLoading,this),e.off(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(z.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(z.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),iv(this.media.textTracks).forEach(t=>{Gf(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==i){this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Subtitle track ${n} "${o.name}" lang:${o.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(o=>(i==null?void 0:i.indexOf(o))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(h=>!n||n.indexOf(h.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(h=>h.default)&&(this.selectDefaultTrack=!1),o.forEach((h,f)=>{h.id=f});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const a=this.hls.config.subtitlePreference;if(!r&&a){this.selectDefaultTrack=!1;const h=Pa(a,o);if(h>-1)r=o[h];else{const f=Pa(a,this.tracks);r=this.tracks[f]}}let l=this.findTrackId(r);l===-1&&r&&(l=this.findTrackId(null));const c={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(z.SUBTITLE_TRACKS_UPDATED,c),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const r=t[i];if(!(n&&!r.default||!n&&!e)&&(!e||Kf(r,e)))return i}if(e){for(let i=0;i<t.length;i++){const r=t[i];if(ap(e.attrs,r.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<t.length;i++){const r=t[i];if(ap(e.attrs,r.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(dA(i,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Tn.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Kf(e,n))return n;const i=Pa(e,this.tracksInGroup);if(i>-1){const r=this.tracksInGroup[i];return this.setSubtitleTrack(i),r}else{if(n)return null;{const r=Pa(e,t);if(r>-1)return t[r]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const n=t.id,i=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(z.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=iv(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter(r=>dA(n,r))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(r=>{r.mode!=="disabled"&&r!==i&&(r.mode="disabled")}),i){const r=this.subtitleDisplay?"showing":"hidden";i.mode!==r&&(i.mode=r)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!bt(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i){this.hls.trigger(z.SUBTITLE_TRACK_SWITCH,{id:e});return}const r=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:o,groupId:a="",name:l,type:c,url:h}=i;this.hls.trigger(z.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:l,type:c,url:h});const f=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(f)}}class Dz{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const i=this.queues[t];i.push(e),i.length===1&&!n&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(r=>{t=r}),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(i){ve.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${i}`),n.onError(i);const r=this.buffers[e];r!=null&&r.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const yb=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class NL{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=n=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:n,mediaSource:i}=this;this.log("Media source opened"),n&&(n.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(z.MEDIA_ATTACHED,{media:n,mediaSource:i})),i&&i.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:i}=this;n!==i&&ve.error(`Media element src was set while attaching MediaSource (${i} > ${n})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=YG(eu(e.config.preferManagedMediaSource)),this.log=ve.log.bind(ve,t),this.warn=ve.warn.bind(ve,t),this.error=ve.error.bind(ve,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.BUFFER_RESET,this.onBufferReset,this),e.on(z.BUFFER_APPENDING,this.onBufferAppending,this),e.on(z.BUFFER_CODECS,this.onBufferCodecs,this),e.on(z.BUFFER_EOS,this.onBufferEos,this),e.on(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(z.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(z.FRAG_PARSED,this.onFragParsed,this),e.on(z.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.BUFFER_RESET,this.onBufferReset,this),e.off(z.BUFFER_APPENDING,this.onBufferAppending,this),e.off(z.BUFFER_CODECS,this.onBufferCodecs,this),e.off(z.BUFFER_EOS,this.onBufferEos,this),e.off(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(z.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(z.FRAG_PARSED,this.onFragParsed,this),e.off(z.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Dz(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media,i=eu(this.appendSource);if(n&&i){var r;const o=this.mediaSource=new i;this.log(`created media source: ${(r=o.constructor)==null?void 0:r.name}`),o.addEventListener("sourceopen",this._onMediaSourceOpen),o.addEventListener("sourceended",this._onMediaSourceEnded),o.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.addEventListener("startstreaming",this._onStartStreaming),o.addEventListener("endstreaming",this._onEndStreaming));const a=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{n.removeAttribute("src");const l=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||l&&o instanceof l,vb(n),Oz(n,a),n.load()}catch{n.src=a}else n.src=a;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(i){this.warn(`onMediaDetaching: ${i.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&vb(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(z.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var n;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(i){this.warn(`onBufferReset ${e}`,i)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,i=Object.keys(t);if(i.forEach(o=>{if(n){const l=this.tracks[o];if(l&&typeof l.buffer.changeType=="function"){var a;const{id:c,codec:h,levelCodec:f,container:p,metadata:y}=t[o],v=G2(l.codec,l.levelCodec),_=v==null?void 0:v.replace(yb,"$1");let S=G2(h,f);const A=(a=S)==null?void 0:a.replace(yb,"$1");if(S&&_!==A){o.slice(0,5)==="audio"&&(S=sx(S,this.appendSource));const w=`${p};codecs=${S}`;this.appendChangeType(o,w),this.log(`switching codec ${v} to ${S}`),this.tracks[o]={buffer:l.buffer,codec:h,container:p,levelCodec:f,metadata:y,id:c}}}}else this.pendingTracks[o]=t[o]}),n)return;const r=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==r&&(this.log(`${r} bufferCodec event(s) expected ${i.join(",")}`),this.bufferCodecEventsExpected=r),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,i={execute:()=>{const r=this.sourceBuffer[e];r&&(this.log(`changing ${e} sourceBuffer type to ${t}`),r.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:r=>{this.warn(`Failed to change ${e} SourceBuffer type`,r)}};n.append(i,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:i,tracks:r}=this,{data:o,type:a,frag:l,part:c,chunkMeta:h}=t,f=h.buffering[a],p=self.performance.now();f.start=p;const y=l.stats.buffering,v=c?c.stats.buffering:null;y.start===0&&(y.start=p),v&&v.start===0&&(v.start=p);const _=r.audio;let S=!1;a==="audio"&&(_==null?void 0:_.container)==="audio/mpeg"&&(S=!this.lastMpegAudioChunk||h.id===1||this.lastMpegAudioChunk.sn!==h.sn,this.lastMpegAudioChunk=h);const A=l.start,w={execute:()=>{if(f.executeStart=self.performance.now(),S){const M=this.sourceBuffer[a];if(M){const C=A-M.timestampOffset;Math.abs(C)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${A} (delta: ${C}) sn: ${l.sn})`),M.timestampOffset=A)}}this.appendExecutor(o,a)},onStart:()=>{},onComplete:()=>{const M=self.performance.now();f.executeEnd=f.end=M,y.first===0&&(y.first=M),v&&v.first===0&&(v.first=M);const{sourceBuffer:C}=this,I={};for(const O in C)I[O]=Jn.getBuffered(C[O]);this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(z.BUFFER_APPENDED,{type:a,frag:l,part:c,chunkMeta:h,parent:l.type,timeRanges:I})},onError:M=>{const C={type:Yt.MEDIA_ERROR,parent:l.type,details:Le.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:l,part:c,chunkMeta:h,error:M,err:M,fatal:!1};if(M.code===DOMException.QUOTA_EXCEEDED_ERR)C.details=Le.BUFFER_FULL_ERROR;else{const I=++this.appendErrors[a];C.details=Le.BUFFER_APPEND_ERROR,this.warn(`Failed ${I}/${n.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer`),I>=n.config.appendErrorMaxRetry&&(C.fatal=!0)}n.trigger(z.ERROR,C)}};i.append(w,a,!!this.pendingTracks[a])}onBufferFlushing(e,t){const{operationQueue:n}=this,i=r=>({execute:this.removeExecutor.bind(this,r,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(z.BUFFER_FLUSHED,{type:r})},onError:o=>{this.warn(`Failed to remove from ${r} SourceBuffer`,o)}});t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach(r=>{n.append(i(r),r)})}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],o=i?i.elementaryStreams:n.elementaryStreams;o[kn.AUDIOVIDEO]?r.push("audiovideo"):(o[kn.AUDIO]&&r.push("audio"),o[kn.VIDEO]&&r.push("video"));const a=()=>{const l=self.performance.now();n.stats.buffering.end=l,i&&(i.stats.buffering.end=l);const c=i?i.stats:n.stats;this.hls.trigger(z.FRAG_BUFFERED,{frag:n,part:i,stats:c,id:n.type})};r.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,r)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((i,r)=>{const o=this.sourceBuffer[r];return o&&(!t.type||t.type===r)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${r} sourceBuffer now EOS`))),i&&!!(!o||o.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(r=>{const o=this.sourceBuffer[r];o&&(o.ending=!1)});const{mediaSource:i}=this;if(!i||i.readyState!=="open"){i&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${i.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),i.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.getSourceBufferTypes().length)return;const r=e.config,o=n.currentTime,a=t.levelTargetDuration,l=t.live&&r.liveBackBufferLength!==null?r.liveBackBufferLength:r.backBufferLength;if(bt(l)&&l>0){const c=Math.max(l,a),h=Math.floor(o/a)*a-c;this.flushBackBuffer(o,a,h)}if(bt(r.frontBufferFlushThreshold)&&r.frontBufferFlushThreshold>0){const c=Math.max(r.maxBufferLength,r.frontBufferFlushThreshold),h=Math.max(c,a),f=Math.floor(o/a)*a+h;this.flushFrontBuffer(o,a,f)}}flushBackBuffer(e,t,n){const{details:i,sourceBuffer:r}=this;this.getSourceBufferTypes().forEach(a=>{const l=r[a];if(l){const c=Jn.getBuffered(l);if(c.length>0&&n>c.start(0)){if(this.hls.trigger(z.BACK_BUFFER_REACHED,{bufferEnd:n}),i!=null&&i.live)this.hls.trigger(z.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(l.ended&&c.end(c.length-1)-e<t*2){this.log(`Cannot flush ${a} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(z.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:a})}}})}flushFrontBuffer(e,t,n){const{sourceBuffer:i}=this;this.getSourceBufferTypes().forEach(o=>{const a=i[o];if(a){const l=Jn.getBuffered(a),c=l.length;if(c<2)return;const h=l.start(c-1),f=l.end(c-1);if(n>h||e>=h&&e<=f)return;if(a.ended&&e-f<2*t){this.log(`Cannot flush ${o} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(z.BUFFER_FLUSHING,{startOffset:h,endOffset:1/0,type:o})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:n,mediaSource:i}=this,r=e.fragments[0].start+e.totalduration,o=n.duration,a=bt(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(i.duration=1/0,this.updateSeekableRange(e)):(r>a&&r>o||!bt(o))&&(this.log(`Updating Media Source duration to ${r.toFixed(3)}`),i.duration=r)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){const r=Math.max(0,n[0].start),o=Math.max(r,r+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${r}-${o}.`),t.setLiveSeekableRange(r,o)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&(!e||i===2||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const r=this.getSourceBufferTypes();if(r.length)this.hls.trigger(z.BUFFER_CREATED,{tracks:this.tracks}),r.forEach(o=>{t.executeNext(o)});else{const o=new Error("could not create source buffer for media codec(s)");this.hls.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:o,reason:o.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const r in e)if(!t[r]){var i;const o=e[r];if(!o)throw Error(`source buffer exists for track ${r}, however track does not`);let a=((i=o.levelCodec)==null?void 0:i.indexOf(","))===-1?o.levelCodec:o.codec;a&&r.slice(0,5)==="audio"&&(a=sx(a,this.appendSource));const l=`${o.container};codecs=${a}`;this.log(`creating sourceBuffer(${l})`);try{const c=t[r]=n.addSourceBuffer(l),h=r;this.addBufferListener(h,"updatestart",this._onSBUpdateStart),this.addBufferListener(h,"updateend",this._onSBUpdateEnd),this.addBufferListener(h,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(h,"bufferedchange",(f,p)=>{const y=p.removedRanges;y!=null&&y.length&&this.hls.trigger(z.BUFFER_FLUSHED,{type:r})}),this.tracks[r]={buffer:c,codec:a,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id}}catch(c){this.error(`error while trying to add sourceBuffer: ${c.message}`),this.hls.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:c,sourceBufferName:r,mimeType:l})}}}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n==null?void 0:n.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const r=this.operationQueue.current(e);r&&r.onError(i)}removeExecutor(e,t,n){const{media:i,mediaSource:r,operationQueue:o,sourceBuffer:a}=this,l=a[e];if(!i||!r||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),o.shiftAndExecuteNext(e);return}const c=bt(i.duration)?i.duration:1/0,h=bt(r.duration)?r.duration:1/0,f=Math.max(0,t),p=Math.min(n,c,h);p>f&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${f},${p}] from the ${e} SourceBuffer`),l.remove(f,p)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(!n){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}n.ended=!1,n.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,i=t.map(r=>n.appendBlocker(r));Promise.all(i).then(()=>{e(),t.forEach(r=>{const o=this.sourceBuffer[r];o!=null&&o.updating||n.shiftAndExecuteNext(r)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const i=this.sourceBuffer[e];if(!i)return;const r=n.bind(this,e);this.listeners[e].push({event:t,listener:r}),i.addEventListener(t,r)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}}function vb(s){const e=s.querySelectorAll("source");[].slice.call(e).forEach(t=>{s.removeChild(t)})}function Oz(s,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,s.appendChild(t)}const Bz={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},UL=s=>String.fromCharCode(Bz[s]||s),ta=15,Ll=100,Fz={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},kz={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Nz={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Uz={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Gz=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Hz{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;ve.log(`${this.time} [${e}] ${n}`)}}}const oh=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class GL{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class zz{constructor(){this.uchar=" ",this.penState=new GL}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class jz{constructor(e){this.chars=[],this.pos=0,this.currPenState=new GL,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Ll;t++)this.chars.push(new zz);this.logger=e}equals(e){for(let t=0;t<Ll;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Ll;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Ll;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Ll&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Ll)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=UL(e);if(this.pos>=Ll){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Ll;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Ll;n++){const i=this.chars[n].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class fS{constructor(e){this.rows=[],this.currRow=ta-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<ta;t++)this.rows.push(new jz(e));this.logger=e}reset(){for(let e=0;e<ta;e++)this.rows[e].clear();this.currRow=ta-1}equals(e){let t=!0;for(let n=0;n<ta;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<ta;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<ta;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let a=0;a<ta;a++)this.rows[a].clear();const r=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const a=o.rows[r].cueStartTime,l=this.logger.time;if(a!==null&&l!==null&&a<l)for(let c=0;c<this.nrRollUpRows;c++)this.rows[t-this.nrRollUpRows+c+1].copy(o.rows[r+c])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const r=e.indent,o=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[o].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let r=0;r<ta;r++){const o=this.rows[r].getTextString();o&&(i=r+1,e?t.push("Row "+i+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class xb{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new fS(n),this.nonDisplayedMemory=new fS(n),this.lastOutputScreen=new fS(n),this.currRollUpRow=this.displayedMemory.rows[ta-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[ta-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class _b{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=Wz(),this.logger=void 0;const i=this.logger=new Hz;this.channels=[null,new xb(e,t,i),new xb(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const i=t[n]&127,r=t[n+1]&127;let o=!1,a=null;if(i===0&&r===0)continue;this.logger.log(3,()=>"["+oh([t[n],t[n+1]])+"] -> ("+oh([i,r])+")");const l=this.cmdHistory;if(i>=16&&i<=31){if(Vz(i,r,l)){jy(null,null,l),this.logger.log(3,()=>"Repeated command ("+oh([i,r])+") is dropped");continue}jy(i,r,this.cmdHistory),o=this.parseCmd(i,r),o||(o=this.parseMidrow(i,r)),o||(o=this.parsePAC(i,r)),o||(o=this.parseBackgroundAttributes(i,r))}else jy(null,null,l);if(!o&&(a=this.parseChars(i,r),a)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!a&&this.logger.log(2,()=>"Couldn't parse cleaned data "+oh([i,r])+" orig: "+oh([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=33&&t<=35;if(!(n||i))return!1;const r=e===20||e===21||e===23?1:2,o=this.channels[r];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=r,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return i?(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+oh([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,r=(e===16||e===24)&&t>=64&&t<=95;if(!(i||r))return!1;const o=e<=23?1:2;t>=64&&t<=95?n=o===1?Fz[e]:Nz[e]:n=o===1?kz[e]:Uz[e];const a=this.channels[o];return a?(a.setPAC(this.interpretPAC(n,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,i.underline=(n&1)===1,n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((n-16)/2)*4,i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let o;r===17?o=t+80:r===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+UL(o)+"' in channel "+n),i=[o]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+oh(i).join(",")),i}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=45&&t<=47;if(!(n||i))return!1;let r;const o={};e===16||e===24?(r=Math.floor((t-32)/2),o.background=Gz[r],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const a=e<=23?1:2;return this.channels[a].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}jy(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function jy(s,e,t){t.a=s,t.b=e}function Vz(s,e,t){return t.a===s&&t.b===e}function Wz(){return{a:null,b:null}}class Vy{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var qE=function(){if(sp!=null&&sp.VTTCue)return self.VTTCue;const s=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,l){if(typeof l!="string"||!Array.isArray(a))return!1;const c=l.toLowerCase();return~a.indexOf(c)?c:!1}function n(a){return t(s,a)}function i(a){return t(e,a)}function r(a,...l){let c=1;for(;c<arguments.length;c++){const h=arguments[c];for(const f in h)a[f]=h[f]}return a}function o(a,l,c){const h=this,f={enumerable:!0};h.hasBeenReset=!1;let p="",y=!1,v=a,_=l,S=c,A=null,w="",M=!0,C="auto",I="start",O=50,k="middle",N=50,B="middle";Object.defineProperty(h,"id",r({},f,{get:function(){return p},set:function(P){p=""+P}})),Object.defineProperty(h,"pauseOnExit",r({},f,{get:function(){return y},set:function(P){y=!!P}})),Object.defineProperty(h,"startTime",r({},f,{get:function(){return v},set:function(P){if(typeof P!="number")throw new TypeError("Start time must be set to a number.");v=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",r({},f,{get:function(){return _},set:function(P){if(typeof P!="number")throw new TypeError("End time must be set to a number.");_=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",r({},f,{get:function(){return S},set:function(P){S=""+P,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",r({},f,{get:function(){return A},set:function(P){A=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",r({},f,{get:function(){return w},set:function(P){const G=n(P);if(G===!1)throw new SyntaxError("An invalid or illegal string was specified.");w=G,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",r({},f,{get:function(){return M},set:function(P){M=!!P,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",r({},f,{get:function(){return C},set:function(P){if(typeof P!="number"&&P!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");C=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",r({},f,{get:function(){return I},set:function(P){const G=i(P);if(!G)throw new SyntaxError("An invalid or illegal string was specified.");I=G,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",r({},f,{get:function(){return O},set:function(P){if(P<0||P>100)throw new Error("Position must be between 0 and 100.");O=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",r({},f,{get:function(){return k},set:function(P){const G=i(P);if(!G)throw new SyntaxError("An invalid or illegal string was specified.");k=G,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",r({},f,{get:function(){return N},set:function(P){if(P<0||P>100)throw new Error("Size must be between 0 and 100.");N=P,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",r({},f,{get:function(){return B},set:function(P){const G=i(P);if(!G)throw new SyntaxError("An invalid or illegal string was specified.");B=G,this.hasBeenReset=!0}})),h.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class Kz{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function HL(s){function e(n,i,r,o){return(n|0)*3600+(i|0)*60+(r|0)+parseFloat(o||0)}const t=s.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class Xz{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function zL(s,e,t,n){const i=n?s.split(n):[s];for(const r in i){if(typeof i[r]!="string")continue;const o=i[r].split(t);if(o.length!==2)continue;const a=o[0],l=o[1];e(a,l)}}const fA=new qE(0,0,""),Wy=fA.align==="middle"?"middle":"center";function $z(s,e,t){const n=s;function i(){const a=HL(s);if(a===null)throw new Error("Malformed timestamp: "+n);return s=s.replace(/^[^\sa-zA-Z-]+/,""),a}function r(a,l){const c=new Xz;zL(a,function(p,y){let v;switch(p){case"region":for(let _=t.length-1;_>=0;_--)if(t[_].id===y){c.set(p,t[_].region);break}break;case"vertical":c.alt(p,y,["rl","lr"]);break;case"line":v=y.split(","),c.integer(p,v[0]),c.percent(p,v[0])&&c.set("snapToLines",!1),c.alt(p,v[0],["auto"]),v.length===2&&c.alt("lineAlign",v[1],["start",Wy,"end"]);break;case"position":v=y.split(","),c.percent(p,v[0]),v.length===2&&c.alt("positionAlign",v[1],["start",Wy,"end","line-left","line-right","auto"]);break;case"size":c.percent(p,y);break;case"align":c.alt(p,y,["start",Wy,"end","left","right"]);break}},/:/,/\s/),l.region=c.get("region",null),l.vertical=c.get("vertical","");let h=c.get("line","auto");h==="auto"&&fA.line===-1&&(h=-1),l.line=h,l.lineAlign=c.get("lineAlign","start"),l.snapToLines=c.get("snapToLines",!0),l.size=c.get("size",100),l.align=c.get("align",Wy);let f=c.get("position","auto");f==="auto"&&fA.position===50&&(f=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=f}function o(){s=s.replace(/^\s+/,"")}if(o(),e.startTime=i(),o(),s.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);s=s.slice(3),o(),e.endTime=i(),o(),r(s,e)}function jL(s){return s.replace(/<br(?: \/)?>/gi,`
`)}class Yz{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Kz,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let r=t.buffer,o=0;for(r=jL(r);o<r.length&&r[o]!=="\r"&&r[o]!==`
`;)++o;const a=r.slice(0,o);return r[o]==="\r"&&++o,r[o]===`
`&&++o,t.buffer=r.slice(o),a}function i(r){zL(r,function(o,a){},/:/)}try{let r="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;r=n();const a=r.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(a!=null&&a[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:r=n(),t.state){case"HEADER":/:/.test(r)?i(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new qE(0,0,""),t.state="CUE",r.indexOf("-->")===-1){t.cue.id=r;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{$z(r,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const a=r.indexOf("-->")!==-1;if(!r||a&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=r}continue;case"BADCUE":r||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Jz=/\r\n|\n\r|\n|\r/g,pS=function(e,t,n=0){return e.slice(n,n+t.length)===t},qz=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!bt(t)||!bt(n)||!bt(i)||!bt(r))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*i,t+=60*60*1e3*r,t},mS=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function QE(s,e,t){return mS(s.toString())+mS(e.toString())+mS(t)}const Qz=function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(o=r)!=null&&o.new;){var o;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n};function Zz(s,e,t,n,i,r,o){const a=new Yz,l=ka(new Uint8Array(s)).trim().replace(Jz,`
`).split(`
`),c=[],h=e?Sz(e.baseTime,e.timescale):0;let f="00:00.000",p=0,y=0,v,_=!0;a.oncue=function(S){const A=t[n];let w=t.ccOffset;const M=(p-h)/9e4;if(A!=null&&A.new&&(y!==void 0?w=t.ccOffset=A.start:Qz(t,n,M)),M){if(!e){v=new Error("Missing initPTS for VTT MPEGTS");return}w=M-t.presentationOffset}const C=S.endTime-S.startTime,I=xo((S.startTime+w-y)*9e4,i*9e4)/9e4;S.startTime=Math.max(I,0),S.endTime=Math.max(I+C,0);const O=S.text.trim();S.text=decodeURIComponent(encodeURIComponent(O)),S.id||(S.id=QE(S.startTime,S.endTime,O)),S.endTime>0&&c.push(S)},a.onparsingerror=function(S){v=S},a.onflush=function(){if(v){o(v);return}r(c)},l.forEach(S=>{if(_)if(pS(S,"X-TIMESTAMP-MAP=")){_=!1,S.slice(16).split(",").forEach(A=>{pS(A,"LOCAL:")?f=A.slice(6):pS(A,"MPEGTS:")&&(p=parseInt(A.slice(7)))});try{y=qz(f)/1e3}catch(A){v=A}return}else S===""&&(_=!1);a.parse(S+`
`)}),a.flush()}const gS="stpp.ttml.im1t",VL=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,WL=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,ej={left:"start",center:"center",right:"end",start:"start",end:"end"};function Sb(s,e,t,n){const i=an(new Uint8Array(s),["mdat"]);if(i.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const r=i.map(a=>ka(a)),o=_z(e.baseTime,1,e.timescale);try{r.forEach(a=>t(tj(a,o)))}catch(a){n(a)}}function tj(s,e){const i=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(r).reduce((f,p)=>(f[p]=i.getAttribute(`ttp:${p}`)||r[p],f),{}),a=i.getAttribute("xml:space")!=="preserve",l=Ab(yS(i,"styling","style")),c=Ab(yS(i,"layout","region")),h=yS(i,"body","[begin]");return[].map.call(h,f=>{const p=KL(f,a);if(!p||!f.hasAttribute("begin"))return null;const y=xS(f.getAttribute("begin"),o),v=xS(f.getAttribute("dur"),o);let _=xS(f.getAttribute("end"),o);if(y===null)throw Eb(f);if(_===null){if(v===null)throw Eb(f);_=y+v}const S=new qE(y-e,_-e,p);S.id=QE(S.startTime,S.endTime,S.text);const A=c[f.getAttribute("region")],w=l[f.getAttribute("style")],M=nj(A,w,l),{textAlign:C}=M;if(C){const I=ej[C];I&&(S.lineAlign=I),S.align=C}return Gi(S,M),S}).filter(f=>f!==null)}function yS(s,e,t){const n=s.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function Ab(s){return s.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function KL(s,e){return[].slice.call(s.childNodes).reduce((t,n,i)=>{var r;return n.nodeName==="br"&&i?t+`
`:(r=n.childNodes)!=null&&r.length?KL(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function nj(s,e,t){const n="http://www.w3.org/ns/ttml#styling";let i=null;const r=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=s!=null&&s.hasAttribute("style")?s.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(i=t[o]),r.reduce((a,l)=>{const c=vS(e,n,l)||vS(s,n,l)||vS(i,n,l);return c&&(a[l]=c),a},{})}function vS(s,e,t){return s&&s.hasAttributeNS(e,t)?s.getAttributeNS(e,t):null}function Eb(s){return new Error(`Could not parse ttml timestamp ${s}`)}function xS(s,e){if(!s)return null;let t=HL(s);return t===null&&(VL.test(s)?t=ij(s,e):WL.test(s)&&(t=rj(s,e))),t}function ij(s,e){const t=VL.exec(s),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function rj(s,e){const t=WL.exec(s),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class XL{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=wb(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(z.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(z.FRAG_LOADING,this.onFragLoading,this),e.on(z.FRAG_LOADED,this.onFragLoaded,this),e.on(z.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(z.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(z.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(z.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(z.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(z.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(z.FRAG_LOADING,this.onFragLoading,this),e.off(z.FRAG_LOADED,this.onFragLoaded,this),e.off(z.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(z.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(z.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(z.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(z.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new Vy(this,"textTrack1"),t=new Vy(this,"textTrack2"),n=new Vy(this,"textTrack3"),i=new Vy(this,"textTrack4");this.cea608Parser1=new _b(1,e,t),this.cea608Parser2=new _b(3,n,i)}}addCues(e,t,n,i,r){let o=!1;for(let a=r.length;a--;){const l=r[a],c=sj(l[0],l[1],t,n);if(c>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),o=!0,c/(n-t)>.5))return}if(o||r.push([t,n]),this.config.renderTextTracksNatively){const a=this.captionsTracks[e];this.Cues.newCue(a,t,n,i)}else{const a=this.Cues.newCue(null,t,n,i);this.hls.trigger(z.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){const{unparsedVttFrags:o}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:i,timescale:r}),o.length&&(this.unparsedVttFrags=[],o.forEach(a=>{this.onFragLoaded(z.FRAG_LOADED,a)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if(Tb(r,{name:e,lang:t,attrs:{}}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:o}=t[e],a=this.getExistingTrack(r,o);if(a)n[e]=a,Gf(n[e]),sL(n[e],i);else{const l=this.createTextTrack("captions",r,o);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(z.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Gf(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=wb(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Gf(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(r=>r.textCodec===gS);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(DL(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const o=this.media,a=o?iv(o.textTracks):null;if(this.tracks.forEach((l,c)=>{let h;if(a){let f=null;for(let p=0;p<a.length;p++)if(a[p]&&Tb(a[p],l)){f=a[p],a[p]=null;break}f&&(h=f)}if(h)Gf(h);else{const f=$L(l);h=this.createTextTrack(f,l.name,l.lang),h&&(h.mode="disabled")}h&&this.textTracks.push(h)}),a!=null&&a.length){const l=a.filter(c=>c!==null).map(c=>c.label);l.length&&ve.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(z.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const i=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!i)return;const r=`textTrack${i[1]}`,o=this.captionsProperties[r];o&&(o.label=n.name,n.lang&&(o.languageCode=n.lang),o.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Ht.MAIN){var n,i;const{cea608Parser1:r,cea608Parser2:o,lastSn:a}=this,{cc:l,sn:c}=t.frag,h=(n=(i=t.part)==null?void 0:i.index)!=null?n:-1;r&&o&&(c!==a+1||c===a&&h!==this.lastPartIndex+1||l!==this.lastCc)&&(r.reset(),o.reset()),this.lastCc=l,this.lastSn=c,this.lastPartIndex=h}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===Ht.SUBTITLE)if(i.byteLength){const r=n.decryptdata,o="stats"in t;if(r==null||!r.encrypted||o){const a=this.tracks[n.level],l=this.vttCCs;l[n.cc]||(l[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),a&&a.textCodec===gS?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(z.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Sb(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),n.trigger(z.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{ve.log(`Failed to parse IMSC1: ${i}`),n.trigger(z.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:o}=this,a=r.length-1;if(!r[n.cc]&&a===-1){o.push(e);return}const l=this.hls,c=(t=n.initSegment)!=null&&t.data?Mo(n.initSegment.data,new Uint8Array(i)):i;Zz(c,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,h=>{this._appendCues(h,n.level),l.trigger(z.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},h=>{const f=h.message==="Missing initPTS for VTT MPEGTS";f?o.push(e):this._fallbackToIMSC1(n,i),ve.log(`Failed to parse VTT cue: ${h}`),!(f&&a>n.cc)&&l.trigger(z.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:h})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Sb(t,this.initPTS[e.cc],()=>{n.textCodec=gS,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(r=>oL(i,r))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger(z.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Ht.SUBTITLE&&this.onFragLoaded(z.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!n||!i)return;const{frag:r,samples:o}=t;if(!(r.type===Ht.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let a=0;a<o.length;a++){const l=o[a].bytes;if(l){const c=this.extractCea608Data(l);n.addData(o[a].pts,c[0]),i.addData(o[a].pts,c[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:r}){const{media:o}=this;if(!(!o||o.currentTime<n)){if(!r||r==="video"){const{captionsTracks:a}=this;Object.keys(a).forEach(l=>sA(a[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){const{textTracks:a}=this;Object.keys(a).forEach(l=>sA(a[l],t,i))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let i=2;for(let r=0;r<n;r++){const o=e[i++],a=127&e[i++],l=127&e[i++];if(a===0&&l===0)continue;if((4&o)!==0){const h=3&o;(h===0||h===1)&&(t[h].push(a),t[h].push(l))}}return t}}function $L(s){return s.characteristics&&/transcribes-spoken-dialog/gi.test(s.characteristics)&&/describes-music-and-sound/gi.test(s.characteristics)?"captions":"subtitles"}function Tb(s,e){return!!s&&s.kind===$L(e)&&dA(e,s)}function sj(s,e,t,n){return Math.min(e,n)-Math.max(s,t)}function wb(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class o_{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(z.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(z.BUFFER_CODECS,this.onBufferCodecs,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(z.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(z.BUFFER_CODECS,this.onBufferCodecs,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&bt(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&ve.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((i,r)=>this.isLevelAllowed(i)&&r<=e);return this.clientRect=null,o_.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const i=(a,l)=>l?a.width!==l.width||a.height!==l.height:!0;let r=e.length-1;const o=Math.max(t,n);for(let a=0;a<e.length;a+=1){const l=e[a];if((l.width>=o||l.height>=o)&&i(l,e[a+1])){r=a;break}}return r}}class YL{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(z.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(z.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const r=i-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,l=1e3*o/r,c=this.hls;if(c.trigger(z.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),l>0&&o>c.config.fpsDroppedMonitoringThreshold*a){let h=c.currentLevel;ve.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(c.autoLevelCapping===-1||c.autoLevelCapping>=h)&&(h=h-1,c.trigger(z.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:c.currentLevel}),c.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const Ky="[eme]";class Lh{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Lh.CDMCleanupPromise?[Lh.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=ve.debug.bind(ve,Ky),this.log=ve.log.bind(ve,Ky),this.warn=ve.warn.bind(ve,Ky),this.error=ve.error.bind(ve,Ky),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(z.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(z.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(z.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(z.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(z.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(z.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===Kn.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(o,a,l)=>!!o&&l.indexOf(o)===a,i=t.map(o=>o.audioCodec).filter(n),r=t.map(o=>o.videoCodec).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise((o,a)=>{const l=c=>{const h=c.shift();this.getMediaKeysPromise(h,i,r).then(f=>o({keySystem:h,mediaKeys:f})).catch(f=>{c.length?l(c):f instanceof mo?a(f):a(new mo({type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_NO_ACCESS,error:f,fatal:!0},f.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${n}`;return KI===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=_G(e,t,n,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let o=r==null?void 0:r.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),o=this.requestMediaKeySystemAccess(e,i);const a=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),o.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const c=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),a.mediaKeys=l.createMediaKeys().then(h=>(this.log(`Media-keys created for "${e}"`),c.then(f=>f?this.setMediaKeysServerCertificate(h,e,f):h))),a.mediaKeys.catch(h=>{this.error(`Failed to create media-keys for "${e}"}: ${h}`)}),a.mediaKeys})}return o.then(()=>r.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Ma.hexDump(e.keyId||[])}`);const i=n.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Ma.hexDump(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${Ma.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const i=tS(this.config),r=e.map(P2).filter(o=>!!o&&i.indexOf(o)!==-1);return this.getKeySystemSelectionPromise(r).then(({keySystem:o})=>{const a=O2(o);a?t(a):n(new Error(`Unable to find format for key-system "${o}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let r=this.keyIdToKeySessionPromise[n];return r||(r=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:a})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(o,a).then(()=>{this.throwIfDestroyed();const l=this.createMediaKeySessionContext({keySystem:o,mediaKeys:a,decryptdata:t});return this.generateRequestWithPreferredKeySession(l,"cenc",t.pssh,"playlist-key")}))),r.catch(o=>this.handleError(o))),r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof mo?this.hls.trigger(z.ERROR,e.data):this.hls.trigger(z.ERROR,{type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const i=P2(e.keyFormat),r=i?[i]:tS(this.config);return this.attemptKeySystemAccess(r)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=tS(this.config)),e.length===0)throw new mo({type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:n}=e,i=`"${e.type}" event: init data type: "${t}"`;if(this.debug(i),n===null)return;let r,o;if(t==="sinf"&&this.config.drmSystems[Kn.FAIRPLAY]){const f=$i(new Uint8Array(n));try{const p=HE(JSON.parse(f).sinf),y=eL(new Uint8Array(p));if(!y)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");r=y.subarray(8,24),o=Kn.FAIRPLAY}catch(p){this.warn(`${i} Failed to parse sinf: ${p}`);return}}else{const f=WG(n),p=f.filter(y=>y.systemId===Um.WIDEVINE)[0];if(!p){f.length===0||f.some(y=>!y.systemId)?this.warn(`${i} contains incomplete or invalid pssh data`):this.log(`ignoring ${i} for ${f.map(y=>D2(y.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(o=D2(p.systemId),p.version===0&&p.data){const y=p.data.length-22;r=p.data.subarray(y,y+16)}}if(!o||!r)return;const a=Ma.hexDump(r),{keyIdToKeySessionPromise:l,mediaKeySessions:c}=this;let h=l[a];for(let f=0;f<c.length;f++){const p=c[f],y=p.decryptdata;if(!y.keyId)continue;const v=Ma.hexDump(y.keyId);if(a===v||y.uri.replace(/-/g,"").indexOf(a)!==-1){if(h=l[v],y.pssh)break;delete l[v],y.pssh=new Uint8Array(n),y.keyId=r,h=l[a]=h.then(()=>this.generateRequestWithPreferredKeySession(p,t,n,"encrypted-event-key-match"));break}}h||(h=l[a]=this.getKeySystemSelectionPromise([o]).then(({keySystem:f,mediaKeys:p})=>{var y;this.throwIfDestroyed();const v=new op("ISO-23001-7",a,(y=O2(f))!=null?y:"");return v.pssh=new Uint8Array(n),v.keyId=r,this.attemptSetMediaKeys(f,p).then(()=>{this.throwIfDestroyed();const _=this.createMediaKeySessionContext({decryptdata:v,keySystem:f,mediaKeys:p});return this.generateRequestWithPreferredKeySession(_,t,n,"encrypted-event-no-match")})})),h.catch(f=>this.handleError(f))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(r=>n.indexOf(r)===-1)})}generateRequestWithPreferredKeySession(e,t,n,i){var r,o;const a=(r=this.config.drmSystems)==null||(o=r[e.keySystem])==null?void 0:o.generateRequest;if(a)try{const v=a.call(this.hls,t,n,e);if(!v)throw new Error("Invalid response from configured generateRequest filter");t=v.initDataType,n=e.decryptdata.pssh=v.initData?new Uint8Array(v.initData):null}catch(v){var l;if(this.warn(v.message),(l=this.hls)!=null&&l.config.debug)throw v}if(n===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const c=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${c} (init data type: ${t} length: ${n?n.byteLength:null})`);const h=new JE,f=e._onmessage=v=>{const _=e.mediaKeysSession;if(!_){h.emit("error",new Error("invalid state"));return}const{messageType:S,message:A}=v;this.log(`"${S}" message event for session "${_.sessionId}" message size: ${A.byteLength}`),S==="license-request"||S==="license-renewal"?this.renewLicense(e,A).catch(w=>{this.handleError(w),h.emit("error",w)}):S==="license-release"?e.keySystem===Kn.FAIRPLAY&&(this.updateKeySession(e,iA("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${S}"`)},p=e._onkeystatuseschange=v=>{if(!e.mediaKeysSession){h.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const S=e.keyStatus;h.emit("keyStatus",S),S==="expired"&&(this.warn(`${e.keySystem} expired for key ${c}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",f),e.mediaKeysSession.addEventListener("keystatuseschange",p);const y=new Promise((v,_)=>{h.on("error",_),h.on("keyStatus",S=>{S.startsWith("usable")?v():S==="output-restricted"?_(new mo({type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):S==="internal-error"?_(new mo({type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${S}"`)):S==="expired"?_(new Error("key expired while generating request")):this.warn(`unhandled key status change "${S}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var v;this.log(`Request generated for key-session "${(v=e.mediaKeysSession)==null?void 0:v.sessionId}" keyId: ${c}`)}).catch(v=>{throw new mo({type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_NO_SESSION,error:v,fatal:!1},`Error generating key-session request: ${v}`)}).then(()=>y).catch(v=>{throw h.removeAllListeners(),this.removeSession(e),v}).then(()=>(h.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Ma.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${Ma.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),r=this.getServerCertificateUrl(e);return r?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,a)=>{const l={responseType:"arraybuffer",url:r},c=t.certLoadPolicy.default,h={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(p,y,v,_)=>{o(p.data)},onError:(p,y,v,_)=>{a(new mo({type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:v,response:fr({url:l.url,data:void 0},p)},`"${e}" certificate request failed (${r}). Status: ${p.code} (${p.text})`))},onTimeout:(p,y,v)=>{a(new mo({type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:v,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${r})`))},onAbort:(p,y,v)=>{a(new Error("aborted"))}};i.load(l,h,f)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,r)=>{e.setServerCertificate(n).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),i(e)}).catch(o=>{r(new mo({type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(i=>{throw new mo({type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:i,fatal:!0},i.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=new DOMParser().parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let h;for(let f=0,p=r.length;f<p;f++){var o,a;h=r[f];const y=(o=h.querySelector("name"))==null?void 0:o.textContent,v=(a=h.querySelector("value"))==null?void 0:a.textContent;y&&v&&e.setRequestHeader(y,v)}}const l=i.querySelector("Challenge"),c=l==null?void 0:l.textContent;if(!c)throw new Error("Cannot find <Challenge> in key message");return iA(atob(c))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)}).catch(o=>{if(!n.decryptdata)throw o;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,r)=>{const o=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${o}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(a.readyState===4)if(a.status===200){this._requestLicenseFailureCount=0;let l=a.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const c=this.config.licenseResponseCallback;if(c)try{l=c.call(this.hls,a,o,e)}catch(h){this.error(h)}i(l)}else{const l=n.errorRetry,c=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||a.status>=400&&a.status<500)r(new mo({type:Yt.KEY_SYSTEM_ERROR,details:Le.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const h=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${h} attempts left`),this.requestLicense(e,t).then(i,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then(({xhr:l,licenseChallenge:c})=>{e.keySystem==Kn.PLAYREADY&&(c=this.unpackPlayReadyKeyMessage(l,c)),l.send(c)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},op.clearKeyUriToKeyIdMap();const n=t.length;Lh.CDMCleanupPromise=Promise.all(t.map(i=>this.removeSession(i)).concat(e==null?void 0:e.setMediaKeys(null).catch(i=>{this.log(`Could not clear media keys: ${i}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(i=>{this.log(`Could not close sessions and clear media keys: ${i}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((i,r)=>(i.indexOf(r.keyFormat)===-1&&i.push(r.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch(r=>{this.log(`Could not remove session: ${r}`)}).then(()=>t.close()).catch(r=>{this.log(`Could not close session: ${r}`)})}}}Lh.CDMCleanupPromise=void 0;class mo extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var Fr;(function(s){s.MANIFEST="m",s.AUDIO="a",s.VIDEO="v",s.MUXED="av",s.INIT="i",s.CAPTION="c",s.TIMED_TEXT="tt",s.KEY="k",s.OTHER="o"})(Fr||(Fr={}));var pA;(function(s){s.DASH="d",s.HLS="h",s.SMOOTH="s",s.OTHER="o"})(pA||(pA={}));var Eh;(function(s){s.OBJECT="CMCD-Object",s.REQUEST="CMCD-Request",s.SESSION="CMCD-Session",s.STATUS="CMCD-Status"})(Eh||(Eh={}));const oj={[Eh.OBJECT]:["br","d","ot","tb"],[Eh.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Eh.SESSION]:["cid","pr","sf","sid","st","v"],[Eh.STATUS]:["bs","rtp"]};class lp{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(n=>n instanceof lp?n:new lp(n))),this.value=e,this.params=t}}class JL{constructor(e){this.description=void 0,this.description=e}}const aj="Dict";function lj(s){return Array.isArray(s)?JSON.stringify(s):s instanceof Map?"Map{}":s instanceof Set?"Set{}":typeof s=="object"?JSON.stringify(s):String(s)}function cj(s,e,t,n){return new Error(`failed to ${s} "${lj(e)}" as ${t}`,{cause:n})}const Mb="Bare Item",uj="Boolean",hj="Byte Sequence",dj="Decimal",fj="Integer";function pj(s){return s<-999999999999999||999999999999999<s}const mj=/[\x00-\x1f\x7f]+/,gj="Token",yj="Key";function Ha(s,e,t){return cj("serialize",s,e,t)}function vj(s){if(typeof s!="boolean")throw Ha(s,uj);return s?"?1":"?0"}function xj(s){return btoa(String.fromCharCode(...s))}function _j(s){if(ArrayBuffer.isView(s)===!1)throw Ha(s,hj);return`:${xj(s)}:`}function qL(s){if(pj(s))throw Ha(s,fj);return s.toString()}function Sj(s){return`@${qL(s.getTime()/1e3)}`}function QL(s,e){if(s<0)return-QL(-s,e);const t=Math.pow(10,e);if(Math.abs(s*t%1-.5)<Number.EPSILON){const i=Math.floor(s*t);return(i%2===0?i:i+1)/t}else return Math.round(s*t)/t}function Aj(s){const e=QL(s,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Ha(s,dj);const t=e.toString();return t.includes(".")?t:`${t}.0`}const Ej="String";function Tj(s){if(mj.test(s))throw Ha(s,Ej);return`"${s.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function wj(s){return s.description||s.toString().slice(7,-1)}function bb(s){const e=wj(s);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Ha(e,gj);return e}function mA(s){switch(typeof s){case"number":if(!bt(s))throw Ha(s,Mb);return Number.isInteger(s)?qL(s):Aj(s);case"string":return Tj(s);case"symbol":return bb(s);case"boolean":return vj(s);case"object":if(s instanceof Date)return Sj(s);if(s instanceof Uint8Array)return _j(s);if(s instanceof JL)return bb(s);default:throw Ha(s,Mb)}}function gA(s){if(/^[a-z*][a-z0-9\-_.*]*$/.test(s)===!1)throw Ha(s,yj);return s}function ZE(s){return s==null?"":Object.entries(s).map(([e,t])=>t===!0?`;${gA(e)}`:`;${gA(e)}=${mA(t)}`).join("")}function ZL(s){return s instanceof lp?`${mA(s.value)}${ZE(s.params)}`:mA(s)}function Mj(s){return`(${s.value.map(ZL).join(" ")})${ZE(s.params)}`}function bj(s,e={whitespace:!0}){if(typeof s!="object")throw Ha(s,aj);const t=s instanceof Map?s.entries():Object.entries(s),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([i,r])=>{r instanceof lp||(r=new lp(r));let o=gA(i);return r.value===!0?o+=ZE(r.params):(o+="=",Array.isArray(r.value)?o+=Mj(r):o+=ZL(r)),o}).join(`,${n}`)}function Cj(s,e){return bj(s,e)}const Rj=s=>s==="ot"||s==="sf"||s==="st",Ij=s=>typeof s=="number"?bt(s):s!=null&&s!==""&&s!==!1;function Lj(s,e){const t=new URL(s),n=new URL(e);if(t.origin!==n.origin)return s;const i=t.pathname.split("/").slice(1),r=n.pathname.split("/").slice(1,-1);for(;i[0]===r[0];)i.shift(),r.shift();for(;r.length;)r.shift(),i.unshift("..");return i.join("/")}function Pj(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(i=="x"?r:r&3|8).toString(16)})}}}const lv=s=>Math.round(s),Dj=(s,e)=>(e!=null&&e.baseUrl&&(s=Lj(s,e.baseUrl)),encodeURIComponent(s)),Xy=s=>lv(s/100)*100,Oj={br:lv,d:lv,bl:Xy,dl:Xy,mtp:Xy,nor:Dj,rtp:Xy,tb:lv};function Bj(s,e){const t={};if(s==null||typeof s!="object")return t;const n=Object.keys(s).sort(),i=Gi({},Oj,e==null?void 0:e.formatters),r=e==null?void 0:e.filter;return n.forEach(o=>{if(r!=null&&r(o))return;let a=s[o];const l=i[o];l&&(a=l(a,e)),!(o==="v"&&a===1)&&(o=="pr"&&a===1||Ij(a)&&(Rj(o)&&typeof a=="string"&&(a=new JL(a)),t[o]=a))}),t}function e3(s,e={}){return s?Cj(Bj(s,e),Gi({whitespace:!1},e)):""}function Fj(s,e={}){if(!s)return{};const t=Object.entries(s),n=Object.entries(oj).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),i=t.reduce((r,o)=>{var a,l;const[c,h]=o,f=((a=n.find(p=>p[1].includes(c)))==null?void 0:a[0])||Eh.REQUEST;return(l=r[f])!=null||(r[f]={}),r[f][c]=h,r},{});return Object.entries(i).reduce((r,[o,a])=>(r[o]=e3(a,e),r),{})}function kj(s,e,t){return Gi(s,Fj(e,t))}const Nj="CMCD";function Uj(s,e={}){if(!s)return"";const t=e3(s,e);return`${Nj}=${encodeURIComponent(t)}`}const Cb=/CMCD=[^&#]+/;function Gj(s,e,t){const n=Uj(e,t);if(!n)return s;if(Cb.test(s))return s.replace(Cb,n);const i=s.includes("?")?"&":"?";return`${s}${i}${n}`}class t3{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:Fr.MANIFEST,su:!this.initialized})}catch(r){ve.warn("Could not generate manifest CMCD data.",r)}},this.applyFragmentData=i=>{try{const r=i.frag,o=this.hls.levels[r.level],a=this.getObjectType(r),l={d:r.duration*1e3,ot:a};(a===Fr.VIDEO||a===Fr.AUDIO||a==Fr.MUXED)&&(l.br=o.bitrate/1e3,l.tb=this.getTopBandwidth(a)/1e3,l.bl=this.getBufferLength(a)),this.apply(i,l)}catch(r){ve.warn("Could not generate segment CMCD data.",r)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||Pj(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(z.MEDIA_DETACHED,this.onMediaDetached,this),e.on(z.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(z.MEDIA_DETACHED,this.onMediaDetached,this),e.off(z.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:1,sf:pA.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Gi(t,this.createData());const n=t.ot===Fr.INIT||t.ot===Fr.VIDEO||t.ot===Fr.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((r,o)=>(i.includes(o)&&(r[o]=t[o]),r),{})),this.useHeaders?(e.headers||(e.headers={}),kj(e.headers,t)):e.url=Gj(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Fr.TIMED_TEXT;if(e.sn==="initSegment")return Fr.INIT;if(t==="audio")return Fr.AUDIO;if(t==="main")return this.hls.audioTracks.length?Fr.VIDEO:Fr.MUXED}getTopBandwidth(e){let t=0,n;const i=this.hls;if(e===Fr.AUDIO)n=i.audioTracks;else{const r=i.maxAutoLevel,o=r>-1?r+1:i.levels.length;n=i.levels.slice(0,o)}for(const r of n)r.bitrate>t&&(t=r.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,n=e===Fr.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Jn.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new n(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,o,a){t(r),this.loader.load(r,o,a)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new n(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,o,a){t(r),this.loader.load(r,o,a)}}}}const Hj=3e5;class n3{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=ve.log.bind(ve,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===Yi.SendAlternateToPenaltyBox&&n.flags===go.MoveAllAlternatesMatchingHost){const i=this.levels;let r=this.pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:a,pathwayId:l,type:c}=t.context;a&&i?o=this.getPathwayForGroupId(a,c,o):l&&(o=l)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!r&&i&&(r=i.reduce((a,l)=>(a.indexOf(l.pathwayId)===-1&&a.push(l.pathwayId),a),[])),r&&r.length>1&&(this.updatePathwayPriority(r),n.resolved=this.pathwayId!==o),n.resolved||ve.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${i&&i.length} priorities: ${JSON.stringify(r)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(r=>{i-n[r]>Hj&&delete n[r]});for(let r=0;r<e.length;r++){const o=e[r];if(o in n)continue;if(o===this.pathwayId)return;const a=this.hls.nextLoadLevel,l=this.hls.levels[a];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,uL(t),this.hls.trigger(z.LEVELS_UPDATED,{levels:t});const c=this.hls.levels[a];l&&c&&this.levels&&(c.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&c.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${c.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let r=0;r<i.length;r++)if(t===Tn.AUDIO_TRACK&&i[r].hasAudioGroup(e)||t===Tn.SUBTITLE_TRACK&&i[r].hasSubtitleGroup(e))return i[r].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(r=>{const{ID:o,"BASE-ID":a,"URI-REPLACEMENT":l}=r;if(t.some(h=>h.pathwayId===o))return;const c=this.getLevelsForPathway(a).map(h=>{const f=new ri(h.attrs);f["PATHWAY-ID"]=o;const p=f.AUDIO&&`${f.AUDIO}_clone_${o}`,y=f.SUBTITLES&&`${f.SUBTITLES}_clone_${o}`;p&&(n[f.AUDIO]=p,f.AUDIO=p),y&&(i[f.SUBTITLES]=y,f.SUBTITLES=y);const v=i3(h.uri,f["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),_=new Wh({attrs:f,audioCodec:h.audioCodec,bitrate:h.bitrate,height:h.height,name:h.name,url:v,videoCodec:h.videoCodec,width:h.width});if(h.audioGroups)for(let S=1;S<h.audioGroups.length;S++)_.addGroupId("audio",`${h.audioGroups[S]}_clone_${o}`);if(h.subtitleGroups)for(let S=1;S<h.subtitleGroups.length;S++)_.addGroupId("text",`${h.subtitleGroups[S]}_clone_${o}`);return _});t.push(...c),Rb(this.audioTracks,n,l,o),Rb(this.subtitleTracks,i,l,o)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let i;try{i=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){const h=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+h)}const r={responseType:"json",url:i.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},c={onSuccess:(h,f,p,y)=>{this.log(`Loaded steering manifest: "${i}"`);const v=h.data;if(v.VERSION!==1){this.log(`Steering VERSION ${v.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=v.TTL;const{"RELOAD-URI":_,"PATHWAY-CLONES":S,"PATHWAY-PRIORITY":A}=v;if(_)try{this.uri=new self.URL(_,i).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${_}`);return}this.scheduleRefresh(this.uri||p.url),S&&this.clonePathways(S);const w={steeringManifest:v,url:i.toString()};this.hls.trigger(z.STEERING_MANIFEST_LOADED,w),A&&this.updatePathwayPriority(A)},onError:(h,f,p,y)=>{if(this.log(`Error loading steering manifest: ${h.code} ${h.text} (${f.url})`),this.stopLoad(),h.code===410){this.enabled=!1,this.log(`Steering manifest ${f.url} no longer available`);return}let v=this.timeToLoad*1e3;if(h.code===429){const _=this.loader;if(typeof(_==null?void 0:_.getResponseHeader)=="function"){const S=_.getResponseHeader("Retry-After");S&&(v=parseFloat(S)*1e3)}this.log(`Steering manifest ${f.url} rate limited`);return}this.scheduleRefresh(this.uri||f.url,v)},onTimeout:(h,f,p)=>{this.log(`Timeout loading steering manifest (${f.url})`),this.scheduleRefresh(this.uri||f.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(r,l,c)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const i=(n=this.hls)==null?void 0:n.media;if(i&&!i.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function Rb(s,e,t,n){s&&Object.keys(e).forEach(i=>{const r=s.filter(o=>o.groupId===i).map(o=>{const a=Gi({},o);return a.details=void 0,a.attrs=new ri(a.attrs),a.url=a.attrs.URI=i3(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),a.groupId=a.attrs["GROUP-ID"]=e[i],a.attrs["PATHWAY-ID"]=n,a});s.push(...r)})}function i3(s,e,t,n){const{HOST:i,PARAMS:r,[t]:o}=n;let a;e&&(a=o==null?void 0:o[e],a&&(s=a));const l=new self.URL(s);return i&&!a&&(l.host=i),r&&Object.keys(r).sort().forEach(c=>{c&&l.searchParams.set(c,r[c])}),l.href}const zj=/^age:\s*[\d.]+\s*$/im;class r3{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new j0,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return r(n,t.url)}).catch(o=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),r(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(o=>{this.callbacks.onError({code:n.status,text:o.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:o}=n.loadPolicy;if(i)for(const a in i)e.setRequestHeader(a,i[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&bt(r)?r:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const o=t.status,a=t.responseType!=="text";if(o>=200&&o<300&&(a&&t.response||t.responseText!==null)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const l=a?t.response:t.responseText,c=t.responseType==="arraybuffer"?l.byteLength:l.length;if(n.loaded=n.total=c,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;const h=this.callbacks.onProgress;if(h&&h(n,e,l,t),!this.callbacks)return;const f={url:t.responseURL,data:l,code:o};this.callbacks.onSuccess(f,n,e,t)}else{const l=r.loadPolicy.errorRetry,c=n.retry,h={url:e.url,data:void 0,code:o};lx(l,c,!1,h)?this.retry(l):(ve.error(`${o} while loading ${e.url}`),this.callbacks.onError({code:o,text:t.statusText},e,t,n))}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(lx(e,t,!0))this.retry(e);else{var n;ve.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=VE(e,n.retry),n.retry++,ve.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&zj.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function jj(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const Vj=/(\d+)-(\d+)\/(\d+)/;class Ib{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||$j,this.controller=new self.AbortController,this.stats=new j0}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const r=Wj(e,this.controller.signal),o=n.onProgress,a=e.responseType==="arraybuffer",l=a?"byteLength":"length",{maxTimeToFirstByteMs:c,maxLoadTimeMs:h}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=c&&bt(c)?c:h,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},t.timeout),self.fetch(this.request).then(f=>{this.response=this.loader=f;const p=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=h,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},h-(p-i.loading.start)),!f.ok){const{status:y,statusText:v}=f;throw new Yj(v||"fetch, bad network response",y,f)}return i.loading.first=p,i.total=Xj(f.headers)||i.total,o&&bt(t.highWaterMark)?this.loadProgressively(f,i,e,t.highWaterMark,o):a?f.arrayBuffer():e.responseType==="json"?f.json():f.text()}).then(f=>{const p=this.response;if(!p)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const y=f[l];y&&(i.loaded=i.total=y);const v={url:p.url,data:f,code:p.status};o&&!bt(t.highWaterMark)&&o(i,e,f,p),n.onSuccess(v,i,e,p)}).catch(f=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const p=f&&f.code||0,y=f?f.message:null;n.onError({code:p,text:y},e,f?f.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,r){const o=new gL,a=e.body.getReader(),l=()=>a.read().then(c=>{if(c.done)return o.dataLength&&r(t,n,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const h=c.value,f=h.length;return t.loaded+=f,f<i||o.dataLength?(o.push(h),o.dataLength>=i&&r(t,n,o.flush(),e)):r(t,n,h,e),l()}).catch(()=>Promise.reject());return l()}}function Wj(s,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Gi({},s.headers))};return s.rangeEnd&&t.headers.set("Range","bytes="+s.rangeStart+"-"+String(s.rangeEnd-1)),t}function Kj(s){const e=Vj.exec(s);if(e)return parseInt(e[2])-parseInt(e[1])+1}function Xj(s){const e=s.get("Content-Range");if(e){const n=Kj(e);if(bt(n))return n}const t=s.get("Content-Length");if(t)return parseInt(t)}function $j(s,e){return new self.Request(s.url,e)}class Yj extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const Jj=/\s/,qj={newCue(s,e,t,n){const i=[];let r,o,a,l,c;const h=self.VTTCue||self.TextTrackCue;for(let p=0;p<n.rows.length;p++)if(r=n.rows[p],a=!0,l=0,c="",!r.isEmpty()){var f;for(let _=0;_<r.chars.length;_++)Jj.test(r.chars[_].uchar)&&a?l++:(c+=r.chars[_].uchar,a=!1);r.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const y=jL(c.trim()),v=QE(e,t,y);s!=null&&(f=s.cues)!=null&&f.getCueById(v)||(o=new h(e,t,y),o.id=v,o.line=p+1,o.align="left",o.position=10+Math.min(80,Math.floor(l*8/32)*10),i.push(o))}return s&&i.length&&(i.sort((p,y)=>p.line==="auto"||y.line==="auto"?0:p.line>8&&y.line>8?y.line-p.line:p.line-y.line),i.forEach(p=>oL(s,p))),i}},Qj={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},s3=fr(fr({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:r3,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:pL,bufferController:NL,capLevelController:o_,errorController:dL,fpsController:YL,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:KI,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:Qj},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},Zj()),{},{subtitleStreamController:FL,subtitleTrackController:kL,timelineController:XL,audioStreamController:OL,audioTrackController:BL,emeController:Lh,cmcdController:t3,contentSteeringController:n3});function Zj(){return{cueHandler:qj,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function e7(s,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=yA(s),n=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(r=>{const o=`${r==="level"?"playlist":r}LoadPolicy`,a=e[o]===void 0,l=[];i.forEach(c=>{const h=`${r}Loading${c}`,f=e[h];if(f!==void 0&&a){l.push(h);const p=t[o].default;switch(e[o]={default:p},c){case"TimeOut":p.maxLoadTimeMs=f,p.maxTimeToFirstByteMs=f;break;case"MaxRetry":p.errorRetry.maxNumRetry=f,p.timeoutRetry.maxNumRetry=f;break;case"RetryDelay":p.errorRetry.retryDelayMs=f,p.timeoutRetry.retryDelayMs=f;break;case"MaxRetryTimeout":p.errorRetry.maxRetryDelayMs=f,p.timeoutRetry.maxRetryDelayMs=f;break}}}),l.length&&ve.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${o}": ${JSON.stringify(e[o])}`)}),fr(fr({},t),e)}function yA(s){return s&&typeof s=="object"?Array.isArray(s)?s.map(yA):Object.keys(s).reduce((e,t)=>(e[t]=yA(s[t]),e),{}):s}function t7(s){const e=s.loader;e!==Ib&&e!==r3?(ve.log("[config]: Custom loader detected, cannot enable progressive streaming"),s.progressive=!1):jj()&&(s.loader=Ib,s.progressive=!0,s.enableSoftwareAES=!0,ve.log("[config]: Progressive streaming enabled, using FetchLoader"))}let _S;class n7 extends i_{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(z.LEVEL_LOADED,this.onLevelLoaded,this),e.on(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(z.FRAG_BUFFERED,this.onFragBuffered,this),e.on(z.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(z.LEVEL_LOADED,this.onLevelLoaded,this),e.off(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(z.FRAG_BUFFERED,this.onFragBuffered,this),e.off(z.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],r={},o={};let a=!1,l=!1,c=!1;t.levels.forEach(h=>{var f,p;const y=h.attrs;let{audioCodec:v,videoCodec:_}=h;((f=v)==null?void 0:f.indexOf("mp4a.40.34"))!==-1&&(_S||(_S=/chrome|firefox/i.test(navigator.userAgent)),_S&&(h.audioCodec=v=void 0)),v&&(h.audioCodec=v=sx(v,n)),((p=_)==null?void 0:p.indexOf("avc1"))===0&&(_=h.videoCodec=ZG(_));const{width:S,height:A,unknownCodecs:w}=h;if(a||(a=!!(S&&A)),l||(l=!!_),c||(c=!!v),w!=null&&w.length||v&&!sS(v,"audio",n)||_&&!sS(_,"video",n))return;const{CODECS:M,"FRAME-RATE":C,"HDCP-LEVEL":I,"PATHWAY-ID":O,RESOLUTION:k,"VIDEO-RANGE":N}=y,P=`${`${O||"."}-`}${h.bitrate}-${k}-${C}-${M}-${N}-${I}`;if(r[P])if(r[P].uri!==h.url&&!h.attrs["PATHWAY-ID"]){const G=o[P]+=1;h.attrs["PATHWAY-ID"]=new Array(G+1).join(".");const Z=new Wh(h);r[P]=Z,i.push(Z)}else r[P].addGroupId("audio",y.AUDIO),r[P].addGroupId("text",y.SUBTITLES);else{const G=new Wh(h);r[P]=G,o[P]=1,i.push(G)}}),this.filterAndSortMediaOptions(i,t,a,l,c)}filterAndSortMediaOptions(e,t,n,i,r){let o=[],a=[],l=e;if((n||i)&&r&&(l=l.filter(({videoCodec:v,videoRange:_,width:S,height:A})=>(!!v||!!(S&&A))&&dH(_))),l.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const v=new Error("no level with compatible codecs found in manifest");this.hls.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:v,reason:v.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:v}=this.hls.config;o=t.audioTracks.filter(_=>!_.audioCodec||sS(_.audioCodec,"audio",v)),Lb(o)}t.subtitles&&(a=t.subtitles,Lb(a));const c=l.slice(0);l.sort((v,_)=>{if(v.attrs["HDCP-LEVEL"]!==_.attrs["HDCP-LEVEL"])return(v.attrs["HDCP-LEVEL"]||"")>(_.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&v.height!==_.height)return v.height-_.height;if(v.frameRate!==_.frameRate)return v.frameRate-_.frameRate;if(v.videoRange!==_.videoRange)return ox.indexOf(v.videoRange)-ox.indexOf(_.videoRange);if(v.videoCodec!==_.videoCodec){const S=U2(v.videoCodec),A=U2(_.videoCodec);if(S!==A)return A-S}if(v.uri===_.uri&&v.codecSet!==_.codecSet){const S=rx(v.codecSet),A=rx(_.codecSet);if(S!==A)return A-S}return v.averageBitrate!==_.averageBitrate?v.averageBitrate-_.averageBitrate:0});let h=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==c.length)){for(let v=0;v<c.length;v++)if(c[v].pathwayId===l[0].pathwayId){h=c[v];break}}this._levels=l;for(let v=0;v<l.length;v++)if(l[v]===h){var f;this._firstLevel=v;const _=h.bitrate,S=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${_}`),((f=this.hls.userConfig)==null?void 0:f.abrEwmaDefaultEstimate)===void 0){const A=Math.min(_,this.hls.config.abrEwmaDefaultEstimateMax);A>S&&S===s3.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=A)}break}const p=r&&!i,y={levels:l,audioTracks:o,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:i,altAudio:!p&&o.some(v=>!!v.url)};this.hls.trigger(z.MANIFEST_PARSED,y),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const h=new Error("invalid level idx"),f=e<0;if(this.hls.trigger(z.ERROR,{type:Yt.OTHER_ERROR,details:Le.LEVEL_SWITCH_ERROR,level:e,fatal:f,error:h,reason:h.message}),f)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&o.details&&i&&r===a)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${n}${r?" with Pathway "+r:""}`);const l={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(z.LEVEL_SWITCHING,l);const c=o.details;if(!c||c.live){const h=this.switchParams(o.uri,i==null?void 0:i.details,c);this.loadPlaylist(h)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===Tn.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Ht.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(r=>!!n[r]))return;const i=this._levels[t.level];i!=null&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,o=this._levels[i];if(!o){var a;this.warn(`Invalid level index ${i}`),(a=t.deliveryDirectives)!=null&&a.skip&&(r.deltaUpdateFailed=!0);return}i===this.currentLevelIndex?(o.fragmentError===0&&(o.loadError=0),this.playlistLoaded(i,t,o.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let i=n.uri;if(e)try{i=e.addDirectives(i)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}const r=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${r?" Pathway "+r:""} ${i}`),this.clearTimer(),this.hls.trigger(z.LEVEL_LOADING,{url:i,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter((i,r)=>r!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(o=>o.level=-1)),!1));uL(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(z.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(z.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function Lb(s){const e={};s.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}class i7{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var t;if(e&&e!==((t=i.context)==null?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Le.KEY_LOAD_ERROR,n,i,r){return new Dl({type:Yt.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let r=0;r<t.length;r++){const o=t[r];if(i<=o.cc&&(n==="initSegment"||o.sn==="initSegment"||n<o.sn)){this.emeController.selectKeySystemFormat(o).then(a=>{o.setKeyFormat(a)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const c=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Le.KEY_LOAD_ERROR,c))}const o=r.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,Le.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let a=this.keyUriToKeyInfo[o];if((n=a)!=null&&n.decryptdata.key)return r.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});if((i=a)!=null&&i.keyLoadPromise){var l;switch((l=a.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then(c=>(r.key=c.keyInfo.decryptdata.key,{frag:e,keyInfo:a}))}}switch(a=this.keyUriToKeyInfo[o]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return r.keyFormat==="identity"?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,Le.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const i=this.emeController.loadKey(n);if(i)return(e.keyLoadPromise=i.then(r=>(e.mediaKeySessionContext=r,n))).catch(r=>{throw e.keyLoadPromise=null,r})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,r=new i(n);return t.keyLoader=e.loader=r,e.keyLoadPromise=new Promise((o,a)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},c=n.keyLoadPolicy.default,h={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:(p,y,v,_)=>{const{frag:S,keyInfo:A,url:w}=v;if(!S.decryptdata||A!==this.keyUriToKeyInfo[w])return a(this.createKeyLoadError(S,Le.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),_));A.decryptdata.key=S.decryptdata.key=new Uint8Array(p.data),S.keyLoader=null,A.loader=null,o({frag:S,keyInfo:A})},onError:(p,y,v,_)=>{this.resetLoader(y),a(this.createKeyLoadError(t,Le.KEY_LOAD_ERROR,new Error(`HTTP Error ${p.code} loading key ${p.text}`),v,fr({url:l.url,data:void 0},p)))},onTimeout:(p,y,v)=>{this.resetLoader(y),a(this.createKeyLoadError(t,Le.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),v))},onAbort:(p,y,v)=>{this.resetLoader(y),a(this.createKeyLoadError(t,Le.INTERNAL_ABORTED,new Error("key loading aborted"),v))}};r.load(l,h,f)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],r&&r.destroy()}}function o3(){return self.SourceBuffer||self.WebKitSourceBuffer}function eT(){if(!eu())return!1;const e=o3();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function a3(){if(!eT())return!1;const s=eu();return typeof(s==null?void 0:s.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>s.isTypeSupported(g0(e,"video")))||["mp4a.40.2","fLaC"].some(e=>s.isTypeSupported(g0(e,"audio"))))}function r7(){var s;const e=o3();return typeof(e==null||(s=e.prototype)==null?void 0:s.changeType)=="function"}const s7=250,cv=2,o7=.1,a7=.05;class l7{constructor(e,t,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:i,stalled:r}=this;if(i===null)return;const{currentTime:o,seeking:a}=i,l=this.seeking&&!a,c=!this.seeking&&a;if(this.seeking=a,o!==e){if(this.moved=!0,a||(this.nudgeRetry=0),r!==null){if(this.stallReported){const S=self.performance.now()-r;ve.warn(`playback not stuck anymore @${o}, after ${Math.round(S)}ms`),this.stallReported=!1}this.stalled=null}return}if(c||l){this.stalled=null;return}if(i.paused&&!a||i.ended||i.playbackRate===0||!Jn.getBuffered(i).length){this.nudgeRetry=0;return}const h=Jn.bufferInfo(i,o,0),f=h.nextStart||0;if(a){const S=h.len>cv,A=!f||t&&t.start<=o||f-o>cv&&!this.fragmentTracker.getPartialFragment(o);if(S||A)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var p;if(!(h.len>0)&&!f)return;const A=Math.max(f,h.start||0)-o,w=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,C=(w==null||(p=w.details)==null?void 0:p.live)?w.details.targetduration*2:cv,I=this.fragmentTracker.getPartialFragment(o);if(A>0&&(A<=C||I)){i.paused||this._trySkipBufferHole(I);return}}const y=self.performance.now();if(r===null){this.stalled=y;return}const v=y-r;if(!a&&v>=s7&&(this._reportStall(h),!this.media))return;const _=Jn.bufferInfo(i,o,n.maxBufferHole);this._tryFixBufferStall(_,v)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:i,media:r}=this;if(r===null)return;const o=r.currentTime,a=i.getPartialFragment(o);a&&(this._trySkipBufferHole(a)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-o<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(ve.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;const r=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);ve.warn(r.message),t.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.BUFFER_STALLED_ERROR,fatal:!1,error:r,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:i}=this;if(i===null)return 0;const r=i.currentTime,o=Jn.bufferInfo(i,r,0),a=r<o.start?o.start:o.nextStart;if(a){const l=o.len<=t.maxBufferHole,c=o.len>0&&o.len<1&&i.readyState<3,h=a-r;if(h>0&&(l||c)){if(h>t.maxBufferHole){const{fragmentTracker:p}=this;let y=!1;if(r===0){const v=p.getAppendedFrag(0,Ht.MAIN);v&&a<v.end&&(y=!0)}if(!y){const v=e||p.getAppendedFrag(r,Ht.MAIN);if(v){let _=!1,S=v.end;for(;S<a;){const A=p.getPartialFragment(S);if(A)S+=A.duration;else{_=!0;break}}if(_)return 0}}}const f=Math.max(a+a7,r+o7);if(ve.warn(`skipping hole, adjusting currentTime from ${r} to ${f}`),this.moved=!0,this.stalled=null,i.currentTime=f,e&&!e.gap){const p=new Error(`fragment loaded with buffer holes, seeking from ${r} to ${f}`);n.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,frag:e})}return f}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:i}=this;if(n===null)return;const r=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const o=r+(i+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${r} to ${o}`);ve.warn(a.message),n.currentTime=o,t.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const o=new Error(`Playhead still not moving while enough data buffered @${r} after ${e.nudgeMaxRetry} nudges`);ve.error(o.message),t.trigger(z.ERROR,{type:Yt.MEDIA_ERROR,details:Le.BUFFER_STALLED_ERROR,error:o,fatal:!0})}}}const c7=100;class u7 extends s_{constructor(e,t,n){super(e,t,n,"[stream-controller]",Ht.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.LEVEL_LOADING,this.onLevelLoading,this),e.on(z.LEVEL_LOADED,this.onLevelLoaded,this),e.on(z.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(z.ERROR,this.onError,this),e.on(z.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(z.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(z.BUFFER_CREATED,this.onBufferCreated,this),e.on(z.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(z.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.LEVEL_LOADED,this.onLevelLoaded,this),e.off(z.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(z.ERROR,this.onError,this),e.off(z.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(z.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(z.BUFFER_CREATED,this.onBufferCreated,this),e.off(z.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(z.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(c7),this.level=-1,!this.startFragRequested){let i=n.startLevel;i===-1&&(n.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=n.firstAutoLevel),n.nextLoadLevel=i,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=je.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=je.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case je.WAITING_LEVEL:{const{levels:t,level:n}=this,i=t==null?void 0:t[n],r=i==null?void 0:i.details;if(r&&(!r.live||this.levelLastLoaded===i)){if(this.waitForCdnTuneIn(r))break;this.state=je.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=je.IDLE;break}break}case je.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:i,level:r}=this,o=i==null?void 0:i[r];this.resetStartWhenNotLoaded(o||null),this.state=je.IDLE}}break}this.state===je.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(t===null||!i&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const r=e.nextLoadLevel;if(!(n!=null&&n[r]))return;const o=n[r],a=this.getMainFwdBufferInfo();if(a===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(a,l)){const _={};this.altAudio&&(_.type="video"),this.hls.trigger(z.BUFFER_EOS,_),this.state=je.ENDED;return}e.loadLevel!==r&&e.manualLevel===-1&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const c=o.details;if(!c||this.state===je.WAITING_LEVEL||c.live&&this.levelLastLoaded!==o){this.level=r,this.state=je.WAITING_LEVEL;return}const h=a.len,f=this.getMaxBufferLength(o.maxBitrate);if(h>=f)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const p=this.backtrackFragment?this.backtrackFragment.start:a.end;let y=this.getNextFragment(p,c);if(this.couldBacktrack&&!this.fragPrevious&&y&&y.sn!=="initSegment"&&this.fragmentTracker.getState(y)!==lr.OK){var v;const S=((v=this.backtrackFragment)!=null?v:y).sn-c.startSN,A=c.fragments[S-1];A&&y.cc===A.cc&&(y=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(y&&this.isLoopLoading(y,p)){if(!y.gap){const S=this.audioOnly&&!this.altAudio?kn.AUDIO:kn.VIDEO,A=(S===kn.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,S,Ht.MAIN)}y=this.getNextFragmentLoopLoading(y,c,a,Ht.MAIN,f)}y&&(y.initSegment&&!y.initSegment.data&&!this.bitrateTest&&(y=y.initSegment),this.loadFragment(y,o,p))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===lr.NOT_LOADED||i===lr.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Ht.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(r!=null&&r.live){const a=this.getMainFwdBufferInfo();if(!a||a.len<r.targetduration*2)return}if(!t.paused&&e){const a=this.hls.nextLoadLevel,l=e[a],c=this.fragLastKbps;c&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*c)+1:n=0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();const l=a.maxStartPTS?a.maxStartPTS:a.start,c=a.duration,h=Math.max(o.end,l+Math.min(Math.max(c-this.config.maxFragLookUpTolerance,c*(this.couldBacktrack?.5:.125)),c*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case je.KEY_LOADING:case je.FRAG_LOADING:case je.FRAG_LOADING_WAITING_RETRY:case je.PARSING:case je.PARSED:this.state=je.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new l7(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;bt(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(z.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,i=!1;t.levels.forEach(r=>{const o=r.audioCodec;o&&(n=n||o.indexOf("mp4a.40.2")!==-1,i=i||o.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&i&&!r7(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==je.IDLE)return;const i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(i.details))&&(this.state=je.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i}=this,r=t.level,o=t.details,a=o.totalduration;if(!i){this.warn(`Levels were reset while loading level ${r}`);return}this.log(`Level ${r} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${a}`);const l=i[r],c=this.fragCurrent;c&&(this.state===je.FRAG_LOADING||this.state===je.FRAG_LOADING_WAITING_RETRY)&&c.level!==t.level&&c.loader&&this.abortCurrentFrag();let h=0;if(o.live||(n=l.details)!=null&&n.live){var f;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;h=this.alignPlaylists(o,l.details,(f=this.levelLastLoaded)==null?void 0:f.details)}if(l.details=o,this.levelLastLoaded=l,this.hls.trigger(z.LEVEL_UPDATED,{details:o,level:r}),this.state===je.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=je.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,h),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const a=o[n.level],l=a.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const c=a.videoCodec,h=l.PTSKnown||!l.live,f=(t=n.initSegment)==null?void 0:t.data,p=this._getAudioCodec(a),y=this.transmuxer=this.transmuxer||new PL(this.hls,Ht.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),v=i?i.index:-1,_=v!==-1,S=new r_(n.level,n.sn,n.stats.chunkCount,r.byteLength,v,_),A=this.initPTS[n.cc];y.push(r,f,p,c,n,i,l.totalduration,h,S,A)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const r=this.hls;n&&(r.trigger(z.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),r.trigger(z.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,i=!!this.hls.audioTracks[n].url;if(i){const r=this.videoBuffer;r&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=i,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,o=!1;for(const a in n){const l=n[a];if(l.id==="main"){if(r=a,i=l,a==="video"){const c=n[a];c&&(this.videoBuffer=c.buffer)}}else o=!0}o&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n&&n.type!==Ht.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===je.PARSED&&(this.state=je.IDLE);return}const r=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*r.total/(r.buffering.end-r.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=je.ERROR;return}switch(t.details){case Le.FRAG_GAP:case Le.FRAG_PARSING_ERROR:case Le.FRAG_DECRYPT_ERROR:case Le.FRAG_LOAD_ERROR:case Le.FRAG_LOAD_TIMEOUT:case Le.KEY_LOAD_ERROR:case Le.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Ht.MAIN,t);break;case Le.LEVEL_LOAD_ERROR:case Le.LEVEL_LOAD_TIMEOUT:case Le.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===je.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===Tn.LEVEL&&(this.state=je.IDLE);break;case Le.BUFFER_APPEND_ERROR:case Le.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===Le.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Le.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!Jn.getBuffered(e).length){const n=this.state!==je.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=je.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==kn.AUDIO||this.audioOnly&&!this.altAudio){const n=(t===kn.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,Ht.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const i=Jn.getBuffered(e),o=(i.length?i.start(0):0)-n;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:i}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=je.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const r=e.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),i.trigger(z.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:i}=this,{remuxResult:r,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:c,level:h}=a,{video:f,text:p,id3:y,initSegment:v}=r,{details:_}=h,S=this.altAudio?void 0:r.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=je.PARSING,v){if(v!=null&&v.tracks){const M=l.initSegment||l;this._bufferInitSegment(h,v.tracks,M,o),i.trigger(z.FRAG_PARSING_INIT_SEGMENT,{frag:M,id:n,tracks:v.tracks})}const A=v.initPTS,w=v.timescale;bt(A)&&(this.initPTS[l.cc]={baseTime:A,timescale:w},i.trigger(z.INIT_PTS_FOUND,{frag:l,id:n,initPTS:A,timescale:w}))}if(f&&_&&l.sn!=="initSegment"){const A=_.fragments[l.sn-1-_.startSN],w=l.sn===_.startSN,M=!A||l.cc>A.cc;if(r.independent!==!1){const{startPTS:C,endPTS:I,startDTS:O,endDTS:k}=f;if(c)c.elementaryStreams[f.type]={startPTS:C,endPTS:I,startDTS:O,endDTS:k};else if(f.firstKeyFrame&&f.independent&&o.id===1&&!M&&(this.couldBacktrack=!0),f.dropped&&f.independent){const N=this.getMainFwdBufferInfo(),B=(N?N.end:this.getLoadPosition())+this.config.maxBufferHole,P=f.firstKeyFramePTS?f.firstKeyFramePTS:C;if(!w&&B<P-this.config.maxBufferHole&&!M){this.backtrack(l);return}else M&&(l.gap=!0);l.setElementaryStreamInfo(f.type,l.start,I,l.start,k,!0)}else w&&C>cv&&(l.gap=!0);l.setElementaryStreamInfo(f.type,C,I,O,k),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(f,l,c,o,w||M)}else if(w||M)l.gap=!0;else{this.backtrack(l);return}}if(S){const{startPTS:A,endPTS:w,startDTS:M,endDTS:C}=S;c&&(c.elementaryStreams[kn.AUDIO]={startPTS:A,endPTS:w,startDTS:M,endDTS:C}),l.setElementaryStreamInfo(kn.AUDIO,A,w,M,C),this.bufferFragmentData(S,l,c,o)}if(_&&y!=null&&(t=y.samples)!=null&&t.length){const A={id:n,frag:l,details:_,samples:y.samples};i.trigger(z.FRAG_PARSING_METADATA,A)}if(_&&p){const A={id:n,frag:l,details:_,samples:p.samples};i.trigger(z.FRAG_PARSING_USERDATA,A)}}_bufferInitSegment(e,t,n,i){if(this.state!==je.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:r,video:o,audiovideo:a}=t;if(r){let l=e.audioCodec;const c=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5");const h=r.metadata;h&&"channelCount"in h&&(h.channelCount||1)!==1&&c.indexOf("firefox")===-1&&(l="mp4a.40.5")}l&&l.indexOf("mp4a.40.5")!==-1&&c.indexOf("android")!==-1&&r.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),r.levelCodec=l,r.id="main",this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${r.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),this.hls.trigger(z.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{const h=t[l].initSegment;h!=null&&h.byteLength&&this.hls.trigger(z.BUFFER_APPENDING,{type:l,data:h,frag:n,part:null,chunkMeta:i,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Ht.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=je.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Jn.isBuffered(e,n)?t=this.getAppendedFrag(n):Jn.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const i=this.fragPlaying,r=t.level;(!i||t.sn!==i.sn||i.level!==r)&&(this.fragPlaying=t,this.hls.trigger(z.FRAG_CHANGED,{frag:t}),(!i||i.level!==r)&&this.hls.trigger(z.LEVEL_SWITCHED,{level:r}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&bt(t)&&bt(n.programDateTime)){const i=n.programDateTime+(t-n.start)*1e3;return new Date(i)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class jc{static get version(){return"1.5.17"}static isMSESupported(){return eT()}static isSupported(){return a3()}static getMediaSource(){return eu()}static get Events(){return z}static get ErrorTypes(){return Yt}static get ErrorDetails(){return Le}static get DefaultConfig(){return jc.defaultConfig?jc.defaultConfig:s3}static set DefaultConfig(e){jc.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new JE,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,dG(e.debug||!1,"Hls instance");const t=this.config=e7(jc.DefaultConfig,e);this.userConfig=e,t.progressive&&t7(t);const{abrController:n,bufferController:i,capLevelController:r,errorController:o,fpsController:a}=t,l=new o(this),c=this.abrController=new n(this),h=this.bufferController=new i(this),f=this.capLevelController=new r(this),p=new a(this),y=new rH(this),v=new cH(this),_=t.contentSteeringController,S=_?new _(this):null,A=this.levelController=new n7(this,S),w=new FH(this),M=new i7(this.config),C=this.streamController=new u7(this,w,M);f.setStreamController(C),p.setStreamController(C);const I=[y,A,C];S&&I.splice(1,0,S),this.networkControllers=I;const O=[c,h,f,p,v,w];this.audioTrackController=this.createController(t.audioTrackController,I);const k=t.audioStreamController;k&&I.push(new k(this,w,M)),this.subtitleTrackController=this.createController(t.subtitleTrackController,I);const N=t.subtitleStreamController;N&&I.push(new N(this,w,M)),this.createController(t.timelineController,O),M.emeController=this.emeController=this.createController(t.emeController,O),this.cmcdController=this.createController(t.cmcdController,O),this.latencyController=this.createController(uH,O),this.coreComponents=O,I.push(l);const B=l.onErrorOut;typeof B=="function"&&this.on(z.ERROR,B,l)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(ve.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const i=e===z.ERROR;this.trigger(z.ERROR,{type:Yt.OTHER_ERROR,details:Le.INTERNAL_EXCEPTION,fatal:i,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){ve.log("destroy"),this.trigger(z.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){ve.log("attachMedia"),this._media=e,this.trigger(z.MEDIA_ATTACHING,{media:e})}detachMedia(){ve.log("detachMedia"),this.trigger(z.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,i=this.url=NE.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,ve.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(z.MANIFEST_LOADING,{url:e})}startLoad(e=-1){ve.log(`startLoad(${e})`),this.started=!0,this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){ve.log("stopLoad"),this.started=!1,this.networkControllers.forEach(e=>{e.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.stopLoad()})}swapAudioCodec(){ve.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){ve.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){ve.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){ve.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){ve.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){ve.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){ve.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(ve.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){hH(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(t===-1&&e!=null&&e.length?i=e.length-1:i=t,n)for(let r=i;r--;){const o=e[r].attrs["HDCP-LEVEL"];if(o&&o<=n)return r}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}jc.defaultConfig=void 0;const h7=Object.freeze(Object.defineProperty({__proto__:null,AbrController:pL,AttrList:ri,AudioStreamController:OL,AudioTrackController:BL,BasePlaylistController:i_,BaseSegment:GE,BaseStreamController:s_,BufferController:NL,CMCDController:t3,CapLevelController:o_,ChunkMetadata:r_,ContentSteeringController:n3,DateRange:UE,EMEController:Lh,ErrorActionFlags:go,ErrorController:dL,ErrorDetails:Le,ErrorTypes:Yt,Events:z,FPSController:YL,Fragment:nv,Hls:jc,HlsSkip:Qm,HlsUrlParameters:lA,KeySystemFormats:ts,KeySystems:Kn,Level:Wh,LevelDetails:WI,LevelKey:op,LoadStats:j0,MetadataSchema:_o,NetworkErrorAction:Yi,Part:VI,PlaylistLevelType:Ht,SubtitleStreamController:FL,SubtitleTrackController:kL,TimelineController:XL,default:jc,getMediaSource:eu,isMSESupported:eT,isSupported:a3},Symbol.toStringTag,{value:"Module"}));var Pb,Db;const d7=typeof window<"u"&&typeof((Pb=window.document)==null?void 0:Pb.createElement)=="function"&&typeof((Db=window.navigator)==null?void 0:Db.userAgent)=="string";let SS=null;async function f7(...s){var e;(e=SS)!==null&&e!==void 0||(SS=await iG(()=>Promise.resolve().then(()=>h7),[]));const t=SS.default;return t.isSupported()?new t(...s):null}function p7(s,{unsuspend:e="loadedmetadata",start:t=!0,hls:n={},crossOrigin:i="anonymous",muted:r=!0,loop:o=!0,playsInline:a=!0,onVideoFrame:l,...c}={}){const h=ki(v=>v.gl),f=te.useRef(null),p=yI(()=>new Promise(async v=>{let _,S;typeof s=="string"?_=s:S=s;const A=Object.assign(document.createElement("video"),{src:_,srcObject:S,crossOrigin:i,loop:o,muted:r,playsInline:a,...c});if(_&&d7&&_.endsWith(".m3u8")){const M=f.current=await f7(n);M&&(M.on(z.MEDIA_ATTACHED,()=>void M.loadSource(_)),M.attachMedia(A))}const w=new ER(A);"colorSpace"in w?w.colorSpace=h.outputColorSpace:w.encoding=h.outputEncoding,A.addEventListener(e,()=>v(w))}),[s]),y=p.source.data;return m7(y,l),te.useEffect(()=>(t&&p.image.play(),()=>{f.current&&(f.current.destroy(),f.current=null)}),[p,t]),p}const m7=(s,e)=>{te.useEffect(()=>{if(!e||!s.requestVideoFrameCallback)return;let t;const n=(...i)=>{e(...i),t=s.requestVideoFrameCallback(n)};return s.requestVideoFrameCallback(n),()=>s.cancelVideoFrameCallback(t)},[s,e])},l3=te.forwardRef(function({children:e,disable:t,disableX:n,disableY:i,disableZ:r,left:o,right:a,top:l,bottom:c,front:h,back:f,onCentered:p,precise:y=!0,cacheKey:v=0,..._},S){const A=te.useRef(null),w=te.useRef(null),M=te.useRef(null);return te.useLayoutEffect(()=>{w.current.matrixWorld.identity();const C=new wr().setFromObject(M.current,y),I=new J,O=new dr,k=C.max.x-C.min.x,N=C.max.y-C.min.y,B=C.max.z-C.min.z;C.getCenter(I),C.getBoundingSphere(O);const P=l?N/2:c?-N/2:0,G=o?-k/2:a?k/2:0,Z=h?B/2:f?-B/2:0;w.current.position.set(t||n?0:-I.x+G,t||i?0:-I.y+P,t||r?0:-I.z+Z),typeof p<"u"&&p({parent:A.current.parent,container:A.current,width:k,height:N,depth:B,boundingBox:C,boundingSphere:O,center:I,verticalAlignment:P,horizontalAlignment:G,depthAlignment:Z})},[v,p,l,o,h,t,n,i,r,y,a,c,f]),te.useImperativeHandle(S,()=>A.current,[]),te.createElement("group",rp({ref:A},_),te.createElement("group",{ref:w},te.createElement("group",{ref:M},e)))});function g7({all:s,scene:e,camera:t}){const n=ki(({gl:o})=>o),i=ki(({camera:o})=>o),r=ki(({scene:o})=>o);return te.useLayoutEffect(()=>{const o=[];s&&(e||r).traverse(c=>{c.visible===!1&&(o.push(c),c.visible=!0)}),n.compile(e||r,t||i);const a=new rE(128);new iE(.01,1e5,a).update(n,e||r),a.dispose(),o.forEach(c=>c.visible=!1)},[]),null}function Bl(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function c3(s,e){s.prototype=Object.create(e.prototype),s.prototype.constructor=s,s.__proto__=e}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Ys={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},cp={duration:.5,overwrite:!1,delay:0},tT,Ur,oi,Eo=1e8,qn=1/Eo,vA=Math.PI*2,y7=vA/4,v7=0,u3=Math.sqrt,x7=Math.cos,_7=Math.sin,pr=function(e){return typeof e=="string"},Ai=function(e){return typeof e=="function"},Yl=function(e){return typeof e=="number"},nT=function(e){return typeof e>"u"},za=function(e){return typeof e=="object"},Ts=function(e){return e!==!1},iT=function(){return typeof window<"u"},$y=function(e){return Ai(e)||pr(e)},h3=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Gr=Array.isArray,xA=/(?:-?\.?\d|\.)+/gi,d3=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Hf=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,AS=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,f3=/[+-]=-?[.\d]+/,p3=/[^,'"\[\]\s]+/gi,S7=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,hi,ba,_A,rT,Qs={},fx={},m3,g3=function(e){return(fx=Kh(e,Qs))&&Cs},sT=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},y0=function(e,t){return!t&&console.warn(e)},y3=function(e,t){return e&&(Qs[e]=t)&&fx&&(fx[e]=t)||Qs},v0=function(){return 0},A7={suppressEvents:!0,isStart:!0,kill:!1},uv={suppressEvents:!0,kill:!1},E7={suppressEvents:!0},oT={},$c=[],SA={},v3,js={},ES={},Ob=30,hv=[],aT="",lT=function(e){var t=e[0],n,i;if(za(t)||Ai(t)||(e=[e]),!(n=(t._gsap||{}).harness)){for(i=hv.length;i--&&!hv[i].targetTest(t););n=hv[i]}for(i=e.length;i--;)e[i]&&(e[i]._gsap||(e[i]._gsap=new z3(e[i],n)))||e.splice(i,1);return e},Ph=function(e){return e._gsap||lT(To(e))[0]._gsap},x3=function(e,t,n){return(n=e[t])&&Ai(n)?e[t]():nT(n)&&e.getAttribute&&e.getAttribute(t)||n},ws=function(e,t){return(e=e.split(",")).forEach(t)||e},bi=function(e){return Math.round(e*1e5)/1e5||0},cr=function(e){return Math.round(e*1e7)/1e7||0},Xf=function(e,t){var n=t.charAt(0),i=parseFloat(t.substr(2));return e=parseFloat(e),n==="+"?e+i:n==="-"?e-i:n==="*"?e*i:e/i},T7=function(e,t){for(var n=t.length,i=0;e.indexOf(t[i])<0&&++i<n;);return i<n},px=function(){var e=$c.length,t=$c.slice(0),n,i;for(SA={},$c.length=0,n=0;n<e;n++)i=t[n],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},_3=function(e,t,n,i){$c.length&&!Ur&&px(),e.render(t,n,Ur&&t<0&&(e._initted||e._startAt)),$c.length&&!Ur&&px()},S3=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(p3).length<2?t:pr(e)?e.trim():e},A3=function(e){return e},bo=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},w7=function(e){return function(t,n){for(var i in n)i in t||i==="duration"&&e||i==="ease"||(t[i]=n[i])}},Kh=function(e,t){for(var n in t)e[n]=t[n];return e},Bb=function s(e,t){for(var n in t)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(e[n]=za(t[n])?s(e[n]||(e[n]={}),t[n]):t[n]);return e},mx=function(e,t){var n={},i;for(i in e)i in t||(n[i]=e[i]);return n},Zm=function(e){var t=e.parent||hi,n=e.keyframes?w7(Gr(e.keyframes)):bo;if(Ts(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},M7=function(e,t){for(var n=e.length,i=n===t.length;i&&n--&&e[n]===t[n];);return n<0},E3=function(e,t,n,i,r){var o=e[i],a;if(r)for(a=t[r];o&&o[r]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[i]=t,t._prev=o,t.parent=t._dp=e,t},a_=function(e,t,n,i){n===void 0&&(n="_first"),i===void 0&&(i="_last");var r=t._prev,o=t._next;r?r._next=o:e[n]===t&&(e[n]=o),o?o._prev=r:e[i]===t&&(e[i]=r),t._next=t._prev=t.parent=null},tu=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Dh=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},b7=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},AA=function(e,t,n,i){return e._startAt&&(Ur?e._startAt.revert(uv):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,i))},C7=function s(e){return!e||e._ts&&s(e.parent)},Fb=function(e){return e._repeat?up(e._tTime,e=e.duration()+e._rDelay)*e:0},up=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},gx=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},l_=function(e){return e._end=cr(e._start+(e._tDur/Math.abs(e._ts||e._rts||qn)||0))},c_=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=cr(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),l_(e),n._dirty||Dh(n,e)),e},T3=function(e,t){var n;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(n=gx(e.rawTime(),t),(!t._dur||V0(0,t.totalDuration(),n)-t._tTime>qn)&&t.render(n,!0)),Dh(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-qn}},Ra=function(e,t,n,i){return t.parent&&tu(t),t._start=cr((Yl(n)?n:n||e!==hi?yo(e,n,t):e._time)+t._delay),t._end=cr(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),E3(e,t,"_first","_last",e._sort?"_start":0),EA(t)||(e._recent=t),i||T3(e,t),e._ts<0&&c_(e,e._tTime),e},w3=function(e,t){return(Qs.ScrollTrigger||sT("scrollTrigger",t))&&Qs.ScrollTrigger.create(t,e)},M3=function(e,t,n,i,r){if(uT(e,t,r),!e._initted)return 1;if(!n&&e._pt&&!Ur&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&v3!==Vs.frame)return $c.push(e),e._lazy=[r,i],1},R7=function s(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||s(t))},EA=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},I7=function(e,t,n,i){var r=e.ratio,o=t<0||!t&&(!e._start&&R7(e)&&!(!e._initted&&EA(e))||(e._ts<0||e._dp._ts<0)&&!EA(e))?0:1,a=e._rDelay,l=0,c,h,f;if(a&&e._repeat&&(l=V0(0,e._tDur,t),h=up(l,a),e._yoyo&&h&1&&(o=1-o),h!==up(e._tTime,a)&&(r=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==r||Ur||i||e._zTime===qn||!t&&e._zTime){if(!e._initted&&M3(e,t,i,n,l))return;for(f=e._zTime,e._zTime=t||(n?qn:0),n||(n=t&&!f),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=l,c=e._pt;c;)c.r(o,c.d),c=c._next;t<0&&AA(e,t,n,!0),e._onUpdate&&!n&&Xs(e,"onUpdate"),l&&e._repeat&&!n&&e.parent&&Xs(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&tu(e,1),!n&&!Ur&&(Xs(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},L7=function(e,t,n){var i;if(n>t)for(i=e._first;i&&i._start<=n;){if(i.data==="isPause"&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=n;){if(i.data==="isPause"&&i._start<t)return i;i=i._prev}},hp=function(e,t,n,i){var r=e._repeat,o=cr(t)||0,a=e._tTime/e._tDur;return a&&!i&&(e._time*=o/e._dur),e._dur=o,e._tDur=r?r<0?1e10:cr(o*(r+1)+e._rDelay*r):o,a>0&&!i&&c_(e,e._tTime=e._tDur*a),e.parent&&l_(e),n||Dh(e.parent,e),e},kb=function(e){return e instanceof is?Dh(e):hp(e,e._dur)},P7={_start:0,endTime:v0,totalDuration:v0},yo=function s(e,t,n){var i=e.labels,r=e._recent||P7,o=e.duration()>=Eo?r.endTime(!1):e._dur,a,l,c;return pr(t)&&(isNaN(t)||t in i)?(l=t.charAt(0),c=t.substr(-1)==="%",a=t.indexOf("="),l==="<"||l===">"?(a>=0&&(t=t.replace(/=/,"")),(l==="<"?r._start:r.endTime(r._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(a<0?r:n).totalDuration()/100:1)):a<0?(t in i||(i[t]=o),i[t]):(l=parseFloat(t.charAt(a-1)+t.substr(a+1)),c&&n&&(l=l/100*(Gr(n)?n[0]:n).totalDuration()),a>1?s(e,t.substr(0,a-1),n)+l:o+l)):t==null?o:+t},e0=function(e,t,n){var i=Yl(t[1]),r=(i?2:1)+(e<2?0:1),o=t[r],a,l;if(i&&(o.duration=t[1]),o.parent=n,e){for(a=o,l=n;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=Ts(l.vars.inherit)&&l.parent;o.immediateRender=Ts(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[r-1]}return new Ni(t[0],o,t[r+1])},ou=function(e,t){return e||e===0?t(e):t},V0=function(e,t,n){return n<e?e:n>t?t:n},kr=function(e,t){return!pr(e)||!(t=S7.exec(e))?"":t[1]},D7=function(e,t,n){return ou(n,function(i){return V0(e,t,i)})},TA=[].slice,b3=function(e,t){return e&&za(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&za(e[0]))&&!e.nodeType&&e!==ba},O7=function(e,t,n){return n===void 0&&(n=[]),e.forEach(function(i){var r;return pr(i)&&!t||b3(i,1)?(r=n).push.apply(r,To(i)):n.push(i)})||n},To=function(e,t,n){return oi&&!t&&oi.selector?oi.selector(e):pr(e)&&!n&&(_A||!dp())?TA.call((t||rT).querySelectorAll(e),0):Gr(e)?O7(e,n):b3(e)?TA.call(e,0):e?[e]:[]},wA=function(e){return e=To(e)[0]||y0("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return To(t,n.querySelectorAll?n:n===e?y0("Invalid scope")||rT.createElement("div"):e)}},C3=function(e){return e.sort(function(){return .5-Math.random()})},R3=function(e){if(Ai(e))return e;var t=za(e)?e:{each:e},n=Oh(t.ease),i=t.from||0,r=parseFloat(t.base)||0,o={},a=i>0&&i<1,l=isNaN(i)||a,c=t.axis,h=i,f=i;return pr(i)?h=f={center:.5,edges:.5,end:1}[i]||0:!a&&l&&(h=i[0],f=i[1]),function(p,y,v){var _=(v||t).length,S=o[_],A,w,M,C,I,O,k,N,B;if(!S){if(B=t.grid==="auto"?0:(t.grid||[1,Eo])[1],!B){for(k=-Eo;k<(k=v[B++].getBoundingClientRect().left)&&B<_;);B<_&&B--}for(S=o[_]=[],A=l?Math.min(B,_)*h-.5:i%B,w=B===Eo?0:l?_*f/B-.5:i/B|0,k=0,N=Eo,O=0;O<_;O++)M=O%B-A,C=w-(O/B|0),S[O]=I=c?Math.abs(c==="y"?C:M):u3(M*M+C*C),I>k&&(k=I),I<N&&(N=I);i==="random"&&C3(S),S.max=k-N,S.min=N,S.v=_=(parseFloat(t.amount)||parseFloat(t.each)*(B>_?_-1:c?c==="y"?_/B:B:Math.max(B,_/B))||0)*(i==="edges"?-1:1),S.b=_<0?r-_:r,S.u=kr(t.amount||t.each)||0,n=n&&_<0?U3(n):n}return _=(S[p]-S.min)/S.max||0,cr(S.b+(n?n(_):_)*S.v)+S.u}},MA=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var i=cr(Math.round(parseFloat(n)/e)*e*t);return(i-i%1)/t+(Yl(n)?0:kr(n))}},I3=function(e,t){var n=Gr(e),i,r;return!n&&za(e)&&(i=n=e.radius||Eo,e.values?(e=To(e.values),(r=!Yl(e[0]))&&(i*=i)):e=MA(e.increment)),ou(t,n?Ai(e)?function(o){return r=e(o),Math.abs(r-o)<=i?r:o}:function(o){for(var a=parseFloat(r?o.x:o),l=parseFloat(r?o.y:0),c=Eo,h=0,f=e.length,p,y;f--;)r?(p=e[f].x-a,y=e[f].y-l,p=p*p+y*y):p=Math.abs(e[f]-a),p<c&&(c=p,h=f);return h=!i||c<=i?e[h]:o,r||h===o||Yl(o)?h:h+kr(o)}:MA(e))},L3=function(e,t,n,i){return ou(Gr(e)?!t:n===!0?!!(n=0):!i,function(){return Gr(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+n*.99))/n)*n*i)/i})},B7=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(i){return t.reduce(function(r,o){return o(r)},i)}},F7=function(e,t){return function(n){return e(parseFloat(n))+(t||kr(n))}},k7=function(e,t,n){return D3(e,t,0,1,n)},P3=function(e,t,n){return ou(n,function(i){return e[~~t(i)]})},N7=function s(e,t,n){var i=t-e;return Gr(e)?P3(e,s(0,e.length),t):ou(n,function(r){return(i+(r-e)%i)%i+e})},U7=function s(e,t,n){var i=t-e,r=i*2;return Gr(e)?P3(e,s(0,e.length-1),t):ou(n,function(o){return o=(r+(o-e)%r)%r||0,e+(o>i?r-o:o)})},x0=function(e){for(var t=0,n="",i,r,o,a;~(i=e.indexOf("random(",t));)o=e.indexOf(")",i),a=e.charAt(i+7)==="[",r=e.substr(i+7,o-i-7).match(a?p3:xA),n+=e.substr(t,i-t)+L3(a?r:+r[0],a?0:+r[1],+r[2]||1e-5),t=o+1;return n+e.substr(t,e.length-t)},D3=function(e,t,n,i,r){var o=t-e,a=i-n;return ou(r,function(l){return n+((l-e)/o*a||0)})},G7=function s(e,t,n,i){var r=isNaN(e+t)?0:function(y){return(1-y)*e+y*t};if(!r){var o=pr(e),a={},l,c,h,f,p;if(n===!0&&(i=1)&&(n=null),o)e={p:e},t={p:t};else if(Gr(e)&&!Gr(t)){for(h=[],f=e.length,p=f-2,c=1;c<f;c++)h.push(s(e[c-1],e[c]));f--,r=function(v){v*=f;var _=Math.min(p,~~v);return h[_](v-_)},n=t}else i||(e=Kh(Gr(e)?[]:{},e));if(!h){for(l in t)cT.call(a,e,l,"get",t[l]);r=function(v){return fT(v,a)||(o?e.p:e)}}}return ou(n,r)},Nb=function(e,t,n){var i=e.labels,r=Eo,o,a,l;for(o in i)a=i[o]-t,a<0==!!n&&a&&r>(a=Math.abs(a))&&(l=o,r=a);return l},Xs=function(e,t,n){var i=e.vars,r=i[t],o=oi,a=e._ctx,l,c,h;if(r)return l=i[t+"Params"],c=i.callbackScope||e,n&&$c.length&&px(),a&&(oi=a),h=l?r.apply(c,l):r.call(c),oi=o,h},Gm=function(e){return tu(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Ur),e.progress()<1&&Xs(e,"onInterrupt"),e},zf,O3=[],B3=function(e){if(e)if(e=!e.name&&e.default||e,iT()||e.headless){var t=e.name,n=Ai(e),i=t&&!n&&e.init?function(){this._props=[]}:e,r={init:v0,render:fT,add:cT,kill:nV,modifier:tV,rawVars:0},o={targetTest:0,get:0,getSetter:dT,aliases:{},register:0};if(dp(),e!==i){if(js[t])return;bo(i,bo(mx(e,r),o)),Kh(i.prototype,Kh(r,mx(e,o))),js[i.prop=t]=i,e.targetTest&&(hv.push(i),oT[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}y3(t,i),e.register&&e.register(Cs,i,Ms)}else O3.push(e)},Wn=255,Hm={aqua:[0,Wn,Wn],lime:[0,Wn,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Wn],navy:[0,0,128],white:[Wn,Wn,Wn],olive:[128,128,0],yellow:[Wn,Wn,0],orange:[Wn,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Wn,0,0],pink:[Wn,192,203],cyan:[0,Wn,Wn],transparent:[Wn,Wn,Wn,0]},TS=function(e,t,n){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(n-t)*e*6:e<.5?n:e*3<2?t+(n-t)*(2/3-e)*6:t)*Wn+.5|0},F3=function(e,t,n){var i=e?Yl(e)?[e>>16,e>>8&Wn,e&Wn]:0:Hm.black,r,o,a,l,c,h,f,p,y,v;if(!i){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Hm[e])i=Hm[e];else if(e.charAt(0)==="#"){if(e.length<6&&(r=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+r+r+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return i=parseInt(e.substr(1,6),16),[i>>16,i>>8&Wn,i&Wn,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),i=[e>>16,e>>8&Wn,e&Wn]}else if(e.substr(0,3)==="hsl"){if(i=v=e.match(xA),!t)l=+i[0]%360/360,c=+i[1]/100,h=+i[2]/100,o=h<=.5?h*(c+1):h+c-h*c,r=h*2-o,i.length>3&&(i[3]*=1),i[0]=TS(l+1/3,r,o),i[1]=TS(l,r,o),i[2]=TS(l-1/3,r,o);else if(~e.indexOf("="))return i=e.match(d3),n&&i.length<4&&(i[3]=1),i}else i=e.match(xA)||Hm.transparent;i=i.map(Number)}return t&&!v&&(r=i[0]/Wn,o=i[1]/Wn,a=i[2]/Wn,f=Math.max(r,o,a),p=Math.min(r,o,a),h=(f+p)/2,f===p?l=c=0:(y=f-p,c=h>.5?y/(2-f-p):y/(f+p),l=f===r?(o-a)/y+(o<a?6:0):f===o?(a-r)/y+2:(r-o)/y+4,l*=60),i[0]=~~(l+.5),i[1]=~~(c*100+.5),i[2]=~~(h*100+.5)),n&&i.length<4&&(i[3]=1),i},k3=function(e){var t=[],n=[],i=-1;return e.split(Yc).forEach(function(r){var o=r.match(Hf)||[];t.push.apply(t,o),n.push(i+=o.length+1)}),t.c=n,t},Ub=function(e,t,n){var i="",r=(e+i).match(Yc),o=t?"hsla(":"rgba(",a=0,l,c,h,f;if(!r)return e;if(r=r.map(function(p){return(p=F3(p,t,1))&&o+(t?p[0]+","+p[1]+"%,"+p[2]+"%,"+p[3]:p.join(","))+")"}),n&&(h=k3(e),l=n.c,l.join(i)!==h.c.join(i)))for(c=e.replace(Yc,"1").split(Hf),f=c.length-1;a<f;a++)i+=c[a]+(~l.indexOf(a)?r.shift()||o+"0,0,0,0)":(h.length?h:r.length?r:n).shift());if(!c)for(c=e.split(Yc),f=c.length-1;a<f;a++)i+=c[a]+r[a];return i+c[f]},Yc=function(){var s="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Hm)s+="|"+e+"\\b";return new RegExp(s+")","gi")}(),H7=/hsl[a]?\(/,N3=function(e){var t=e.join(" "),n;if(Yc.lastIndex=0,Yc.test(t))return n=H7.test(t),e[1]=Ub(e[1],n),e[0]=Ub(e[0],n,k3(e[1])),!0},_0,Vs=function(){var s=Date.now,e=500,t=33,n=s(),i=n,r=1e3/240,o=r,a=[],l,c,h,f,p,y,v=function _(S){var A=s()-i,w=S===!0,M,C,I,O;if((A>e||A<0)&&(n+=A-t),i+=A,I=i-n,M=I-o,(M>0||w)&&(O=++f.frame,p=I-f.time*1e3,f.time=I=I/1e3,o+=M+(M>=r?4:r-M),C=1),w||(l=c(_)),C)for(y=0;y<a.length;y++)a[y](I,p,O,S)};return f={time:0,frame:0,tick:function(){v(!0)},deltaRatio:function(S){return p/(1e3/(S||60))},wake:function(){m3&&(!_A&&iT()&&(ba=_A=window,rT=ba.document||{},Qs.gsap=Cs,(ba.gsapVersions||(ba.gsapVersions=[])).push(Cs.version),g3(fx||ba.GreenSockGlobals||!ba.gsap&&ba||{}),O3.forEach(B3)),h=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&f.sleep(),c=h||function(S){return setTimeout(S,o-f.time*1e3+1|0)},_0=1,v(2))},sleep:function(){(h?cancelAnimationFrame:clearTimeout)(l),_0=0,c=v0},lagSmoothing:function(S,A){e=S||1/0,t=Math.min(A||33,e)},fps:function(S){r=1e3/(S||240),o=f.time*1e3+r},add:function(S,A,w){var M=A?function(C,I,O,k){S(C,I,O,k),f.remove(M)}:S;return f.remove(S),a[w?"unshift":"push"](M),dp(),M},remove:function(S,A){~(A=a.indexOf(S))&&a.splice(A,1)&&y>=A&&y--},_listeners:a},f}(),dp=function(){return!_0&&Vs.wake()},Sn={},z7=/^[\d.\-M][\d.\-,\s]/,j7=/["']/g,V7=function(e){for(var t={},n=e.substr(1,e.length-3).split(":"),i=n[0],r=1,o=n.length,a,l,c;r<o;r++)l=n[r],a=r!==o-1?l.lastIndexOf(","):l.length,c=l.substr(0,a),t[i]=isNaN(c)?c.replace(j7,"").trim():+c,i=l.substr(a+1).trim();return t},W7=function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<n?e.indexOf(")",n+1):n)},K7=function(e){var t=(e+"").split("("),n=Sn[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[V7(t[1])]:W7(e).split(",").map(S3)):Sn._CE&&z7.test(e)?Sn._CE("",e):n},U3=function(e){return function(t){return 1-e(1-t)}},G3=function s(e,t){for(var n=e._first,i;n;)n instanceof is?s(n,t):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==t&&(n.timeline?s(n.timeline,t):(i=n._ease,n._ease=n._yEase,n._yEase=i,n._yoyo=t)),n=n._next},Oh=function(e,t){return e&&(Ai(e)?e:Sn[e]||K7(e))||t},ed=function(e,t,n,i){n===void 0&&(n=function(l){return 1-t(1-l)}),i===void 0&&(i=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var r={easeIn:t,easeOut:n,easeInOut:i},o;return ws(e,function(a){Sn[a]=Qs[a]=r,Sn[o=a.toLowerCase()]=n;for(var l in r)Sn[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=Sn[a+"."+l]=r[l]}),r},H3=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},wS=function s(e,t,n){var i=t>=1?t:1,r=(n||(e?.3:.45))/(t<1?t:1),o=r/vA*(Math.asin(1/i)||0),a=function(h){return h===1?1:i*Math.pow(2,-10*h)*_7((h-o)*r)+1},l=e==="out"?a:e==="in"?function(c){return 1-a(1-c)}:H3(a);return r=vA/r,l.config=function(c,h){return s(e,c,h)},l},MS=function s(e,t){t===void 0&&(t=1.70158);var n=function(o){return o?--o*o*((t+1)*o+t)+1:0},i=e==="out"?n:e==="in"?function(r){return 1-n(1-r)}:H3(n);return i.config=function(r){return s(e,r)},i};ws("Linear,Quad,Cubic,Quart,Quint,Strong",function(s,e){var t=e<5?e+1:e;ed(s+",Power"+(t-1),e?function(n){return Math.pow(n,t)}:function(n){return n},function(n){return 1-Math.pow(1-n,t)},function(n){return n<.5?Math.pow(n*2,t)/2:1-Math.pow((1-n)*2,t)/2})});Sn.Linear.easeNone=Sn.none=Sn.Linear.easeIn;ed("Elastic",wS("in"),wS("out"),wS());(function(s,e){var t=1/e,n=2*t,i=2.5*t,r=function(a){return a<t?s*a*a:a<n?s*Math.pow(a-1.5/e,2)+.75:a<i?s*(a-=2.25/e)*a+.9375:s*Math.pow(a-2.625/e,2)+.984375};ed("Bounce",function(o){return 1-r(1-o)},r)})(7.5625,2.75);ed("Expo",function(s){return s?Math.pow(2,10*(s-1)):0});ed("Circ",function(s){return-(u3(1-s*s)-1)});ed("Sine",function(s){return s===1?1:-x7(s*y7)+1});ed("Back",MS("in"),MS("out"),MS());Sn.SteppedEase=Sn.steps=Qs.SteppedEase={config:function(e,t){e===void 0&&(e=1);var n=1/e,i=e+(t?0:1),r=t?1:0,o=1-qn;return function(a){return((i*V0(0,o,a)|0)+r)*n}}};cp.ease=Sn["quad.out"];ws("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(s){return aT+=s+","+s+"Params,"});var z3=function(e,t){this.id=v7++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:x3,this.set=t?t.getSetter:dT},S0=function(){function s(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,hp(this,+t.duration,1,1),this.data=t.data,oi&&(this._ctx=oi,oi.data.push(this)),_0||Vs.wake()}var e=s.prototype;return e.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,hp(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,i){if(dp(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(c_(this,n),!r._dp||r.parent||T3(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&Ra(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===qn||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),_3(this,n,i)),this},e.time=function(n,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+Fb(this))%(this._dur+this._rDelay)||(n?this._dur:0),i):this._time},e.totalProgress=function(n,i){return arguments.length?this.totalTime(this.totalDuration()*n,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(n,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+Fb(this),i):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(n,i){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*r,i):this._repeat?up(this._tTime,r)+1:1},e.timeScale=function(n,i){if(!arguments.length)return this._rts===-qn?0:this._rts;if(this._rts===n)return this;var r=this.parent&&this._ts?gx(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-qn?0:this._rts,this.totalTime(V0(-Math.abs(this._delay),this._tDur,r),i!==!1),l_(this),b7(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(dp(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==qn&&(this._tTime-=qn)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=n;var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&Ra(i,this,n-this._delay),this}return this._start},e.endTime=function(n){return this._start+(Ts(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var i=this.parent||this._dp;return i?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?gx(i.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){n===void 0&&(n=E7);var i=Ur;return Ur=n,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),Ur=i,this},e.globalTime=function(n){for(var i=this,r=arguments.length?n:i.rawTime();i;)r=i._start+r/(Math.abs(i._ts)||1),i=i._dp;return!this.parent&&this._sat?this._sat.globalTime(n):r},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,kb(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var i=this._time;return this._rDelay=n,kb(this),i?this.time(i):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,i){return this.totalTime(yo(this,n),Ts(i))},e.restart=function(n,i){return this.play().totalTime(n?-this._delay:0,Ts(i))},e.play=function(n,i){return n!=null&&this.seek(n,i),this.reversed(!1).paused(!1)},e.reverse=function(n,i){return n!=null&&this.seek(n||this.totalDuration(),i),this.reversed(!0).paused(!1)},e.pause=function(n,i){return n!=null&&this.seek(n,i),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-qn:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-qn,this},e.isActive=function(){var n=this.parent||this._dp,i=this._start,r;return!!(!n||this._ts&&this._initted&&n.isActive()&&(r=n.rawTime(!0))>=i&&r<this.endTime(!0)-qn)},e.eventCallback=function(n,i,r){var o=this.vars;return arguments.length>1?(i?(o[n]=i,r&&(o[n+"Params"]=r),n==="onUpdate"&&(this._onUpdate=i)):delete o[n],this):o[n]},e.then=function(n){var i=this;return new Promise(function(r){var o=Ai(n)?n:A3,a=function(){var c=i.then;i.then=null,Ai(o)&&(o=o(i))&&(o.then||o===i)&&(i.then=c),r(o),i.then=c};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?a():i._prom=a})},e.kill=function(){Gm(this)},s}();bo(S0.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-qn,_prom:0,_ps:!1,_rts:1});var is=function(s){c3(e,s);function e(n,i){var r;return n===void 0&&(n={}),r=s.call(this,n)||this,r.labels={},r.smoothChildTiming=!!n.smoothChildTiming,r.autoRemoveChildren=!!n.autoRemoveChildren,r._sort=Ts(n.sortChildren),hi&&Ra(n.parent||hi,Bl(r),i),n.reversed&&r.reverse(),n.paused&&r.paused(!0),n.scrollTrigger&&w3(Bl(r),n.scrollTrigger),r}var t=e.prototype;return t.to=function(i,r,o){return e0(0,arguments,this),this},t.from=function(i,r,o){return e0(1,arguments,this),this},t.fromTo=function(i,r,o,a){return e0(2,arguments,this),this},t.set=function(i,r,o){return r.duration=0,r.parent=this,Zm(r).repeatDelay||(r.repeat=0),r.immediateRender=!!r.immediateRender,new Ni(i,r,yo(this,o),1),this},t.call=function(i,r,o){return Ra(this,Ni.delayedCall(0,i,r),o)},t.staggerTo=function(i,r,o,a,l,c,h){return o.duration=r,o.stagger=o.stagger||a,o.onComplete=c,o.onCompleteParams=h,o.parent=this,new Ni(i,o,yo(this,l)),this},t.staggerFrom=function(i,r,o,a,l,c,h){return o.runBackwards=1,Zm(o).immediateRender=Ts(o.immediateRender),this.staggerTo(i,r,o,a,l,c,h)},t.staggerFromTo=function(i,r,o,a,l,c,h,f){return a.startAt=o,Zm(a).immediateRender=Ts(a.immediateRender),this.staggerTo(i,r,a,l,c,h,f)},t.render=function(i,r,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,h=i<=0?0:cr(i),f=this._zTime<0!=i<0&&(this._initted||!c),p,y,v,_,S,A,w,M,C,I,O,k;if(this!==hi&&h>l&&i>=0&&(h=l),h!==this._tTime||o||f){if(a!==this._time&&c&&(h+=this._time-a,i+=this._time-a),p=h,C=this._start,M=this._ts,A=!M,f&&(c||(a=this._zTime),(i||!r)&&(this._zTime=i)),this._repeat){if(O=this._yoyo,S=c+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(S*100+i,r,o);if(p=cr(h%S),h===l?(_=this._repeat,p=c):(_=~~(h/S),_&&_===h/S&&(p=c,_--),p>c&&(p=c)),I=up(this._tTime,S),!a&&this._tTime&&I!==_&&this._tTime-I*S-this._dur<=0&&(I=_),O&&_&1&&(p=c-p,k=1),_!==I&&!this._lock){var N=O&&I&1,B=N===(O&&_&1);if(_<I&&(N=!N),a=N?0:h%c?c:h,this._lock=1,this.render(a||(k?0:cr(_*S)),r,!c)._lock=0,this._tTime=h,!r&&this.parent&&Xs(this,"onRepeat"),this.vars.repeatRefresh&&!k&&(this.invalidate()._lock=1),a&&a!==this._time||A!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,B&&(this._lock=2,a=N?c:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!k&&this.invalidate()),this._lock=0,!this._ts&&!A)return this;G3(this,k)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(w=L7(this,cr(a),cr(p)),w&&(h-=p-(p=w._start))),this._tTime=h,this._time=p,this._act=!M,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,a=0),!a&&p&&!r&&!_&&(Xs(this,"onStart"),this._tTime!==h))return this;if(p>=a&&i>=0)for(y=this._first;y;){if(v=y._next,(y._act||p>=y._start)&&y._ts&&w!==y){if(y.parent!==this)return this.render(i,r,o);if(y.render(y._ts>0?(p-y._start)*y._ts:(y._dirty?y.totalDuration():y._tDur)+(p-y._start)*y._ts,r,o),p!==this._time||!this._ts&&!A){w=0,v&&(h+=this._zTime=-qn);break}}y=v}else{y=this._last;for(var P=i<0?i:p;y;){if(v=y._prev,(y._act||P<=y._end)&&y._ts&&w!==y){if(y.parent!==this)return this.render(i,r,o);if(y.render(y._ts>0?(P-y._start)*y._ts:(y._dirty?y.totalDuration():y._tDur)+(P-y._start)*y._ts,r,o||Ur&&(y._initted||y._startAt)),p!==this._time||!this._ts&&!A){w=0,v&&(h+=this._zTime=P?-qn:qn);break}}y=v}}if(w&&!r&&(this.pause(),w.render(p>=a?0:-qn)._zTime=p>=a?1:-1,this._ts))return this._start=C,l_(this),this.render(i,r,o);this._onUpdate&&!r&&Xs(this,"onUpdate",!0),(h===l&&this._tTime>=this.totalDuration()||!h&&a)&&(C===this._start||Math.abs(M)!==Math.abs(this._ts))&&(this._lock||((i||!c)&&(h===l&&this._ts>0||!h&&this._ts<0)&&tu(this,1),!r&&!(i<0&&!a)&&(h||a||!l)&&(Xs(this,h===l&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(i,r){var o=this;if(Yl(r)||(r=yo(this,r,i)),!(i instanceof S0)){if(Gr(i))return i.forEach(function(a){return o.add(a,r)}),this;if(pr(i))return this.addLabel(i,r);if(Ai(i))i=Ni.delayedCall(0,i);else return this}return this!==i?Ra(this,i,r):this},t.getChildren=function(i,r,o,a){i===void 0&&(i=!0),r===void 0&&(r=!0),o===void 0&&(o=!0),a===void 0&&(a=-Eo);for(var l=[],c=this._first;c;)c._start>=a&&(c instanceof Ni?r&&l.push(c):(o&&l.push(c),i&&l.push.apply(l,c.getChildren(!0,r,o)))),c=c._next;return l},t.getById=function(i){for(var r=this.getChildren(1,1,1),o=r.length;o--;)if(r[o].vars.id===i)return r[o]},t.remove=function(i){return pr(i)?this.removeLabel(i):Ai(i)?this.killTweensOf(i):(a_(this,i),i===this._recent&&(this._recent=this._last),Dh(this))},t.totalTime=function(i,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=cr(Vs.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),s.prototype.totalTime.call(this,i,r),this._forcing=0,this):this._tTime},t.addLabel=function(i,r){return this.labels[i]=yo(this,r),this},t.removeLabel=function(i){return delete this.labels[i],this},t.addPause=function(i,r,o){var a=Ni.delayedCall(0,r||v0,o);return a.data="isPause",this._hasPause=1,Ra(this,a,yo(this,i))},t.removePause=function(i){var r=this._first;for(i=yo(this,i);r;)r._start===i&&r.data==="isPause"&&tu(r),r=r._next},t.killTweensOf=function(i,r,o){for(var a=this.getTweensOf(i,o),l=a.length;l--;)Vc!==a[l]&&a[l].kill(i,r);return this},t.getTweensOf=function(i,r){for(var o=[],a=To(i),l=this._first,c=Yl(r),h;l;)l instanceof Ni?T7(l._targets,a)&&(c?(!Vc||l._initted&&l._ts)&&l.globalTime(0)<=r&&l.globalTime(l.totalDuration())>r:!r||l.isActive())&&o.push(l):(h=l.getTweensOf(a,r)).length&&o.push.apply(o,h),l=l._next;return o},t.tweenTo=function(i,r){r=r||{};var o=this,a=yo(o,i),l=r,c=l.startAt,h=l.onStart,f=l.onStartParams,p=l.immediateRender,y,v=Ni.to(o,bo({ease:r.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:r.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale())||qn,onStart:function(){if(o.pause(),!y){var S=r.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale());v._dur!==S&&hp(v,S,0,1).render(v._time,!0,!0),y=1}h&&h.apply(v,f||[])}},r));return p?v.render(0):v},t.tweenFromTo=function(i,r,o){return this.tweenTo(r,bo({startAt:{time:yo(this,i)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(i){return i===void 0&&(i=this._time),Nb(this,yo(this,i))},t.previousLabel=function(i){return i===void 0&&(i=this._time),Nb(this,yo(this,i),1)},t.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+qn)},t.shiftChildren=function(i,r,o){o===void 0&&(o=0);for(var a=this._first,l=this.labels,c;a;)a._start>=o&&(a._start+=i,a._end+=i),a=a._next;if(r)for(c in l)l[c]>=o&&(l[c]+=i);return Dh(this)},t.invalidate=function(i){var r=this._first;for(this._lock=0;r;)r.invalidate(i),r=r._next;return s.prototype.invalidate.call(this,i)},t.clear=function(i){i===void 0&&(i=!0);for(var r=this._first,o;r;)o=r._next,this.remove(r),r=o;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),Dh(this)},t.totalDuration=function(i){var r=0,o=this,a=o._last,l=Eo,c,h,f;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-i:i));if(o._dirty){for(f=o.parent;a;)c=a._prev,a._dirty&&a.totalDuration(),h=a._start,h>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,Ra(o,a,h-a._delay,1)._lock=0):l=h,h<0&&a._ts&&(r-=h,(!f&&!o._dp||f&&f.smoothChildTiming)&&(o._start+=h/o._ts,o._time-=h,o._tTime-=h),o.shiftChildren(-h,!1,-1/0),l=0),a._end>r&&a._ts&&(r=a._end),a=c;hp(o,o===hi&&o._time>r?o._time:r,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(i){if(hi._ts&&(_3(hi,gx(i,hi)),v3=Vs.frame),Vs.frame>=Ob){Ob+=Ys.autoSleep||120;var r=hi._first;if((!r||!r._ts)&&Ys.autoSleep&&Vs._listeners.length<2){for(;r&&!r._ts;)r=r._next;r||Vs.sleep()}}},e}(S0);bo(is.prototype,{_lock:0,_hasPause:0,_forcing:0});var X7=function(e,t,n,i,r,o,a){var l=new Ms(this._pt,e,t,0,1,$3,null,r),c=0,h=0,f,p,y,v,_,S,A,w;for(l.b=n,l.e=i,n+="",i+="",(A=~i.indexOf("random("))&&(i=x0(i)),o&&(w=[n,i],o(w,e,t),n=w[0],i=w[1]),p=n.match(AS)||[];f=AS.exec(i);)v=f[0],_=i.substring(c,f.index),y?y=(y+1)%5:_.substr(-5)==="rgba("&&(y=1),v!==p[h++]&&(S=parseFloat(p[h-1])||0,l._pt={_next:l._pt,p:_||h===1?_:",",s:S,c:v.charAt(1)==="="?Xf(S,v)-S:parseFloat(v)-S,m:y&&y<4?Math.round:0},c=AS.lastIndex);return l.c=c<i.length?i.substring(c,i.length):"",l.fp=a,(f3.test(i)||A)&&(l.e=0),this._pt=l,l},cT=function(e,t,n,i,r,o,a,l,c,h){Ai(i)&&(i=i(r||0,e,o));var f=e[t],p=n!=="get"?n:Ai(f)?c?e[t.indexOf("set")||!Ai(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():f,y=Ai(f)?c?Q7:K3:hT,v;if(pr(i)&&(~i.indexOf("random(")&&(i=x0(i)),i.charAt(1)==="="&&(v=Xf(p,i)+(kr(p)||0),(v||v===0)&&(i=v))),!h||p!==i||bA)return!isNaN(p*i)&&i!==""?(v=new Ms(this._pt,e,t,+p||0,i-(p||0),typeof f=="boolean"?eV:X3,0,y),c&&(v.fp=c),a&&v.modifier(a,this,e),this._pt=v):(!f&&!(t in e)&&sT(t,i),X7.call(this,e,t,p,i,y,l||Ys.stringFilter,c))},$7=function(e,t,n,i,r){if(Ai(e)&&(e=t0(e,r,t,n,i)),!za(e)||e.style&&e.nodeType||Gr(e)||h3(e))return pr(e)?t0(e,r,t,n,i):e;var o={},a;for(a in e)o[a]=t0(e[a],r,t,n,i);return o},j3=function(e,t,n,i,r,o){var a,l,c,h;if(js[e]&&(a=new js[e]).init(r,a.rawVars?t[e]:$7(t[e],i,r,o,n),n,i,o)!==!1&&(n._pt=l=new Ms(n._pt,r,e,0,1,a.render,a,0,a.priority),n!==zf))for(c=n._ptLookup[n._targets.indexOf(r)],h=a._props.length;h--;)c[a._props[h]]=l;return a},Vc,bA,uT=function s(e,t,n){var i=e.vars,r=i.ease,o=i.startAt,a=i.immediateRender,l=i.lazy,c=i.onUpdate,h=i.runBackwards,f=i.yoyoEase,p=i.keyframes,y=i.autoRevert,v=e._dur,_=e._startAt,S=e._targets,A=e.parent,w=A&&A.data==="nested"?A.vars.targets:S,M=e._overwrite==="auto"&&!tT,C=e.timeline,I,O,k,N,B,P,G,Z,Y,se,oe,re,ce;if(C&&(!p||!r)&&(r="none"),e._ease=Oh(r,cp.ease),e._yEase=f?U3(Oh(f===!0?r:f,cp.ease)):0,f&&e._yoyo&&!e._repeat&&(f=e._yEase,e._yEase=e._ease,e._ease=f),e._from=!C&&!!i.runBackwards,!C||p&&!i.stagger){if(Z=S[0]?Ph(S[0]).harness:0,re=Z&&i[Z.prop],I=mx(i,oT),_&&(_._zTime<0&&_.progress(1),t<0&&h&&a&&!y?_.render(-1,!0):_.revert(h&&v?uv:A7),_._lazy=0),o){if(tu(e._startAt=Ni.set(S,bo({data:"isStart",overwrite:!1,parent:A,immediateRender:!0,lazy:!_&&Ts(l),startAt:null,delay:0,onUpdate:c&&function(){return Xs(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Ur||!a&&!y)&&e._startAt.revert(uv),a&&v&&t<=0&&n<=0){t&&(e._zTime=t);return}}else if(h&&v&&!_){if(t&&(a=!1),k=bo({overwrite:!1,data:"isFromStart",lazy:a&&!_&&Ts(l),immediateRender:a,stagger:0,parent:A},I),re&&(k[Z.prop]=re),tu(e._startAt=Ni.set(S,k)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Ur?e._startAt.revert(uv):e._startAt.render(-1,!0)),e._zTime=t,!a)s(e._startAt,qn,qn);else if(!t)return}for(e._pt=e._ptCache=0,l=v&&Ts(l)||l&&!v,O=0;O<S.length;O++){if(B=S[O],G=B._gsap||lT(S)[O]._gsap,e._ptLookup[O]=se={},SA[G.id]&&$c.length&&px(),oe=w===S?O:w.indexOf(B),Z&&(Y=new Z).init(B,re||I,e,oe,w)!==!1&&(e._pt=N=new Ms(e._pt,B,Y.name,0,1,Y.render,Y,0,Y.priority),Y._props.forEach(function(H){se[H]=N}),Y.priority&&(P=1)),!Z||re)for(k in I)js[k]&&(Y=j3(k,I,e,oe,B,w))?Y.priority&&(P=1):se[k]=N=cT.call(e,B,k,"get",I[k],oe,w,0,i.stringFilter);e._op&&e._op[O]&&e.kill(B,e._op[O]),M&&e._pt&&(Vc=e,hi.killTweensOf(B,se,e.globalTime(t)),ce=!e.parent,Vc=0),e._pt&&l&&(SA[G.id]=1)}P&&Y3(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!ce,p&&t<=0&&C.render(Eo,!0,!0)},Y7=function(e,t,n,i,r,o,a,l){var c=(e._pt&&e._ptCache||(e._ptCache={}))[t],h,f,p,y;if(!c)for(c=e._ptCache[t]=[],p=e._ptLookup,y=e._targets.length;y--;){if(h=p[y][t],h&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==t&&h.fp!==t;)h=h._next;if(!h)return bA=1,e.vars[t]="+=0",uT(e,a),bA=0,l?y0(t+" not eligible for reset"):1;c.push(h)}for(y=c.length;y--;)f=c[y],h=f._pt||f,h.s=(i||i===0)&&!r?i:h.s+(i||0)+o*h.c,h.c=n-h.s,f.e&&(f.e=bi(n)+kr(f.e)),f.b&&(f.b=h.s+kr(f.b))},J7=function(e,t){var n=e[0]?Ph(e[0]).harness:0,i=n&&n.aliases,r,o,a,l;if(!i)return t;r=Kh({},t);for(o in i)if(o in r)for(l=i[o].split(","),a=l.length;a--;)r[l[a]]=r[o];return r},q7=function(e,t,n,i){var r=t.ease||i||"power1.inOut",o,a;if(Gr(t))a=n[e]||(n[e]=[]),t.forEach(function(l,c){return a.push({t:c/(t.length-1)*100,v:l,e:r})});else for(o in t)a=n[o]||(n[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:t[o],e:r})},t0=function(e,t,n,i,r){return Ai(e)?e.call(t,n,i,r):pr(e)&&~e.indexOf("random(")?x0(e):e},V3=aT+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",W3={};ws(V3+",id,stagger,delay,duration,paused,scrollTrigger",function(s){return W3[s]=1});var Ni=function(s){c3(e,s);function e(n,i,r,o){var a;typeof i=="number"&&(r.duration=i,i=r,r=null),a=s.call(this,o?i:Zm(i))||this;var l=a.vars,c=l.duration,h=l.delay,f=l.immediateRender,p=l.stagger,y=l.overwrite,v=l.keyframes,_=l.defaults,S=l.scrollTrigger,A=l.yoyoEase,w=i.parent||hi,M=(Gr(n)||h3(n)?Yl(n[0]):"length"in i)?[n]:To(n),C,I,O,k,N,B,P,G;if(a._targets=M.length?lT(M):y0("GSAP target "+n+" not found. https://gsap.com",!Ys.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=y,v||p||$y(c)||$y(h)){if(i=a.vars,C=a.timeline=new is({data:"nested",defaults:_||{},targets:w&&w.data==="nested"?w.vars.targets:M}),C.kill(),C.parent=C._dp=Bl(a),C._start=0,p||$y(c)||$y(h)){if(k=M.length,P=p&&R3(p),za(p))for(N in p)~V3.indexOf(N)&&(G||(G={}),G[N]=p[N]);for(I=0;I<k;I++)O=mx(i,W3),O.stagger=0,A&&(O.yoyoEase=A),G&&Kh(O,G),B=M[I],O.duration=+t0(c,Bl(a),I,B,M),O.delay=(+t0(h,Bl(a),I,B,M)||0)-a._delay,!p&&k===1&&O.delay&&(a._delay=h=O.delay,a._start+=h,O.delay=0),C.to(B,O,P?P(I,B,M):0),C._ease=Sn.none;C.duration()?c=h=0:a.timeline=0}else if(v){Zm(bo(C.vars.defaults,{ease:"none"})),C._ease=Oh(v.ease||i.ease||"none");var Z=0,Y,se,oe;if(Gr(v))v.forEach(function(re){return C.to(M,re,">")}),C.duration();else{O={};for(N in v)N==="ease"||N==="easeEach"||q7(N,v[N],O,v.easeEach);for(N in O)for(Y=O[N].sort(function(re,ce){return re.t-ce.t}),Z=0,I=0;I<Y.length;I++)se=Y[I],oe={ease:se.e,duration:(se.t-(I?Y[I-1].t:0))/100*c},oe[N]=se.v,C.to(M,oe,Z),Z+=oe.duration;C.duration()<c&&C.to({},{duration:c-C.duration()})}}c||a.duration(c=C.duration())}else a.timeline=0;return y===!0&&!tT&&(Vc=Bl(a),hi.killTweensOf(M),Vc=0),Ra(w,Bl(a),r),i.reversed&&a.reverse(),i.paused&&a.paused(!0),(f||!c&&!v&&a._start===cr(w._time)&&Ts(f)&&C7(Bl(a))&&w.data!=="nested")&&(a._tTime=-qn,a.render(Math.max(0,-h)||0)),S&&w3(Bl(a),S),a}var t=e.prototype;return t.render=function(i,r,o){var a=this._time,l=this._tDur,c=this._dur,h=i<0,f=i>l-qn&&!h?l:i<qn?0:i,p,y,v,_,S,A,w,M,C;if(!c)I7(this,i,r,o);else if(f!==this._tTime||!i||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==h){if(p=f,M=this.timeline,this._repeat){if(_=c+this._rDelay,this._repeat<-1&&h)return this.totalTime(_*100+i,r,o);if(p=cr(f%_),f===l?(v=this._repeat,p=c):(v=~~(f/_),v&&v===cr(f/_)&&(p=c,v--),p>c&&(p=c)),A=this._yoyo&&v&1,A&&(C=this._yEase,p=c-p),S=up(this._tTime,_),p===a&&!o&&this._initted&&v===S)return this._tTime=f,this;v!==S&&(M&&this._yEase&&G3(M,A),this.vars.repeatRefresh&&!A&&!this._lock&&this._time!==_&&this._initted&&(this._lock=o=1,this.render(cr(_*v),!0).invalidate()._lock=0))}if(!this._initted){if(M3(this,h?i:p,o,r,f))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&v!==S))return this;if(c!==this._dur)return this.render(i,r,o)}if(this._tTime=f,this._time=p,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=w=(C||this._ease)(p/c),this._from&&(this.ratio=w=1-w),p&&!a&&!r&&!v&&(Xs(this,"onStart"),this._tTime!==f))return this;for(y=this._pt;y;)y.r(w,y.d),y=y._next;M&&M.render(i<0?i:M._dur*M._ease(p/this._dur),r,o)||this._startAt&&(this._zTime=i),this._onUpdate&&!r&&(h&&AA(this,i,r,o),Xs(this,"onUpdate")),this._repeat&&v!==S&&this.vars.onRepeat&&!r&&this.parent&&Xs(this,"onRepeat"),(f===this._tDur||!f)&&this._tTime===f&&(h&&!this._onUpdate&&AA(this,i,!0,!0),(i||!c)&&(f===this._tDur&&this._ts>0||!f&&this._ts<0)&&tu(this,1),!r&&!(h&&!a)&&(f||a||A)&&(Xs(this,f===l?"onComplete":"onReverseComplete",!0),this._prom&&!(f<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),s.prototype.invalidate.call(this,i)},t.resetTo=function(i,r,o,a,l){_0||Vs.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),h;return this._initted||uT(this,c),h=this._ease(c/this._dur),Y7(this,i,r,o,a,h,c,l)?this.resetTo(i,r,o,a,1):(c_(this,0),this.parent||E3(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(i,r){if(r===void 0&&(r="all"),!i&&(!r||r==="all"))return this._lazy=this._pt=0,this.parent?Gm(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(i,r,Vc&&Vc.vars.overwrite!==!0)._first||Gm(this),this.parent&&o!==this.timeline.totalDuration()&&hp(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=i?To(i):a,c=this._ptLookup,h=this._pt,f,p,y,v,_,S,A;if((!r||r==="all")&&M7(a,l))return r==="all"&&(this._pt=0),Gm(this);for(f=this._op=this._op||[],r!=="all"&&(pr(r)&&(_={},ws(r,function(w){return _[w]=1}),r=_),r=J7(a,r)),A=a.length;A--;)if(~l.indexOf(a[A])){p=c[A],r==="all"?(f[A]=r,v=p,y={}):(y=f[A]=f[A]||{},v=r);for(_ in v)S=p&&p[_],S&&((!("kill"in S.d)||S.d.kill(_)===!0)&&a_(this,S,"_pt"),delete p[_]),y!=="all"&&(y[_]=1)}return this._initted&&!this._pt&&h&&Gm(this),this},e.to=function(i,r){return new e(i,r,arguments[2])},e.from=function(i,r){return e0(1,arguments)},e.delayedCall=function(i,r,o,a){return new e(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:r,onReverseComplete:r,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(i,r,o){return e0(2,arguments)},e.set=function(i,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new e(i,r)},e.killTweensOf=function(i,r,o){return hi.killTweensOf(i,r,o)},e}(S0);bo(Ni.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});ws("staggerTo,staggerFrom,staggerFromTo",function(s){Ni[s]=function(){var e=new is,t=TA.call(arguments,0);return t.splice(s==="staggerFromTo"?5:4,0,0),e[s].apply(e,t)}});var hT=function(e,t,n){return e[t]=n},K3=function(e,t,n){return e[t](n)},Q7=function(e,t,n,i){return e[t](i.fp,n)},Z7=function(e,t,n){return e.setAttribute(t,n)},dT=function(e,t){return Ai(e[t])?K3:nT(e[t])&&e.setAttribute?Z7:hT},X3=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},eV=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},$3=function(e,t){var n=t._pt,i="";if(!e&&t.b)i=t.b;else if(e===1&&t.e)i=t.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*e):Math.round((n.s+n.c*e)*1e4)/1e4)+i,n=n._next;i+=t.c}t.set(t.t,t.p,i,t)},fT=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},tV=function(e,t,n,i){for(var r=this._pt,o;r;)o=r._next,r.p===i&&r.modifier(e,t,n),r=o},nV=function(e){for(var t=this._pt,n,i;t;)i=t._next,t.p===e&&!t.op||t.op===e?a_(this,t,"_pt"):t.dep||(n=1),t=i;return!n},iV=function(e,t,n,i){i.mSet(e,t,i.m.call(i.tween,n,i.mt),i)},Y3=function(e){for(var t=e._pt,n,i,r,o;t;){for(n=t._next,i=r;i&&i.pr>t.pr;)i=i._next;(t._prev=i?i._prev:o)?t._prev._next=t:r=t,(t._next=i)?i._prev=t:o=t,t=n}e._pt=r},Ms=function(){function s(t,n,i,r,o,a,l,c,h){this.t=n,this.s=r,this.c=o,this.p=i,this.r=a||X3,this.d=l||this,this.set=c||hT,this.pr=h||0,this._next=t,t&&(t._prev=this)}var e=s.prototype;return e.modifier=function(n,i,r){this.mSet=this.mSet||this.set,this.set=iV,this.m=n,this.mt=r,this.tween=i},s}();ws(aT+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(s){return oT[s]=1});Qs.TweenMax=Qs.TweenLite=Ni;Qs.TimelineLite=Qs.TimelineMax=is;hi=new is({sortChildren:!1,defaults:cp,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Ys.stringFilter=N3;var Bh=[],dv={},rV=[],Gb=0,sV=0,bS=function(e){return(dv[e]||rV).map(function(t){return t()})},CA=function(){var e=Date.now(),t=[];e-Gb>2&&(bS("matchMediaInit"),Bh.forEach(function(n){var i=n.queries,r=n.conditions,o,a,l,c;for(a in i)o=ba.matchMedia(i[a]).matches,o&&(l=1),o!==r[a]&&(r[a]=o,c=1);c&&(n.revert(),l&&t.push(n))}),bS("matchMediaRevert"),t.forEach(function(n){return n.onMatch(n,function(i){return n.add(null,i)})}),Gb=e,bS("matchMedia"))},J3=function(){function s(t,n){this.selector=n&&wA(n),this.data=[],this._r=[],this.isReverted=!1,this.id=sV++,t&&this.add(t)}var e=s.prototype;return e.add=function(n,i,r){Ai(n)&&(r=i,i=n,n=Ai);var o=this,a=function(){var c=oi,h=o.selector,f;return c&&c!==o&&c.data.push(o),r&&(o.selector=wA(r)),oi=o,f=i.apply(o,arguments),Ai(f)&&o._r.push(f),oi=c,o.selector=h,o.isReverted=!1,f};return o.last=a,n===Ai?a(o,function(l){return o.add(null,l)}):n?o[n]=a:a},e.ignore=function(n){var i=oi;oi=null,n(this),oi=i},e.getTweens=function(){var n=[];return this.data.forEach(function(i){return i instanceof s?n.push.apply(n,i.getTweens()):i instanceof Ni&&!(i.parent&&i.parent.data==="nested")&&n.push(i)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,i){var r=this;if(n?function(){for(var a=r.getTweens(),l=r.data.length,c;l--;)c=r.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(h){return a.splice(a.indexOf(h),1)}));for(a.map(function(h){return{g:h._dur||h._delay||h._sat&&!h._sat.vars.immediateRender?h.globalTime(0):-1/0,t:h}}).sort(function(h,f){return f.g-h.g||-1/0}).forEach(function(h){return h.t.revert(n)}),l=r.data.length;l--;)c=r.data[l],c instanceof is?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof Ni)&&c.revert&&c.revert(n);r._r.forEach(function(h){return h(n,r)}),r.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),i)for(var o=Bh.length;o--;)Bh[o].id===this.id&&Bh.splice(o,1)},e.revert=function(n){this.kill(n||{})},s}(),oV=function(){function s(t){this.contexts=[],this.scope=t,oi&&oi.data.push(this)}var e=s.prototype;return e.add=function(n,i,r){za(n)||(n={matches:n});var o=new J3(0,r||this.scope),a=o.conditions={},l,c,h;oi&&!o.selector&&(o.selector=oi.selector),this.contexts.push(o),i=o.add("onMatch",i),o.queries=n;for(c in n)c==="all"?h=1:(l=ba.matchMedia(n[c]),l&&(Bh.indexOf(o)<0&&Bh.push(o),(a[c]=l.matches)&&(h=1),l.addListener?l.addListener(CA):l.addEventListener("change",CA)));return h&&i(o,function(f){return o.add(null,f)}),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(i){return i.kill(n,!0)})},s}(),yx={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(i){return B3(i)})},timeline:function(e){return new is(e)},getTweensOf:function(e,t){return hi.getTweensOf(e,t)},getProperty:function(e,t,n,i){pr(e)&&(e=To(e)[0]);var r=Ph(e||{}).get,o=n?A3:S3;return n==="native"&&(n=""),e&&(t?o((js[t]&&js[t].get||r)(e,t,n,i)):function(a,l,c){return o((js[a]&&js[a].get||r)(e,a,l,c))})},quickSetter:function(e,t,n){if(e=To(e),e.length>1){var i=e.map(function(h){return Cs.quickSetter(h,t,n)}),r=i.length;return function(h){for(var f=r;f--;)i[f](h)}}e=e[0]||{};var o=js[t],a=Ph(e),l=a.harness&&(a.harness.aliases||{})[t]||t,c=o?function(h){var f=new o;zf._pt=0,f.init(e,n?h+n:h,zf,0,[e]),f.render(1,f),zf._pt&&fT(1,zf)}:a.set(e,l);return o?c:function(h){return c(e,l,n?h+n:h,a,1)}},quickTo:function(e,t,n){var i,r=Cs.to(e,Kh((i={},i[t]="+=0.1",i.paused=!0,i),n||{})),o=function(l,c,h){return r.resetTo(t,l,c,h)};return o.tween=r,o},isTweening:function(e){return hi.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Oh(e.ease,cp.ease)),Bb(cp,e||{})},config:function(e){return Bb(Ys,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,i=e.plugins,r=e.defaults,o=e.extendTimeline;(i||"").split(",").forEach(function(a){return a&&!js[a]&&!Qs[a]&&y0(t+" effect requires "+a+" plugin.")}),ES[t]=function(a,l,c){return n(To(a),bo(l||{},r),c)},o&&(is.prototype[t]=function(a,l,c){return this.add(ES[t](a,za(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,t){Sn[e]=Oh(t)},parseEase:function(e,t){return arguments.length?Oh(e,t):Sn},getById:function(e){return hi.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var n=new is(e),i,r;for(n.smoothChildTiming=Ts(e.smoothChildTiming),hi.remove(n),n._dp=0,n._time=n._tTime=hi._time,i=hi._first;i;)r=i._next,(t||!(!i._dur&&i instanceof Ni&&i.vars.onComplete===i._targets[0]))&&Ra(n,i,i._start-i._delay),i=r;return Ra(hi,n,0),n},context:function(e,t){return e?new J3(e,t):oi},matchMedia:function(e){return new oV(e)},matchMediaRefresh:function(){return Bh.forEach(function(e){var t=e.conditions,n,i;for(i in t)t[i]&&(t[i]=!1,n=1);n&&e.revert()})||CA()},addEventListener:function(e,t){var n=dv[e]||(dv[e]=[]);~n.indexOf(t)||n.push(t)},removeEventListener:function(e,t){var n=dv[e],i=n&&n.indexOf(t);i>=0&&n.splice(i,1)},utils:{wrap:N7,wrapYoyo:U7,distribute:R3,random:L3,snap:I3,normalize:k7,getUnit:kr,clamp:D7,splitColor:F3,toArray:To,selector:wA,mapRange:D3,pipe:B7,unitize:F7,interpolate:G7,shuffle:C3},install:g3,effects:ES,ticker:Vs,updateRoot:is.updateRoot,plugins:js,globalTimeline:hi,core:{PropTween:Ms,globals:y3,Tween:Ni,Timeline:is,Animation:S0,getCache:Ph,_removeLinkedListItem:a_,reverting:function(){return Ur},context:function(e){return e&&oi&&(oi.data.push(e),e._ctx=oi),oi},suppressOverwrites:function(e){return tT=e}}};ws("to,from,fromTo,delayedCall,set,killTweensOf",function(s){return yx[s]=Ni[s]});Vs.add(is.updateRoot);zf=yx.to({},{duration:0});var aV=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},lV=function(e,t){var n=e._targets,i,r,o;for(i in t)for(r=n.length;r--;)o=e._ptLookup[r][i],o&&(o=o.d)&&(o._pt&&(o=aV(o,i)),o&&o.modifier&&o.modifier(t[i],e,n[r],i))},CS=function(e,t){return{name:e,rawVars:1,init:function(i,r,o){o._onInit=function(a){var l,c;if(pr(r)&&(l={},ws(r,function(h){return l[h]=1}),r=l),t){l={};for(c in r)l[c]=t(r[c]);r=l}lV(a,r)}}}},Cs=yx.registerPlugin({name:"attr",init:function(e,t,n,i,r){var o,a,l;this.tween=n;for(o in t)l=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(l||0)+"",t[o],i,r,0,0,o),a.op=o,a.b=l,this._props.push(o)},render:function(e,t){for(var n=t._pt;n;)Ur?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n],0,0,0,0,0,1)}},CS("roundProps",MA),CS("modifiers"),CS("snap",I3))||yx;Ni.version=is.version=Cs.version="3.12.5";m3=1;iT()&&dp();Sn.Power0;Sn.Power1;Sn.Power2;Sn.Power3;Sn.Power4;Sn.Linear;Sn.Quad;Sn.Cubic;Sn.Quart;Sn.Quint;Sn.Strong;Sn.Elastic;Sn.Back;Sn.SteppedEase;Sn.Bounce;Sn.Sine;Sn.Expo;Sn.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Hb,Wc,$f,pT,Th,zb,mT,cV=function(){return typeof window<"u"},Jl={},ph=180/Math.PI,Yf=Math.PI/180,Lf=Math.atan2,jb=1e8,gT=/([A-Z])/g,uV=/(left|right|width|margin|padding|x)/i,hV=/[\s,\(]\S/,Da={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},RA=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},dV=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},fV=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},pV=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},q3=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Q3=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},mV=function(e,t,n){return e.style[t]=n},gV=function(e,t,n){return e.style.setProperty(t,n)},yV=function(e,t,n){return e._gsap[t]=n},vV=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},xV=function(e,t,n,i,r){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(r,o)},_V=function(e,t,n,i,r){var o=e._gsap;o[t]=n,o.renderTransform(r,o)},fi="transform",bs=fi+"Origin",SV=function s(e,t){var n=this,i=this.target,r=i.style,o=i._gsap;if(e in Jl&&r){if(this.tfm=this.tfm||{},e!=="transform")e=Da[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return n.tfm[a]=kl(i,a)}):this.tfm[e]=o.x?o[e]:kl(i,e),e===bs&&(this.tfm.zOrigin=o.zOrigin);else return Da.transform.split(",").forEach(function(a){return s.call(n,a,t)});if(this.props.indexOf(fi)>=0)return;o.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(bs,t,"")),e=fi}(r||t)&&this.props.push(e,t,r[e])},Z3=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},AV=function(){var e=this.props,t=this.target,n=t.style,i=t._gsap,r,o;for(r=0;r<e.length;r+=3)e[r+1]?t[e[r]]=e[r+2]:e[r+2]?n[e[r]]=e[r+2]:n.removeProperty(e[r].substr(0,2)==="--"?e[r]:e[r].replace(gT,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)i[o]=this.tfm[o];i.svg&&(i.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),r=mT(),(!r||!r.isStart)&&!n[fi]&&(Z3(n),i.zOrigin&&n[bs]&&(n[bs]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},eP=function(e,t){var n={target:e,props:[],revert:AV,save:SV};return e._gsap||Cs.core.getCache(e),t&&t.split(",").forEach(function(i){return n.save(i)}),n},tP,IA=function(e,t){var n=Wc.createElementNS?Wc.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Wc.createElement(e);return n&&n.style?n:Wc.createElement(e)},Na=function s(e,t,n){var i=getComputedStyle(e);return i[t]||i.getPropertyValue(t.replace(gT,"-$1").toLowerCase())||i.getPropertyValue(t)||!n&&s(e,fp(t)||t,1)||""},Vb="O,Moz,ms,Ms,Webkit".split(","),fp=function(e,t,n){var i=t||Th,r=i.style,o=5;if(e in r&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(Vb[o]+e in r););return o<0?null:(o===3?"ms":o>=0?Vb[o]:"")+e},LA=function(){cV()&&window.document&&(Hb=window,Wc=Hb.document,$f=Wc.documentElement,Th=IA("div")||{style:{}},IA("div"),fi=fp(fi),bs=fi+"Origin",Th.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",tP=!!fp("perspective"),mT=Cs.core.reverting,pT=1)},RS=function s(e){var t=IA("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,i=this.nextSibling,r=this.style.cssText,o;if($f.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=s}catch{}else this._gsapBBox&&(o=this._gsapBBox());return n&&(i?n.insertBefore(this,i):n.appendChild(this)),$f.removeChild(t),this.style.cssText=r,o},Wb=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},nP=function(e){var t;try{t=e.getBBox()}catch{t=RS.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===RS||(t=RS.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+Wb(e,["x","cx","x1"])||0,y:+Wb(e,["y","cy","y1"])||0,width:0,height:0}:t},iP=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&nP(e))},Xh=function(e,t){if(t){var n=e.style,i;t in Jl&&t!==bs&&(t=fi),n.removeProperty?(i=t.substr(0,2),(i==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),n.removeProperty(i==="--"?t:t.replace(gT,"-$1").toLowerCase())):n.removeAttribute(t)}},Kc=function(e,t,n,i,r,o){var a=new Ms(e._pt,t,n,0,1,o?Q3:q3);return e._pt=a,a.b=i,a.e=r,e._props.push(n),a},Kb={deg:1,rad:1,turn:1},EV={grid:1,flex:1},nu=function s(e,t,n,i){var r=parseFloat(n)||0,o=(n+"").trim().substr((r+"").length)||"px",a=Th.style,l=uV.test(t),c=e.tagName.toLowerCase()==="svg",h=(c?"client":"offset")+(l?"Width":"Height"),f=100,p=i==="px",y=i==="%",v,_,S,A;if(i===o||!r||Kb[i]||Kb[o])return r;if(o!=="px"&&!p&&(r=s(e,t,n,"px")),A=e.getCTM&&iP(e),(y||o==="%")&&(Jl[t]||~t.indexOf("adius")))return v=A?e.getBBox()[l?"width":"height"]:e[h],bi(y?r/v*f:r/100*v);if(a[l?"width":"height"]=f+(p?o:i),_=~t.indexOf("adius")||i==="em"&&e.appendChild&&!c?e:e.parentNode,A&&(_=(e.ownerSVGElement||{}).parentNode),(!_||_===Wc||!_.appendChild)&&(_=Wc.body),S=_._gsap,S&&y&&S.width&&l&&S.time===Vs.time&&!S.uncache)return bi(r/S.width*f);if(y&&(t==="height"||t==="width")){var w=e.style[t];e.style[t]=f+i,v=e[h],w?e.style[t]=w:Xh(e,t)}else(y||o==="%")&&!EV[Na(_,"display")]&&(a.position=Na(e,"position")),_===e&&(a.position="static"),_.appendChild(Th),v=Th[h],_.removeChild(Th),a.position="absolute";return l&&y&&(S=Ph(_),S.time=Vs.time,S.width=_[h]),bi(p?v*r/f:v&&r?f/v*r:0)},kl=function(e,t,n,i){var r;return pT||LA(),t in Da&&t!=="transform"&&(t=Da[t],~t.indexOf(",")&&(t=t.split(",")[0])),Jl[t]&&t!=="transform"?(r=E0(e,i),r=t!=="transformOrigin"?r[t]:r.svg?r.origin:xx(Na(e,bs))+" "+r.zOrigin+"px"):(r=e.style[t],(!r||r==="auto"||i||~(r+"").indexOf("calc("))&&(r=vx[t]&&vx[t](e,t,n)||Na(e,t)||x3(e,t)||(t==="opacity"?1:0))),n&&!~(r+"").trim().indexOf(" ")?nu(e,t,r,n)+n:r},TV=function(e,t,n,i){if(!n||n==="none"){var r=fp(t,e,1),o=r&&Na(e,r,1);o&&o!==n?(t=r,n=o):t==="borderColor"&&(n=Na(e,"borderTopColor"))}var a=new Ms(this._pt,e.style,t,0,1,$3),l=0,c=0,h,f,p,y,v,_,S,A,w,M,C,I;if(a.b=n,a.e=i,n+="",i+="",i==="auto"&&(_=e.style[t],e.style[t]=i,i=Na(e,t)||i,_?e.style[t]=_:Xh(e,t)),h=[n,i],N3(h),n=h[0],i=h[1],p=n.match(Hf)||[],I=i.match(Hf)||[],I.length){for(;f=Hf.exec(i);)S=f[0],w=i.substring(l,f.index),v?v=(v+1)%5:(w.substr(-5)==="rgba("||w.substr(-5)==="hsla(")&&(v=1),S!==(_=p[c++]||"")&&(y=parseFloat(_)||0,C=_.substr((y+"").length),S.charAt(1)==="="&&(S=Xf(y,S)+C),A=parseFloat(S),M=S.substr((A+"").length),l=Hf.lastIndex-M.length,M||(M=M||Ys.units[t]||C,l===i.length&&(i+=M,a.e+=M)),C!==M&&(y=nu(e,t,_,M)||0),a._pt={_next:a._pt,p:w||c===1?w:",",s:y,c:A-y,m:v&&v<4||t==="zIndex"?Math.round:0});a.c=l<i.length?i.substring(l,i.length):""}else a.r=t==="display"&&i==="none"?Q3:q3;return f3.test(i)&&(a.e=0),this._pt=a,a},Xb={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},wV=function(e){var t=e.split(" "),n=t[0],i=t[1]||"50%";return(n==="top"||n==="bottom"||i==="left"||i==="right")&&(e=n,n=i,i=e),t[0]=Xb[n]||n,t[1]=Xb[i]||i,t.join(" ")},MV=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n=t.t,i=n.style,r=t.u,o=n._gsap,a,l,c;if(r==="all"||r===!0)i.cssText="",l=1;else for(r=r.split(","),c=r.length;--c>-1;)a=r[c],Jl[a]&&(l=1,a=a==="transformOrigin"?bs:fi),Xh(n,a);l&&(Xh(n,fi),o&&(o.svg&&n.removeAttribute("transform"),E0(n,1),o.uncache=1,Z3(i)))}},vx={clearProps:function(e,t,n,i,r){if(r.data!=="isFromStart"){var o=e._pt=new Ms(e._pt,t,n,0,0,MV);return o.u=i,o.pr=-10,o.tween=r,e._props.push(n),1}}},A0=[1,0,0,1,0,0],rP={},sP=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},$b=function(e){var t=Na(e,fi);return sP(t)?A0:t.substr(7).match(d3).map(bi)},yT=function(e,t){var n=e._gsap||Ph(e),i=e.style,r=$b(e),o,a,l,c;return n.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,r=[l.a,l.b,l.c,l.d,l.e,l.f],r.join(",")==="1,0,0,1,0,0"?A0:r):(r===A0&&!e.offsetParent&&e!==$f&&!n.svg&&(l=i.display,i.display="block",o=e.parentNode,(!o||!e.offsetParent)&&(c=1,a=e.nextElementSibling,$f.appendChild(e)),r=$b(e),l?i.display=l:Xh(e,"display"),c&&(a?o.insertBefore(e,a):o?o.appendChild(e):$f.removeChild(e))),t&&r.length>6?[r[0],r[1],r[4],r[5],r[12],r[13]]:r)},PA=function(e,t,n,i,r,o){var a=e._gsap,l=r||yT(e,!0),c=a.xOrigin||0,h=a.yOrigin||0,f=a.xOffset||0,p=a.yOffset||0,y=l[0],v=l[1],_=l[2],S=l[3],A=l[4],w=l[5],M=t.split(" "),C=parseFloat(M[0])||0,I=parseFloat(M[1])||0,O,k,N,B;n?l!==A0&&(k=y*S-v*_)&&(N=C*(S/k)+I*(-_/k)+(_*w-S*A)/k,B=C*(-v/k)+I*(y/k)-(y*w-v*A)/k,C=N,I=B):(O=nP(e),C=O.x+(~M[0].indexOf("%")?C/100*O.width:C),I=O.y+(~(M[1]||M[0]).indexOf("%")?I/100*O.height:I)),i||i!==!1&&a.smooth?(A=C-c,w=I-h,a.xOffset=f+(A*y+w*_)-A,a.yOffset=p+(A*v+w*S)-w):a.xOffset=a.yOffset=0,a.xOrigin=C,a.yOrigin=I,a.smooth=!!i,a.origin=t,a.originIsAbsolute=!!n,e.style[bs]="0px 0px",o&&(Kc(o,a,"xOrigin",c,C),Kc(o,a,"yOrigin",h,I),Kc(o,a,"xOffset",f,a.xOffset),Kc(o,a,"yOffset",p,a.yOffset)),e.setAttribute("data-svg-origin",C+" "+I)},E0=function(e,t){var n=e._gsap||new z3(e);if("x"in n&&!t&&!n.uncache)return n;var i=e.style,r=n.scaleX<0,o="px",a="deg",l=getComputedStyle(e),c=Na(e,bs)||"0",h,f,p,y,v,_,S,A,w,M,C,I,O,k,N,B,P,G,Z,Y,se,oe,re,ce,H,$,X,W,ne,Ee,le,ye;return h=f=p=_=S=A=w=M=C=0,y=v=1,n.svg=!!(e.getCTM&&iP(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(i[fi]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[fi]!=="none"?l[fi]:"")),i.scale=i.rotate=i.translate="none"),k=yT(e,n.svg),n.svg&&(n.uncache?(H=e.getBBox(),c=n.xOrigin-H.x+"px "+(n.yOrigin-H.y)+"px",ce=""):ce=!t&&e.getAttribute("data-svg-origin"),PA(e,ce||c,!!ce||n.originIsAbsolute,n.smooth!==!1,k)),I=n.xOrigin||0,O=n.yOrigin||0,k!==A0&&(G=k[0],Z=k[1],Y=k[2],se=k[3],h=oe=k[4],f=re=k[5],k.length===6?(y=Math.sqrt(G*G+Z*Z),v=Math.sqrt(se*se+Y*Y),_=G||Z?Lf(Z,G)*ph:0,w=Y||se?Lf(Y,se)*ph+_:0,w&&(v*=Math.abs(Math.cos(w*Yf))),n.svg&&(h-=I-(I*G+O*Y),f-=O-(I*Z+O*se))):(ye=k[6],Ee=k[7],X=k[8],W=k[9],ne=k[10],le=k[11],h=k[12],f=k[13],p=k[14],N=Lf(ye,ne),S=N*ph,N&&(B=Math.cos(-N),P=Math.sin(-N),ce=oe*B+X*P,H=re*B+W*P,$=ye*B+ne*P,X=oe*-P+X*B,W=re*-P+W*B,ne=ye*-P+ne*B,le=Ee*-P+le*B,oe=ce,re=H,ye=$),N=Lf(-Y,ne),A=N*ph,N&&(B=Math.cos(-N),P=Math.sin(-N),ce=G*B-X*P,H=Z*B-W*P,$=Y*B-ne*P,le=se*P+le*B,G=ce,Z=H,Y=$),N=Lf(Z,G),_=N*ph,N&&(B=Math.cos(N),P=Math.sin(N),ce=G*B+Z*P,H=oe*B+re*P,Z=Z*B-G*P,re=re*B-oe*P,G=ce,oe=H),S&&Math.abs(S)+Math.abs(_)>359.9&&(S=_=0,A=180-A),y=bi(Math.sqrt(G*G+Z*Z+Y*Y)),v=bi(Math.sqrt(re*re+ye*ye)),N=Lf(oe,re),w=Math.abs(N)>2e-4?N*ph:0,C=le?1/(le<0?-le:le):0),n.svg&&(ce=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!sP(Na(e,fi)),ce&&e.setAttribute("transform",ce))),Math.abs(w)>90&&Math.abs(w)<270&&(r?(y*=-1,w+=_<=0?180:-180,_+=_<=0?180:-180):(v*=-1,w+=w<=0?180:-180)),t=t||n.uncache,n.x=h-((n.xPercent=h&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-h)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+o,n.y=f-((n.yPercent=f&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-f)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+o,n.z=p+o,n.scaleX=bi(y),n.scaleY=bi(v),n.rotation=bi(_)+a,n.rotationX=bi(S)+a,n.rotationY=bi(A)+a,n.skewX=w+a,n.skewY=M+a,n.transformPerspective=C+o,(n.zOrigin=parseFloat(c.split(" ")[2])||!t&&n.zOrigin||0)&&(i[bs]=xx(c)),n.xOffset=n.yOffset=0,n.force3D=Ys.force3D,n.renderTransform=n.svg?CV:tP?oP:bV,n.uncache=0,n},xx=function(e){return(e=e.split(" "))[0]+" "+e[1]},IS=function(e,t,n){var i=kr(t);return bi(parseFloat(t)+parseFloat(nu(e,"x",n+"px",i)))+i},bV=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,oP(e,t)},ah="0deg",Fm="0px",lh=") ",oP=function(e,t){var n=t||this,i=n.xPercent,r=n.yPercent,o=n.x,a=n.y,l=n.z,c=n.rotation,h=n.rotationY,f=n.rotationX,p=n.skewX,y=n.skewY,v=n.scaleX,_=n.scaleY,S=n.transformPerspective,A=n.force3D,w=n.target,M=n.zOrigin,C="",I=A==="auto"&&e&&e!==1||A===!0;if(M&&(f!==ah||h!==ah)){var O=parseFloat(h)*Yf,k=Math.sin(O),N=Math.cos(O),B;O=parseFloat(f)*Yf,B=Math.cos(O),o=IS(w,o,k*B*-M),a=IS(w,a,-Math.sin(O)*-M),l=IS(w,l,N*B*-M+M)}S!==Fm&&(C+="perspective("+S+lh),(i||r)&&(C+="translate("+i+"%, "+r+"%) "),(I||o!==Fm||a!==Fm||l!==Fm)&&(C+=l!==Fm||I?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+lh),c!==ah&&(C+="rotate("+c+lh),h!==ah&&(C+="rotateY("+h+lh),f!==ah&&(C+="rotateX("+f+lh),(p!==ah||y!==ah)&&(C+="skew("+p+", "+y+lh),(v!==1||_!==1)&&(C+="scale("+v+", "+_+lh),w.style[fi]=C||"translate(0, 0)"},CV=function(e,t){var n=t||this,i=n.xPercent,r=n.yPercent,o=n.x,a=n.y,l=n.rotation,c=n.skewX,h=n.skewY,f=n.scaleX,p=n.scaleY,y=n.target,v=n.xOrigin,_=n.yOrigin,S=n.xOffset,A=n.yOffset,w=n.forceCSS,M=parseFloat(o),C=parseFloat(a),I,O,k,N,B;l=parseFloat(l),c=parseFloat(c),h=parseFloat(h),h&&(h=parseFloat(h),c+=h,l+=h),l||c?(l*=Yf,c*=Yf,I=Math.cos(l)*f,O=Math.sin(l)*f,k=Math.sin(l-c)*-p,N=Math.cos(l-c)*p,c&&(h*=Yf,B=Math.tan(c-h),B=Math.sqrt(1+B*B),k*=B,N*=B,h&&(B=Math.tan(h),B=Math.sqrt(1+B*B),I*=B,O*=B)),I=bi(I),O=bi(O),k=bi(k),N=bi(N)):(I=f,N=p,O=k=0),(M&&!~(o+"").indexOf("px")||C&&!~(a+"").indexOf("px"))&&(M=nu(y,"x",o,"px"),C=nu(y,"y",a,"px")),(v||_||S||A)&&(M=bi(M+v-(v*I+_*k)+S),C=bi(C+_-(v*O+_*N)+A)),(i||r)&&(B=y.getBBox(),M=bi(M+i/100*B.width),C=bi(C+r/100*B.height)),B="matrix("+I+","+O+","+k+","+N+","+M+","+C+")",y.setAttribute("transform",B),w&&(y.style[fi]=B)},RV=function(e,t,n,i,r){var o=360,a=pr(r),l=parseFloat(r)*(a&&~r.indexOf("rad")?ph:1),c=l-i,h=i+c+"deg",f,p;return a&&(f=r.split("_")[1],f==="short"&&(c%=o,c!==c%(o/2)&&(c+=c<0?o:-o)),f==="cw"&&c<0?c=(c+o*jb)%o-~~(c/o)*o:f==="ccw"&&c>0&&(c=(c-o*jb)%o-~~(c/o)*o)),e._pt=p=new Ms(e._pt,t,n,i,c,dV),p.e=h,p.u="deg",e._props.push(n),p},Yb=function(e,t){for(var n in t)e[n]=t[n];return e},IV=function(e,t,n){var i=Yb({},n._gsap),r="perspective,force3D,transformOrigin,svgOrigin",o=n.style,a,l,c,h,f,p,y,v;i.svg?(c=n.getAttribute("transform"),n.setAttribute("transform",""),o[fi]=t,a=E0(n,1),Xh(n,fi),n.setAttribute("transform",c)):(c=getComputedStyle(n)[fi],o[fi]=t,a=E0(n,1),o[fi]=c);for(l in Jl)c=i[l],h=a[l],c!==h&&r.indexOf(l)<0&&(y=kr(c),v=kr(h),f=y!==v?nu(n,l,c,v):parseFloat(c),p=parseFloat(h),e._pt=new Ms(e._pt,a,l,f,p-f,RA),e._pt.u=v||0,e._props.push(l));Yb(a,i)};ws("padding,margin,Width,Radius",function(s,e){var t="Top",n="Right",i="Bottom",r="Left",o=(e<3?[t,n,i,r]:[t+r,t+n,i+n,i+r]).map(function(a){return e<2?s+a:"border"+a+s});vx[e>1?"border"+s:s]=function(a,l,c,h,f){var p,y;if(arguments.length<4)return p=o.map(function(v){return kl(a,v,c)}),y=p.join(" "),y.split(p[0]).length===5?p[0]:y;p=(h+"").split(" "),y={},o.forEach(function(v,_){return y[v]=p[_]=p[_]||p[(_-1)/2|0]}),a.init(l,y,f)}});var aP={name:"css",register:LA,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,i,r){var o=this._props,a=e.style,l=n.vars.startAt,c,h,f,p,y,v,_,S,A,w,M,C,I,O,k,N;pT||LA(),this.styles=this.styles||eP(e),N=this.styles.props,this.tween=n;for(_ in t)if(_!=="autoRound"&&(h=t[_],!(js[_]&&j3(_,t,n,i,e,r)))){if(y=typeof h,v=vx[_],y==="function"&&(h=h.call(n,i,e,r),y=typeof h),y==="string"&&~h.indexOf("random(")&&(h=x0(h)),v)v(this,e,_,h,n)&&(k=1);else if(_.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(_)+"").trim(),h+="",Yc.lastIndex=0,Yc.test(c)||(S=kr(c),A=kr(h)),A?S!==A&&(c=nu(e,_,c,A)+A):S&&(h+=S),this.add(a,"setProperty",c,h,i,r,0,0,_),o.push(_),N.push(_,0,a[_]);else if(y!=="undefined"){if(l&&_ in l?(c=typeof l[_]=="function"?l[_].call(n,i,e,r):l[_],pr(c)&&~c.indexOf("random(")&&(c=x0(c)),kr(c+"")||c==="auto"||(c+=Ys.units[_]||kr(kl(e,_))||""),(c+"").charAt(1)==="="&&(c=kl(e,_))):c=kl(e,_),p=parseFloat(c),w=y==="string"&&h.charAt(1)==="="&&h.substr(0,2),w&&(h=h.substr(2)),f=parseFloat(h),_ in Da&&(_==="autoAlpha"&&(p===1&&kl(e,"visibility")==="hidden"&&f&&(p=0),N.push("visibility",0,a.visibility),Kc(this,a,"visibility",p?"inherit":"hidden",f?"inherit":"hidden",!f)),_!=="scale"&&_!=="transform"&&(_=Da[_],~_.indexOf(",")&&(_=_.split(",")[0]))),M=_ in Jl,M){if(this.styles.save(_),C||(I=e._gsap,I.renderTransform&&!t.parseTransform||E0(e,t.parseTransform),O=t.smoothOrigin!==!1&&I.smooth,C=this._pt=new Ms(this._pt,a,fi,0,1,I.renderTransform,I,0,-1),C.dep=1),_==="scale")this._pt=new Ms(this._pt,I,"scaleY",I.scaleY,(w?Xf(I.scaleY,w+f):f)-I.scaleY||0,RA),this._pt.u=0,o.push("scaleY",_),_+="X";else if(_==="transformOrigin"){N.push(bs,0,a[bs]),h=wV(h),I.svg?PA(e,h,0,O,0,this):(A=parseFloat(h.split(" ")[2])||0,A!==I.zOrigin&&Kc(this,I,"zOrigin",I.zOrigin,A),Kc(this,a,_,xx(c),xx(h)));continue}else if(_==="svgOrigin"){PA(e,h,1,O,0,this);continue}else if(_ in rP){RV(this,I,_,p,w?Xf(p,w+h):h);continue}else if(_==="smoothOrigin"){Kc(this,I,"smooth",I.smooth,h);continue}else if(_==="force3D"){I[_]=h;continue}else if(_==="transform"){IV(this,h,e);continue}}else _ in a||(_=fp(_)||_);if(M||(f||f===0)&&(p||p===0)&&!hV.test(h)&&_ in a)S=(c+"").substr((p+"").length),f||(f=0),A=kr(h)||(_ in Ys.units?Ys.units[_]:S),S!==A&&(p=nu(e,_,c,A)),this._pt=new Ms(this._pt,M?I:a,_,p,(w?Xf(p,w+f):f)-p,!M&&(A==="px"||_==="zIndex")&&t.autoRound!==!1?pV:RA),this._pt.u=A||0,S!==A&&A!=="%"&&(this._pt.b=c,this._pt.r=fV);else if(_ in a)TV.call(this,e,_,c,w?w+h:h);else if(_ in e)this.add(e,_,c||e[_],w?w+h:h,i,r);else if(_!=="parseTransform"){sT(_,h);continue}M||(_ in a?N.push(_,0,a[_]):N.push(_,1,c||e[_])),o.push(_)}}k&&Y3(this)},render:function(e,t){if(t.tween._time||!mT())for(var n=t._pt;n;)n.r(e,n.d),n=n._next;else t.styles.revert()},get:kl,aliases:Da,getSetter:function(e,t,n){var i=Da[t];return i&&i.indexOf(",")<0&&(t=i),t in Jl&&t!==bs&&(e._gsap.x||kl(e,"x"))?n&&zb===n?t==="scale"?vV:yV:(zb=n||{})&&(t==="scale"?xV:_V):e.style&&!nT(e.style[t])?mV:~t.indexOf("-")?gV:dT(e,t)},core:{_removeProperty:Xh,_getMatrix:yT}};Cs.utils.checkPrefix=fp;Cs.core.getStyleSaver=eP;(function(s,e,t,n){var i=ws(s+","+e+","+t,function(r){Jl[r]=1});ws(e,function(r){Ys.units[r]="deg",rP[r]=1}),Da[i[13]]=s+","+e,ws(n,function(r){var o=r.split(":");Da[o[1]]=i[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");ws("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(s){Ys.units[s]="px"});Cs.registerPlugin(aP);var vT=Cs.registerPlugin(aP)||Cs;vT.core.Tween;/*!
 * @gsap/react 2.1.1
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/let Jb=typeof window<"u"?te.useLayoutEffect:te.useEffect,qb=s=>s&&!Array.isArray(s)&&typeof s=="object",Yy=[],LV={},lP=vT;const xT=(s,e=Yy)=>{let t=LV;qb(s)?(t=s,s=null,e="dependencies"in t?t.dependencies:Yy):qb(e)&&(t=e,e="dependencies"in t?t.dependencies:Yy),s&&typeof s!="function"&&console.warn("First parameter must be a function or config object");const{scope:n,revertOnUpdate:i}=t,r=te.useRef(!1),o=te.useRef(lP.context(()=>{},n)),a=te.useRef(c=>o.current.add(null,c)),l=e&&e.length&&!i;return Jb(()=>{if(s&&o.current.add(s,n),!l||!r.current)return()=>o.current.revert()},e),l&&Jb(()=>(r.current=!0,()=>o.current.revert()),Yy),{context:o.current,contextSafe:a.current}};xT.register=s=>{lP=s};xT.headless=!0;function PV(s){const e=te.useRef(null),{nodes:t,materials:n}=Sp("/models/dell_laptop.glb"),i=p7(s.video?s.video:"/textures/project/sample_video.mov");return xT(()=>{vT.from(e.current.rotation,{y:Math.PI/2,duration:1,ease:"power3.out"})},[s.next]),F.jsxs("group",{ref:e,...s,dispose:null,children:[F.jsxs("group",{name:"Cube006_8",position:[.292,.361,-.505],rotation:[0,0,-2.95],scale:[-.178,.105,1.669],children:[F.jsx("mesh",{name:"Object_14",castShadow:!0,receiveShadow:!0,geometry:t.Object_14.geometry,material:n.Material}),F.jsx("mesh",{name:"Object_15",castShadow:!0,receiveShadow:!0,geometry:t.Object_15.geometry,material:n["Material.002"]}),F.jsx("mesh",{name:"Object_16",castShadow:!0,receiveShadow:!0,geometry:t.Object_16.geometry,material:n["Material.025"]})]}),F.jsxs("group",{name:"screen007_204",position:[1.253,.406,-.552],rotation:[0,0,2.897],scale:[-.067,.066,.144],children:[F.jsx("mesh",{name:"Object_358",castShadow:!0,receiveShadow:!0,geometry:t.Object_358.geometry,material:n["Material.010"]}),F.jsx("mesh",{name:"Object_359",castShadow:!0,receiveShadow:!0,geometry:t.Object_359.geometry,material:n["Material.009"]}),F.jsx("mesh",{name:"Object_360",castShadow:!0,receiveShadow:!0,geometry:t.Object_360.geometry,material:n.dell_logo2edited}),F.jsx("mesh",{name:"Object_361",castShadow:!0,receiveShadow:!0,geometry:t.Object_361.geometry,material:n["Material.006"]}),F.jsx("mesh",{name:"Object_362",castShadow:!0,receiveShadow:!0,geometry:t.Object_362.geometry,material:n.delllogo3})]}),F.jsx("mesh",{name:"Object_4",castShadow:!0,receiveShadow:!0,geometry:t.Object_4.geometry,material:n["8th_gen_core_i5_logo"],position:[-.576,.439,.642],rotation:[0,-Math.PI/2,0],scale:.132}),F.jsx("mesh",{name:"Object_6",castShadow:!0,receiveShadow:!0,geometry:t.Object_6.geometry,material:n["Material.003"],position:[1.101,.395,-2],scale:[.069,.008,.099]}),F.jsx("mesh",{name:"Object_8",castShadow:!0,receiveShadow:!0,geometry:t.Object_8.geometry,material:n["Material.008"],position:[.898,.396,-1.992],rotation:[-Math.PI,0,-Math.PI],scale:[.042,.014,.016]}),F.jsx("mesh",{name:"Object_10",castShadow:!0,receiveShadow:!0,geometry:t.Object_10.geometry,material:n["Material.011"],position:[.577,.389,-1.977],rotation:[Math.PI/2,0,0],scale:[.264,.182,.041]}),F.jsx("mesh",{name:"Object_12",castShadow:!0,receiveShadow:!0,geometry:t.Object_12.geometry,material:n["Material.005"],position:[.897,.401,-1.967],scale:[.039,.004,.039]}),F.jsx("mesh",{name:"Object_18",castShadow:!0,receiveShadow:!0,geometry:t.Object_18.geometry,material:n["Material.004"],position:[.074,.378,-1.964],rotation:[.002,0,-2.943],scale:[-.164,.105,1.623]}),F.jsx("mesh",{name:"Object_20",castShadow:!0,receiveShadow:!0,geometry:t.Object_20.geometry,material:n.Material,position:[1.053,.391,.8],rotation:[0,0,-2.95],scale:[-.176,.083,1.623]}),F.jsx("mesh",{name:"Object_22",castShadow:!0,receiveShadow:!0,geometry:t.Object_22.geometry,material:n["Material.007"],position:[1.048,.421,-1.752],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_24",castShadow:!0,receiveShadow:!0,geometry:t.Object_24.geometry,material:n["Material.011"],position:[-.38,.389,-1.931],rotation:[Math.PI/2,0,0],scale:[.305,.182,.025]}),F.jsx("mesh",{name:"Object_26",castShadow:!0,receiveShadow:!0,geometry:t.Object_26.geometry,material:n["Material.007"],position:[1.048,.421,-1.586],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_28",castShadow:!0,receiveShadow:!0,geometry:t.Object_28.geometry,material:n["Material.007"],position:[1.048,.421,-1.415],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_30",castShadow:!0,receiveShadow:!0,geometry:t.Object_30.geometry,material:n["Material.007"],position:[1.048,.421,-1.248],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_32",castShadow:!0,receiveShadow:!0,geometry:t.Object_32.geometry,material:n["Material.007"],position:[1.048,.421,-1.083],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_34",castShadow:!0,receiveShadow:!0,geometry:t.Object_34.geometry,material:n["Material.007"],position:[1.048,.421,-.915],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_36",castShadow:!0,receiveShadow:!0,geometry:t.Object_36.geometry,material:n["Material.007"],position:[1.048,.421,-.749],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_38",castShadow:!0,receiveShadow:!0,geometry:t.Object_38.geometry,material:n["Material.007"],position:[1.048,.421,-.585],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_40",castShadow:!0,receiveShadow:!0,geometry:t.Object_40.geometry,material:n["Material.007"],position:[1.048,.421,-.419],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_42",castShadow:!0,receiveShadow:!0,geometry:t.Object_42.geometry,material:n["Material.007"],position:[1.048,.421,-.253],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_44",castShadow:!0,receiveShadow:!0,geometry:t.Object_44.geometry,material:n["Material.007"],position:[1.048,.421,-.087],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_46",castShadow:!0,receiveShadow:!0,geometry:t.Object_46.geometry,material:n["Material.007"],position:[1.048,.421,.08],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_48",castShadow:!0,receiveShadow:!0,geometry:t.Object_48.geometry,material:n["Material.007"],position:[1.048,.421,.244],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_50",castShadow:!0,receiveShadow:!0,geometry:t.Object_50.geometry,material:n["Material.007"],position:[1.048,.421,.41],scale:[.048,.112,.071]}),F.jsx("mesh",{name:"Object_52",castShadow:!0,receiveShadow:!0,geometry:t.Object_52.geometry,material:n["Material.007"],position:[1.048,.421,.572],scale:[.048,.112,.075]}),F.jsx("mesh",{name:"Object_54",castShadow:!0,receiveShadow:!0,geometry:t.Object_54.geometry,material:n["Material.007"],position:[.181,.421,-.66],scale:[.072,.106,.419]}),F.jsx("mesh",{name:"Object_56",castShadow:!0,receiveShadow:!0,geometry:t.Object_56.geometry,material:n["Material.007"],position:[.9,.421,-1.75],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_58",castShadow:!0,receiveShadow:!0,geometry:t.Object_58.geometry,material:n["Material.007"],position:[.9,.421,-1.578],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_60",castShadow:!0,receiveShadow:!0,geometry:t.Object_60.geometry,material:n["Material.007"],position:[.9,.421,-1.408],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_62",castShadow:!0,receiveShadow:!0,geometry:t.Object_62.geometry,material:n["Material.007"],position:[.9,.421,-1.24],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_64",castShadow:!0,receiveShadow:!0,geometry:t.Object_64.geometry,material:n["Material.007"],position:[.9,.421,-1.067],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_66",castShadow:!0,receiveShadow:!0,geometry:t.Object_66.geometry,material:n["Material.007"],position:[.9,.421,-.896],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_68",castShadow:!0,receiveShadow:!0,geometry:t.Object_68.geometry,material:n["Material.007"],position:[.9,.421,-.721],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_70",castShadow:!0,receiveShadow:!0,geometry:t.Object_70.geometry,material:n["Material.007"],position:[.9,.421,-.549],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_72",castShadow:!0,receiveShadow:!0,geometry:t.Object_72.geometry,material:n["Material.007"],position:[.9,.421,-.379],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_74",castShadow:!0,receiveShadow:!0,geometry:t.Object_74.geometry,material:n["Material.007"],position:[.9,.421,-.208],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_76",castShadow:!0,receiveShadow:!0,geometry:t.Object_76.geometry,material:n["Material.007"],position:[.9,.421,-.035],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_78",castShadow:!0,receiveShadow:!0,geometry:t.Object_78.geometry,material:n["Material.007"],position:[.9,.421,.136],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_80",castShadow:!0,receiveShadow:!0,geometry:t.Object_80.geometry,material:n["Material.007"],position:[.9,.421,.307],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_82",castShadow:!0,receiveShadow:!0,geometry:t.Object_82.geometry,material:n["Material.007"],position:[.9,.421,.528],scale:[.069,.116,.119]}),F.jsx("mesh",{name:"Object_84",castShadow:!0,receiveShadow:!0,geometry:t.Object_84.geometry,material:n["Material.007"],position:[.714,.422,-1.697],scale:[.07,.121,.12]}),F.jsx("mesh",{name:"Object_86",castShadow:!0,receiveShadow:!0,geometry:t.Object_86.geometry,material:n["Material.007"],position:[.539,.421,-1.678],scale:[.07,.129,.146]}),F.jsx("mesh",{name:"Object_88",castShadow:!0,receiveShadow:!0,geometry:t.Object_88.geometry,material:n["Material.007"],position:[.361,.421,-1.638],scale:[.069,.131,.185]}),F.jsx("mesh",{name:"Object_90",castShadow:!0,receiveShadow:!0,geometry:t.Object_90.geometry,material:n["Material.007"],position:[.179,.421,-1.727],scale:[.067,.121,.095]}),F.jsx("mesh",{name:"Object_92",castShadow:!0,receiveShadow:!0,geometry:t.Object_92.geometry,material:n["Material.007"],position:[.715,.422,-1.481],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_94",castShadow:!0,receiveShadow:!0,geometry:t.Object_94.geometry,material:n["Material.007"],position:[.715,.422,-1.309],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_96",castShadow:!0,receiveShadow:!0,geometry:t.Object_96.geometry,material:n["Material.007"],position:[.715,.422,-1.139],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_98",castShadow:!0,receiveShadow:!0,geometry:t.Object_98.geometry,material:n["Material.007"],position:[.715,.422,-.971],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_100",castShadow:!0,receiveShadow:!0,geometry:t.Object_100.geometry,material:n["Material.007"],position:[.715,.422,-.798],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_102",castShadow:!0,receiveShadow:!0,geometry:t.Object_102.geometry,material:n["Material.007"],position:[.715,.422,-.627],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_104",castShadow:!0,receiveShadow:!0,geometry:t.Object_104.geometry,material:n["Material.007"],position:[.715,.422,-.452],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_106",castShadow:!0,receiveShadow:!0,geometry:t.Object_106.geometry,material:n["Material.007"],position:[.715,.422,-.28],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_108",castShadow:!0,receiveShadow:!0,geometry:t.Object_108.geometry,material:n["Material.007"],position:[.715,.422,-.11],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_110",castShadow:!0,receiveShadow:!0,geometry:t.Object_110.geometry,material:n["Material.007"],position:[.715,.422,.061],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_112",castShadow:!0,receiveShadow:!0,geometry:t.Object_112.geometry,material:n["Material.007"],position:[.715,.422,.234],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_114",castShadow:!0,receiveShadow:!0,geometry:t.Object_114.geometry,material:n["Material.007"],position:[.715,.422,.405],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_116",castShadow:!0,receiveShadow:!0,geometry:t.Object_116.geometry,material:n["Material.007"],position:[.715,.422,.575],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_118",castShadow:!0,receiveShadow:!0,geometry:t.Object_118.geometry,material:n["Material.007"],position:[.539,.421,.524],scale:[.07,.129,.121]}),F.jsx("mesh",{name:"Object_120",castShadow:!0,receiveShadow:!0,geometry:t.Object_120.geometry,material:n["Material.007"],position:[.538,.421,-1.424],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_122",castShadow:!0,receiveShadow:!0,geometry:t.Object_122.geometry,material:n["Material.007"],position:[.538,.421,-1.253],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_124",castShadow:!0,receiveShadow:!0,geometry:t.Object_124.geometry,material:n["Material.007"],position:[.538,.421,-1.082],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_126",castShadow:!0,receiveShadow:!0,geometry:t.Object_126.geometry,material:n["Material.007"],position:[.538,.421,-.914],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_128",castShadow:!0,receiveShadow:!0,geometry:t.Object_128.geometry,material:n["Material.007"],position:[.538,.421,-.742],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_130",castShadow:!0,receiveShadow:!0,geometry:t.Object_130.geometry,material:n["Material.007"],position:[.538,.421,-.57],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_132",castShadow:!0,receiveShadow:!0,geometry:t.Object_132.geometry,material:n["Material.007"],position:[.538,.421,-.395],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_134",castShadow:!0,receiveShadow:!0,geometry:t.Object_134.geometry,material:n["Material.007"],position:[.538,.421,-.224],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_136",castShadow:!0,receiveShadow:!0,geometry:t.Object_136.geometry,material:n["Material.007"],position:[.538,.421,-.053],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_138",castShadow:!0,receiveShadow:!0,geometry:t.Object_138.geometry,material:n["Material.007"],position:[.538,.421,.118],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_140",castShadow:!0,receiveShadow:!0,geometry:t.Object_140.geometry,material:n["Material.007"],position:[.538,.421,.29],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_142",castShadow:!0,receiveShadow:!0,geometry:t.Object_142.geometry,material:n["Material.007"],position:[.361,.421,.476],scale:[.069,.131,.167]}),F.jsx("mesh",{name:"Object_144",castShadow:!0,receiveShadow:!0,geometry:t.Object_144.geometry,material:n["Material.007"],position:[.36,.422,-1.342],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_146",castShadow:!0,receiveShadow:!0,geometry:t.Object_146.geometry,material:n["Material.007"],position:[.36,.422,-1.171],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_148",castShadow:!0,receiveShadow:!0,geometry:t.Object_148.geometry,material:n["Material.007"],position:[.36,.422,-1],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_150",castShadow:!0,receiveShadow:!0,geometry:t.Object_150.geometry,material:n["Material.007"],position:[.36,.422,-.832],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_152",castShadow:!0,receiveShadow:!0,geometry:t.Object_152.geometry,material:n["Material.007"],position:[.36,.422,-.66],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_154",castShadow:!0,receiveShadow:!0,geometry:t.Object_154.geometry,material:n["Material.007"],position:[.36,.421,-.488],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_156",castShadow:!0,receiveShadow:!0,geometry:t.Object_156.geometry,material:n["Material.007"],position:[.36,.421,-.313],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_158",castShadow:!0,receiveShadow:!0,geometry:t.Object_158.geometry,material:n["Material.007"],position:[.36,.421,-.142],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_160",castShadow:!0,receiveShadow:!0,geometry:t.Object_160.geometry,material:n["Material.007"],position:[.36,.421,.028],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_162",castShadow:!0,receiveShadow:!0,geometry:t.Object_162.geometry,material:n["Material.007"],position:[.36,.421,.2],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_164",castShadow:!0,receiveShadow:!0,geometry:t.Object_164.geometry,material:n["Material.007"],position:[.181,.421,-1.517],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_166",castShadow:!0,receiveShadow:!0,geometry:t.Object_166.geometry,material:n["Material.007"],position:[.181,.421,-1.343],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_168",castShadow:!0,receiveShadow:!0,geometry:t.Object_168.geometry,material:n["Material.007"],position:[.181,.421,-1.173],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_170",castShadow:!0,receiveShadow:!0,geometry:t.Object_170.geometry,material:n["Material.007"],position:[.183,.421,-.142],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_172",castShadow:!0,receiveShadow:!0,geometry:t.Object_172.geometry,material:n["Material.007"],position:[.183,.421,.028],scale:[.069,.116,.073]}),F.jsx("mesh",{name:"Object_174",castShadow:!0,receiveShadow:!0,geometry:t.Object_174.geometry,material:n["Material.007"],position:[.205,.421,.2],scale:[.044,.112,.071]}),F.jsx("mesh",{name:"Object_176",castShadow:!0,receiveShadow:!0,geometry:t.Object_176.geometry,material:n["Material.007"],position:[.079,.421,.203],scale:[.044,.112,.074]}),F.jsx("mesh",{name:"Object_178",castShadow:!0,receiveShadow:!0,geometry:t.Object_178.geometry,material:n["Material.007"],position:[.079,.421,.385],scale:[.044,.112,.074]}),F.jsx("mesh",{name:"Object_180",castShadow:!0,receiveShadow:!0,geometry:t.Object_180.geometry,material:n["Material.007"],position:[.079,.421,.568],scale:[.044,.112,.074]}),F.jsx("mesh",{name:"Object_182",castShadow:!0,receiveShadow:!0,geometry:t.Object_182.geometry,material:n["Material.007"],position:[.205,.421,.385],scale:[.044,.112,.074]}),F.jsx("mesh",{name:"Object_184",castShadow:!0,receiveShadow:!0,geometry:t.Object_184.geometry,material:n["Material.007"],position:[.205,.421,.569],scale:[.044,.112,.071]}),F.jsx("mesh",{name:"Object_186",castShadow:!0,receiveShadow:!0,geometry:t.Object_186.geometry,material:n["Material.012"],position:[.538,.422,.291],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_188",castShadow:!0,receiveShadow:!0,geometry:t.Object_188.geometry,material:n["Material.012"],position:[.538,.422,.118],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_190",castShadow:!0,receiveShadow:!0,geometry:t.Object_190.geometry,material:n["Material.012"],position:[.538,.422,-.053],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_192",castShadow:!0,receiveShadow:!0,geometry:t.Object_192.geometry,material:n["Material.012"],position:[.538,.422,-.223],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_194",castShadow:!0,receiveShadow:!0,geometry:t.Object_194.geometry,material:n["Material.012"],position:[.538,.422,-.395],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_196",castShadow:!0,receiveShadow:!0,geometry:t.Object_196.geometry,material:n["Material.012"],position:[.538,.422,-.57],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_198",castShadow:!0,receiveShadow:!0,geometry:t.Object_198.geometry,material:n["Material.012"],position:[.538,.422,-.742],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_200",castShadow:!0,receiveShadow:!0,geometry:t.Object_200.geometry,material:n["Material.012"],position:[.538,.422,-.915],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_202",castShadow:!0,receiveShadow:!0,geometry:t.Object_202.geometry,material:n["Material.012"],position:[.538,.422,-1.082],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_204",castShadow:!0,receiveShadow:!0,geometry:t.Object_204.geometry,material:n["Material.012"],position:[.538,.422,-1.252],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_206",castShadow:!0,receiveShadow:!0,geometry:t.Object_206.geometry,material:n["Material.012"],position:[.538,.422,-1.425],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_208",castShadow:!0,receiveShadow:!0,geometry:t.Object_208.geometry,material:n["Material.012"],position:[.361,.422,-1.342],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_210",castShadow:!0,receiveShadow:!0,geometry:t.Object_210.geometry,material:n["Material.012"],position:[.18,.422,-.659],scale:[.065,.018,.408]}),F.jsx("mesh",{name:"Object_212",castShadow:!0,receiveShadow:!0,geometry:t.Object_212.geometry,material:n["Material.012"],position:[.361,.422,-1.17],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_214",castShadow:!0,receiveShadow:!0,geometry:t.Object_214.geometry,material:n["Material.012"],position:[.361,.422,-.998],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_216",castShadow:!0,receiveShadow:!0,geometry:t.Object_216.geometry,material:n["Material.012"],position:[.361,.422,-.831],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_218",castShadow:!0,receiveShadow:!0,geometry:t.Object_218.geometry,material:n["Material.012"],position:[.361,.422,-.659],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_220",castShadow:!0,receiveShadow:!0,geometry:t.Object_220.geometry,material:n["Material.012"],position:[.361,.422,-.488],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_222",castShadow:!0,receiveShadow:!0,geometry:t.Object_222.geometry,material:n["Material.012"],position:[.361,.422,-.314],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_224",castShadow:!0,receiveShadow:!0,geometry:t.Object_224.geometry,material:n["Material.012"],position:[.361,.422,-.142],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_226",castShadow:!0,receiveShadow:!0,geometry:t.Object_226.geometry,material:n["Material.012"],position:[.361,.422,.03],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_228",castShadow:!0,receiveShadow:!0,geometry:t.Object_228.geometry,material:n["Material.012"],position:[.539,.422,.525],scale:[.065,.018,.111]}),F.jsx("mesh",{name:"Object_230",castShadow:!0,receiveShadow:!0,geometry:t.Object_230.geometry,material:n["Material.012"],position:[.361,.422,.2],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_232",castShadow:!0,receiveShadow:!0,geometry:t.Object_232.geometry,material:n["Material.012"],position:[.363,.422,.478],scale:[.065,.018,.158]}),F.jsx("mesh",{name:"Object_234",castShadow:!0,receiveShadow:!0,geometry:t.Object_234.geometry,material:n["Material.012"],position:[.183,.422,-.142],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_236",castShadow:!0,receiveShadow:!0,geometry:t.Object_236.geometry,material:n["Material.012"],position:[.183,.422,.031],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_238",castShadow:!0,receiveShadow:!0,geometry:t.Object_238.geometry,material:n["Material.012"],position:[.205,.422,.2],scale:[.04,.018,.065]}),F.jsx("mesh",{name:"Object_240",castShadow:!0,receiveShadow:!0,geometry:t.Object_240.geometry,material:n["Material.012"],position:[.205,.422,.385],scale:[.042,.018,.068]}),F.jsx("mesh",{name:"Object_242",castShadow:!0,receiveShadow:!0,geometry:t.Object_242.geometry,material:n["Material.012"],position:[.08,.422,.385],scale:[.042,.018,.068]}),F.jsx("mesh",{name:"Object_244",castShadow:!0,receiveShadow:!0,geometry:t.Object_244.geometry,material:n["Material.012"],position:[.08,.422,.567],scale:[.042,.018,.068]}),F.jsx("mesh",{name:"Object_246",castShadow:!0,receiveShadow:!0,geometry:t.Object_246.geometry,material:n["Material.012"],position:[.08,.422,.204],scale:[.042,.018,.068]}),F.jsx("mesh",{name:"Object_248",castShadow:!0,receiveShadow:!0,geometry:t.Object_248.geometry,material:n["Material.012"],position:[.205,.422,.57],scale:[.04,.018,.065]}),F.jsx("mesh",{name:"Object_250",castShadow:!0,receiveShadow:!0,geometry:t.Object_250.geometry,material:n["Material.012"],position:[.179,.422,-1.342],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_252",castShadow:!0,receiveShadow:!0,geometry:t.Object_252.geometry,material:n["Material.012"],position:[.179,.422,-1.172],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_254",castShadow:!0,receiveShadow:!0,geometry:t.Object_254.geometry,material:n["Material.012"],position:[.179,.422,-1.518],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_256",castShadow:!0,receiveShadow:!0,geometry:t.Object_256.geometry,material:n["Material.012"],position:[.179,.422,-1.726],scale:[.065,.018,.087]}),F.jsx("mesh",{name:"Object_258",castShadow:!0,receiveShadow:!0,geometry:t.Object_258.geometry,material:n["Material.012"],position:[.361,.422,-1.638],scale:[.065,.018,.178]}),F.jsx("mesh",{name:"Object_260",castShadow:!0,receiveShadow:!0,geometry:t.Object_260.geometry,material:n["Material.012"],position:[.538,.422,-1.68],scale:[.065,.018,.139]}),F.jsx("mesh",{name:"Object_262",castShadow:!0,receiveShadow:!0,geometry:t.Object_262.geometry,material:n["Material.012"],position:[.9,.422,-1.068],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_264",castShadow:!0,receiveShadow:!0,geometry:t.Object_264.geometry,material:n["Material.012"],position:[.714,.422,-1.698],scale:[.065,.018,.113]}),F.jsx("mesh",{name:"Object_266",castShadow:!0,receiveShadow:!0,geometry:t.Object_266.geometry,material:n["Material.012"],position:[.714,.422,-1.309],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_268",castShadow:!0,receiveShadow:!0,geometry:t.Object_268.geometry,material:n["Material.012"],position:[.714,.422,-1.138],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_270",castShadow:!0,receiveShadow:!0,geometry:t.Object_270.geometry,material:n["Material.012"],position:[.714,.422,-.97],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_272",castShadow:!0,receiveShadow:!0,geometry:t.Object_272.geometry,material:n["Material.012"],position:[.714,.422,-.797],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_274",castShadow:!0,receiveShadow:!0,geometry:t.Object_274.geometry,material:n["Material.012"],position:[.714,.422,-.625],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_276",castShadow:!0,receiveShadow:!0,geometry:t.Object_276.geometry,material:n["Material.012"],position:[.714,.422,-.452],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_278",castShadow:!0,receiveShadow:!0,geometry:t.Object_278.geometry,material:n["Material.012"],position:[.714,.422,-.28],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_280",castShadow:!0,receiveShadow:!0,geometry:t.Object_280.geometry,material:n["Material.012"],position:[.714,.422,-.109],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_282",castShadow:!0,receiveShadow:!0,geometry:t.Object_282.geometry,material:n["Material.012"],position:[.714,.422,.062],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_284",castShadow:!0,receiveShadow:!0,geometry:t.Object_284.geometry,material:n["Material.012"],position:[.714,.422,.233],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_286",castShadow:!0,receiveShadow:!0,geometry:t.Object_286.geometry,material:n["Material.012"],position:[.714,.422,.405],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_288",castShadow:!0,receiveShadow:!0,geometry:t.Object_288.geometry,material:n["Material.012"],position:[.714,.422,.576],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_290",castShadow:!0,receiveShadow:!0,geometry:t.Object_290.geometry,material:n["Material.012"],position:[.9,.422,-.896],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_292",castShadow:!0,receiveShadow:!0,geometry:t.Object_292.geometry,material:n["Material.012"],position:[.9,.422,-.72],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_294",castShadow:!0,receiveShadow:!0,geometry:t.Object_294.geometry,material:n["Material.012"],position:[.9,.422,-.549],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_296",castShadow:!0,receiveShadow:!0,geometry:t.Object_296.geometry,material:n["Material.012"],position:[.9,.422,-.379],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_298",castShadow:!0,receiveShadow:!0,geometry:t.Object_298.geometry,material:n["Material.012"],position:[.714,.422,-1.48],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_300",castShadow:!0,receiveShadow:!0,geometry:t.Object_300.geometry,material:n["Material.012"],position:[.9,.422,-1.751],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_302",castShadow:!0,receiveShadow:!0,geometry:t.Object_302.geometry,material:n["Material.012"],position:[.9,.422,-1.578],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_304",castShadow:!0,receiveShadow:!0,geometry:t.Object_304.geometry,material:n["Material.012"],position:[.9,.422,-1.406],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_306",castShadow:!0,receiveShadow:!0,geometry:t.Object_306.geometry,material:n["Material.012"],position:[.901,.422,-1.239],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_308",castShadow:!0,receiveShadow:!0,geometry:t.Object_308.geometry,material:n["Material.012"],position:[.9,.422,-.209],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_310",castShadow:!0,receiveShadow:!0,geometry:t.Object_310.geometry,material:n["Material.012"],position:[.9,.422,-.034],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_312",castShadow:!0,receiveShadow:!0,geometry:t.Object_312.geometry,material:n["Material.012"],position:[.9,.422,.137],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_314",castShadow:!0,receiveShadow:!0,geometry:t.Object_314.geometry,material:n["Material.012"],position:[.9,.422,.308],scale:[.065,.018,.065]}),F.jsx("mesh",{name:"Object_316",castShadow:!0,receiveShadow:!0,geometry:t.Object_316.geometry,material:n["Material.012"],position:[.9,.422,.528],scale:[.065,.018,.111]}),F.jsx("mesh",{name:"Object_318",castShadow:!0,receiveShadow:!0,geometry:t.Object_318.geometry,material:n["Material.012"],position:[1.048,.422,.246],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_320",castShadow:!0,receiveShadow:!0,geometry:t.Object_320.geometry,material:n["Material.012"],position:[1.048,.422,.41],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_322",castShadow:!0,receiveShadow:!0,geometry:t.Object_322.geometry,material:n["Material.012"],position:[1.048,.422,.573],scale:[.043,.018,.07]}),F.jsx("mesh",{name:"Object_324",castShadow:!0,receiveShadow:!0,geometry:t.Object_324.geometry,material:n["Material.012"],position:[1.048,.422,.081],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_326",castShadow:!0,receiveShadow:!0,geometry:t.Object_326.geometry,material:n["Material.012"],position:[1.048,.422,-.087],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_328",castShadow:!0,receiveShadow:!0,geometry:t.Object_328.geometry,material:n["Material.012"],position:[1.048,.422,-.253],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_330",castShadow:!0,receiveShadow:!0,geometry:t.Object_330.geometry,material:n["Material.012"],position:[1.048,.422,-.417],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_332",castShadow:!0,receiveShadow:!0,geometry:t.Object_332.geometry,material:n["Material.012"],position:[1.048,.422,-.584],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_334",castShadow:!0,receiveShadow:!0,geometry:t.Object_334.geometry,material:n["Material.012"],position:[1.048,.422,-.749],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_336",castShadow:!0,receiveShadow:!0,geometry:t.Object_336.geometry,material:n["Material.012"],position:[1.048,.422,-.916],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_338",castShadow:!0,receiveShadow:!0,geometry:t.Object_338.geometry,material:n["Material.012"],position:[1.048,.422,-1.084],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_340",castShadow:!0,receiveShadow:!0,geometry:t.Object_340.geometry,material:n["Material.012"],position:[1.048,.422,-1.249],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_342",castShadow:!0,receiveShadow:!0,geometry:t.Object_342.geometry,material:n["Material.012"],position:[1.048,.422,-1.414],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_344",castShadow:!0,receiveShadow:!0,geometry:t.Object_344.geometry,material:n["Material.012"],position:[1.048,.422,-1.587],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_346",castShadow:!0,receiveShadow:!0,geometry:t.Object_346.geometry,material:n["Material.012"],position:[1.048,.422,-1.752],scale:[.043,.018,.065]}),F.jsx("mesh",{name:"Object_348",castShadow:!0,receiveShadow:!0,geometry:t.Object_348.geometry,material:n["Material.014"],position:[.196,.429,-1.364],scale:.133}),F.jsx("mesh",{name:"Object_350",castShadow:!0,receiveShadow:!0,geometry:t.Object_350.geometry,material:n["Material.015"],position:[.197,.43,-1.331],scale:.133}),F.jsx("mesh",{name:"Object_352",castShadow:!0,receiveShadow:!0,geometry:t.Object_352.geometry,material:n["Material.016"],position:[.173,.425,-1.333],scale:.133}),F.jsx("mesh",{name:"Object_354",castShadow:!0,receiveShadow:!0,geometry:t.Object_354.geometry,material:n["Material.017"],position:[.175,.425,-1.364],scale:.133}),F.jsx("mesh",{name:"Object_356",castShadow:!0,receiveShadow:!0,geometry:t.Object_356.geometry,material:n["Material.019"],position:[.575,.441,-1.574],scale:.004}),F.jsx("mesh",{name:"Object_364",castShadow:!0,receiveShadow:!0,geometry:t.Object_364.geometry,material:n["Material.020"],position:[.457,.406,-.656],scale:[.039,.037,.039]}),F.jsx("mesh",{name:"Object_366",castShadow:!0,receiveShadow:!0,geometry:t.Object_366.geometry,material:n["Material.021"],position:[.208,.441,.386],scale:.343}),F.jsx("mesh",{name:"Object_368",castShadow:!0,receiveShadow:!0,geometry:t.Object_368.geometry,material:n["Material.021"],position:[.08,.441,.201],rotation:[0,Math.PI/2,0],scale:.343}),F.jsx("mesh",{name:"Object_370",castShadow:!0,receiveShadow:!0,geometry:t.Object_370.geometry,material:n["Material.021"],position:[.08,.441,.569],rotation:[0,-Math.PI/2,0],scale:.343}),F.jsx("mesh",{name:"Object_372",castShadow:!0,receiveShadow:!0,geometry:t.Object_372.geometry,material:n["Material.021"],position:[.079,.441,.386],rotation:[-Math.PI,0,-Math.PI],scale:.343}),F.jsx("mesh",{name:"Object_374",castShadow:!0,receiveShadow:!0,geometry:t.Object_374.geometry,material:n["Material.018"],position:[.799,.4,-2.008],rotation:[Math.PI/2,0,0],scale:.084}),F.jsx("mesh",{name:"Object_376",castShadow:!0,receiveShadow:!0,geometry:t.Object_376.geometry,material:n["Material.018"],position:[.759,.418,.914],rotation:[Math.PI/2,0,0],scale:.084}),F.jsx("mesh",{name:"Object_378",castShadow:!0,receiveShadow:!0,geometry:t.Object_378.geometry,material:n.material_0,position:[1.001,.375,.884],scale:[.031,.022,.031]}),F.jsx("mesh",{name:"Object_380",castShadow:!0,receiveShadow:!0,geometry:t.Object_380.geometry,material:n["Material.022"],position:[1,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_382",castShadow:!0,receiveShadow:!0,geometry:t.Object_382.geometry,material:n["Material.011"],position:[1.003,.371,.863],rotation:[1.658,0,0],scale:[.05,.081,.025]}),F.jsx("mesh",{name:"Object_384",castShadow:!0,receiveShadow:!0,geometry:t.Object_384.geometry,material:n["Material.022"],position:[1.005,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_386",castShadow:!0,receiveShadow:!0,geometry:t.Object_386.geometry,material:n["Material.022"],position:[1.009,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_388",castShadow:!0,receiveShadow:!0,geometry:t.Object_388.geometry,material:n["Material.022"],position:[1.014,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_390",castShadow:!0,receiveShadow:!0,geometry:t.Object_390.geometry,material:n["Material.022"],position:[1.018,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_392",castShadow:!0,receiveShadow:!0,geometry:t.Object_392.geometry,material:n["Material.022"],position:[1.022,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_394",castShadow:!0,receiveShadow:!0,geometry:t.Object_394.geometry,material:n["Material.022"],position:[1.027,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_396",castShadow:!0,receiveShadow:!0,geometry:t.Object_396.geometry,material:n["Material.022"],position:[.996,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_398",castShadow:!0,receiveShadow:!0,geometry:t.Object_398.geometry,material:n["Material.022"],position:[.992,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_400",castShadow:!0,receiveShadow:!0,geometry:t.Object_400.geometry,material:n["Material.022"],position:[.987,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_402",castShadow:!0,receiveShadow:!0,geometry:t.Object_402.geometry,material:n["Material.022"],position:[.983,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_404",castShadow:!0,receiveShadow:!0,geometry:t.Object_404.geometry,material:n["Material.022"],position:[.979,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_406",castShadow:!0,receiveShadow:!0,geometry:t.Object_406.geometry,material:n["Material.022"],position:[.975,.4,.88],rotation:[0,0,-1.608],scale:[.01,.001,.015]}),F.jsx("mesh",{name:"Object_408",castShadow:!0,receiveShadow:!0,geometry:t.Object_408.geometry,material:n["Material.018"],position:[.647,.418,.914],rotation:[Math.PI/2,0,0],scale:.084}),F.jsx("mesh",{name:"Object_410",castShadow:!0,receiveShadow:!0,geometry:t.Object_410.geometry,material:n.material_0,position:[.898,.385,.884],scale:[.031,.01,.031]}),F.jsx("mesh",{name:"Object_412",castShadow:!0,receiveShadow:!0,geometry:t.Object_412.geometry,material:n["Material.011"],position:[.843,.371,.863],rotation:[1.658,0,0],scale:[.253,.081,.025]}),F.jsx("mesh",{name:"Object_414",castShadow:!0,receiveShadow:!0,geometry:t.Object_414.geometry,material:n["Material.022"],position:[.899,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_416",castShadow:!0,receiveShadow:!0,geometry:t.Object_416.geometry,material:n["Material.022"],position:[.903,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_418",castShadow:!0,receiveShadow:!0,geometry:t.Object_418.geometry,material:n["Material.022"],position:[.908,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_420",castShadow:!0,receiveShadow:!0,geometry:t.Object_420.geometry,material:n["Material.022"],position:[.912,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_422",castShadow:!0,receiveShadow:!0,geometry:t.Object_422.geometry,material:n["Material.022"],position:[.916,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_424",castShadow:!0,receiveShadow:!0,geometry:t.Object_424.geometry,material:n["Material.022"],position:[.921,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_426",castShadow:!0,receiveShadow:!0,geometry:t.Object_426.geometry,material:n["Material.022"],position:[.925,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_428",castShadow:!0,receiveShadow:!0,geometry:t.Object_428.geometry,material:n["Material.022"],position:[.895,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_430",castShadow:!0,receiveShadow:!0,geometry:t.Object_430.geometry,material:n["Material.022"],position:[.89,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_432",castShadow:!0,receiveShadow:!0,geometry:t.Object_432.geometry,material:n["Material.022"],position:[.886,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_434",castShadow:!0,receiveShadow:!0,geometry:t.Object_434.geometry,material:n["Material.022"],position:[.882,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_436",castShadow:!0,receiveShadow:!0,geometry:t.Object_436.geometry,material:n["Material.022"],position:[.878,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_438",castShadow:!0,receiveShadow:!0,geometry:t.Object_438.geometry,material:n["Material.022"],position:[.874,.393,.88],rotation:[0,0,-1.608],scale:[.005,.001,.015]}),F.jsx("mesh",{name:"Object_440",castShadow:!0,receiveShadow:!0,geometry:t.Object_440.geometry,material:n.material_0,position:[.794,.384,.884],scale:[.038,.01,.031]}),F.jsx("mesh",{name:"Object_442",castShadow:!0,receiveShadow:!0,geometry:t.Object_442.geometry,material:n.material_0,position:[.68,.385,.884],scale:[.038,.01,.031]}),F.jsx("mesh",{name:"Object_444",castShadow:!0,receiveShadow:!0,geometry:t.Object_444.geometry,material:n["Material.027"],position:[.793,.39,.868],rotation:[0,0,3.122],scale:[.037,.003,.042]}),F.jsx("mesh",{name:"Object_446",castShadow:!0,receiveShadow:!0,geometry:t.Object_446.geometry,material:n["Material.005"],position:[.68,.39,.868],rotation:[0,0,3.122],scale:[.037,.003,.042]}),F.jsx("mesh",{name:"Object_448",castShadow:!0,receiveShadow:!0,geometry:t.Object_448.geometry,material:n["Material.026"],position:[1.506,1.352,-.534],rotation:[0,0,2.897],scale:[-.067,.066,.144],children:F.jsx("meshBasicMaterial",{map:i})}),F.jsx("mesh",{name:"Object_450",castShadow:!0,receiveShadow:!0,geometry:t.Object_450.geometry,material:n["Material.011"],position:[.292,.361,-.505],rotation:[0,0,-2.95],scale:[-.178,.105,1.669]}),F.jsx("mesh",{name:"Object_452",castShadow:!0,receiveShadow:!0,geometry:t.Object_452.geometry,material:n["Material.011"],position:[.292,.361,-.505],rotation:[0,0,-2.95],scale:[-.178,.105,1.669]}),F.jsx("mesh",{name:"Object_454",castShadow:!0,receiveShadow:!0,geometry:t.Object_454.geometry,material:n["Material.013"],position:[.696,.441,-1.503],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_456",castShadow:!0,receiveShadow:!0,geometry:t.Object_456.geometry,material:n["Material.013"],position:[.694,.441,-1.335],rotation:[0,-Math.PI/2,0],scale:.05}),F.jsx("mesh",{name:"Object_458",castShadow:!0,receiveShadow:!0,geometry:t.Object_458.geometry,material:n["Material.013"],position:[.694,.441,-1.152],rotation:[0,-Math.PI/2,0],scale:.05}),F.jsx("mesh",{name:"Object_460",castShadow:!0,receiveShadow:!0,geometry:t.Object_460.geometry,material:n["Material.013"],position:[.694,.441,-.985],rotation:[0,-Math.PI/2,0],scale:.05}),F.jsx("mesh",{name:"Object_462",castShadow:!0,receiveShadow:!0,geometry:t.Object_462.geometry,material:n["Material.013"],position:[.694,.441,-.813],rotation:[0,-Math.PI/2,0],scale:.05}),F.jsx("mesh",{name:"Object_464",castShadow:!0,receiveShadow:!0,geometry:t.Object_464.geometry,material:n["Material.013"],position:[.694,.441,-.641],rotation:[0,-Math.PI/2,0],scale:.05}),F.jsx("mesh",{name:"Object_466",castShadow:!0,receiveShadow:!0,geometry:t.Object_466.geometry,material:n["Material.013"],position:[.694,.441,-.468],rotation:[0,-Math.PI/2,0],scale:.05}),F.jsx("mesh",{name:"Object_468",castShadow:!0,receiveShadow:!0,geometry:t.Object_468.geometry,material:n["Material.013"],position:[.694,.441,-.289],rotation:[0,-Math.PI/2,0],scale:.05}),F.jsx("mesh",{name:"Object_470",castShadow:!0,receiveShadow:!0,geometry:t.Object_470.geometry,material:n["Material.013"],position:[.694,.441,-.13],rotation:[0,-Math.PI/2,0],scale:.05}),F.jsx("mesh",{name:"Object_472",castShadow:!0,receiveShadow:!0,geometry:t.Object_472.geometry,material:n["Material.013"],position:[.694,.441,.042],rotation:[0,-Math.PI/2,0],scale:.05}),F.jsx("mesh",{name:"Object_474",castShadow:!0,receiveShadow:!0,geometry:t.Object_474.geometry,material:n["Material.013"],position:[.522,.441,-1.44],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_476",castShadow:!0,receiveShadow:!0,geometry:t.Object_476.geometry,material:n["Material.013"],position:[.522,.441,-1.263],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_478",castShadow:!0,receiveShadow:!0,geometry:t.Object_478.geometry,material:n["Material.013"],position:[.522,.441,-1.1],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_480",castShadow:!0,receiveShadow:!0,geometry:t.Object_480.geometry,material:n["Material.013"],position:[.522,.441,-.927],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_482",castShadow:!0,receiveShadow:!0,geometry:t.Object_482.geometry,material:n["Material.013"],position:[.522,.44,-.764],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_484",castShadow:!0,receiveShadow:!0,geometry:t.Object_484.geometry,material:n["Material.013"],position:[.527,.441,-1.795],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_486",castShadow:!0,receiveShadow:!0,geometry:t.Object_486.geometry,material:n["Material.013"],position:[.352,.441,-1.795],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_488",castShadow:!0,receiveShadow:!0,geometry:t.Object_488.geometry,material:n["Material.013"],position:[.168,.441,-1.795],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_490",castShadow:!0,receiveShadow:!0,geometry:t.Object_490.geometry,material:n["Material.013"],position:[.168,.441,-1.536],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_492",castShadow:!0,receiveShadow:!0,geometry:t.Object_492.geometry,material:n["Material.013"],position:[.168,.441,-1.197],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_494",castShadow:!0,receiveShadow:!0,geometry:t.Object_494.geometry,material:n["Material.013"],position:[.522,.441,-.59],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_496",castShadow:!0,receiveShadow:!0,geometry:t.Object_496.geometry,material:n["Material.013"],position:[.529,.441,-.402],rotation:[0,-Math.PI/2,0],scale:[.056,.056,.046]}),F.jsx("mesh",{name:"Object_498",castShadow:!0,receiveShadow:!0,geometry:t.Object_498.geometry,material:n["Material.013"],position:[.522,.441,-.242],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_500",castShadow:!0,receiveShadow:!0,geometry:t.Object_500.geometry,material:n["Material.013"],position:[.522,.441,-.068],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_502",castShadow:!0,receiveShadow:!0,geometry:t.Object_502.geometry,material:n["Material.013"],position:[.707,.441,-1.795],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_504",castShadow:!0,receiveShadow:!0,geometry:t.Object_504.geometry,material:n["Material.013"],position:[.904,.441,-1.767],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_506",castShadow:!0,receiveShadow:!0,geometry:t.Object_506.geometry,material:n["Material.013"],position:[.343,.44,-.675],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_508",castShadow:!0,receiveShadow:!0,geometry:t.Object_508.geometry,material:n["Material.013"],position:[.343,.44,-.846],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_510",castShadow:!0,receiveShadow:!0,geometry:t.Object_510.geometry,material:n["Material.013"],position:[.343,.44,-1.017],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_512",castShadow:!0,receiveShadow:!0,geometry:t.Object_512.geometry,material:n["Material.013"],position:[.343,.44,-1.187],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_514",castShadow:!0,receiveShadow:!0,geometry:t.Object_514.geometry,material:n["Material.013"],position:[.343,.44,-1.358],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_516",castShadow:!0,receiveShadow:!0,geometry:t.Object_516.geometry,material:n["Material.013"],position:[.343,.44,-.509],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_518",castShadow:!0,receiveShadow:!0,geometry:t.Object_518.geometry,material:n["Material.013"],position:[.343,.44,-.335],rotation:[0,-Math.PI/2,0],scale:.056}),F.jsx("mesh",{name:"Object_520",castShadow:!0,receiveShadow:!0,geometry:t.Object_520.geometry,material:n["Material.013"],position:[.367,.44,-.153],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_522",castShadow:!0,receiveShadow:!0,geometry:t.Object_522.geometry,material:n["Material.013"],position:[.367,.44,.019],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_524",castShadow:!0,receiveShadow:!0,geometry:t.Object_524.geometry,material:n["Material.013"],position:[.548,.44,.111],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_526",castShadow:!0,receiveShadow:!0,geometry:t.Object_526.geometry,material:n["Material.013"],position:[.168,.441,-.161],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_528",castShadow:!0,receiveShadow:!0,geometry:t.Object_528.geometry,material:n["Material.013"],position:[.168,.44,.002],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_530",castShadow:!0,receiveShadow:!0,geometry:t.Object_530.geometry,material:n["Material.013"],position:[.909,.441,-1.584],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_532",castShadow:!0,receiveShadow:!0,geometry:t.Object_532.geometry,material:n["Material.013"],position:[.919,.441,-1.424],rotation:[0,-Math.PI/2,0],scale:.035}),F.jsx("mesh",{name:"Object_534",castShadow:!0,receiveShadow:!0,geometry:t.Object_534.geometry,material:n["Material.013"],position:[.863,.441,-1.417],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_536",castShadow:!0,receiveShadow:!0,geometry:t.Object_536.geometry,material:n["Material.013"],position:[.671,.441,-.425],rotation:[0,-Math.PI/2,0],scale:.035}),F.jsx("mesh",{name:"Object_538",castShadow:!0,receiveShadow:!0,geometry:t.Object_538.geometry,material:n["Material.013"],position:[.671,.441,-.256],rotation:[0,-Math.PI/2,0],scale:.035}),F.jsx("mesh",{name:"Object_540",castShadow:!0,receiveShadow:!0,geometry:t.Object_540.geometry,material:n["Material.013"],position:[.671,.441,-.085],rotation:[0,-Math.PI/2,0],scale:.035}),F.jsx("mesh",{name:"Object_542",castShadow:!0,receiveShadow:!0,geometry:t.Object_542.geometry,material:n["Material.013"],position:[.671,.441,.083],rotation:[0,-Math.PI/2,0],scale:.035}),F.jsx("mesh",{name:"Object_544",castShadow:!0,receiveShadow:!0,geometry:t.Object_544.geometry,material:n["Material.013"],position:[.729,.44,.226],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_546",castShadow:!0,receiveShadow:!0,geometry:t.Object_546.geometry,material:n["Material.013"],position:[.671,.44,.226],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_548",castShadow:!0,receiveShadow:!0,geometry:t.Object_548.geometry,material:n["Material.013"],position:[.729,.44,.398],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_550",castShadow:!0,receiveShadow:!0,geometry:t.Object_550.geometry,material:n["Material.013"],position:[.671,.44,.397],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_552",castShadow:!0,receiveShadow:!0,geometry:t.Object_552.geometry,material:n["Material.013"],position:[.729,.44,.569],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_554",castShadow:!0,receiveShadow:!0,geometry:t.Object_554.geometry,material:n["Material.013"],position:[.671,.44,.571],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_556",castShadow:!0,receiveShadow:!0,geometry:t.Object_556.geometry,material:n["Material.013"],position:[.493,.441,-.364],rotation:[0,-Math.PI/2,0],scale:.035}),F.jsx("mesh",{name:"Object_558",castShadow:!0,receiveShadow:!0,geometry:t.Object_558.geometry,material:n["Material.013"],position:[.493,.441,-.193],rotation:[0,-Math.PI/2,0],scale:.035}),F.jsx("mesh",{name:"Object_560",castShadow:!0,receiveShadow:!0,geometry:t.Object_560.geometry,material:n["Material.013"],position:[.493,.441,-.025],rotation:[0,-Math.PI/2,0],scale:.035}),F.jsx("mesh",{name:"Object_562",castShadow:!0,receiveShadow:!0,geometry:t.Object_562.geometry,material:n["Material.013"],position:[.316,.441,-.275],rotation:[0,-Math.PI/2,0],scale:.035}),F.jsx("mesh",{name:"Object_564",castShadow:!0,receiveShadow:!0,geometry:t.Object_564.geometry,material:n["Material.013"],position:[.53,.441,.512],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_566",castShadow:!0,receiveShadow:!0,geometry:t.Object_566.geometry,material:n["Material.013"],position:[.356,.441,.529],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_568",castShadow:!0,receiveShadow:!0,geometry:t.Object_568.geometry,material:n["Material.013"],position:[.919,.441,-1.248],rotation:[0,-Math.PI/2,0],scale:.042}),F.jsx("mesh",{name:"Object_570",castShadow:!0,receiveShadow:!0,geometry:t.Object_570.geometry,material:n["Material.013"],position:[.863,.441,-1.247],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_572",castShadow:!0,receiveShadow:!0,geometry:t.Object_572.geometry,material:n["Material.013"],position:[.919,.441,-1.077],rotation:[0,-Math.PI/2,0],scale:.042}),F.jsx("mesh",{name:"Object_574",castShadow:!0,receiveShadow:!0,geometry:t.Object_574.geometry,material:n["Material.013"],position:[.863,.441,-1.076],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_576",castShadow:!0,receiveShadow:!0,geometry:t.Object_576.geometry,material:n["Material.013"],position:[1.035,.441,-1.795],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_578",castShadow:!0,receiveShadow:!0,geometry:t.Object_578.geometry,material:n["Material.013"],position:[.919,.441,-.911],rotation:[0,-Math.PI/2,0],scale:.042}),F.jsx("mesh",{name:"Object_580",castShadow:!0,receiveShadow:!0,geometry:t.Object_580.geometry,material:n["Material.013"],position:[.863,.441,-.905],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_582",castShadow:!0,receiveShadow:!0,geometry:t.Object_582.geometry,material:n["Material.013"],position:[1.056,.441,.523],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_584",castShadow:!0,receiveShadow:!0,geometry:t.Object_584.geometry,material:n["Material.013"],position:[.89,.441,.452],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_586",castShadow:!0,receiveShadow:!0,geometry:t.Object_586.geometry,material:n["Material.013"],position:[.918,.441,.13],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_588",castShadow:!0,receiveShadow:!0,geometry:t.Object_588.geometry,material:n["Material.013"],position:[.908,.441,.294],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_590",castShadow:!0,receiveShadow:!0,geometry:t.Object_590.geometry,material:n["Material.013"],position:[.539,.44,.285],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_592",castShadow:!0,receiveShadow:!0,geometry:t.Object_592.geometry,material:n["Material.013"],position:[.367,.44,.191],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_594",castShadow:!0,receiveShadow:!0,geometry:t.Object_594.geometry,material:n["Material.013"],position:[1.018,.441,-.893],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_596",castShadow:!0,receiveShadow:!0,geometry:t.Object_596.geometry,material:n["Material.013"],position:[1.018,.441,-1.067],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_598",castShadow:!0,receiveShadow:!0,geometry:t.Object_598.geometry,material:n["Material.013"],position:[1.018,.441,-1.234],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_600",castShadow:!0,receiveShadow:!0,geometry:t.Object_600.geometry,material:n["Material.013"],position:[1.018,.441,-1.397],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_602",castShadow:!0,receiveShadow:!0,geometry:t.Object_602.geometry,material:n["Material.013"],position:[1.018,.441,-1.569],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_604",castShadow:!0,receiveShadow:!0,geometry:t.Object_604.geometry,material:n["Material.013"],position:[1.056,.441,.365],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_606",castShadow:!0,receiveShadow:!0,geometry:t.Object_606.geometry,material:n["Material.013"],position:[1.056,.441,.215],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_608",castShadow:!0,receiveShadow:!0,geometry:t.Object_608.geometry,material:n["Material.013"],position:[1.056,.441,.037],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_610",castShadow:!0,receiveShadow:!0,geometry:t.Object_610.geometry,material:n["Material.013"],position:[1.056,.441,-.131],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_612",castShadow:!0,receiveShadow:!0,geometry:t.Object_612.geometry,material:n["Material.013"],position:[1.018,.441,-.733],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_614",castShadow:!0,receiveShadow:!0,geometry:t.Object_614.geometry,material:n["Material.013"],position:[1.018,.441,-.569],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_616",castShadow:!0,receiveShadow:!0,geometry:t.Object_616.geometry,material:n["Material.013"],position:[1.018,.441,-.405],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_618",castShadow:!0,receiveShadow:!0,geometry:t.Object_618.geometry,material:n["Material.013"],position:[1.018,.441,-.238],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_620",castShadow:!0,receiveShadow:!0,geometry:t.Object_620.geometry,material:n["Material.013"],position:[1.018,.441,-.09],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_622",castShadow:!0,receiveShadow:!0,geometry:t.Object_622.geometry,material:n["Material.013"],position:[1.018,.441,.079],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_624",castShadow:!0,receiveShadow:!0,geometry:t.Object_624.geometry,material:n["Material.013"],position:[1.018,.441,.236],rotation:[0,-Math.PI/2,0],scale:.036}),F.jsx("mesh",{name:"Object_626",castShadow:!0,receiveShadow:!0,geometry:t.Object_626.geometry,material:n["Material.013"],position:[.919,.441,-.73],rotation:[0,-Math.PI/2,0],scale:.042}),F.jsx("mesh",{name:"Object_628",castShadow:!0,receiveShadow:!0,geometry:t.Object_628.geometry,material:n["Material.013"],position:[.863,.441,-.732],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_630",castShadow:!0,receiveShadow:!0,geometry:t.Object_630.geometry,material:n["Material.013"],position:[.919,.441,-.565],rotation:[0,-Math.PI/2,0],scale:.042}),F.jsx("mesh",{name:"Object_632",castShadow:!0,receiveShadow:!0,geometry:t.Object_632.geometry,material:n["Material.013"],position:[.863,.441,-.562],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_634",castShadow:!0,receiveShadow:!0,geometry:t.Object_634.geometry,material:n["Material.013"],position:[.919,.441,-.39],rotation:[0,-Math.PI/2,0],scale:.042}),F.jsx("mesh",{name:"Object_636",castShadow:!0,receiveShadow:!0,geometry:t.Object_636.geometry,material:n["Material.013"],position:[.863,.441,-.393],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_638",castShadow:!0,receiveShadow:!0,geometry:t.Object_638.geometry,material:n["Material.013"],position:[.928,.441,-.222],rotation:[0,-Math.PI/2,0],scale:[.042,.042,.035]}),F.jsx("mesh",{name:"Object_640",castShadow:!0,receiveShadow:!0,geometry:t.Object_640.geometry,material:n["Material.013"],position:[.943,.441,-.028],rotation:[0,Math.PI/2,0],scale:[.042,.042,.035]}),F.jsx("mesh",{name:"Object_642",castShadow:!0,receiveShadow:!0,geometry:t.Object_642.geometry,material:n["Material.013"],position:[.863,.441,-.224],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_644",castShadow:!0,receiveShadow:!0,geometry:t.Object_644.geometry,material:n["Material.013"],position:[.863,.441,-.049],rotation:[0,-Math.PI/2,0],scale:.048}),F.jsx("mesh",{name:"Object_646",castShadow:!0,receiveShadow:!0,geometry:t.Object_646.geometry,material:n["Material.013"],position:[.216,.44,.163],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_648",castShadow:!0,receiveShadow:!0,geometry:t.Object_648.geometry,material:n["Material.013"],position:[.216,.441,.532],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_650",castShadow:!0,receiveShadow:!0,geometry:t.Object_650.geometry,material:n["Material.013"],position:[.179,.441,.524],rotation:[0,-Math.PI/2,0],scale:.04}),F.jsx("mesh",{name:"Object_652",castShadow:!0,receiveShadow:!0,geometry:t.Object_652.geometry,material:n.material_0,position:[.884,.403,.915],rotation:[Math.PI/2,0,0],scale:.011})]})}Sp.preload("/models/dell_laptop.glb");const cP=()=>{const{progress:s}=o9();return F.jsx(t9,{center:!0,children:F.jsx("div",{className:"loading",children:F.jsxs("p",{children:["Loading ",Math.round(s),"%"]})})})};function DV(){const[s,e]=te.useState(0),t=Qb[s],n=Qb.length,i=t.projectPreview,r=o=>{e(a=>o=="previous"?a==0?n-1:a-1:a==n-1?0:a+1)};return F.jsxs("section",{id:"projects",className:"desktop:py-40",children:[F.jsx("h1",{className:"desktop:ml-40 tablet:ml-5 phone:ml-3 my-5",children:"02 My Work"}),F.jsxs("div",{className:"w-full flex phone:max-desktop:flex-col",children:[F.jsxs("div",{className:"min-w-[60%] flex flex-col justify-between gap-4 bg-black p-8 rounded-lg",children:[F.jsx("h2",{className:"",children:t.name}),F.jsxs("div",{children:[F.jsxs("p",{className:"opacity-50 text-white leading-relaxed",children:[t.description,F.jsx("br",{})]}),t.extra&&F.jsxs("p",{className:"mt-3 text-accent-color opacity-100",children:[F.jsx("span",{className:"underline",children:"Notice:"})," ",t.extra]})]}),F.jsxs("div",{className:"flex justify-between desktop:items-center tablet:items-start phone:max-tablet:flex-col phone:max-tablet:gap-10",children:[F.jsx("div",{className:"flex gap-3 items-center ",children:t.techStackIcons.map(o=>F.jsx("div",{className:"bg-primary-color w-16 p-2 rounded-lg",children:F.jsx("img",{src:o,alt:""})}))}),F.jsxs("div",{className:"flex flex-col gap-10 desktop:items-end tablet:items-start",children:[t.github&&F.jsxs("a",{href:t.github,className:"flex items-center justify-between gap-4 bg-primary-color p-2 rounded-lg underline desktop:w-full tablet:w-full phone:w-fit",target:"_blank",children:[F.jsx("p",{children:"Repository"}),F.jsx("div",{className:"w-5",children:F.jsx("img",{src:UA,alt:"Github Repository link"})})]}),t.liveSite&&F.jsxs("a",{href:t.liveSite,className:"flex items-center justify-between gap-4 bg-primary-color p-2 rounded-lg underline desktop:w-full tablet:w-full phone:w-fit",target:"_blank",children:[F.jsx("p",{children:"Live Site!"}),F.jsx("div",{className:"w-5",children:F.jsx("img",{src:HO,alt:"Live project link"})})]})]})]}),F.jsxs("div",{className:"flex justify-between items-center",children:[F.jsx("button",{onClick:()=>r("previous"),children:F.jsx("div",{className:"w-10 rounded-full bg-primary-color p-2",children:F.jsx("img",{src:zO,alt:""})})}),F.jsx("button",{onClick:()=>r("next"),children:F.jsx("div",{className:"w-10 rounded-full bg-primary-color p-2",children:F.jsx("img",{src:jO,alt:""})})})]})]}),F.jsx("div",{className:"min-w-[40%] h-[690px]",children:F.jsx(BI,{className:"min-h-[400px] h-full",children:F.jsx(l3,{children:F.jsx(OV,{projectPreview:i,projectIndex:s})})})})]})]})}const Qb=[{name:"Theme Park Managment",description:"This project is a full-stack web application designed to streamline theme park management with role-based functionality for customers, employees, and admins. Customers can explore park details, register/login, and purchase tickets through an intuitive interface. Employees manage database operations, access ride and event data, and track maintenance tasks via a dedicated dashboard. Admins oversee park operations, including employee management, ticket availability, park scheduling, and weather-dependent capacity planning. The app integrates secure user authentication, real-time data updates, and robust reporting features, offering a seamless and efficient way to interact with the park's database.",techStackIcons:[_C,xC,vC],liveSite:"https://gleaming-lokum-158537.netlify.app/",github:"https://github.com/Darrenf040/themepark",projectPreview:"",extra:"Please be aware that since the web app is hosted on a free tier, it may take a little longer to load the live site initially. Thank you for your patience!"},{name:"Weather App",description:"This project is a basic weather application built using JavaScript and Webpack. It fetches real-time weather data from a public API using asynchronous methods, allowing users to check current conditions for any location they search. The app highlights a simple, efficient design and demonstrates the seamless use of Webpack for modular JavaScript development.",techStackIcons:[OS],github:"https://github.com/Darrenf040/Weather-app",liveSite:"",projectPreview:""},{name:"Tic Tac Toe",description:"This project is a classic Tic Tac Toe game built with HTML, CSS, and JavaScript. It offers three difficulty levels—Easy, Medium, and Hard—providing a fun and challenging experience for players of all skill levels. The Hard mode features an unbeatable AI powered by the Minimax algorithm, ensuring optimal gameplay. The project demonstrates clean UI design, dynamic interactivity, and advanced algorithm implementation.",techStackIcons:[yC,gC,OS],liveSite:"https://darrenf040.github.io/Tic-Tac-Toe/",github:"https://github.com/Darrenf040/Tic-Tac-Toe",projectPreview:""}],OV=({projectPreview:s,projectIndex:e})=>{const{viewport:t}=ki(),[n,i]=te.useState(0),[r,o]=te.useState([]);return te.useEffect(()=>{let a=t.width/4,l=[0,-2,1];window.innerWidth<744?(a=Math.max(.8,t.width/5.8),l=[0,0,1]):window.innerWidth<1048?(a=Math.max(1.6,t.width/6.5),l=[0,0,1]):window.innerWidth<500&&(l=[0,0,.5]),o(l),i(a)},[t.width]),F.jsxs(F.Fragment,{children:[F.jsx("ambientLight",{}),F.jsx(HI,{makeDefault:!0,position:[-6,3,1.2],fov:65}),F.jsx(te.Suspense,{fallback:F.jsx(cP,{}),children:F.jsx("group",{scale:n,position:r,children:F.jsx(PV,{video:s,next:e})})}),F.jsx(zI,{enablePan:!1,enableZoom:!1,maxPolarAngle:Math.PI/2,target:[0,0,0]})]})};class W0{constructor(e=0,t="Network Error"){this.status=e,this.text=t}}const BV=()=>{if(!(typeof localStorage>"u"))return{get:s=>Promise.resolve(localStorage.getItem(s)),set:(s,e)=>Promise.resolve(localStorage.setItem(s,e)),remove:s=>Promise.resolve(localStorage.removeItem(s))}},Tr={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:BV()},_T=s=>s?typeof s=="string"?{publicKey:s}:s.toString()==="[object Object]"?s:{}:{},FV=(s,e="https://api.emailjs.com")=>{if(!s)return;const t=_T(s);Tr.publicKey=t.publicKey,Tr.blockHeadless=t.blockHeadless,Tr.storageProvider=t.storageProvider,Tr.blockList=t.blockList,Tr.limitRate=t.limitRate,Tr.origin=t.origin||e},uP=async(s,e,t={})=>{const n=await fetch(Tr.origin+s,{method:"POST",headers:t,body:e}),i=await n.text(),r=new W0(n.status,i);if(n.ok)return r;throw r},hP=(s,e,t)=>{if(!s||typeof s!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e||typeof e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t||typeof t!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},kV=s=>{if(s&&s.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},dP=s=>s.webdriver||!s.languages||s.languages.length===0,fP=()=>new W0(451,"Unavailable For Headless Browser"),NV=(s,e)=>{if(!Array.isArray(s))throw"The BlockList list has to be an array";if(typeof e!="string")throw"The BlockList watchVariable has to be a string"},UV=s=>{var e;return!((e=s.list)!=null&&e.length)||!s.watchVariable},GV=(s,e)=>s instanceof FormData?s.get(e):s[e],pP=(s,e)=>{if(UV(s))return!1;NV(s.list,s.watchVariable);const t=GV(e,s.watchVariable);return typeof t!="string"?!1:s.list.includes(t)},mP=()=>new W0(403,"Forbidden"),HV=(s,e)=>{if(typeof s!="number"||s<0)throw"The LimitRate throttle has to be a positive number";if(e&&typeof e!="string")throw"The LimitRate ID has to be a non-empty string"},zV=async(s,e,t)=>{const n=Number(await t.get(s)||0);return e-Date.now()+n},gP=async(s,e,t)=>{if(!e.throttle||!t)return!1;HV(e.throttle,e.id);const n=e.id||s;return await zV(n,e.throttle,t)>0?!0:(await t.set(n,Date.now().toString()),!1)},yP=()=>new W0(429,"Too Many Requests"),jV=async(s,e,t,n)=>{const i=_T(n),r=i.publicKey||Tr.publicKey,o=i.blockHeadless||Tr.blockHeadless,a=i.storageProvider||Tr.storageProvider,l={...Tr.blockList,...i.blockList},c={...Tr.limitRate,...i.limitRate};return o&&dP(navigator)?Promise.reject(fP()):(hP(r,s,e),kV(t),t&&pP(l,t)?Promise.reject(mP()):await gP(location.pathname,c,a)?Promise.reject(yP()):uP("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:r,service_id:s,template_id:e,template_params:t}),{"Content-type":"application/json"}))},VV=s=>{if(!s||s.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},WV=s=>typeof s=="string"?document.querySelector(s):s,KV=async(s,e,t,n)=>{const i=_T(n),r=i.publicKey||Tr.publicKey,o=i.blockHeadless||Tr.blockHeadless,a=Tr.storageProvider||i.storageProvider,l={...Tr.blockList,...i.blockList},c={...Tr.limitRate,...i.limitRate};if(o&&dP(navigator))return Promise.reject(fP());const h=WV(t);hP(r,s,e),VV(h);const f=new FormData(h);return pP(l,f)?Promise.reject(mP()):await gP(location.pathname,c,a)?Promise.reject(yP()):(f.append("lib_version","4.4.1"),f.append("service_id",s),f.append("template_id",e),f.append("user_id",r),uP("/api/v1.0/email/send-form",f))},XV={init:FV,send:jV,sendForm:KV,EmailJSResponseStatus:W0};var $V={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function vP(s){if(typeof s=="number")return{value:s,unit:"px"};var e,t=(s.match(/^[0-9.]*/)||"").toString();t.includes(".")?e=parseFloat(t):e=parseInt(t,10);var n=(s.match(/[^0-9]*$/)||"").toString();return $V[n]?{value:e,unit:n}:(console.warn("React Spinners: ".concat(s," is not a valid css value. Defaulting to ").concat(e,"px.")),{value:e,unit:"px"})}function Jy(s){var e=vP(s);return"".concat(e.value).concat(e.unit)}var YV=function(s,e,t){var n="react-spinners-".concat(s,"-").concat(t);if(typeof window>"u"||!window.document)return n;var i=document.createElement("style");document.head.appendChild(i);var r=i.sheet,o=`
    @keyframes `.concat(n,` {
      `).concat(e,`
    }
  `);return r&&r.insertRule(o,0),n},Fi=function(){return Fi=Object.assign||function(s){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(s[i]=e[i])}return s},Fi.apply(this,arguments)},JV=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t},qV=YV("FadeLoader","50% {opacity: 0.3} 100% {opacity: 1}","fade");function QV(s){var e=s.loading,t=e===void 0?!0:e,n=s.color,i=n===void 0?"#000000":n,r=s.speedMultiplier,o=r===void 0?1:r,a=s.cssOverride,l=a===void 0?{}:a,c=s.height,h=c===void 0?15:c,f=s.width,p=f===void 0?5:f,y=s.radius,v=y===void 0?2:y,_=s.margin,S=_===void 0?2:_,A=JV(s,["loading","color","speedMultiplier","cssOverride","height","width","radius","margin"]),w=vP(S).value,M=w+18,C=M/2+M/5.5,I=Fi({display:"inherit",position:"relative",fontSize:"0",top:M,left:M,width:"".concat(M*3,"px"),height:"".concat(M*3,"px")},l),O=function(oe){return{position:"absolute",width:Jy(p),height:Jy(h),margin:Jy(S),backgroundColor:i,borderRadius:Jy(v),transition:"2s",animationFillMode:"both",animation:"".concat(qV," ").concat(1.2/o,"s ").concat(oe*.12,"s infinite ease-in-out")}},k=Fi(Fi({},O(1)),{top:"".concat(M,"px"),left:"0"}),N=Fi(Fi({},O(2)),{top:"".concat(C,"px"),left:"".concat(C,"px"),transform:"rotate(-45deg)"}),B=Fi(Fi({},O(3)),{top:"0",left:"".concat(M,"px"),transform:"rotate(90deg)"}),P=Fi(Fi({},O(4)),{top:"".concat(-1*C,"px"),left:"".concat(C,"px"),transform:"rotate(45deg)"}),G=Fi(Fi({},O(5)),{top:"".concat(-1*M,"px"),left:"0"}),Z=Fi(Fi({},O(6)),{top:"".concat(-1*C,"px"),left:"".concat(-1*C,"px"),transform:"rotate(-45deg)"}),Y=Fi(Fi({},O(7)),{top:"0",left:"".concat(-1*M,"px"),transform:"rotate(90deg)"}),se=Fi(Fi({},O(8)),{top:"".concat(C,"px"),left:"".concat(-1*C,"px"),transform:"rotate(45deg)"});return t?te.createElement("span",Fi({style:I},A),te.createElement("span",{style:k}),te.createElement("span",{style:N}),te.createElement("span",{style:B}),te.createElement("span",{style:P}),te.createElement("span",{style:G}),te.createElement("span",{style:Z}),te.createElement("span",{style:Y}),te.createElement("span",{style:se})):null}const ZV=()=>{const s=te.useRef(null),e=te.useRef(null),[t,n]=te.useState(""),[i,r]=te.useState(!1),[o,a]=te.useState(!1),[l,c]=te.useState(!1),h=f=>{f.preventDefault(),r(!0),a(!1),c(!1),XV.sendForm("service_etfueih","template_5l2w6bj",s.current,{publicKey:"2lZk3dR7sn1dwlYJ-"}).then(()=>{n(e.current.value),a(!0),s.current.reset(),r(!1)},p=>{c(!0),r(!1)})};return F.jsxs("form",{ref:s,onSubmit:h,className:"flex flex-col gap-8 justify-between mt-5 bg-[#252525] p-8 desktop:h-[550px] rounded-lg desktop:text-3xl tablet:text-2xl phone:text-base",children:[F.jsxs("div",{className:"flex gap-5",children:[F.jsxs("div",{className:"w-[50%]",children:[F.jsx("label",{children:"Name"}),F.jsx("br",{}),F.jsx("input",{ref:e,type:"text",name:"user_name",defaultValue:"",required:!0})]}),F.jsxs("div",{className:"w-[50%]",children:[F.jsx("label",{children:"Email"}),F.jsx("br",{}),F.jsx("input",{type:"email",name:"user_email",defaultValue:"",required:!0})]})]}),F.jsxs("div",{children:[F.jsx("label",{children:"Message"}),F.jsx("textarea",{name:"message",id:"description",rows:"4",cols:"50",placeholder:"Enter your description here",defaultValue:"",required:!0})," "]}),F.jsx("button",{type:"submit",className:"text-black bg-accent-color rounded-3xl",children:"Submit"}),F.jsxs("div",{className:"flex justify-center",children:[F.jsx(QV,{color:"#d1ff48",loading:i}),o?F.jsx("p",{className:"text-accent-color",children:`Thanks ${t}, Message Sent Sucessfully`}):"",l?F.jsx("p",{className:"text-accent-color",children:"Error Sending Message"}):""]})]})},xP="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0,0,256,256'%20width='75px'%20height='75px'%20fill-rule='nonzero'%3e%3cg%20fill='%23d1ff48'%20fill-rule='nonzero'%20stroke='none'%20stroke-width='1'%20stroke-linecap='butt'%20stroke-linejoin='miter'%20stroke-miterlimit='10'%20stroke-dasharray=''%20stroke-dashoffset='0'%20font-family='none'%20font-weight='none'%20font-size='none'%20text-anchor='none'%20style='mix-blend-mode:%20normal'%3e%3cg%20transform='scale(5.12,5.12)'%3e%3cpath%20d='M41,4h-32c-2.76,0%20-5,2.24%20-5,5v32c0,2.76%202.24,5%205,5h32c2.76,0%205,-2.24%205,-5v-32c0,-2.76%20-2.24,-5%20-5,-5zM17,20v19h-6v-19zM11,14.47c0,-1.4%201.2,-2.47%203,-2.47c1.8,0%202.93,1.07%203,2.47c0,1.4%20-1.12,2.53%20-3,2.53c-1.8,0%20-3,-1.13%20-3,-2.53zM39,39h-6c0,0%200,-9.26%200,-10c0,-2%20-1,-4%20-3.5,-4.04h-0.08c-2.42,0%20-3.42,2.06%20-3.42,4.04c0,0.91%200,10%200,10h-6v-19h6v2.56c0,0%201.93,-2.56%205.81,-2.56c3.97,0%207.19,2.73%207.19,8.26z'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/svg%3e",_P="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='48px'%20viewBox='0%20-960%20960%20960'%20width='48px'%20fill='%23D1FF48'%3e%3cpath%20d='M140-160q-24%200-42-18t-18-42v-520q0-24%2018-42t42-18h680q24%200%2042%2018t18%2042v520q0%2024-18%2042t-42%2018H140Zm340-302L140-685v465h680v-465L480-462Zm0-60%20336-218H145l335%20218ZM140-685v-55%20520-465Z'/%3e%3c/svg%3e";function eW(){return F.jsxs("section",{id:"contact",className:"py-40 flex flex-col justify-center items-center phone:max-tablet:px-3",children:[F.jsxs("div",{className:"flex desktop:gap-16 phone:gap-4 items-center phone:max-tablet:flex-col",children:[F.jsx("h1",{children:"03 Contact Me"}),F.jsxs("div",{className:"flex desktop:gap-12 tablet:gap-4",children:[F.jsx("a",{href:"https://github.com/Darrenf040",target:"_blank",children:F.jsx("div",{className:"w-[75px] h-[75px] desktop:scale-100 tablet:scale-65 phone:scale-50",children:F.jsx("img",{className:"w-full",src:UA,alt:"Github Link"})})}),F.jsx("a",{href:"https://www.linkedin.com/in/darren-francis-8299ab253/",target:"_blank",children:F.jsx("div",{className:"w-[75px] h-[75px] desktop:scale-100 tablet:scale-65 phone:scale-50",children:F.jsx("img",{className:"w-full",src:xP,alt:"Linkedin Link"})})}),F.jsx("a",{href:"mailto:darrenfr83@email.com",children:F.jsx("div",{className:"w-[75px] h-[75px] desktop:scale-100 tablet:scale-65 phone:scale-50",children:F.jsx("img",{className:"w-full",src:_P,alt:"Email Link"})})})]})]}),F.jsx(ZV,{})]})}const tW=()=>F.jsxs("footer",{className:"destop:px-40 tablet:px-10 phone:px-3 py-20 flex justify-between bg-black phone:max-tablet:flex-col phone:max-tablet:items-center phone:max-tablet:gap-5",children:[F.jsx("p",{className:"text-[16px]",href:"",children:"darrenfr83@gmail.com"}),F.jsxs("div",{className:"flex gap-5",children:[F.jsx("a",{className:"w-[25px]",href:"https://www.linkedin.com/in/darren-francis-8299ab253/",target:"_blank",children:F.jsx("img",{src:xP,alt:"Linkedin icon"})}),F.jsx("a",{className:"w-[25px]",href:"https://github.com/Darrenf040",target:"_blank",children:F.jsx("img",{src:UA,alt:"Github icon"})}),F.jsx("a",{className:"w-[25px]",href:"mailto:darrenfr83@email.com",children:F.jsx("img",{src:_P,alt:"Mail icon"})})]}),F.jsxs("p",{className:"text-[16px]",children:["© 2024 Darren Francis ",F.jsx("span",{className:"underline",children:F.jsx(NA,{to:"/credit",children:"Credits"})})]})]});function nW(s){const e=Sp("/gaming_desktop_pc/scene.gltf"),{viewport:t}=ki(),n=Math.max(t.width/35,.6);return F.jsxs("mesh",{scale:n,position:[0,-2.5,-3],onClick:s.onClick,children:[F.jsx("hemisphereLight",{intensity:.15}),F.jsx("pointLight",{intensity:.3}),F.jsx("primitive",{object:e.scene,rotation:[0,19*Math.PI/12,0]})]})}function iW(){const s=te.useRef(null);return F.jsxs(BI,{frameloop:"demand",gl:{preserveDrawingBuffer:!0},children:[F.jsx(HI,{makeDefault:!0,position:[5,5,15],fov:70}),F.jsxs(te.Suspense,{fallback:F.jsx(cP,{}),children:[F.jsx(zI,{ref:s,enableZoom:!1,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/2,enablePan:!1}),F.jsx(l3,{children:F.jsx(nW,{})})]}),F.jsx(g7,{all:!0})]})}function rW(){return F.jsx("section",{id:"hero",className:"py-20 flex flex-col items-center h-screen phone:max-tablet:h-[65vh]",children:F.jsxs("div",{className:"flex flex-col relative w-[100%] items-center flex-1",id:"canvas-container",children:[F.jsxs("div",{className:"max-w-3xl",children:[F.jsx("h1",{className:" text-center",children:"Hi, I'm Darren,"}),F.jsx("h1",{className:" text-center text-accent-color",children:"Full Stack Developer"})]}),F.jsx(iW,{})]})})}const sW=()=>F.jsxs(F.Fragment,{children:[F.jsx(mC,{}),F.jsx(rW,{}),F.jsx(GO,{}),F.jsx(DV,{}),F.jsx(eW,{}),F.jsx(tW,{})]});function oW(){return F.jsx(F.Fragment,{children:F.jsx(fO,{children:F.jsxs(jD,{children:[F.jsx(PS,{path:"/",element:F.jsx(sW,{})}),F.jsx(PS,{path:"/credit",element:F.jsx(wO,{})})]})})})}Zb.createRoot(document.getElementById("root")).render(F.jsx(te.StrictMode,{children:F.jsx(oW,{})}));
